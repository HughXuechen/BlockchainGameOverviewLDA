Transaction Community Identification in Bitcoin
Transaction Community Identification in Bitcoin
Yuhang Zhang, Jun Wang
School of Economics and Management
Beihang University
Beijing 100191, China
{zhangyuhang,king.wang}@buaa.edu.cn
Fei Zhao
SKLSDE, School of Computer Science and Engineering
Beihang University
Beijing 100191, China
zhaofei@nlsde.buaa.edu.cn
Abstract—The emergency of anonymous encrypted digital
currency based on blockchain brings the rapid growth of
financial crimes simultaneously. However, under the condition
of Know Your Customer rules, the traditional rule-based
filtering and supervised pattern recognition methods are mainly
built, which does not apply to the scenario of anonymous
encrypted digital currency. In this paper, we attempt to tackle
this problem by constructing user graph from transactions
and dividing the whole user graph into tightly connected
communities and clustering similar communities into groups.
Experimental results on bitcoin transaction datasets show that
the proposed approach has higher than 92% precision and
higher than 73% recall for identifying gambling and mining
pool communities.
Keywords-community discovery; transaction community
identification; outlier; Abnormal transaction node detection;
I. INTRODUCTION
Financial crimes are serious problems that all govern-
ments need to face, which represents by fraud and money
laundering. It can cause non-negligible harm to national
political, economic and social stability, and pose a great
threat to the financial property security of individuals and
country. Criminals continuously seek new ways of money
transferring to avoid government supervision. Especially
after [1] put forward bitcoin, a distributed and decentralized
encrypted digital currency based on blockchain, financial
crimes in encrypted digital currency such as bitcoin have
grown explosively. How to effectively supervise the trans-
actions and detect communities that connects to financial
crimes in bitcoin becomes an important issue.
However, the problem of transaction community identifi-
cation in transaction networks with incomplete information
is rarely considered in previous researches. A typical trans-
action network is a partial transaction network of anonymous
encrypted digital currencies such as bitcoin. In this paper,
we try to tackle this problem by transaction communities
discovery and clustering on top of constructed user graph.
Firstly, the user graph is constructed by identifying public
key addresses stored in blockchain which belong to the
same user according to two local properties of blockchain
data in bitcoin. In such a way, the massive public key
addresses can be reduced to smaller user entities, which
can mitigate the problem of lacking user information caused
by the anonymity of bitcoin. Secondly, we use community
discovery technology in complex network and unsupervised
clustering method to divide the whole user graph into tightly
connected communities and cluster similar communities
into groups. Experimental results on bitcoin transaction
datasets indicate that our transaction communities discovery
and clustering method can cluster communities involved in
certain financial crimes with reasonable performance.
II. RELATED WORK
In the traditional financial field, rule-based filtering sys-
tems are built on top of business systems to detect violation
of financial regulations, which have their limitation that
rules have to be constructed manually. To overcome this
limitation, researchers begin to use machine learning and
pattern recognition methods to identify transaction patterns
automatically from massive transaction data and distinguish
different types of transactions from each other.
[2] propose a fraud mining scheme based on rule-based
learning theory and the neural network algorithm. [3] use
Support Vector Machine (SVM) to solve the problem of the
high dimension features in suspicious transaction identifica-
tion. [4] propose a method for mining suspicious transactions
in large amount of transaction data with extremely skewed
positive classes. [5] have explored the possibility of using
neural networks to identify suspicious transactions in the
financial field. [6] propose a structured approach for mining
criminal networks, such as core members, sub-members
and relationships among members of the criminal network.
[7] consider various attributes of transaction entity such as
the characteristics of the entity itself, time and transaction
behavior. He suggested that k-means, fuzzy logic and time
series analysis techniques can be used to analyze criminal
networks. There are also attempts of applying machine
learning techniques for suspicious transaction detection for
anti-money laundering [8], [9]. [11] propose a method for
incidence relation acquiring based on clustering in order
to track malicious bitcoin transactions. [12] and [13] both
study the problem of illegal activity discovery on bitcoin
blockchain.
140
2020 13th International Symposium on Computational Intelligence and Design (ISCID)
2473-3547/20/$31.00 ©2020 IEEE
DOI 10.1109/ISCID51228.2020.00038
20
20
 1
3t
h 
In
te
rn
at
io
na
l S
ym
po
si
um
 o
n 
C
om
pu
ta
tio
na
l I
nt
el
lig
en
ce
 a
nd
 D
es
ig
n 
(I
SC
ID
) |
 9
78
-1
-7
28
1-
84
46
-3
/2
0/
$3
1.
00
 ©
20
20
 IE
EE
 | 
D
O
I: 
10
.1
10
9/
IS
C
ID
51
22
8.
20
20
.0
00
38
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:05:28 UTC from IEEE Xplore.  Restrictions apply. 
For most of the above studies, the datasets used for
training come from major banks and stock exchanges, which
are built on the basis of Know Your Customer (KYC)
system [10]. However, the KYC system cannot be enforced
on transactions in anonymous encrypted digital currency
and Over the Counter (OTC) Market exchanges. Therefore,
it is an extremely important to investigate the problem
of transaction communities identification with limited and
incomplete transaction information, which may provide a
solution for supervision of anonymous encrypted digital
currency and non-KYC transaction system.
III. BITCOIN BLOCKCHAIN
Each bitcoin is a chain of transactions from one user to the
next, where users are identified by a public key (public key
for the ECDSA signature). So there are mainly two kinds
of data structures used in Bitcoin: transactions and blocks.
Transactions describe the transfer of bitcoins between users.
Blocks are records of valid transactions. A transaction can
specify multiple inputs and outputs. An output contains a
public key of the recipient. An input contains an output of
a previous transaction which indicates the source of money.
Hence all valid transactions in bitcoin form a transaction
graph in the following way: the vertices of the graph are
transactions, and if an input of current transaction refers
to an output of a previous transaction, then an edge from
the previous transaction to current transaction is added.
The transaction graph is a directed, acyclic graph, which
represents flow of money transferring. The public keys are
usually called addresses as they specify where the bitcoins
transfer to. From the perspective of bitcoin ownership, a
user own the amount of bitcoins transfer to a public key if
he possess a private key that corresponds to that public key.
So these outputs of previous transactions specified as inputs
must correspond to the same private key.
In this paper, we represent a transaction graph as a set of
5-tuples defined in Table I for constructing user graph.
Table I
5-TUPLE FOR TRANSACTION GRAPH
Data item Description
in address addresses of the sender
out address addresses of the recipients
value amount of money in transaction
timestamp time of the transaction
transcation id transaction ID
IV. TRANSACTION COMMUNITY IDENTIFICATION
A transaction community is a tightly connected subgraph
in the user graph, which reflects the transaction activities
that frequently occurs among a group of users. In any
period of time, transactions typically occur in the form
of communities. Hence, transaction communities are better
targets for understanding the characteristics of transactions,
especially abnormal transactions.
Consequently, the first step is to partition the user graph
into a series of communities which have no intersection.
There are a number of algorithms that can achieve this
goal [14], [15], [16]. In this paper, we adopt the classic
Louvain algorithm [17] for community partitioning, because
that it can process large-scale sparse graphs efficiently with
implementation on Spark GraphX [18]. After the partition,
the set C = {C1, C2, . . . , Ck} of community in the user
graph can be obtained. Then, we cluster these transaction
communities into groups to identify their different types.
We attempt to extract the features from communities, and
use feature vectors to represent the structural differences
of diverse transaction communities. This method can be
regarded as data mining based on graph model and the
original transaction data. The mining of community features
is based on the statistics and analysis of the information
stored on the blockchain, and does not include any other
information as the community transaction features.
A. Feature selection
By analyzing the bitcoin transaction data, we choose a few
features that might help to describe the structural differences
between different types of communities, as shown in Table
II.
Table II
FEATURES OF A COMMUNITY
Data item Description
d Degree distribution in a community
din In degree distribution in a community
dout Out degree distribution in a community
ASP Average shortest path length of a community
R Average radius of a community
E Average transaction volume in a community
D Variance of transaction volume in a community
N Number of transactions included in a community
Hub Ratio of in and out degree of hub node
TN Number of transaction nodes
Since the community is regarded as a whole, we need to
make a statistical analysis of the attributes of all the nodes
in the community to obtain the feature values for our study.
In Table II, d represents the degree distribution in a
community. According to our statistical analysis on known
gambling and mining pool communities, the differences of
node degrees between mining pool and gambling community
in bitcoin are mainly concentrated between 0 and 4, so numi
(0 ≤ i ≤ 4) is used to store the number of nodes with
degree i. Meanwhile for the remaining nodes, we divide
the remaining degree space, i.e. 5 ∼ max(degree), evenly
into three parts {low,mid, high} and count the number of
nodes in the each part respectively as described in formula
(1). In order to eliminate the impact of different community
scales on the features, the ratios calculated by formula
(2) are used as a feature for community clustering. Thus,
the feature d can be described by a vector of length 8,
141
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:05:28 UTC from IEEE Xplore.  Restrictions apply. 
i.e. (P0, P1, P2, P3, P4, Plow, Pmid, Phigh). We can obtain
features din and dout similarly.
⎧⎨
⎩
numlow =
∑
i∈low numi
nummid =
∑
i∈mid numi
numhigh =
∑
i∈high numi
(1)
Pi =
numi
n
, i ∈ {0, 1, 2, 3, 4, low,mid, high}, (2)
where n represents the total number of nodes in the com-
munity.
The features Hub is related to hub node, which is defined
as follows.
Definition 1 (Hub). A hub node H(C) of a community C
is a node v with maximum PageRank value in C, which can
be viewed as the central node of the community C.
H(C) = v, (3)
where PageRank(v) = max({PageRank(v′) | v′ ∈ VC}),
and VC is the node set of the community C.
Hub for a community C is defined as the following.
Hub =
inDegree(H(C))
outDegree(H(C))
(4)
The ASP is the average shortest path length of the
community, R is the average radius of the community. When
the community is treated as a sub-graph, ASP and R can
be computed directly with the AvgShortPath and Radius
algorithms for graphs. The other features such as E, D,
TN and N are also easily to compute.
Based on the experimental results, d, din, dout, E, D,
Hub and ASP are selected to be parts of the feature vector
used in this paper. The detailed results and analyzations are
described in the experiment section.
B. Community clustering
On the basis of the above selected features, the community
feature vector is defined as FCi
= (f
(1)
Ci
, f
(2)
Ci
, . . . , f
(7)
Ci
). The
date set can be viewed as the following matrix.
FC =
⎡
⎢⎢⎣
f
(1)
C1
. . . f
(7)
C1
...
. . .
...
f
(1)
Cm
. . . f
(7)
Cm
⎤
⎥⎥⎦ , (5)
where m is the total number of communities, f
(j)
Ci
∈ [0, 1].
All the values in the feature vectors are continuous values
between [0, 1] after normalization. Because the dimension
of the vector is relatively small, we do not need to perform
principal component analysis (PCA) for dimension reduc-
tion. For the identification of transaction community, we use
the k-means algorithm to cluster communities based on the
above features.
V. EXPERIMENTS AND EVALUATIONS
A. Experimental setup
In order to evaluate the effectiveness of the proposed
algorithms, we implement the algorithms in Python 3 with
Pycharm. All experiments are performed on a Windows 7 64
bit system with Intel(R) Core(TM) i7-8700 CPU @3.20GHz,
32GB memory.
We collected four types of labels for public key ad-
dress from websites such as blockchain.info, bitcoin-
whoiswho.com: gambling, mining poll, exchange, and
money laundering. We extract transaction data from two
segments of bitcoin blockchain to construct two datasets
for evaluation. One dataset consists of transaction records
from 2012/09/01 to 2012/10/01, which contains 360, 766
nodes (public key addresses) and 1, 097, 885 transactions
(denoted as BC2012 dataset). The other dataset consists of
transaction records from 2013/05/01 to 2013/05/31, which
contains 823, 688 nodes and 2, 242, 622 transactions (de-
noted as BC2013 dataset). When selecting the two segments
for constructing datasets, we intentionally choose intervals
which contain transaction records involving many nodes
with known labels and occurring in different months.
The metrics used for evaluating the transaction community
identification algorithm are precision, recall, and F1-score,
which are defined in the following based on only the
incomplete labeled.
P =
|TP |
|EXP | (6)
R =
|TP |
|True| (7)
F1 =
2 ∗ |TP |
|EXP |+ |True| (8)
Here TP is the number of labeled communities which are
accurately identified, EXP is the number of all labeled
communities, which contain both positive and negative in-
stances, and True is the number of communities with a
given type of labels. It should be noted that the label of a
community is determined by the label of hub node in the
community.
B. Evaluation of transaction community identification
We use the BC2012 dataset to conduct the experiments of
transaction community identification. After performing the
user graph construction algorithm, we construct a user graph
with transaction data for each 3 days period and discover
256 communities with more than 100 nodes, where 118
communities contain nodes with labels.
In order to cluster different kinds of communities, we
gather several features that describe different characteristics
of the community structure. To determine which sets of
features are optimal for community clustering, we perform
a series of experiments by using different set of features.
142
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:05:28 UTC from IEEE Xplore.  Restrictions apply. 
Table III
RESULTS OF DIFFERENT FEATURE SETS AND TRANSACTION COMMUNITY IDENTIFICATION
Feature set Gambling Pool Exchange Money Laundering
P R P R P R P R
{d,R,ASP,Hub} 62% 83% 78% 60% 62.5% 34.5% 42% 50%
{d, din, R,ASP,Hub} 66% 83% 73% 60% 62.5% 34.5% 43% 50%
{d, dout, R,ASP,Hub} 66% 83% 78% 60% 62.5% 34.5% 43% 50%
{d, din, dout, R,ASP,Hub} 100% 66% 74% 62% 58% 66% 50% 37.5%
{d, din, dout, ASP,Hub} 100% 66% 80% 70% 59% 59% 50% 46%
{d, din, dout, Hub} 100% 68% 93% 60% 45% 48% 35% 50%
{d, din, dout, E,D,ASP,Hub} 97% 73% 92% 80% 78% 69% 60% 52%
Figure 1. The Precision, Recall and F1-scores of different clusters with three representative feature sets
Table III shows the Precision and Recall results for different
feature sets, and Figure 1 shows the Precision, Recall and
F1-score of the communities clustering for three represen-
tative feature sets.
The results listed in Table III is only partial. Nevertheless,
it is enough to demonstrate that we use the control variable
method to select the optimal feature sets. Precision and
Recall are calculated based on communities that contain
nodes with annotations because of lacking annotation data,
which is also the reason that we use unsupervised clustering
other than supervised classification.
Through the clustering results based on different feature
sets, it can be observed that the precision and recall of
gambling community. Moreover, mining pool communities
are obviously superior than those of exchange and money
laundering communities, which is due to the single transac-
tion behavior of gambling and mining pool and their distinct
transaction patterns. Besides, the selected features can reflect
the differences between the two transaction communities.
We can find that the precision, recall and F1-score of the
four types of communities all have better performance when
using feature set (d, din, dout, E,D,ASP,Hub) through the
above experiments. After comprehensive experiments, the
number of clusters is set to 5 during clustering.
VI. CONCLUSION
In this paper, we attempt to utilize user behavior and
association modeling analysis to actively identify transaction
communities with incomplete user information and unpre-
dictable characteristics. The unknown transaction communi-
ties are identified based on clustering on graphs, which pro-
vides a technique for supporting illegal behavior supervision
on digital cryptocurrency such as bitcoin. The transaction
information are used for identifying transaction addresses
which belong to the same user to mitigate the problem of
lacking user information. By applying community discovery
and clustering algorithms on the user graph, suspicious com-
munities are clustered with known communities involved
illegal activities. Experimental results on bitcoin transaction
data show that our methods have reasonable performance on
clustering communities involving in different activities.
There are still spaces of improvement for the transac-
tion community identification. For instance, our user graph
construction algorithm does not support transactions with
more than two new output addresses. It could be improved
by incorporating new heuristic tactics for other types of
transactions to identify addresses that belong to the same
user. With the current feature set selection, the identification
of exchange platform and money laundering network is
not as good as gambling communities and mining pools.
Therefore, finding better feature sets is also one of the
directions of future research.
ACKNOWLEDGMENT
This research work is supported by the National Nat-
ural Science Foundation of China (Grant No. 71871005,
71531001 and 61690202).
REFERENCES
[1] S. Nakamoto, “Bitcoin: A peer-to-peer electronic cash sys-
tem,” 2009.
[2] T. Fawcett and F. Provost, “Adaptive fraud detection,” Data
Mining & Knowledge Discovery, vol. 1, no. 3, pp. 291–316,
1997.
143
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:05:28 UTC from IEEE Xplore.  Restrictions apply. 
[3] B. Scholkopf, S. Mika, and C. Burges, “Input space versus
feature space in kernel-based methods,” IEEE Trans on Neu-
ral Network, vol. 10, no. 5, pp. 1000–1017, 1999.
[4] W. Fan, P. Yu, and H. Wang, “Mining extremely skewed trad-
ing anomalies,” Lecture Notes in Computer Science, vol. 29,
no. 92, pp. 801–810, 2004.
[5] V. Sethi, R. C. King, and J. C. Quick, “What causes stress
in information system professionals,” Communications of the
ACM, vol. 47, no. 3, pp. 99–102, 2004.
[6] J. Xu and H. Chen, “CrimeNet explorer: a framework for
criminal network knowledge discovery,” ACM Transactions
on Information Systems, vol. 23, no. 2, pp. 201–226, 2005.
[7] B. Long, Z. Zhang, and P. Yu, “Spectral clustering for
multi-type relational data,” in International Conference on
Machine Learning, Carnegie Mellon University, Pittsburgh,
USA, 2006, pp. 23–27.
[8] Z. Chen, L. D. V. Khoa, E. N. Teoh, A. Nazir, E. K. Karup-
piah, and K. S. Lam, “Machine learning techniques for anti-
money laundering (aml) solutions in suspicious transaction
detection: a review,” Knowledge and Information Systems,
vol. 57, no. 2, pp. 245–285, 2018.
[9] Y. Zhang and P. Trubey, “Machine learning and sampling
scheme: An empirical study of money laundering detection,”
Computational Economics, 2018.
[10] S. Gohr, “Know your customer,” Callcenter International,
vol. 1, no. 1, pp. 26–29, 2008.
[11] B. Zheng, L. Zhu, and M. Shen, “Malicious bitcoin trans-
action tracing using incidence relation clustering,” in Inter-
national Conference on Mobile Networks and Management,
2017, pp. 313–323.
[12] R. V. Wegberg, J.-J. Oerlemans, and O. V. Deventer, “Bit-
coin money laundering: mixed results?: An explorative study
on money laundering of cybercrime proceeds using bitcoin,”
Journal of Financial Crime, vol. 25, no. 2, pp. 419–435, 2018.
[13] A. Turner, A. Samantha, and M. Irwin, “Bitcoin transactions:
a digital discovery of illicit activity on the blockchain,”
Journal of Financial Crime, vol. 25, no. 1, 2018.
[14] H. Pirim, B. Eksioglu, and F. W. Glover, “A novel mixed
integer linear programming model for clustering relational
networks,” Journal of Optimization Theory and Applications,
vol. 176, no. 2, pp. 492–508, 2018.
[15] Z.-H. Deng, H.-H. Qiao, Q. Song, and L. Gao, “A complex
network community detection algorithm based on label prop-
agation and fuzzy c-means,” Physica A: Statistical Mechanics
and its Applications, vol. 519, pp. 217–226, 2019.
[16] S. Srinivas and C. Rajendran, “Community detection and
influential node identification in complex networks using
mathematical programming,” Expert Systems with Applica-
tions, vol. 135, pp. 296–312, 2019.
[17] V. D. Blondel, J.-L. Guillaume, R. Lambiotte, and E. Lefeb-
vre, “Fast unfolding of communities in large networks,”
Journal of statistical mechanics: theory and experiment, vol.
2008, no. 10, p. P10008, 2008.
[18] M. Zaharia, M. Chowdhury, M. J. Franklin, S. Shenker, and
I. Stoica, “Spark: Cluster computing with working sets,” in
Proceedings of the 2Nd USENIX Conference on Hot Topics
in Cloud Computing, ser. HotCloud’10. Berkeley, CA, USA:
USENIX Association, 2010, pp. 10–10.
[19] J. Hirshman, Y. Huang, and S. Macke, “Unsupervised ap-
proaches to detecting anomalous behavior in the bitcoin
transaction network,” in 2016 Information Security for South
Africa (ISSA), 2013.
[20] S. Meiklejohn, M. Pomarole, G. Jordan, K. Levchenko,
D. McCoy, G. M. Voelker, and S. Savage, “A fistful of bit-
coins: characterizing payments among men with no names,”
in Proceedings of the 2013 conference on Internet measure-
ment conference. ACM, 2013, pp. 127–140.
[21] L. Akoglu, H. Tong, and D. Koutra, “Graph based anomaly
detection and description: a survey,” Data Mining & Knowl-
edge Discovery, vol. 29, no. 3, pp. 626–688, 2015.
[22] N. Christin, “Traveling the silk road: a measurement analysis
of a large anonymous online marketplace,” in Proceedings of
the 22nd International Conference on World Wide Web, 2013,
pp. 356–362.
[23] V. Chandola, A. Banerjee, and V. Kumar, “Anomaly detection
for discrete sequences: A survey,” IEEE Transactions on
Knowledge & Data Engineering, vol. 24, no. 5, pp. 823–839,
2012.
[24] M. Möser, R. Böhme, and D. Breuker, “An inquiry into
money laundering tools in the bitcoin ecosystem,” in eCrime
Researchers Summit (eCRS), San Franciso, CA, USA, 2013,
pp. 34–36.
[25] S. Cai, R. Sun, S. Hao, S. Li, and G. Yuan, “Minimal weighted
infrequent itemset mining-based outlier detection approach on
uncertain data stream,” Neural Computing and Applications,
pp. 1–21, Nov. 2018.
[26] T. Pham and S. Lee, “Anomaly detection in bitcoin network
using unsupervised learning methods,” arXiv:1611.03941,
2017.
[27] R. Deters, “How to detect and contain suspicious transactions
in distributed ledgers,” in SmartBlock. Springer, Cham, 2018,
pp. 149–158.
144
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:05:28 UTC from IEEE Xplore.  Restrictions apply.