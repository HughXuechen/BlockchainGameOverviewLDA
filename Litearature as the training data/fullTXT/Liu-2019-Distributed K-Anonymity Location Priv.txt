书书书
第４２卷　第５期
２０１９年５月
计　　算　　机　　学　　报
ＣＨＩＮＥＳＥＪＯＵＲＮＡＬＯＦＣＯＭＰＵＴＥＲＳ
Ｖｏｌ．４２Ｎｏ．５
Ｍａｙ２０１９
　
收稿日期：２０１８０４２４；在线出版日期：２０１８１２２９．本课题得到国家自然科学基金（Ｕ１７０８２６２，Ｕ１７３６２０３，Ｕ１４０５２５５）、国家“九七三”重点
研究发展计划项目（２０１７ＹＦＢ０８０１８０５）、贵州财经大学引进人才科研启动项目（２０１８ＹＪ１６）、贵州财经大学校级科研基金项目
（２０１８ＸＹＢ０１）资助．刘　海，博士，主要研究领域为位置隐私保护和安全协议设计．Ｅｍａｉｌ：ｌｉｕｈａｉ４７５７＠１６３．ｃｏｍ．李兴华（通信作者），博
士，教授，主要研究领域为网络与信息安全、隐私保护和密码学．Ｅｍａｉｌ：ｘｈｌｉ１＠ｍａｉｌ．ｘｉｄｉａｎ．ｅｄｕ．ｃｎ．雒　彬，博士研究生，主要研究领域
为位置隐私保护和信任评估．王运帷，博士研究生，主要研究领域为区块链和隐私保护．任彦冰，硕士研究生，主要研究方向为区块链和
位置隐私保护．马建峰，博士，长江学者特聘教授，主要研究领域为网络与信息安全、编码理论、密码学．丁红发，博士研究生，讲师，主要
研究领域为数据隐私保护．
基于区块链的分布式犓匿名位置隐私保护方案
刘　海１），２），３），４）　李兴华２），３），４）　雒　彬２），３），４）　王运帷２），３），４）
任彦冰２），３），４）　马建峰２），３），４）　丁红发１）
１）（贵州财经大学信息学院　贵阳　５５００２５）
２）（西安电子科技大学网络与信息安全学院　西安　７１００７１）
３）（西安电子科技大学综合业务网理论及关键技术国家重点实验室　西安　７１００７１）
４）（西安电子科技大学陕西省网络与系统安全重点实验室　西安　７１００７１）
摘　要　由于无需可信第三方和复杂的密码技术就可为请求用户提供准确的查询结果，分布式犓匿名已被广泛地
用于保护基于位置服务中用户的位置隐私．然而，现有分布式犓匿名位置隐私保护方案均未考虑匿名区构造过程
中存在的位置泄露和位置欺骗行为，这使得自利的请求用户会泄露协作用户的真实位置；而自利的协作用户也会
提供虚假的位置导致服务提供商能识别出请求用户的真实位置．因此，现有分布式犓匿名方案并不能有效保护用
户的位置隐私．为了解决上述问题，本文将匿名区的构造视为请求用户与协作用户间的两方博弈，利用区块链记录
博弈双方以及协作用户提供的真实位置作为证据，通过惩罚具有位置泄露和欺骗行为的用户，使其作为请求者时
不能成功构造出匿名区来约束他们的自利性．基于上文，本文提出一个基于区块链的分布式犓匿名位置隐私保护
方案．安全性分析和大量实验表明，本文所提方案不仅能激励协作用户提供真实位置参与匿名区构造，而且能防止
请求用户泄露协作用户的真实位置，还可高效地生成匿名区，从而有效保护用户的位置隐私．
关键词　基于位置的服务；位置隐私保护；分布式犓匿名；匿名区构造；协同构造博弈；区块链
中图法分类号ＴＰ３９１　　　犇犗犐号１０．１１８９７／ＳＰ．Ｊ．１０１６．２０１９．００９４２
犇犻狊狋狉犻犫狌狋犲犱犓犃狀狅狀狔犿犻狋狔犔狅犮犪狋犻狅狀犘狉犻狏犪犮狔犘狉狅狋犲犮狋犻狅狀犛犮犺犲犿犲
犅犪狊犲犱狅狀犅犾狅犮犽犮犺犪犻狀
ＬＩＵＨａｉ１），２），３），４）　ＬＩＸｉｎｇＨｕａ２），３），４）　ＬＵＯＢｉｎ２），３），４）　ＷＡＮＧＹｕｎＷｅｉ２），３），４）
ＲＥＮＹａｎＢｉｎｇ２），３），４）　ＭＡＪｉａｎＦｅｎｇ２），３），４）　ＤＩＮＧＨｏｎｇＦａ１）
１）（犛犮犺狅狅犾狅犳犐狀犳狅狉犿犪狋犻狅狀，犌狌犻狕犺狅狌犝狀犻狏犲狉狊犻狋狔狅犳犉犻狀犪狀犮犲犪狀犱犈犮狅狀狅犿犻犮狊，犌狌犻狔犪狀犵　５５００２５）
２）（犛犮犺狅狅犾狅犳犆狔犫犲狉犈狀犵犻狀犲犲狉犻狀犵，犡犻犱犻犪狀犝狀犻狏犲狉狊犻狋狔，犡犻′犪狀　７１００７１）
３）（犛狋犪狋犲犓犲狔犔犪犫狅狉犪狋狅狉狔狅犳犐狀狋犲犵狉犪狋犲犱犛犲狉狏犻犮犲狊犖犲狋狑狅狉犽狊，犡犻犱犻犪狀犝狀犻狏犲狉狊犻狋狔，犡犻′犪狀　７１００７１）
４）（犛犺犪犪狀狓犻犓犲狔犔犪犫狅狉犪狋狅狉狔狅犳犖犲狋狑狅狉犽犪狀犱犛狔狊狋犲犿犛犲犮狌狉犻狋狔，犡犻犱犻犪狀犝狀犻狏犲狉狊犻狋狔，犡犻′犪狀　７１００７１）
犃犫狊狋狉犪犮狋　Ｗｉｔｈｔｈｅｄｅｖｅｌｏｐｍｅｎｔｏｆｗｉｒｅｌｅｓｓｃｏｍｍｕｎｉｃａｔｉｏｎａｎｄｐｏｓｉｔｉｏｎｉｎｇｔｅｃｈｎｏｌｏｇｉｅｓ，ｌｏｃａｔｉｏｎ
ｂａｓｅｄｓｅｒｖｉｃｅ（ＬＢＳ）ｈａｓｂｅｃｏｍｅａｐａｒｔｏｆｏｕｒｄａｉｌｙｌｉｆｅ．Ｈｏｗｅｖｅｒ，ｓｉｎｃｅＬＢＳａｌｗａｙｓｒｅｑｕｉｒｅｓｔｈｅ
ｕｓｅｒｓｔｏｓｕｂｍｉｔｔｈｅｉｒｌｏｃａｔｉｏｎｓ，ａｎｕｎｐｒｅｃｅｄｅｎｔｅｄｔｈｒｅａｔａｂｏｕｔｌｏｃａｔｉｏｎｐｒｉｖａｃｙｏｆｍｏｂｉｌｅｕｓｅｒｓ
ｃｏｍｅｓｗｉｔｈｔｈｅｃｏｎｖｅｎｉｅｎｃｅｏｆｗｉｄｅｌｙｕｓｅｄｔｅｃｈｎｉｑｕｅ．Ｔｈｅｒｅｆｏｒｅ，ＬＢＳｌｏｃａｔｉｏｎｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎ
ｈａｓａｔｔｒａｃｔｅｄｓｕｂｓｔａｎｔｉａｌａｔｔｅｎｔｉｏｎ．ＡｍｏｎｇｔｈｅｅｘｉｓｔｉｎｇＬＢＳｌｏｃａｔｉｏｎｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎｍｅｔｈｏｄｓ，
ｔｈｅｄｉｓｔｒｉｂｕｔｅｄ犓ａｎｏｎｙｍｉｔｙｔｅｃｈｎｉｑｕｅｉｓｏｎｅｏｆｔｈｅｍｏｓｔｃｏｍｍｏｎａｎｄｐｏｐｕｌａｒｍｅｔｈｏｄｓ．Ｉｎｔｈｉｓ
《
 计
 算
 机
 学
 报
 》
ｔｅｃｈｎｉｑｕｅ，ｗｉｔｈｏｕｔａｎｙｔｒｕｓｔｅｄｔｈｉｒｄｐａｒｔｙ，ｔｈｅｒｅｑｕｅｓｔｕｓｅｒｃａｎｓｕｂｍｉｔａｎａｎｏｎｙｍｏｕｓｃｌｏａｋｉｎｇ
ｒｅｇｉｏｎｔｈａｔｉｎｃｌｕｄｅｓｔｈｅｌｏｃａｔｉｏｎｓｏｆｏｔｈｅｒｃｏｏｐｅｒａｔｉｖｅｕｓｅｒｓｉｎｓｔｅａｄｏｆｈｉｓ／ｈｅｒｒｅａｌｌｏｃａｔｉｏｎ．Ｉｎ
ｔｈｉｓｗａｙ，ｔｈｅａｄｖｅｒｓａｒｙｃａｎｉｄｅｎｔｉｆｙｔｈｅｒｅｑｕｅｓｔｕｓｅｒ’ｓｒｅａｌｌｏｃａｔｉｏｎｗｉｔｈａｓｕｆｆｉｃｉｅｎｔｎｅｇｌｉｇｉｂｌｅ
ｐｒｏｂａｂｉｌｉｔｙ．Ｆｕｒｔｈｅｒｍｏｒｅ，ｃｏｍｐａｒｅｄｗｉｔｈｏｔｈｅｒｍｅｔｈｏｄｓ，ｔｈｅｄｉｓｔｒｉｂｕｔｅｄ犓ａｎｏｎｙｍｉｔｙｍｅｔｈｏｄｉｓ
ａｂｌｅｔｏｐｒｏｖｉｄｅｐｒｅｃｉｓｅｑｕｅｒｙｒｅｓｕｌｔｓｗｉｔｈｏｕｔａｎｙｒｅｑｕｉｒｅｍｅｎｔｆｏｒｃｏｍｐｌｉｃａｔｅｄｃｒｙｐｔｏｇｒａｐｈｉｃ
ｔｅｃｈｎｏｌｏｇｉｅｓｒｅｄｕｃｅｔｈｅｒｅｑｕｅｓｔｕｓｅｒ’ｓｃｏｍｐｕｔａｔｉｏｎａｌｂｕｒｄｅｎ．Ｉｎｌｉｇｈｔｏｆｔｈｅｓｅａｄｖａｎｔａｇｅｓ，ｔｈｅ
ｄｉｓｔｒｉｂｕｔｅｄ犓ａｎｏｎｙｍｉｔｙｍｅｔｈｏｄｈａｓｂｅｅｎｗｉｄｅｌｙｕｓｅｄｔｏｐｒｏｔｅｃｔｔｈｅｒｅｑｕｅｓｔｕｓｅｒ’ｓｌｏｃａｔｉｏｎ
ｐｒｉｖａｃｙｗｈｅｎｈｅ／ｓｈｅｅｎｊｏｙｓＬＢＳ．Ｈｏｗｅｖｅｒ，ｔｈｅｅｘｉｓｔｉｎｇｄｉｓｔｒｉｂｕｔｅｄ犓ａｎｏｎｙｍｉｔｙｌｏｃａｔｉｏｎｐｒｉｖａｃｙ
ｐｒｏｔｅｃｔｉｏｎｓｃｈｅｍｅｓｄｏｎｏｔｃｏｎｓｉｄｅｒｌｏｃａｔｉｏｎｌｅａｋｉｎｇｂｅｈａｖｉｏｒｓａｎｄｌｏｃａｔｉｏｎｃｈｅａｔｉｎｇｂｅｈａｖｉｏｒｓｄｕｒｉｎｇ
ｔｈｅｃｏｎｓｔｒｕｃｔｉｏｎｏｆａｎｏｎｙｍｏｕｓｃｌｏａｋｉｎｇｒｅｇｉｏｎ．Ｗｈｅｎｄｉｒｅｃｔｌｙａｄｏｐｔｉｎｇｔｈｅｅｘｉｓｔｉｎｇｓｃｈｅｍｅｓ，ｏｎ
ｏｎｅｈａｎｄ，ａｓｅｌｆｉｓｈｒｅｑｕｅｓｔｕｓｅｒｃｏｕｌｄｄｉｓｃｌｏｓｅｔｈｅｃｏｏｐｅｒａｔｉｖｅｕｓｅｒｓ’ｌｏｃａｔｉｏｎｓｔｏｇａｉｎｉｌｌｅｇａｌ
ｂｅｎｅｆｉｔｓ．Ｏｎｔｈｅｏｔｈｅｒｈａｎｄ，ａｓｅｌｆｉｓｈｃｏｏｐｅｒａｔｉｖｅｕｓｅｒｃｏｕｌｄｐｒｏｖｉｄｅａｆａｋｅｌｏｃａｔｉｏｎ，ｗｈｉｃｈｌｅａｄｓ
ｔｈａｔｔｈｅｃｏｎｓｔｒｕｃｔｅｄａｎｏｎｙｍｏｕｓｃｌｏａｋｉｎｇｒｅｇｉｏｎｃａｎｎｏｔｓａｔｉｓｆｙｔｈｅｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎｒｅｑｕｉｒｅｍｅｎｔ
ｏｆｔｈｅｒｅｑｕｅｓｔｕｓｅｒａｎｄｍｏｒｅｓｅｒｉｏｕｓｌｙ，ｔｈｅａｄｖｅｒｓａｒｙｃｏｕｌｄｂｅｕｓｅｄｔｏｄｉｒｅｃｔｌｙｉｄｅｎｔｉｆｙｔｈｅｒｅｑｕｅｓｔ
ｕｓｅｒ’ｓｒｅａｌｌｏｃａｔｉｏｎ．Ｔｈｅｒｅｆｏｒｅ，ｔｈｅｓｅｓｃｈｅｍｅｓｃａｎｎｏｔｐｒｏｔｅｃｔｔｈｅｕｓｅｒｓ’ｌｏｃａｔｉｏｎｐｒｉｖａｃｙ
ｃｏｍｐｌｅｔｅｌｙ．Ｆｏｒｔｕｎａｔｅｌｙ，ｂｌｏｃｋｃｈａｉｎｃａｎｐｒｏｖｉｄｅａｎｏｐｅｎａｎｄｄｉｓｔｒｉｂｕｔｅｄｌｅｄｇｅｒｔｈａｔｇｕａｒａｎｔｅｅｓｔｈａｔ
ｔｈｅｒｅｃｏｒｄｅｄｔｒａｎｓａｃｔｉｏｎｓａｒｅｉｎｈｅｒｅｎｔｌｙｒｅｓｉｓｔａｎｔｔｏｍｏｄｉｆｉｃａｔｉｏｎ．Ｔｏａｄｄｒｅｓｓｔｈｅｐｒｏｂｌｅｍ
ｍｅｎｔｉｏｎｅｄａｂｏｖｅ，ｔｈｉｓｐａｐｅｒｉｎｔｒｏｄｕｃｅｓｂｌｏｃｋｃｈａｉｎｉｎｔｏｔｈｅｄｉｓｔｒｉｂｕｔｅｄ犓ａｎｏｎｙｍｉｔｙｌｏｃａｔｉｏｎ
ｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎａｎｄｐｒｏｐｏｓｅｓａｎａｄｖａｎｃｅｄｓｃｈｅｍｅ．Ｉｎｔｈｅｐｒｏｐｏｓｅｄｓｃｈｅｍｅ，ｔｈｅｃｏｎｓｔｒｕｃｔｉｏｎｏｆ
ａｎｏｎｙｍｏｕｓｃｌｏａｋｉｎｇｒｅｇｉｏｎｉｓｆｉｒｓｔｌｙｒｅｇａｒｄｅｄａｓａｔｗｏｐａｒｔｙｃｏｏｐｅｒａｔｉｏｎｃｏｎｓｔｒｕｃｔｉｏｎｇａｍｅ
ｂｅｔｗｅｅｎｔｈｅｒｅｑｕｅｓｔｕｓｅｒａｎｄｃｏｏｐｅｒａｔｉｖｅｕｓｅｒｔｏａｎａｌｙｚｅｔｈｅｉｒｓｔｒａｔｅｇｉｅｓａｎｄｕｔｉｌｉｔｉｅｓ，ａｎｄｔｈｅｎ
ｔｈｅｓｅｃｕｒｉｔｙｏｆｄｉｓｔｒｉｂｕｔｅｄ犓ａｎｏｎｙｍｉｔｙｌｏｃａｔｉｏｎｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎｉｓｇｉｖｅｎ．Ａｆｔｅｒｗａｒｄｓ，ｂｙ
ａｄｏｐｔｉｎｇｂｌｏｃｋｃｈａｉｎｔｏｒｅｃｏｒｄｔｈｅｕｓｅｒｓｉｎｖｏｌｖｅｄｉｎｔｈｅｃｏｎｓｔｒｕｃｔｉｏｎｏｆａｎｏｎｙｍｏｕｓｃｌｏａｋｉｎｇｒｅｇｉｏｎ
ａｎｄｔｈｅｐｒｏｖｉｄｅｄｌｏｃａｔｉｏｎｓａｓｅｖｉｄｅｎｃｅｓ，ｔｈｅｃｏｒｒｅｓｐｏｎｄｉｎｇｕｓｅｒｓａｒｅｐｕｎｉｓｈｅｄｗｉｔｈｕｎｓｕｃｃｅｓｓｆｕｌｌｙ
ｃｏｎｓｔｒｕｃｔｉｎｇｔｈｅａｎｏｎｙｍｏｕｓｃｌｏａｋｉｎｇｉｎｔｈｅｉｒｆｕｔｕｒｅＬＢＳｑｕｅｒｉｅｓｗｈｅｎｌｏｃａｔｉｏｎｌｅａｋｉｎｇｏｒｃｈｅａｔｉｎｇ
ｂｅｈａｖｉｏｒｓｏｃｃｕｒ．Ｔｈｅｓｅｃｕｒｉｔｙａｎａｌｙｓｉｓｄｅｍｏｎｓｔｒａｔｅｓｔｈａｔｔｈｅｐｒｏｐｏｓｅｄｓｃｈｅｍｅｎｏｔｏｎｌｙｐｒｅｖｅｎｔｓ
ｔｈｅｒｅｑｕｅｓｔｕｓｅｒｆｒｏｍｄｉｓｃｌｏｓｉｎｇｔｈｅｃｏｏｐｅｒａｔｉｖｅｕｓｅｒｓ’ｌｏｃａｔｉｏｎｓｂｕｔａｌｓｏｐｒｏｍｏｔｅｓｔｈｅｃｏｏｐｅｒａｔｉｖｅ
ｕｓｅｒｓｔｏｐｒｏｖｉｄｅｔｈｅｒｅａｌｌｏｃａｔｉｏｎｓ，ｔｈｅｒｅｂｙｅｆｆｅｃｔｉｖｅｌｙｐｒｏｔｅｃｔｉｎｇｌｏｃａｔｉｏｎｐｒｉｖａｃｙｏｆｔｈｅｒｅｑｕｅｓｔｕｓｅｒ
ａｎｄｃｏｏｐｅｒａｔｉｖｅｕｓｅｒｓ．Ｅｘｔｅｎｓｉｖｅｅｘｐｅｒｉｍｅｎｔｓｉｎｄｉｃａｔｅｔｈａｔｔｈｅｐｒｏｐｏｓｅｄｓｃｈｅｍｅｄｏｅｓｎｏｔｉｎｃｒｅａｓｅ
ｔｈｅｃｏｍｐｕｔａｔｉｏｎｄｅｌａｙａｎｄｃｏｍｍｕｎｉｃａｔｉｏｎｃｏｓｔｏｎｂｏｔｈｔｈｅｒｅｑｕｅｓｔｕｓｅｒｓｉｄｅａｎｄｔｈｅｃｏｏｐｅｒａｔｉｖｅ
ｕｓｅｒｓｉｄｅ，ｗｈｉｃｈｓｈｏｗｓｔｈａｔｔｈｅｐｒｏｐｏｓｅｄｓｃｈｅｍｅｃａｎｃｏｎｓｔｒｕｃｔｔｈｅａｎｏｎｙｍｏｕｓｃｌｏａｋｉｎｇｒｅｇｉｏｎ
ｅｆｆｉｃｉｅｎｔｌｙ．
犓犲狔狑狅狉犱狊　ｌｏｃａｔｉｏｎｂａｓｅｄｓｅｒｖｉｃｅ；ｌｏｃａｔｉｏｎｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎ；ｄｉｓｔｒｉｂｕｔｅｄ犓ａｎｏｎｙｍｉｔｙ；ａｎｏｎｙｍｏｕｓ
ｃｌｏａｋｉｎｇｒｅｇｉｏｎｃｏｎｓｔｒｕｃｔｉｏｎ；ｃｏｏｐｅｒａｔｉｏｎｃｏｎｓｔｒｕｃｔｉｏｎｇａｍｅ；ｂｌｏｃｋｃｈａｉｎ
１　引　言
基于位置的服务（ＬｏｃａｔｉｏｎＢａｓｅｄＳｅｒｖｉｃｅ，
ＬＢＳ）［１２］是根据用户提供的位置信息，在地理信息
系统平台的支持下，为用户提供包括兴趣点查询、广
告推送和娱乐游戏在内的增值服务．随着移动通信
技术的不断发展以及智能终端设备的不断普及，
ＬＢＳ已被广泛地应用到电子商务、卫生医疗和移动
社交等领域，成为人们日常生活必不可少的重要组
成．据一项最新报告显示①，２０１７年美国共有２．２０
亿ＬＢＳ用户，占其人口总数的６８．０９％，预计到
２０１８年ＬＢＳ用户将增至２．４２亿．
然而，随着ＬＢＳ的广泛应用，ＬＢＳ中的位置隐
私泄露问题受到了用户的广泛关注［３７］．造成用户位
置隐私泄露的主要原因是位置服务提供商（Ｌｏｃａｔｉｏｎ
ｂａｓｅｄＳｅｒｖｉｃｅＰｒｏｖｉｄｅｒ，ＬＳＰ）会利用数据挖掘等技
３４９５期 刘　海等：基于区块链的分布式犓匿名位置隐私保护方案
①ｈｔｔｐｓ：／／ｗｗｗ．ｓｔａｔｉｓｔａ．ｃｏｍ／ｓｔａｔｉｓｔｉｃｓ／４３６０７１／ｌｏｃａｔｉｏｎ
ｂａｓｅｄｓｅｒｖｉｃｅｕｓｅｒｓｕｓａ．
《
 计
 算
 机
 学
 报
 》
术从用户提交的位置信息中非法获取用户的个人敏
感信息［８９］，如家庭／工作地址、个人嗜好、生活习惯
等．犓匿名［１０１１］是ＬＢＳ位置隐私保护中最常见的一
种方法，其基本思想是当发送ＬＢＳ查询请求时，用
户首先至少获取其他犓－１个协作用户真实位置后
构建一个匿名区，然后再将该匿名区替代自己的真
实位置提交给ＬＳＰ，从而有效保护自己的个人位置
隐私．与其他位置隐私保护方法相比，如差分隐
私［１２１３］、位置坐标变换［１４１５］和基于密码学［１６１７］的方
法，犓匿名方法具有以下优势：（１）不依赖复杂的密
码技术；（２）可有效地降低用户的计算开销；（３）可
让用户获取准确的查询结果，享受较高的ＬＢＳ服务
质量．
但是，在传统的犓匿名方法［１８１９］中，需要一个
集中式的节点来当匿名服务器，为请求用户构造匿
名区．一旦匿名服务器被攻破，攻击者就能轻而易举
地获取请求用户和协作用户的真实位置．并且，集中
式匿名服务器的存在，不仅使得用户（包括请求用户
和协作用户）与匿名服务器间存在通信瓶颈，而且完
全可信的第三方在现实环境中也难以找到．这都导
致集中式犓匿名方法并不实用．为了解决该问题，
学者们又提出无需可信第三方的分布式犓匿名位
置隐私保护方法［１８３５］．在该方法中，请求用户可直接
与周围协作用户进行协商并获取协作用户的真实位
置，自主式地生成匿名区来保护自己的位置隐私．然
而，现有的分布式犓匿名位置隐私保护方案却存在
以下两个问题：
（１）收到协作用户提供的真实位置后，自利的
请求用户会将这些位置信息泄露给第三方以获取额
外收益；或者恶意的攻击者会假扮为请求用户来获
取协作用户的真实位置，从而导致协作用户位置隐
私的泄露．
（２）收到请求用户发送的协作请求后，即使某
些协作用户位于敏感区域，但由于自利性，其仍会提
供虚假位置给请求用户来提高自己的活跃度（或信
誉值），以便自己作为请求者时能高效地构造出匿名
区．如果自利的协作用户随机生成一个位于无移动
用户区域内的虚假位置给请求用户来构造匿名区，
由于ＬＳＰ可利用背景知识如网络监视技术或区域
监视技术识别出无用户区域［３６］，ＬＳＰ就能缩小匿名
区．这不仅导致请求用户的位置隐私保护需求难以
得到满足，甚至还使得ＬＳＰ可直接推测出请求用户
的隐私信息，如图１所示．假设请求用户Ａｌｉｃｅ使用
分布式犓匿名隐私保护方法保护其位置隐私．当
Ａｌｉｃｅ发送匿名区构造协作请求后，协作用户Ｂｏｂ
正在酒吧酗酒．此时，他既不想提供自己的真实位置
来泄露自己酗酒的不良嗜好，又想参与匿名区构造
以提升自己的活跃度使得自己作为请求者时能获得
他人帮助，因此Ｂｏｂ就随机生成了一个位于河流中
心的虚假位置提供给Ａｌｉｃｅ．Ａｌｉｃｅ在收到协作用户
Ｂ提供的位置后，将构造出的匿名区连同自己的查
询内容提交给ＬＳＰ，如图１（ａ）所示．当收到Ａｌｉｃｅ提
交的匿名区后，ＬＳＰ识别出该匿名区中的无人区
域，发现缩小后的匿名区属于医院区域，如图１（ｂ）
所示．此时，ＬＳＰ就能以极大概率推测出Ａｌｉｃｅ的身
体健康状况，从而非法获取请求用户Ａｌｉｃｅ的个人
隐私．
图１　协作用户提供虚假位置给请求用户的示例图
综上所述，由于未考虑匿名区构造过程中存在
的位置泄露和欺骗行为，现有的分布式犓匿名位置
隐私保护方案并不能完全保护用户的位置隐私．为
了解决上述问题，本文提出了一个基于区块链的分
布式犓匿名位置隐私保护方案．据作者所知，这是
第一个利用区块链来研究ＬＢＳ位置隐私保护的方
案．本文的主要贡献如下：
（１）通过记录参与匿名区构造的请求用户、协作
用户及其提供的位置信息作为证据，惩罚具有位置泄
露和欺骗行为的用户，使其作为请求者时不能构造出
匿名区，并设计一个交互记录机制来约束匿名区构
造过程中请求用户和协作用户的自利性行为．
（２）基于设计的交互记录机制，结合区块链技
术，本文提出一个分布式犓匿名位置隐私保护方
案．安全性分析证明该方案在有效防止请求用户泄
露协作用户的位置信息的同时，还能激励协作用户
提供真实位置来参与匿名区的构造．
（３）大量实验表明，当请求用户使用本方案构
造匿名区时，其与协作用户所需的计算开销、通信开
销和存储开销较少，能高效地构造出匿名区．这说明
本方案具有较好的实用性．
４４９ 计　　算　　机　　学　　报 ２０１９年
《
 计
 算
 机
 学
 报
 》
２　相关工作
２１　分布式环境下匿名区的构造方法
分布式犓匿名位置隐私保护方法最早是由
Ｃｈｏｗ等人［２０］提出的，其基本思想是请求用户利用
点对点通信方式获取至少其他犓－１个协作用户的
真实位置构造匿名区，使得ＬＳＰ仅能以不高于１／犓
的概率从匿名区中猜测出请求用户的真实位置．然
而，在他们的方案中，请求用户和协作用户需要拥有
两个独立的通信网络，分别用于Ｐ２Ｐ通信和ＬＢＳ查
询通信．这极大地降低了该方案的实用性．Ｇｈｉｎｉｔａ
等人［２１］利用Ｈｉｂｅｒｔ曲线将请求用户和协作用户的
位置信息从二维空间映射至一维空间，并将每个用
户的一维位置信息存储于Ｂ＋树的数据节点中，使
得请求用户可快速获取相邻协作用户的真实位置来
构造匿名区．但是，当协作用户较多时，请求用户需
从Ｂ＋树的根节点进行检索，从而增大了请求用户
的计算开销．为了解决该问题，文献［２２］又利用环形
结构替代Ｂ＋树结构存储所有用户的一维位置，使
得请求用户可快速查找相邻用户构造匿名区．Ｃｈｏｗ
等人［２３］指出请求用户在构造匿名区时需结合实际
的道路交通网络，否则ＬＳＰ就可根据道路交通网络
从请求用户提交的匿名区中识别出某些协作用户的
真实位置，乃至直接识别出请求用户的真实位置．他
们为请求用户在每条道路上进行ＬＢＳ查询设置不
同的服务质量，在确保服务质量的前提下，使得生成
的匿名区中尽可能多地包含交叉路口，提高请求用
户的位置隐私保护等级．Ｓｕｎ等人［２４］将网络中所有
用户的真实位置进行分类，提出基于位置标签的分
布式犓匿名隐私保护方案．在他们的方案中，请求
用户构造的匿名区中不仅要至少包括犓－１个协作
用户的真实位置，并且协作用户真实位置的类型也
要与请求用户真实位置的类型一致．
２２　分布式环境下协作用户位置的获取方法
当请求用户未收到犓－１个协作用户发送的位
置信息时，上述方案均通过提高点对点通信跳数的
方法来获取更多协作用户提供的位置信息．这势必
增加网络传输延迟，加重网络通信负担．为了解决该
问题，Ｃｈｏｗ等人［２５］提出利用历史协作用户的真实
位置为请求用户构造匿名区．在他们的方案中，请求
用户在进行每次ＬＢＳ查询后，均会将采用的协作用
户的位置信息进行存储．若下次ＬＢＳ查询时获得的
协作用户数量不满足其位置隐私保护需求，可直接
利用历史协作用户提供的位置信息参与构造匿名
区．为了降低请求用户的存储开销，Ｋｉｍ等人［２６］采
用Ｈｉｂｅｒｔ曲线对历史协作用户的位置信息进行降
维处理，并利用构造出的匿名区的信息熵来度量请
求用户的位置隐私保护等级，提出了基于网格的分
布式犓匿名位置隐私保护方案．Ｐｅｎｇ等人［２７］通过
让合法请求用户发送虚假查询的方式混淆自己的真
实查询，提出了一个适用于分布式网络的犓匿名位
置隐私保护方案．在他们的方案中，请求用户通过发
送虚假协作请求获取协作用户的真实位置，并将它
们存入缓存中．当请求用户需要向ＬＳＰ发送查询请
求时，可利用缓存中存取的位置信息构造匿名区．除
采用历史协作用户的位置信息外，Ｚｈｏｎｇ和Ｈｅｎｇ
ａｒｔｎｅｒ［２８］、Ｔａｋａｂｉ等人［２９］结合现有移动通信基础设
施，分别提出了两个基于区域感知的分布式犓匿名
位置隐私保护方案．他们的基本思想是让请求用户
随机构造匿名区，通过向移动通信运营商询问该区
域内包含的其他用户数量来确定该匿名区是否满足
请求用户的隐私保护需求．然而，这两个方案均不能
抵抗来自移动通信运营商和ＬＳＰ的合谋攻击．Ｃｈｅ
等人［３０］通过让网络中所有用户主动发送自己的真
实位置以及自己周围邻居的位置信息表的方法，提
出了一个双向主动的分布式犓匿名隐私保护方案．
Ｈｗａｎｇ和Ｈｕａｎｇ［３１］、Ｈｗａｎｇ等人［３２］提出请求用户
可利用社交网络获取协作用户的真实位置来构造匿
名区．
２３　分布式犓匿名中的激励机制
Ｙａｎｇ等人［３３］指出原有的分布式犓匿名隐私
保护方案均假设协作用户是诚实的，他们在收到请
求用户发送的匿名区协作构造请求后，会提供自己
真实的位置给请求用户．然而，在现实环境中，用户
都是自利的．若请求用户直接使用这些方案保护自
己ＬＢＳ查询时的位置隐私，将难以获得满足自己隐
私保护需求的协作用户真实位置数量来构造匿名
区．他们利用单轮密封式双重拍卖机制允许多个请
求用户通过拍卖的方式获取协作用户的真实位置，
从而激励网络中的所有用户都参与到匿名区的构
造．Ｚｈａｎｇ等人［３４］指出当请求用户的真实位置过于
敏感时，若采用方案［３３］的方法，其将难以拍卖到满
足隐私保护需求的协作用户位置数量来构造匿名
区．为了解决该问题，他们利用贪心算法设计了一个
中标判定规则，使得所有请求用户均能获得满足其
隐私保护需求的位置数量来构造匿名区．Ｌｉ等人［３５］
指出上述两个方案均需要存在可信的拍卖者，否则
５４９５期 刘　海等：基于区块链的分布式犓匿名位置隐私保护方案
《
 计
 算
 机
 学
 报
 》
其可将请求用户与协作用户的位置信息泄露给
ＬＳＰ．他们将信誉引入到匿名区构造中，提出了基于
信誉激励的分布式犓匿名区隐私保护方案．在他们
的方案中，协作用户只会帮助信誉值高的请求用户
构造匿名区，而每个用户的信誉值则靠帮助其它用
户构造匿名区来提升．此外，Ｇｏｎｇ等人［３６３７］指出为
了更好地保护请求用户的位置隐私，请求用户与协
作用户在参与匿名区构造时需要更换使用的假名．
因此，为了激励协作用户更换假名，他们将参与匿名
区构造的请求用户和协作视为一类特殊的社会群
体，基于群体用户间的社会关系，通过最大化群体收
益，激励协作用户在参与匿名区构造时更换自己的
假名．
综上所述，现有的分布式犓匿名位置隐私保护
方案均未考虑匿名区构造过程中存在的隐私泄露和
欺骗行为．这不仅使得自利的请求用户在收到协作
用户的真实位置后可将这些位置信息泄露给第三
方，还会使得自利的协作用户提供虚假位置给请求
用户，使得最终生成的匿名区不能满足请求用户的
位置隐私保护需求，甚至使得ＬＳＰ可直接获知请求
用户的位置隐私．因此，现有的分布式犓匿名位置
隐私保护方案不能完全保护用户的位置隐私．
３　预备知识
３１　系统结构
如图２所示，本文采用点对点对等式结构［３７］，
由请求用户、协作用户和ＬＳＰ组成，无需第三方．假
设请求用户与协作用户以及请求用户与ＬＳＰ间存
在安全的通信链路．当请求用户犘０向ＬＳＰ发送查
询请求时，他首先向周围用户发送协作请求以获取
他们的真实位置．当收到协作用户犘１，犘２，…，犘犓－１
提供的位置犔狅犮ｒｅａｌ１，犔狅犮ｒｅａｌ２，…，犔狅犮ｒｅａｌ犓－１后，请求用户
犘０构造匿名区ＡＣＲ，并连同查询内容一同提交给
ＬＳＰ．
图２　系统结构
当ＬＳＰ认证通过请求用户犘０的身份后，他根
据请求用户提交的匿名区和查询内容在数据库中进
行检索，将所有结果返回给请求用户犘０．在收到
ＬＳＰ发送的查询结果后，请求用户犘０根据自己的真
实位置犔狅犮ｒｅａｌ０对它们进行筛选，从而获得准确的查
询结果．其中，犔狅犮ｒｅａｌ犻表示第犻（１犻犓－１）个协作
用户犘犻的真实位置；匿名区犃犆犚＝犃狉犲犪（犔狅犮ｒｅａｌ０，
犔狅犮ｒｅａｌ１，…，犔狅犮ｒｅａｌ犓－１）；犃狉犲犪（·）是匿名区构造函数；犓
表示请求用户犘０的隐私保护需求．
此外，本文还假设请求用户与协作用户均是理
性的，即在匿名区构造过程中，他们总是根据自身利
益最大化进行策略选择．对于理性的请求用户犘０来
说，他首先期望获得协作用户提供的真实位置用于
生成匿名区ＡＣＲ；其次，在成功构造匿名区的同时，
他会泄露协作用户的真实位置以获得更多额外收
益．因此，在匿名区构造过程中，理性请求用户犘０的
偏好满足：珦犝＋＞珦犝＞珦犝－＞珦犝－－．其中：
·珦犝＋表示请求用户犘０成功构造匿名区，且泄
露协作用户犘犻真实位置时的收益；
·珦犝表示请求用户犘０成功构造匿名区，但未泄
露协作用户犘犻真实位置时的收益；
·珦犝－表示请求用户犘０未成功构造匿名区，但
泄露协作用户犘犻真实位置时的收益；
·珦犝－－表示请求用户犘０未成功构造匿名区，且
未泄露协作用户犘犻真实位置时的收益．
而对于理性的协作用户犘犻来说，他首先期望能
保护自己的位置隐私；其次，在有效保护自己位置隐
私的同时，向请求用户提供协作帮助．因此，在匿名
区构造过程中，理性协作用户犘犻的偏好满足：珮犠＋＞
珮犠＞珮犠－＞珮犠犳＞珮犠－－．其中：
·珮犠＋表示协作用户犘犻提供虚假位置犔狅犮ｆａｋｅ犻给
请求用户犘０，且请求用户犘０采用该虚假位置构造
匿名区时的收益；
·珮犠表示协作用户犘犻提供自己的真实位置
犔狅犮ｒｅａｌ犻给请求用户犘０，且请求用户犘０未泄露该位置
时的收益；
·珮犠－表示协作用户犘犻未提供位置信息来协作
请求用户犘０构造匿名区时的收益；
·珮犠犳表示协作用户犘犻提供虚假位置犔狅犮ｆａｋｅ犻给
请求用户犘０，但被请求用户正确识别，未采用该位
置构造匿名区时的收益；
·珮犠－－表示协作用户犘犻提供自己真实位置
犔狅犮ｒｅａｌ犻给请求用户犘０，但请求用户犘０泄露自己真实
６４９ 计　　算　　机　　学　　报 ２０１９年
《
 计
 算
 机
 学
 报
 》
位置时的收益．
３２　分布式犓匿名位置隐私保护的安全性
本文分别将请求用户和周围协作用户视为攻击
者．在分布式匿名区的构造过程中，自利的请求用户
在收到协作用户提供的位置信息后，会泄露这些信
息给第三方以获取额外的收益．而自利的协作用户
在收到请求用户发送的匿名区构造协作请求后，其
可能会提供虚假的位置信息给请求用户，使得请求
用户构造出的匿名区不能满足其隐私保护需求，甚
至使得ＬＳＰ可直接推测出请求用户的个人隐私，如
图１所示．
为了清晰地给出分布式匿名区构造的安全性定
义，本文将匿名区的协同构造视为请求用户犘０和协
作用户犘犻间的两方博弈，首先形式化描述匿名区协
同构造博弈．
定义１（匿名区协同构造博弈）．匿名区协同构
造博弈是一个五元组犌ＡＣＲ＝｛犘，犃，犎，犉，犝｝，其中：
·犘＝｛犘０，犘犻｝是理性用户集合；犘０表示请求用
户；犘犻表示协作用户．
·犃＝｛犃０，犃犻｝是参与者的策略集合．其中，犃０＝
｛犪（１）０，犪（２）０｝是请求用户犘０的策略集合：犪（１）０表示请求
用户犘０在收到协作用户犘犻提供的位置犔狅犮犻后不将
其泄露给第三方；犪（２）０表示请求用户犘０在收到协作
用户犘犻提供的位置犔狅犮犻后将其泄露给第三方．犃犻＝
｛犪（１）犻，犪（２）犻，犪（３）犻｝表示协作用户犘犻的策略集合：犪（１）犻表
示协作用户犘犻在收到协作请求后，提供自己的真实
位置犔狅犮ｒｅａｌ犻给请求用户犘０；犪（２）犻表示协作用户犘犻在
收到协作请求后，不提供位置信息给请求用户犘０；
犪（３）犻表示协作用户犘犻在收到协作请求后，提供虚假
的位置犔狅犮ｆａｋｅ犻给请求用户犘０．并且，在匿名区协同
构造博弈犌ＡＣＲ中，请求用户和协作用户各选一个策
略形成的向量犪＝（犪０，犪犻）称为理性用户的策略组
合．其中，犪０∈犃０；犪犻∈犃犻．
·犎是历史集合．任意一个历史犺∈犎表示其
对应时刻理性用户选择的策略构成的策略组合．显
然，空字符τ∈犎，其表示匿名区协同构造博弈开
始．对于任意的历史犺∈犎，在其之后可能出现的所
有策略组合记为犃（犺）＝｛犪｜（犺，犪）∈犎｝．如果存在
犺′∈犎使得犃（犺′）＝，则称该历史犺′是终止的．集
合犣表示所有终止历史组成的集合．
·犉：（犎／犣）→犘是用户分配函数，它为没有终
止的历史犺∈犎＼犣指定下一步进行策略选择的用
户．由于在匿名区协同构造博弈中，理性协作用户
犘犻率先进行策略选择，故犉（τ）＝犘犻．
·犝＝｛狌０，狌犻｝是理性用户的收益集合．其中，狌０
∈｛珦犝＋，珦犝，珦犝－，珦犝－－｝是理性请求用户犘０的收益函
数；狌犻∈｛珮犠＋，珮犠，珮犠－，珮犠犳，珮犠－－｝是理性协作用户
犘犻的收益函数．
基于形式化描述的匿名区协同构造博弈模型，
下面给出分布式犓匿名的安全性定义．
定义２（分布式犓匿名位置隐私保护的安全性）．
假设犘０是理性请求用户，犘１，犘２，…，犘犓－１是犓－１
个理性协作用户．当理性请求用户犘０采用分布式犓
匿名隐私保护方案向犘１，犘２，…，犘犓－１发送协作构
造匿名区请求，且成功构造出匿名区ＡＣＲ时，下述
条件成立：
狌０＝珦犝 （１）
狌犻＝珮犠 （２）
ＰｒＬＳＰ［犔狅犮ｒｅａｌ０狘ＡＣＲ］１／犓 （３
烅
烄
烆 ）
那么，该分布式犓匿名位置隐私保护方案就称为是
安全的．其中，犓表示请求用户犘０在发送当前ＬＢＳ
查询时的位置隐私保护需求；１犻犓－１；ＰｒＬＳＰ
［犔狅犮ｒｅａｌ０｜ＡＣＲ］表示ＬＳＰ从请求用户犘０提交的匿名
区ＡＣＲ中正确识别出其真实位置犔狅犮ｒｅａｌ０的概率．
在上述定义中，式（１）和式（２）是从匿名区构造
的角度对分布式犓匿名位置隐私保护的安全性进
行定义．其中，式（１）表示在匿名区构造过程中请求
用户犘０不会泄露协作用户的位置；式（２）表示在匿名
区构造过程中协作用户犘犻提供自己的真实位置
犔狅犮ｒｅａｌ犻给请求用户犘０．而式（３）是从ＬＢＳ查询的角度
对分布式犓匿名位置隐私保护的安全性进行定义．
３３　区块链
区块链①的基本思想是通过整合密码技术和点
对点通信技术，基于数据分布式存储一致性的原理，
利用智能合约来自动化执行预设脚本代码，在实现
去中心化共享数据的同时，确保共享数据的不可篡
改性和不可伪造性．
区块链的基础架构［３９］可分为六层，自顶向下分
别是：应用层、合约层、激励层、共识层、网络层和数
据层，如图３所示．
（１）应用层
应用层封装了区块链在社会活动中可应用的场
景及实例．
７４９５期 刘　海等：基于区块链的分布式犓匿名位置隐私保护方案
①ＮａｋａｍｏｔｏＳ．Ｂｉｔｃｏｉｎ：Ａｐｅｅｒｔｏｐｅｅｒｅｌｅｃｔｒｏｎｉｃｃａｓｈ
ｓｙｓｔｅｍ［ＥＢ／ＯＬ］．ｈｔｔｐｓ：／／ｂｉｔｃｏｉｎ．ｏｒｇ／［２０１８０７２８］．
《
 计
 算
 机
 学
 报
 》
图３　区块链基础架构
（２）合约层
合约层封装了各类脚本代码以及算法机制等，
为用户提供可编程环境，从而实现智能合约．利用智
能合约，区块链就可将各自业务规则转化成区块链
系统中自动执行的合约，使得该合约的执行不依赖
任何第三方．理论上智能合约一旦部署且符合其执
行的条件，即可自动执行．
（３）激励层
在区块链中，数据是由所有节点共同维护的．为
了激励节点积极参与到区块链的维护中，激励层封
装了激励相容的分配规则和支付规则，在各节点参
与维护区块链的同时，使其自身收益最大化．
（４）共识层
在区块链中，由于需要在无中心节点的情况下
保证各个节点记账的一致性，此时需利用共识层中
封装的各种共识机制在相互没有信任基础的个体间
达成共识．
（５）网络层
网络层封装了区块链系统的组网规则———对等
式组网，以及在该网络中节点间的交易账单和其他
数据的传播、验证协议等．
（６）数据层
数据层利用Ｈａｓｈ算法、Ｍｅｒｋｌｅ树等密码技术
和时间戳技术将数据区块生成时间间隔内形成的所
有交易账单以链式结构进行存储，确保区块链中存
储的数据具有不可伪造、不可篡改和可追溯性．
４　基于区块链的分布式犓匿名位置
隐私保护方案
　　为了防止在分布式匿名区构造过程中请求用户
泄露协作用户的位置以及协作用户提供虚假位置欺
骗请求用户等情况的发生，本文首先利用加密和签
名技术来防止其余用户非法获取协作用户提供的位
置信息以及参与匿名区构造用户具有位置欺骗或泄
露行为后的抵赖，并利用区块链分布式存储参与匿
名区构造的博弈双方以及提供的位置信息作为证
据，设计了一个分布式犓匿名位置隐私保护方案．
４１　共识机制
为了防止在分布式匿名区构造过程中请求用户
泄露协作用户的位置以及协作用户提供虚假位置欺
骗请求用户，本节首先设计了一个协作请求记录机
制约束请求用户和协作用户的自利性行为；并且还
提出了一个区块链记账权竞争机制，激励网络中所
有用户参与区块链的维护中．
假设在任意第狇次匿名区协同构造博弈中，策
略犪狇＿（１）０ 表示请求用户犘０在收到协作用户犘犻提供的
位置犔狅犮狇犻后并不将其泄露给第三方；策略犪狇＿（２）０ 表示
请求用户犘０在收到协作用户犘犻提供的位置犔狅犮狇犻后
将其泄露给第三方．策略犪狇＿（１）犻 表示协作用户犘犻在收
到协作请求后，提供自己的真实位置犔狅犮ｒｅａｌ犻给请求
用户犘０；策略犪狇＿（２）犻 表示协作用户犘犻在收到协作请
求后，不提供任何位置信息给请求用户犘０；策略
犪狇＿（３）犻 表示协作用户犘犻在收到协作请求后，提供虚假
的位置犔狅犮ｆａｋｅ犻给请求用户犘０．令狌狇０和狌狇犻分别表示第
狇次匿名区协同构造博弈结束时请求用户犘０和协
作用户犘犻的收益．并且，令策略犪狇＋犼０→０表示第狇次匿
名区协同构造博弈的请求用户犘０在之后的第犼次
博弈中仍作为请求者时选择的策略；策略犪狇＋犼犻→０表示
参与第狇次匿名区协同构造博弈的协作用户犘犻在
第犼次博弈中作为请求者时选择的策略．那么，本文
提出的协作请求记录机制如下所示．
定义３（共识机制Ｉ———交互记录机制）．交互记
录机制犕犚＝（犪狇，狆［狇～＋犿］）是一个二元组．其中，
·犪狇＝（犪狇０，犪狇犻）是在第狇次匿名区协同构造博
弈中，请求用户犘０和协作用户犘犻选择的策略犪狇０和
犪狇犻形成的策略组合．
·狆［狇～＋犿］＝｛狆［狇～＋犿］０ ，狆［狇～＋犿］犻 ｝是交互记录机制犕犚
根据请求用户犘０和协作用户犘犻在第狇次匿名区协
同构造博弈中选择的策略，给予他们在之后的第狇～
次匿名区协同构造博弈犌狇～ＡＣＲ至第狇～＋犿次匿名区协
同构造博弈犌狇～＋犿ＡＣＲ的支付收益．对于任意犼∈［狇～，狇～＋
犿］，它满足：
狆犼０＝
狌犼０（犪犼０→０，犪犼＿（１）犻′ ），犪狇０＝犪狇＿（１）０
狌犼０（犪犼０→０，犪犼＿（２）犻′ ），犪狇０＝犪狇＿（２）烅烄烆 ０
（４）
８４９ 计　　算　　机　　学　　报 ２０１９年
《
 计
 算
 机
 学
 报
 》
狆犼犻＝
狌犼犻→０（犪犼犻→０，犪犼＿（１）犻′ ）， 犪狇犻＝犪狇＿（１）犻
狌犼犻→０（犪犼犻→０，犪犼犻′（λ犻→０，δ犻′）），犪狇犻＝犪狇＿（２）犻
狌犼犻→０（犪犼犻→０，犪犼＿（２）犻′ ）， 犪狇犻＝犪狇＿（３）
烅
烄
烆 犻
（５）
其中：犿表示惩罚轮数；犪犼犻′表示在匿名区协同构造博
弈犌犼ＡＣＲ中协作用户犘犻′选择的策略；λ犻→０表示参与匿
名区协同构造博弈犌狇ＡＣＲ的协作用户犘犻在参与博弈
犌犼ＡＣＲ时协助其他用户构造匿名区的次数；δ犻′是匿名
区协同构造博弈犌犼ＡＣＲ中协作用户犘犻′的判断阈值．
当λ犻→０＜δ犻′时，犪犼犻′（λ犻→０，δ犻′）＝犪犼＿（２）犻′ ；否则，犪犼犻′（λ犻→０，
δ犻′）＝犪犼＿（１）犻′ ．
交互记录机制犕犚就是通过记录参与匿名区构
造的请求用户、协作用户及其提供的位置信息来约
束他们的自利性行为．也就是说，一旦发现匿名区协
同构造博弈犌狇ＡＣＲ中请求用户犘０泄露了协作用户的
位置信息，那么其之后的犿次服务查询中均不会有
用户帮助其构造匿名区；同样地，如果发现匿名区协
同构造博弈犌狇ＡＣＲ中的协作用户犘犻提供虚假位置，那
么该协作用户在之后的犿次服务查询中也不会有
其他用户帮助其构造匿名区．
在本文提出的方案中，将利用区块链分布式存
储参与匿名区构造的博弈双方以及协作用户提供的
位置信息作为证据．因此，为了激励网络中所有用户
参与到区块链的维护中，本文还提出了一个区块链
记账权竞争机制．
定义４（共识机制ＩＩ———记账权竞争机制）．　
记账权竞争机制犕犆＝（珘λ，狆～）是一个二元组．其中：
·珘λ＝（λ１～，λ２～，…，λ珘狀）是在竞争生成新区块
犫犾狅犮犽犕时，参与竞争获取记账权的用户犘１～，犘２～，…，
犘珘狀历史上帮助其他用户构造匿名区的次数λ１～，λ２～，
…，λ珘狀所形成的历史协同构造次数集合．λ珓犻是参与新
区块生成记账权的第珓犻个用户犘珓犻历史帮助其他用户
构造匿名区的次数．
·珟狆＝｛珟狆１～，珟狆２～，…，珟狆珘狀｝是记账权竞争机制犕犆
根据参与新区块生成记账权竞争的用户犘１～，犘２～，…，
犘珘狀历史上帮助其他用户构造匿名区构造的次数，给
予他们在生成新区块时的收益．对于任意珟狆珓犻∈珟狆，其
满足：
珟狆珓犻＝
０， 其他
λ珓犻＋１，λ珓犻＝ａｒｇｍａｘ｛λ珓犻′ｍｏｄλ犕－１ｍａｘ
烅烄烆 ｝（６）
其中，λ犕－１ｍａｘ表示获得生成区块犫犾狅犮犽犕－１记账权的用
户在当时曾帮助其他用户构造匿名区的历史次数；
珓犻′∈［１～，２～，…，珘狀］．
简单来说，本文提出的生成新区块记账权竞争
机制犕犆的基本思想是让参与匿名区构造次数最多
的用户获取记账权．但是，为了防止参与匿名区构造
次数最多的用户始终获取记账权限，从而有机会伪造
分布式匿名区协作构造区块链情况的发生，本文利用
λ珓犻＝ａｒｇｍａｘ｛λ珓犻′ｍｏｄλ犕－１ｍａｘ｝使得区块链的记账权分
散给网络中的各个用户．此外，为了激励网络中所有
用户来参与区块链的更新，本文将获得生成新区块
的记账权视为参与匿名区构造的一种特殊方式．显
然，对于网络中任意用户犘珓犻来说，其帮助其他用户
构造匿名区的历史次数λ珓犻越大，那么犘珓犻作为请求者
发送匿名区协同构造请求时就会有越多的用户提供
自己的位置信息给他，使其能成功构造出匿名区的
概率就越大．这也能在一定程度上预防用户在区块
链系统中频繁地使用新犮犐犇．
值得注意的是，在本文提出的记账权竞争机制
中，网络中的任何用户，即包括发送匿名区协同构造
请求的请求用户、提供位置信息的协同用户以及收
到匿名区协同构造请求未提供位置信息的其他用户
均能参与到生成新区块记账权的竞争中．
４２　本文方案
本文将请求用户获取协作用户真实位置的过程
视为一类特殊的交易（Ｔｒａｎｓａｃｔｉｏｎ），在交易账单中
记录交易双方的ＩＤ以及协作用户提供的位置信息，
并将此账单存储至公有链中．当请求用户指认协作
用户提供虚假位置或者协作用户指认请求用户泄露
自己位置时，可将该交易账单作为凭证用于仲裁．一
旦证实出现位置泄露或欺骗行为，那么具有上述行
为的用户在作为请求者时将不会有其他用户给其提
供帮助，使其不能成功地构造匿名区．此外，为了激
励网络中用户参与到区块链的维护中，每次生成区
块的用户均会被视为帮助请求用户构造匿名区．具
体方案如下所示．
Ｓｔｅｐ１．　请求用户犘０向协作用户发送匿名区
构造协作请求
犚犲狇＝｛犜０－犻，犮犐犇０，λ０，犖（犜狉犪狀犾１），犖（犜狉犪狀犾２），…，
犖（犜狉犪狀犾λ０），狊犻犵狀犛犓－犮犐犇０（λ０‖犜０－犻）｝ （７）
其中，犜０－犻表示请求用户犘０发送匿名区构造协作请
求时的时间戳；犮犐犇０是请求用户犘０在区块链系统中
使用的假名；λ０表示请求用户作为协作者时曾参与
匿名区构造的次数；犖（犜狉犪狀犾犽）表示存储请求用户
犘０协作其他用户构造匿名区的交易账单犜狉犪狀犾犽的交
易账单号；１犽λ０；犛犓－犮犐犇０是请求用户犘０在区
块链系统中的私钥；狊犻犵狀犛犓－犮犐犇０（λ０‖犜０－犻）表示利用
９４９５期 刘　海等：基于区块链的分布式犓匿名位置隐私保护方案
《
 计
 算
 机
 学
 报
 》
私钥犛犓－犮犐犇０对λ０‖犜０－犻的签名；“‖”是连接符．
Ｓｔｅｐ２．　协作用户犘犻（犻≠０）在收到请求用户发
送的匿名区构造请求后，首先去分布式匿名区协作
构造区块链犅犾狅犪犽犮犺犪犻狀＝｛犅犾狅犮犽１，犅犾狅犮犽２，…，
犅犾狅犮犽犕－１｝中统计请求用户犘０曾参与匿名区构造的
次数λ′０，并在该区块链中查找是否存在记录请求用
户犘０欺骗行为的惩罚交易账单．
·当λ′０＝λ０且未找到记录当前请求用户犘０欺
骗行为的惩罚交易账单时，协作用户犘犻根据阈值δ犻
决定是否发送自己的真实位置犔狅犮ｒｅａｌ犻给请求用户．
１）若λ０＜δ犻，则协作用户犘犻不响应请求用户犘０
的协作请求；
２）若λ０δ犻，则协作用户犘犻将交易账单
犜狉犪狀＝｛犜犻－０，犮犐犇０，犈狀犮犘犓－犮犐犇０（犔狅犮狉犲犪犾犻‖犜犻－０），
狊犻犵狀犛犓－犮犐犇犻（犈狀犮犘犓－犮犐犇０（犔狅犮狉犲犪犾犻‖犜犻－０））｝（８）
发送给请求用户犘０．
·当λ′０＝λ０，但在区块犅犾狅犮犽犾′中找到记录当前
请求用户犘０欺骗行为的惩罚交易账单时，协作用户
犘犻根据当前区块数量判断请求用户犘０是否仍在惩
罚期内．
１）若犕－１－犾′犿，即请求用户犘０仍在惩罚周
期内，则协作用户犘犻不响应请求用户犘０的协作请
求，并广播惩罚交易账单
犜狉犪狀犘狌狀＝｛犜犻－０，犮犐犇０，犮犐犇犻，犘狌狀犻狊犺犿犲狀狋，
狊犻犵狀犛犓－犮犐犇犻（犘狌狀犻狊犺犿犲狀狋‖犜犻－０）｝（９）
　　２）若犕－１－犾′＞犿，即请求用户犘０已被惩罚完
毕，则协作用户犘犻将交易账单犜狉犪狀发送给请求用
户犘０．
·当λ′０≠λ０时，协作用户犘犻不响应请求用户犘０
的协作请求，且广播惩罚交易账单
犜狉犪狀Ｐｕｎ＝｛犜犻－０，犮犐犇０，犮犐犇犻，犘狌狀犻狊犺犿犲狀狋，
狊犻犵狀犛犓－犮犐犇犻（犘狌狀犻狊犺犿犲狀狋‖犜犻－０），犜０－犻，λ０，
狊犻犵狀犛犓－犮犐犇０（λ０‖犜０－犻）｝ （１０）
其中，犕表示请求用户犘０发送协作请求时分布式匿
名区协作构造区块链中区块的数量；犾′表示记录请求用
户犘０欺骗行为的区块序号，满足：１犾′犕－１；犜犻－０
表示生成交易账单的时间戳；犿是惩罚阈值；犘犓－
犮犐犇０是请求用户犘０在区块链系统中的公钥；犛犓－
犮犐犇犻是协作用户犘犻在区块链系统中的私钥；犘狌狀犻狊犺
犿犲狀狋是惩罚交易账单标识符；犈狀犮犘犓－犮犐犇０（犔狅犮ｒｅａｌ犻‖
犜犻－０）表示在区块链系统中使用请求用户犘０的公钥
犘犓－犮犐犇０加密犔狅犮ｒｅａｌ犻‖犜犻－０后得到的密文．
Ｓｔｅｐ３．　请求用户犘０在收到协作用户犘犻发送
的交易账单犜狉犪狀后，使用协作用户犘犻在区块链系
统中的公钥犘犓－犮犐犇犻验证签名信息
狊犻犵狀犛犓－犮犐犇犻（犈狀犮犘犓－犮犐犇０（犔狅犮ｒｅａｌ犻‖犜犻－０））（１１）
的正确性．
·若验证通过，则利用自己的私钥犛犓－犮犐犇０
解密犈狀犮犘犓－犮犐犇０（犔狅犮ｒｅａｌ犻‖犜犻－０）得到协作用户犘犻的
真实位置犔狅犮ｒｅａｌ犻．然后，计算犈狀犮犘犓－犮犐犇犻（犔狅犮ｒｅａｌ犻‖
犜犻－０）和狊犻犵狀犛犓－犮犐犇０（犈狀犮犘犓－犮犐犇犻（犔狅犮ｒｅａｌ犻‖犜犻－０）），并
将其写入交易账单犜狉犪狀后进行广播．
·若验证不通过，则不使用犔狅犮ｒｅａｌ犻构造匿名区
ＡＣＲ，且广播发送惩罚交易账单
犜狉犪狀Ｐｕｎ＝｛犜犻－０，犮犐犇０，犮犐犇犻，犘狌狀犻狊犺犿犲狀狋，
狊犻犵狀犛犓－犮犐犇０（狆狌狀犻狊犺犿犲狀狋‖犜犻－０），
犈狀犮犘犓－犮犐犇０（犔狅犮ｒｅａｌ犻‖犜犻－０），
狊犻犵狀犛犓－犮犐犇犻（犈狀犮犘犓－犮犐犇０（犔狅犮ｒｅａｌ犻‖犜犻－０））｝
（１２）
当请求用户得到不少于犓－１个协作用户提供的真
实位置后就可成功地构造出匿名区．
Ｓｔｅｐ４．　网络中所有用户在收到广播发送的交
易账单后分别验证其真实性．若验证不通过，则分别
生成新的惩罚交易账单并进行广播．若验证通过，则
保存交易账单用于生成新的区块犅犾狅犮犽犕．当要更新
分布式匿名区协作构造区块链时，若
λ犕犼＝ａｒｇｍａｘ｛λ犻′ｍｏｄλ犕－１ｍａｘ｝ （１３）
则由用户犘犼获得记账权，将生成新的区块犅犾狅犮犽犕加
入分布式匿名区协作构造区块链．
在上述方案中，用户的犮犐犇将作为索引，用于
在区块链系统中检索包含该犮犐犇的所有历史交易
账单，使得网络中每个用户均能追溯请求用户和协
作用户的历史行为．并且，当请求用户使用上述方案
保护自己ＬＢＳ查询时的位置隐私时，还可能出现以
下三种情况：
（１）当请求用户在同一位置进行多次ＬＢＳ查询
时，用户无需广播发送构造匿名区协作请求．其只需
通过查找存储在区块链中的交易账单即可快速获得
历史查询时协作用户提供的真实位置，从而高效地
构造出匿名区，提高服务质量．
（２）当请求用户连续地进行ＬＢＳ查询时，用户
也无需广播发送构造匿名区协作请求．此时，其同样
通过查询存储在区块链中的交易账单即可快速获得
上次查询时协作的用户，从而直接向这些用户发送
协作请求，快速构造匿名区，提高服务质量．
（３）当生成新的区块时，若存在多个用户犘犼１，
０５９ 计　　算　　机　　学　　报 ２０１９年
《
 计
 算
 机
 学
 报
 》
犘犼２，…，犘犼狀使得
λ犕犼１＝λ犕犼２＝…＝λ犕犼狀＝ａｒｇｍａｘ｛λ犻′ｍｏｄλ犕－１ｍａｘ｝
（１４）
成立，则由网络中用户通过投票决定本次区块链的
记账权由犘犼１，犘犼２，…，犘犼狀中的哪个用户获得．并且，
为了降低网络中用户查询时的开销，在实际应用中，
还可在上述方案中引入滑动窗口机制，减少区块链
中存储交易账单的区块数量．
此外，如果在实际使用本方案时，位置隐私数据
更新的频繁程度远远高于公有链网络中的交易产生
速度时（即公有链网络中的交易产生速度与位置隐私
数据更新的频繁程度不在一个数量级），则可采用诸
如区域划分的方法（即某个区域内所有用户构成一个
群体）的方法，利用联盟链技术对本方案进行优化．
４３　方案分析
４．３．１　安全性
本文假定网络中至少存在犓－１个用户犘犻（１
犻犓－１）的阈值δ犻λ０，即请求用户犘０能成功地构
造出包含其他犓－１个协作用户提供位置的匿名区
ＡＣＲ．并且，还假设如果请求用户犘０在收到这犓－１
个用户提供的真实位置犔狅犮ｒｅａｌ１，犔狅犮ｒｅａｌ２，…，犔狅犮ｒｅａｌ犓－１
后，其采用的匿名区构造方法犃狉犲犪（·）是安全的，
即式（１５）
ＰｒＬＳＰ［犔狅犮ｒｅａｌ０｜犃狉犲犪（犔狅犮ｒｅａｌ０，犔狅犮ｒｅａｌ１，…，犔狅犮ｒｅａｌ犓－１）］１／犓
（１５）
成立．因此，本文仅从匿名区构造的角度证明本方案
是安全的．
引理１．令α表示协作用户犘犻正确识别出请求用
户犘０具有位置泄露行为的概率，β表示请求用户犘０识
别出协作用户提供虚假位置的概率．当网络中存在
犓－１个用户犘犻（１犻犓－１）的阈值δ犻λ０时，若犿＞
ｍａｘ 珦犝＋－珦犝
α·（珦犝－珦犝－－）｛ ，（１－β）·（珮犠＋－珮犠）
β·（珦犝－珦犝－－ ｝） ，那
么，本方案不仅能防止请求用户犘０泄露协作用户
犘犻（１犻犓－１）的位置信息，还能确保协作用户犘犻
参与分布式匿名区构造时提供的是真实位置
犔狅犮ｒｅａｌ犻．
证明．　反证法．
假设当理性用户犘犻的阈值δ犻λ０且犿＞ｍａｘ
珦犝＋－珦犝
α·（珦犝－珦犝－－），
（１－β）·（珮犠＋－珮犠）
β·（珦犝－珦犝－－烅烄烆 烍烌烎） 时，请求
用户犘０在任意第狇次匿名区协同构造博弈中，当收
到理性用户犘犻提供真实位置犔狅犮狇＿ｒｅａｌ犻 后将该位置泄
露给第三方，即选择策略犪狇＿（２）０ ．此时，对于请求用户
犘０来说，他在博弈犌狇ＡＣＲ中的收益为：
狌０（犪狇＿（２）０ ）＝珦犝＋ （１６）
　　当理性协作用户犘犻在任意时刻证实了犘０曾泄
露自己的真实位置犔狅犮狇＿ｒｅａｌ犻 时，犘０仍作为请求者在该
时刻之后的犪（２）犻次匿名区协同构造博弈犌狇
～
ＡＣＲ，犌狇
～＋１
ＡＣＲ，
…，犌狇～＋犿ＡＣＲ中的收益满足：
狌狇～＋犼０（犪狇～＋犼０狘犪狇＿（２）０ ）＝珦犝－ （１７）
其中，１犼犿．
因此，理性用户犘０选择策略犪狇＿（２）０ 在犿＋１次博
弈犌狇ＡＣＲ，犌狇～ＡＣＲ，犌狇～＋１ＡＣＲ，…，犌狇～＋犿ＡＣＲ的总体收益为：
珘狌０（犪狇＿（２）０ ）＝α·狌０（犪狇＿（２）０ ）＋（１－α）·［狌０（犪狇～０｜犪狇＿（２）０ ）＋
　狌０（犪狇～＋１０｜犪狇＿（２）０ ）＋…＋狌０（犪狇～＋犿０｜犪狇＿（２）０ ）］
＝珦犝＋＋犿珦犝＋α·犿·（珦犝－－－珦犝） （１８）
　　然而，若请求用户犘０在第犪狇＿（１）犻 次匿名区协同
构造博弈中，在收到真实位置犌狇～ＡＣＲ，犌狇～＋１ＡＣＲ，…，犌狇～＋犿ＡＣＲ
后不将该位置泄露给第三方，即选择策略犪狇＿（１）０ 时，
其在匿名区协同构造博弈犌狇ＡＣＲ和犌狇～ＡＣＲ，犌狇～＋１ＡＣＲ，…，
犌狇～＋犿ＡＣＲ中的总体收益为：
珘狌０（犪狇＿（１）０ ）＝狌０（犪狇＿（１）０ ）＋狌０（犪狇～０狘犪狇＿（１）０ ）＋
狌０（犪狇～＋１０狘犪狇＿（１）０ ）＋…＋狌０（犪狇～＋犿０ 狘犪狇＿（１）０ ）
＝珦犝＋犿珦犝 （１９）
根据假设可知：当且仅当珘狌０（犪狇＿（１）０ ）珘狌０（犪狇＿（２）０ ）时，
请求用户犘０会泄露协作用户犘犻提供的位置信息．即
珦犝＋犿珦犝珦犝＋＋犿珦犝＋α·犿·（珦犝－－－珦犝）（２０）
成立．
那么，犿α
·（珦犝＋－珦犝）
珦犝－珦犝－－
，与已知犿＞
α·（珦犝＋－珦犝）
珦犝－珦犝－－ 相矛盾．故对于理性请求用户犘０来
说，其不会泄露协作用户犘犻的真实位置．
同理，假设在任意第狇次匿名区协同构造博弈中，
当犿＞ｍａｘ
珦犝＋－珦犝
α·（珦犝－珦犝－－），
（１－β）·（珮犠＋－珮犠）
β·（珦犝－珦犝－－烅烄烆 烍烌烎）
以及协作用户犘犻（１犻犓－１）决定帮助请求用户
构造匿名区时，协作用户犘犻提供虚假位置犔狅犮狇＿ｆａｋｅ犻 ，
即选择策略犪狇＿（３）犻 ．此时，对于理性协作用户犘犻来说，
其提供虚假位置犔狅犮狇＿ｆａｋｅ犻 被请求用户犘０正确识别的
概率β．因此，协作用户在当前博弈犌狇ＡＣＲ以及在被证
实提供虚假位置之后作为请求者参与的犪（２）犻次匿
名区协同构造博弈犌狇～ＡＣＲ，犌狇～＋１ＡＣＲ，…，犌狇～＋犿ＡＣＲ中的总体收
益为
１５９５期 刘　海等：基于区块链的分布式犓匿名位置隐私保护方案
《
 计
 算
 机
 学
 报
 》
珘狌犻（犪狇＿（３）犻 ）＝β·狌犻（犪狇＿（３）犻 ）＋（１－β）·［狌犻→０（犪狇
～
０｜犪狇＿（３）犻 ）＋
　狌犻→０（犪狇～＋１０｜犪狇＿（３）犻 ）＋…＋狌犻→０（犪狇～＋犿０｜犪狇＿（３）犻 ）］
＝（１－β）·珮犠＋＋β·珮犠犳＋β·犿·（珦犝－－－珦犝）
（２１）
其中，狌犻→０（·）表示匿名区协同构造博弈犌狇ＡＣＲ中的
协作用户犘０在之后的协同构造博弈中作为请求者
时的收益函数．
而当协作用户犘犻决定帮助请求用户构造匿名
区且其提供真实位置犔狅犮ｒｅａｌ犻，即选择策略犪狇＿（１）犻 时，
在博弈犌狇ＡＣＲ和犌狇～ＡＣＲ，犌狇～＋１ＡＣＲ，…，犌狇～＋犿ＡＣＲ中的总体收益为
珘狌犻（犪狇＿（１）犻 ）＝狌犻（犪狇＿（１）犻 ）＋狌犻→０（犪狇～０）＋
狌犻→０（犪狇～＋１０）＋…＋狌犻→０（犪狇～＋犿０）
＝珮犠＋犿珦犝 （２２）
　　根据假设可知：当且仅当珘狌犻（犪狇＿（１）犻 ）珘狌犻（犪狇＿（３）犻 ）
时，协作用户犘犻会提供虚假位置给请求用户．即下
式
珮犠＋犿珦犝（１－β）·珮犠＋＋β·珮犠犳＋β·犿·（珦犝－－－珦犝）
成立．那么，犿＜
（１－β）·（珮犠＋－珮犠）
β·（珦犝－珦犝－－）与已知犿＞
（１－β）·（珮犠＋－珮犠）
β·（珦犝－珦犝－－）相矛盾．故当协作用户决定帮
助请求用户构造匿名区时，其会提供真实的位置．
证毕．
同理可得如下引理．
引理２．　令α表示协作用户正确识别出请求
用户犘０具有位置泄露行为的概率，β表示请求用户
犘０识别出协作用户提供虚假位置的概率．对于网络
中的任意理性用户犘犻来说，当δ犻λ０且犿＞ｍａｘ
珦犝＋－珦犝
α·（珦犝－珦犝－－），
（１－β）·（珮犠＋－珮犠）
β·（珦犝－珦犝－－｛ ｝） 时，本方
案能激励该用户犘犻参与到分布式匿名区的构造中．
由引理１和引理２可总结出：
定理１．令α表示协作用户正确识别出请求用
户犘０具有位置泄露行为的概率，β表示请求用户犘０
识别出协作用户提供虚假位置的概率．假设理性请
求用户犘０采用本方案保护其ＬＢＳ查询时的位置隐
私且在网络中存在犓－１个其他理性用户犘犻（１犻
犓－１）的阈值δ犻λ０．其中λ０表示理性请求用户犘０
历史上帮助其他用户构造匿名区的次数．如果犿＞
ｍａｘ
珦犝＋－珦犝
α·（珦犝－珦犝－－），
（１－β）·（珮犠＋－珮犠）
β·（珦犝－珦犝－－｛ ｝） ，本
方案是安全的．即本方案在促使协作用户犘犻（１犻
犓－１）提供自己的真实位置给请求用户犘０，并可防
止请求用户犘０泄露这些位置的同时，还使得ＬＳＰ
从请求用户犘０提交的匿名区中识别其真实位置的
正确率不高于１／犓．
４．３．２　计算复杂性
本方案涉及加密、解密以及签名运算．本文将签
名运算视为一类特殊的加密运算．并且由于解密运
算是加密运算的逆运算，因此本文用犗（犈狀犮）表示进
行加密、解密和签名运算时所需的计算复杂度．
在本方案中，当每个协作用户犘犻收到请求用户
犘０发送的匿名区构造协作请求后，其首先根据请求
用户犘０的公钥犘犓－犮犐犇０进行计算，验证签名数据
狊犻犵狀犛犓－犮犐犇０（λ０‖犜０－犻）的正确性，此时其所需的计算
复杂度为犗（犈狀犮）．若未通过正确性验证，则协作用
户犘犻计算狊犻犵狀犛犓－犮犐犇犻（犘狌狀犻狊犺犿犲狀狋‖犜犻－０），并广播
惩罚交易账单．此时其所需的计算复杂度为犗（犈狀犮）．
若通过正确性验证，协作用户犘犻会通过查询区块链
犅犾狅犮犽犮犺犪犻狀＝｛犅犾狅犮犽１，犅犾狅犮犽２，…，犅犾狅犮犽犕－１｝中存储
的交易账单，确定请求用户犘０帮助其他用户构造匿
名区的次数λ０的真实性，并在该区块链中查找是否
存在记录犘０欺骗行为的惩罚交易账单．当发现请求
用户犘０发送虚假的λ０或其仍在惩罚期内，则计算
狊犻犵狀犛犓－犮犐犇犻（犘狌狀犻狊犺犿犲狀狋‖犜犻－０）后广播惩罚交易账单．
此时，犘犻的计算复杂度为犗（犕）＋犗（犈狀犮）＝犗（犈狀犮）．
当通过λ０的正确性验证且未找到记录请求用户犘０
欺骗行为的惩罚交易账单，那么协作用户犘犻根据其
阈值δ犻决定是否提供自己的位置给请求用户犘０．若
λ０＜δ犻，则不响应请求用户发送的匿名区构造协作
请求，此时其所需的计算开销为犗（１）；若λ０δ犻，则
在计算犈狀犮犘犓－犮犐犇０（犔狅犮狉犲犪犾犻‖犜犻－０）以及相应的签名
狊犻犵狀犛犓－犮犐犇犻（犈狀犮犘犓－犮犐犇０（犔狅犮狉犲犪犾犻‖犜犻－０））后，将交易账
单发送给请求用户犘０．此时协作用户犘犻所需的计
算复杂度为犗（１）＋犗（犈狀犮）＋犗（犈狀犮）＝犗（犈狀犮）．因
此，当收到匿名构造协作请求后，协作用户犘犻所需
的计算复杂度上限为
犗（犈狀犮）＋犗（犈狀犮）＋犗（犈狀犮）＝犗（犈狀犮）（２５）
　　同理可得，当收到协作用户犘犻发送的交易账单
后，请求用户所需的计算复杂度为犗（犈狀犮）；当生成
新区块犅犾狅犮犽犕时，网络中参与新区块生成的用户所
需的计算复杂度为犗（犈狀犮）．
综上所述，若请求用户采用本方案成功获取狉
犓－１个协作用户提供的真实位置时，网络中各
用户的计算复杂度分别为
（１）对于请求用户来说，其所需的计算复杂
２５９ 计　　算　　机　　学　　报 ２０１９年
《
 计
 算
 机
 学
 报
 》
度为
狉·犗（犈狀犮）＋犗（犈狀犮）＝犗（犈狀犮） （２６）
　　（２）对于提供自己真实位置协作请求用户构造
匿名区的用户来说，其所需的计算复杂度为
犗（犈狀犮）＋犗（犈狀犮）＋犗（犈狀犮）＝犗（犈狀犮）（２７）
　　（３）对于未响应匿名区协作构造请求的用户来
说，其所需的计算复杂度为
犗（犈狀犮）＋犗（１）＋犗（犈狀犮）＝犗（犈狀犮）（２８）
４．３．３　方案对比
（１）可保护位于人群稀疏区中用户的位置隐私
现有的分布式犓匿名位置隐私保护方
案［２０２４，３３３７］是通过增加网络中点对点通信跳数的方
法来确保请求用户能至少获取其他犓－１个协作用
户的真实位置来构造匿名区，保护自己的位置隐私．
当请求用户位于人群稀疏区时，若直接使用这些方
案势必会增加其通信时延，从而降低服务质量；甚至
还会出现请求用户未能获取至少犓－１个协作用户
的真实位置，难以成功构造匿名区的极端情形．虽然
方案［２５３２］提出通过存储历史协作用户的真实位
置或利用社交网络实现匿名区构造的方法，但是上
述方案却存在以下要求：１）请求用户拥有足够的存
储空间用于存储大量历史协作用户的真实位
置［２５２７，３０］；２）依赖第三方的存在［２８２９］；３）当进行
ＬＢＳ查询时，其可通过社交网络找到至少犓－１个
可信用户［３１３２］．显然，这些额外要求也限制了这些
方案的实用性．
然而，在本方案中，当请求用户位于人群稀疏区
进行ＬＢＳ查询时，他无需通过点对点通信的方式获
取至少犓－１个协作用户的真实位置，仅需通过查
询分布式匿名区协作构造区块链就可获取曾帮助自
己构造匿名区的协作用户位置，从而即可成功地构
造匿名区来保护本次查询时自己的位置隐私．
（２）可保护连续请求下用户的位置隐私
现有的大多数分布式犓匿名位置隐私保护方
案［２２２７，３０３７］均不能有效抵抗查询追踪攻击［３８］．如果
请求用户直接采用这些方案保护自己连续查询时的
位置隐私，ＬＳＰ可通过查找请求用户提交的匿名区
中不同用户的方法来降低请求用户的位置隐私保护
等级，乃至能直接识别出请求用户的真实位置．造成
上述问题的根本原因是当请求用户进行连续ＬＢＳ
查询时，其难以获得相同协作用户提供的真实位置
来构造匿名区．
然而，在本方案中，当用户连续进行ＬＢＳ查询
时，其可通过查询分布式匿名区协作构造区块链来
获取连续查询最初时刻帮助其构造匿名区的用户．
随后，可通过再次向这些用户发送协作请求以获取
自己后续连续查询时他们的真实位置，使得自己连
续查询时提交给ＬＳＰ的匿名区中始终包含犓－１
个相同协作用户的真实位置，从而有效保护自己连
续查询时的位置隐私．
综上所述，与现有分布式犓匿名位置隐私保护
方案的对比结果如表１所示．
表１　方案对比
方案
安全性
匿名区
构造
ＬＢＳ
查询
实用性
稀疏
区域
连续
查询 第三方
［２０２１］ ×  ×  ×
［２２２４］ ×  × × ×
［２５２７，３０３２］ ×   × ×
［２８２９］ × ×   
［３３３５］ ×  × × 
［３６３７］ ×  × × ×
本方案     ×
５　实　验
本实验首先选用国家密码管理局推荐的ＳＭ２
椭圆曲线公钥密码（ＥｌｌｉｐｔｉｃＣｕｒｖｅｓＣｒｙｐｔｏｇｒａｐｈｙ）
算法对协作用户提供的位置信息进行加密和签名．
椭圆曲线公钥密码算法是目前最适用于移动终端的
加密／签名算法之一．与其他公钥密码算法相比，如
ＲＳＡ加密算法，它在减少用户端计算开销的同时，
还能提供更高的安全级别．例如，密钥长度为２５６ｂｉｔ
的ＥＣＣ算法的安全强度等同于密钥长度为３０７２ｂｉｔ
的ＲＳＡ算法的安全强度．
其次，本实验还采用Ｅｔｈｅｒｅｕｍ１．５．５版本构建
分布式匿名区协作构造区块链．Ｅｔｈｅｒｅｕｍ是目前最
常使用的一个开源的、模块化且有智能合约功能的
区块链平台．在搭建的区块链网络中，共有２５个网
络节点，其中１个节点作为请求用户犘０节点，其余
２４个作为协作用户犘１，犘２，…，犘２４节点．通过生成
随机数的方式为请求用户犘０节点生成其作为协作
者时曾参与匿名区构造的次数λ０以及为协作用户
节点生成阈值δ１，δ２，…，δ２４，使得至少有犓－１个协
作用户犘犻１，犘犻２，…，犘犻犓－１的阈值δ犻１，δ犻２，…，δ犻犓－１
λ０．即当发送匿名区构造协同请求后，请求用户犘０
至少能获得犓－１个协作用户提供的位置信息来构
造匿名区．此外，在搭建的区块链网络平台中，采用
本文提出的共识机制ＩＩ———记账权竞争机制来决定
网络中哪个用户获得新区块的生成权．并且，在搭建
３５９５期 刘　海等：基于区块链的分布式犓匿名位置隐私保护方案
《
 计
 算
 机
 学
 报
 》
的区块链网络系统中，设定每个区块存储１００个历
史交易账单．其中，每个交易账单用于记录匿名区协
作构造过程中请求用户和协作用户关于协作用户提
供的位置信息的密文和签名数据；设定当前区块链长
度｜犅犾狅犮犽犮犺犪犻狀｜＝１００，即共存在１００×１００＝１００００
个历史交易账单．
本实验设定请求用户的隐私保护需求犓值从２
变化到２０，针对不同的犓值，重复执行１００次所需
算法．所有的实验算法均采用ＪＡＶＡ编程语言实
现，并使用了ＪＰＢＣ２．０密码学库．它是目前最常见
的密码学库文件之一，其适用于ＪＡＶＡ编程环境，
且预定义了大量的密码学计算运算，如有限域的生
成、有限域上的加法和乘法运算等．实验环境为
３．３０ＧＨｚＣｏｒｅｉ５４５９０ＣＰＵ，４ＧＢＤＤＲ３１６００
ＲＡＭ，操作系统为Ｕｂｕｎｔｕ１６．０４版本．
５１　匿名区构造
在本部分实验中，假设请求用户曾提供自己的
真实位置参与过１００次匿名区的构造，即λ０＝１００．
当请求用户收到多于犓－１个协作用户提供的位置
信息时，其任意选取犓－１个位置用于构造匿名区．
协作用户与请求用户在匿名区构造过程中所需的平
均计算时延和通信开销分别如图４所示．
当请求用户采用本方案保护其ＬＢＳ查询时的
位置隐私时，随着隐私保护需求犓的不断增加，其
成功构造匿名区所需的平均计算时延呈递增趋势．
而对于协作用户来说，其所需的平均计算时延却与
请求用户的隐私保护需求犓值无关，如图４（ａ）所
示．造成上述现象的原因是随着犓值的不断增加，
请求用户需要验证协作用户发送的签名数据的正确
性以及解密获取协作用户真实位置的次数也不断增
多．然而，对于协作用户犘犻（１犻犓－１）来说，当收
到请求用户犘０发送的匿名区构造协作请求且发现
δ犻λ０后，其仅需发送利用请求用户公钥加密自己
真实位置的密文以及该密文对应的签名数据给请求
用户，所以请求用户所需的平均计算时延与犓值无
关．此外，在匿名区构造过程中，请求用户所需的平
均通信开销随着请求用户隐私保护需求犓值的增
大而增加．其原因是随着犓值的变大，请求用户需
要接收更多协作用户提供的位置信息来构造匿名
区，从而增大了请求用户的平均通信开销．然而，对
于协作用户来说，由于是采用点对点通信的方式提
供自己的真实位置给请求用户，因此协作用户所需
的平均通信开销并不随着请求用户隐私保护需求
犓值的变化而改变，如图４（ｂ）所示．
图４　构造匿名区所需的平均计算时延和通信开销
通过上述实验也可发现，当请求用户采用本方案
成功生成匿名区时，请求用户端和协作用户端所需的
计算时延和通信开销也极为有限．例如，当犓＝２０
时，请求用户的平均计算时延为２８２．０７４ｍｓ，其平均
通信开销为１７．０１８ＫＢ；而协作用户的平均计算时
延为３１．７７６ｍｓ，平均计算通信开销为１．４８９ＫＢ．这
就说明本方案具有较好的可用性，能高效地为请求
用户生成匿名区．
５２　区块链更新
下面分析本方案中分布式匿名区协作构造区块
链更新时用户所需的平均计算开销和存储开销．在
该部分实验中，设定生成新区块时包含的交易账单
数量为１００．
在更新分布式匿名区协作构造区块链时，无论
请求用户是否获得更新区块链的权限，其所需的计
算时延随着自身隐私保护需求犓值的增大而减少．
其原因是当犓值增大时，请求用户在构造匿名区时
已验证协作用户发送的关于其真实位置密文的签名
数据的数量也随之增多，从而使其在更新区块链过
４５９ 计　　算　　机　　学　　报 ２０１９年
《
 计
 算
 机
 学
 报
 》
程中需要验证协作用户发送的关于其真实位置密文
的签名数据的数量减少，如图５（ａ）所示．例如，当犓
值从２变化到２０时，若请求用户未获得更新区块链
的权限时，其在更新分布式匿名区协作构造区块链
的过程中，所需的计算时延从３５２８．７０３ｍｓ减少至
３３７４．６８１ｍｓ；若请求用户获得更新区块链的权限
时，其所需的计算时延也从３２４２．０８４ｍｓ减少至
３１２５．９１６ｍｓ．
图５　区块链更新时请求用户和协作用户所需平均计算时延
对于协作用户来说，在更新分布式匿名区协作
构造区块链时，无论请求用户是否获得更新区块链
的权限，其均需要对请求用户广播发送的所有交易
账单的正确性进行验证．因此，其所需的计算时延并
不受请求用户的隐私保护需求犓值的影响，如图５
（ｂ）所示．并且，由于协作用户仅需验证每个交易账
单中关于协作用户真实位置密文的签名数据的正确
性，从而使其在更新分布式匿名区协作构造区块链
过程中所需的计算时延远小于请求用户所需的计算
时延．例如，当协作用户未获得更新区块链的权限
时，其在更新分布式匿名区协作构造区块链的过程
中，所需的平均计算时延为１７３３．５８３ｍｓ；而当其获
得更新区块链的权限时，所需的平均计算时延为
１４３９．４２８ｍｓ．
５３　交易账单数量对本方案的影响
这部分实验用于分析当前交易账单数量对区块
链更新时所需的通信开销、生成新区块所需的计算
时延以及新生成区块大小的影响．设定生成新的区
块时形成的交易账单数量从１００变化至１０００．
在本方案中，存储至区块链中的交易账单最终
是由请求用户进行全网广播的，这使得网络中的所
有用户均能验证这些交易账单的正确性．因此，请求
用户在区块链更新过程中的通信开销随着交易账单
数量的增加而增大，如图６所示．并且，随着交易账
单数量的增加，在生成分布式匿名区协作构造区块
链的新区块时，需要存储的交易账单数量以及计算
这些账单Ｈａｓｈ值为叶子节点的Ｍｅｒｋｌｅ树根节点
所需的计算时延也随之增加．这就导致生成新区块所
需的计算时延以及生成的新区块大小随着交易账单
数量的增加而增多，分别如图７（ａ）和图７（ｂ）所示．例
如，当交易账单数量为１００时，生成新区块所需的计
算时延仅为２５２．４８１ｍｓ，生成的新区块大小为
９９８．３３３ＫＢ；而当交易账单数量为１０００时，生成新
区块所需的计算时延为７１４８．６９４ｍｓ，生成的新区块
的大小也增加至９８２４．５７１ＫＢ．
图６　交易账单数量对区块链更新时请求用户
所需平均通信开销的影响
通过上述分析可知，当生产新的区块时，随着交
易账单数量的增加，网络中各用户的计算时延、通信
开销和存储开销也会随之增加．但是，对于请求用户
来说，当其获得新区块的生成权时，他可先构造匿名
区再进行新区块的生成．从图４（ａ）和图４（ｂ）可知，
在使用本方案生成匿名区时，请求用户和协作用户
５５９５期 刘　海等：基于区块链的分布式犓匿名位置隐私保护方案
《
 计
 算
 机
 学
 报
 》
图７　交易账单数量对区块链更新时网络中用户的影响
所需的计算时延和通信开销均十分有限．这就说明本
方案能高效地生成匿名区而且具有较好的实用性．
此外，在实际应用中，也可通过调整生成新区块
的频率来减少用于生成新区块的交易账单数量，降
低区块链更新时网络中各用户的计算时延、通信开
销和存储开销，从而进一步提高本方案的可用性．
５４　区块链长度对本方案的影响
本部分实验用于分析区块链长度（即区块链中
区块的个数）对协作用户在匿名区构造过程中的存
储开销和计算时延的影响，分别如图８（ａ）和图８（ｂ）
所示．
在该部分实验中，设定每个区块中均存储１００
个交易账单，区块链长度从１０个区块增至１００个区
块．在本方案中，当收到请求用户发送的协作请求
后，收到匿名区构造协作请求后，为了验证请求用户
历史上是否存在位置隐私泄露或欺骗行为，协作用
户需要下载并查询整个区块链中存储的交易账单．
因此，随着分布式匿名区协作构造区块链长度的增
加，协作用户在匿名区构造过程中所需的计算时延
图８　区块链长度对协作用户的影响
和存储开销也在不断增大．此外，由于协作用户查询
整个区块链中存储的交易账单所需时间极为有限，
因此当区块链长度增加时，在匿名区构造过程中协
作用户所需的计算时延增长的极为缓慢．例如，当分
布式匿名区协作构造区块链长度从１０变化至１００
时，在匿名区构造过程中，协作用户所需的平均计算
时延仅从３２．０７５ｍｓ增至３２．５０３ｍｓ．
５５　历史协作次数对本方案的影响
下面分析请求用户作为协作者参与匿名区构造
的次数对其成功构造匿名区时所需通信开销的影
响，如图９所示．
在本方案中，随着请求用户作为协作者参与匿
名区构造的次数的增多，即λ０的增大，请求用户需
要提供的交易账单号的数量也随之增多，从而导致
请求用户在匿名区构造过程中所需的通信开销也随
之增大．此外，当收到匿名区构造协作请求后，为了
验证请求用户历史上是否存在位置隐私泄露或欺骗
行为，协作用户需要查询整个区块链中存储的交易
账单．因此，请求用户作为协作者参与匿名区构造的
６５９ 计　　算　　机　　学　　报 ２０１９年
《
 计
 算
 机
 学
 报
 》
图９　历史协作次数对请求用户所需通信开销的影响
次数并不影响协作用户在匿名区构造过程中的计算
时延．
５６　网络中用户数量对本方案的影响
下面简要分析网络中用户数量对使用本方案构
造匿名区成功率的影响．在该部分实验中，通过生成
随机数的方式分别为请求用户生成其历史帮助其他
用户构造匿名区的次数以及协作用户的判断阈值．
设定请求用户的隐私保护需求犓＝５，１０，１５和２０，
针对不同的犓值分别重复执行５０次实验，具体结
果如图１０所示．
图１０　网络中用户数量对匿名区构造成功率的影响
实验表明，随着网络中用户数量的不断增加，网
络中决定给请求用户提供帮助的协作用户数量也不
断增多，即判断阈值δ犻满足λ０δ犻的协作用户犘犻的
数量也不断变大，从而导致请求用户使用本方案构
造匿名区的成功率也不断增大．
５７　方案对比
最后，通过与现有分布式犓匿名位置隐私保护
方案［２１，３５］进行对比，说明本方案的实用性．其中，方
案［２１］是经典的分布式犓匿名位置隐私保护方案，
它利用树形结构存储请求用户和协作用户的位置信
息，从而避免请求用户位于构造出的匿名区域中心；
而作为目前最好的一个分布式犓匿名位置隐私保
护方案，方案［３５］通过设计信誉机制来促使协作用
户参与匿名区构造，并引入半可信的第三方使得请
求用户可对协作用户提供的信誉证书进行批验证，
从而极大地降低了请求用户的计算时延．
如图１１和图１２所示，与方案［３５］相比，本方案
不仅在无需第三方参与且能有效防止匿名区构造过
程中出现位置泄露和位置欺骗行为的同时，还降低
了请求用户和协作用户的计算时延和通信开销．此
外，与方案［２１］相比，本方案在未显著增加请求用户
和协作用户计算时延和通信开销的同时，有效约束
匿名区构造过程中请求用户和协作用户的行为．这
就说明本方案具有较好的实用性．
图１１　平均计算时延
综上所述，当请求用户采用本方案保护其ＬＢＳ
查询时的位置隐私时，他和网络中协作用户所需的计
算时延、通信开销和存储开销都极为有限．这就证明
７５９５期 刘　海等：基于区块链的分布式犓匿名位置隐私保护方案
《
 计
 算
 机
 学
 报
 》
图１２　平均通信开销
了本方案能高效地生成匿名区，具有较好的实用性．
６　总结与展望
现有分布式犓匿名隐私保护方案并不能有效
保护用户的位置隐私．造成这一问题的原因是这些
方案并未考虑匿名区构造过程中的隐私泄露和欺骗
行为，使得自利的请求用户在收到协作用户的真实
位置后会将其泄露给第三方以获取额外收益；而自
利的协作用户则会向请求用户提供虚假位置，导致
构造出的匿名区不能满足请求用户的位置隐私保护
需求．为了解决该问题，本文首先形式化描述分布式
匿名区构造过程博弈，并通过分析请求用户和协作
用户的策略选择和收益，给出分布式犓匿名位置隐
私保护的安全性定义．随后，利用区块链分布式存储
参与博弈的请求用户和协作用户以及协作用户提供
的位置信息作为证据，通过惩罚具有位置泄露和欺
骗行为的用户在未来发送匿名区协同构造请求时不
能成功地构造匿名区，来约束请求用户和协作用户
的自利性行为．本文基于上述讨论提出了一个基于
区块链的分布式犓匿名位置隐私保护方案．安全性
分析及实验表明本方案不仅能有效防止请求用户泄
露协作用户的位置信息，还能促使协作用户提供真
实的位置，从而高效地构造出匿名区．此外，本方案
不仅能保护人群稀疏场景中请求用户的位置隐私，
还能保护其连续查询时的位置隐私．
在分布式犓匿名位置隐私保护方法中，请求用
户的位置隐私保护需求与所享受的服务质量是相互
矛盾的．为了兼顾用户对这两方面的需求，在未来的
工作中，作者将分析影响请求用户位置隐私保护和
所享受的服务质量的因素，在博弈论指导下，建立两
者之间的博弈模型，指导分布式犓匿名位置隐私保
护方案的设计，使得所提方案能够兼顾位置隐私保
护和服务质量．此外，在分布式匿名区构造过程中，
准确地度量请求用户和协作用户的信誉值，不仅能
协助请求用户选择可信的协作用户提供的位置信息
来构造匿名区，还能帮助协作用户确定是否参与匿
名区构造．因此，未来的另一个工作是利用可信计算
的方法与理论，设计适用于分布式匿名区构造的信
任评估模型．
参考文献
［１］ＫｒｕｍｍＪ．Ａｓｕｒｖｅｙｏｆｃｏｍｐｕｔａｔｉｏｎａｌｌｏｃａｔｉｏｎｐｒｉｖａｃｙ．
ＰｅｒｓｏｎａｌａｎｄＵｂｉｑｕｉｔｏｕｓＣｏｍｐｕｔｉｎｇ，２００９，１３（６）：３９１３９９
［２］ＤａｍｉａｎｉＭＬ．Ｌｏｃａｔｉｏｎｐｒｉｖａｃｙｍｏｄｅｌｓｉｎｍｏｂｉｌｅａｐｐｌｉｃａｔｉｏｎｓ：
Ｃｏｎｃｅｐｔｕａｌｖｉｅｗａｎｄｒｅｓｅａｒｃｈｄｉｒｅｃｔｉｏｎｓ．ＧｅｏＩｎｆｏｒｍａｔｉｃａ，
２０１４，１８（４）：８１９８４２
［３］ＺｈｕＨ，ＬｕＲ，ＨｕａｎｇＣ，ｅｔａｌ．Ａｎｅｆｆｉｃｉｅｎｔｐｒｉｖａｃｙｐｒｅｓｅｒｖｉｎｇ
ｌｏｃａｔｉｏｎｂａｓｅｄｓｅｒｖｉｃｅｓｑｕｅｒｙｓｃｈｅｍｅｉｎｏｕｔｓｏｕｒｃｅｄｃｌｏｕｄ．
ＩＥＥＥＴｒａｎｓａｃｔｉｏｎｓｏｎＶｅｈｉｃｕｌａｒＴｅｃｈｎｏｌｏｇｙ，２０１６，６５（９）：
７７２９７７３９
［４］ＷａｎｇＸ，ＭｕＹ，ＣｈｅｎＲ．Ｏｎｅｒｏｕｎｄｐｒｉｖａｃｙｐｒｅｓｅｒｖｉｎｇ
ｍｅｅｔｉｎｇｌｏｃａｔｉｏｎｄｅｔｅｒｍｉｎａｔｉｏｎｆｏｒｓｍａｒｔｐｈｏｎｅａｐｐｌｉｃａｔｉｏｎｓ．
ＩＥＥＥＴｒａｎｓａｃｔｉｏｎｓｏｎＩｎｆｏｒｍａｔｉｏｎＦｏｒｅｎｓｉｃｓａｎｄＳｅｃｕｒｉｔｙ，
２０１６，１１（８）：１７１２１７２１
［５］ＹｕＲ，ＫａｎｇＪ，ＨｕａｎｇＸ，ｅｔａｌ．ＭｉｘＧｒｏｕｐ：Ａｃｃｕｍｕｌａｔｉｖｅ
ｐｓｅｕｄｏｎｙｍｅｘｃｈａｎｇｉｎｇｆｏｒｌｏｃａｔｉｏｎｐｒｉｖａｃｙｅｎｈａｎｃｅｍｅｎｔｉｎ
ｖｅｈｉｃｕｌａｒｓｏｃｉａｌｎｅｔｗｏｒｋｓ．ＩＥＥＥＴｒａｎｓａｃｔｉｏｎｓｏｎＤｅｐｅｎｄａｂｌｅ
ＳｅｃｕｒｅＣｏｍｐｕｔｉｎｇ，２０１６，１３（１）：９３１０５
［６］ＷａｎｇＸ，ＰａｎｄｅＡ，ＺｈｕＪ，ｅｔａｌ．ＳＴＡＭＰ：Ｅｎａｂｌｉｎｇｐｒｉｖａｃｙ
ｐｒｅｓｅｒｖｉｎｇｌｏｃａｔｉｏｎｐｒｏｏｆｓｆｏｒｍｏｂｉｌｅｕｓｅｒｓ．ＩＥＥＥ／ＡＣＭ
ＴｒａｎｓａｃｔｉｏｎｓｏｎＮｅｔｗｏｒｋｉｎｇ，２０１６，２４（６）：３２７６３２８９
［７］ＯｌｔｅａｎｕＡＭ，ＨｕｇｕｅｎｉｎＫ，ＳｈｏｋｒｉＲ，ｅｔａｌ．Ｑｕａｎｔｉｆｙｉｎｇ
ｉｎｔｅｒｄｅｐｅｎｄｅｎｔｐｒｉｖａｃｙｒｉｓｋｓｗｉｔｈｌｏｃａｔｉｏｎｄａｔａ．ＩＥＥＥＴｒａｎｓａｃ
ｔｉｏｎｓｏｎＭｏｂｉｌｅＣｏｍｐｕｔｉｎｇ，２０１７，１６（３）：８２９８４２
［８］ＤｅＭｏｎｔｊｏｙｅＹＡ，ＨｉｄａｌｇｏＣＡ，ＶｅｒｌｅｙｓｅｎＭ，ｅｔａｌ．Ｕｎｉｑｕｅｉｎ
ｔｈｅｃｒｏｗｄ：ｔｈｅｐｒｉｖａｃｙｂｏｕｎｄｓｏｆｈｕｍａｎｍｏｂｉｌｉｔｙ．Ｓｃｉｅｎｔｉｆｉｃ
Ｒｅｐｏｒｔｓ，２０１３，３（６），ＡｒｔｉｃｌｅＮｏ．１３７６
［９］ＤｅＭｏｎｔｊｏｙｅＹＡ，ＲａｄａｅｌｌｉＬ，ＳｉｎｇｈＶＫ，ｅｔａｌ．Ｕｎｉｑｕｅｉｎ
ｔｈｅｓｈｏｐｐｉｎｇｍａｌｌ：ｏｎｔｈｅｉｄｅｎｔｉｆｉａｂｉｌｉｔｙｏｆｃｒｅｄｉｔｃａｒｄｍｅｔａ
ｄａｔａ．Ｓｃｉｅｎｃｅ，２０１５，３４７（６２２１）：５３６５３９
８５９ 计　　算　　机　　学　　报 ２０１９年
《
 计
 算
 机
 学
 报
 》
［１０］ＧｒｕｔｅｓｅｒＭ，ＧｒｕｎｗａｌｄＤ．Ａｎｏｎｙｍｏｕｓｕｓａｇｅｏｆｌｏｃａｔｉｏｎ
ｂａｓｅｄｓｅｒｖｉｃｅｓｔｈｒｏｕｇｈｓｐａｔｉａｌａｎｄｔｅｍｐｏｒａｌｃｌｏａｋｉｎｇ／／
Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ１ｓｔＩｎｔｅｒｎａｔｉｏｎａｌＣｏｎｆｅｒｅｎｃｅｏｎＭｏｂｉｌｅ
Ｓｙｓｔｅｍ，Ａｐｐｌｉｃａｔｉｏｎｓ，ａｎｄＳｅｒｖｉｃｅｓ（ＭｏｂｉＳｙｓ２００３）．Ｓａｎ
Ｆｒａｎｃｉｓｃｏ，ＵＳＡ，２００３：１１２
［１１］ＬｉｕＸ，ＬｉｕＫ，ＧｕｏＬ，ｅｔａｌ．Ａｇａｍｅｔｈｅｏｒｅｔｉｃａｐｐｒｏａｃｈｆｏｒ
ａｃｈｉｅｖｉｎｇ犓ａｎｏｎｙｍｉｔｙｉｎｌｏｃａｔｉｏｎｂａｓｅｄｓｅｒｖｉｃｅｓ／／Ｐｒｏｃｅｅｄ
ｉｎｇｓｏｆｔｈｅ３２ｎｄＩＥＥＥＩｎｔｅｒｎａｔｉｏｎａｌＣｏｎｆｅｒｅｎｃｅｏｎＣｏｍｐｕｔｅｒ
Ｃｏｍｍｕｎｉｃａｔｉｏｎｓ（ＩＮＦＯＣＯＭ２０１３）．Ｔｕｒｉｎ，Ｉｔａｌｙ，２０１３：
２９８５２９９３
［１２］ＸｉａｏＹ，ＸｉｏｎｇＬ．Ｐｒｏｔｅｃｔｉｎｇｌｏｃａｔｉｏｎｓｗｉｔｈｄｉｆｆｅｒｅｎｔｉａｌｐｒｉｖａｃｙ
ｕｎｄｅｒｔｅｍｐｏｒａｌｃｏｒｒｅｌａｔｉｏｎｓ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ２２ｎｄＡＣＭ
ＣｏｎｆｅｒｅｎｃｅｏｎＣｏｍｐｕｔｅｒａｎｄＣｏｍｍｕｎｉｃａｔｉｏｎｓＳｅｃｕｒｉｔｙ（ＣＣＳ
２０１５）．Ｄｅｎｖｅｒ，ＵＳＡ，２０１５：１２９８１３０９
［１３］ＷｕＹＣ，ＣｈｅｎＨ，ＺｈａｏＳＹ，ｅｔａｌ．Ｄｉｆｆｅｒｅｎｔｉａｌｌｙｐｒｉｖａｔｅ
ｔｒａｊｅｃｔｏｒｙｐｒｏｔｅｃｔｉｏｎｂａｓｅｄｏｎｓｐａｔｉａｌａｎｄｔｅｍｐｏｒａｌｃｏｒｒｅｌａ
ｔｉｏｎ．ＣｈｉｎｅｓｅＪｏｕｒｎａｌｏｆＣｏｍｐｕｔｅｒｓ，２０１８，４１（２）：３０９３２２
（ｉｎＣｈｉｎｅｓｅ）
（吴云乘，陈红，赵素云等．一种基于时空相关性的差分隐私
轨迹保护机制．计算机学报，２０１８，４１（２）：３０９３２２）
［１４］ＤｕｃｋｈａｍＭ，ＫｕｌｉｋＬ．Ａｆｏｒｍａｌｍｏｄｅｌｏｆｏｂｆｕｓｃａｔｉｏｎａｎｄ
ｎｅｇｏｔｉａｔｉｏｎｆｏｒｌｏｃａｔｉｏｎｐｒｉｖａｃｙ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ３ｒｄ
ＩｎｔｅｒｎａｔｉｏｎａｌＣｏｎｆｅｒｅｎｃｅｏｎＰｅｒｖａｓｉｖｅＣｏｍｐｕｔｉｎｇ（Ｐｅｒｖａｓｉｖｅ
２００５）．Ｍｕｎｉｃｈ，Ｇｅｒｍａｎｙ，２００５：１５２１７０
［１５］ＬｉＭ，ＳａｌｉｎａｓＳ，ＴｈａｐａＡ，ｅｔａｌ．狀ＣＤ：Ａｇｅｏｍｅｔｒｉｃ
ａｐｐｒｏａｃｈｔｏｐｒｅｓｅｒｖｉｎｇｌｏｃａｔｉｏｎｐｒｉｖａｃｙｉｎｌｏｃａｔｉｏｎｂａｓｅｄ
ｓｅｒｖｉｃｅｓ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ３２ｎｄＩＥＥＥＩｎｔｅｒｎａｔｉｏｎａｌＣｏｎ
ｆｅｒｅｎｃｅｏｎＣｏｍｐｕｔｅｒＣｏｍｍｕｎｉｃａｔｉｏｎｓ（ＩＮＦＯＣＯＭ２０１３）．
Ｔｕｒｉｎ，Ｉｔａｌｙ，２０１３：３０１２３０２０
［１６］ＭａｓｃｅｔｔｉＳ，ＦｒｅｎｉＤ，ＢｅｔｔｉｎｉＣ，ｅｔａｌ．Ｐｒｉｖａｃｙｉｎｇｅｏｓｏｃｉａｌ
ｎｅｔｗｏｒｋｓ：ｐｒｏｘｉｍｉｔｙｎｏｔｉｆｉｃａｔｉｏｎｗｉｔｈｕｎｔｒｕｓｔｅｄｓｅｒｖｉｃｅｐｒｏ
ｖｉｄｅｒｓａｎｄｃｕｒｉｏｕｓｂｕｄｄｉｅｓ．ＶＬＤＢＪｏｕｒｎａｌ，２０１１，２０（４）：
５４１５６６
［１７］ＳｃｈｌｅｇｅｌＲ，ＣｈｏｗＣＹ，ＨｕａｎｇＱ，ｅｔａｌ．Ｕｓｅｒｄｅｆｉｎｅｄｐｒｉｖａｃｙ
ｇｒｉｄｓｙｓｔｅｍｆｏｒｃｏｎｔｉｎｕｏｕｓｌｏｃａｔｉｏｎｂａｓｅｄｓｅｒｖｉｃｅｓ．ＩＥＥＥ
ＴｒａｎｓａｃｔｉｏｎｓｏｎＭｏｂｉｌｅＣｏｍｐｕｔｉｎｇ，２０１５，１４（１０）：２１５８
２１７２
［１８］ＧｅｄｉｋＢ，ＬｉｕＬ．Ｐｒｏｔｅｃｔｉｎｇｌｏｃａｔｉｏｎｐｒｉｖａｃｙｗｉｔｈｐｅｒｓｏｎａｌｉｚｅｄ
犽ａｎｏｎｙｍｉｔｙ：ａｒｃｈｉｔｅｃｔｕｒｅａｎｄａｌｇｏｒｉｔｈｍｓ．ＩＥＥＥＴｒａｎｓａｃ
ｔｉｏｎｓｏｎＭｏｂｉｌｅＣｏｍｐｕｔｉｎｇ，２００８，７（１）：１１８
［１９］ＶｕＫ，ＺｈｅｎｇＲ，ＧａｏＪ．Ｅｆｆｉｃｉｅｎｔａｌｇｏｒｉｔｈｍｆｏｒ犽ａｎｏｎｙｍｏｕｓ
ｌｏｃａｔｉｏｎｐｒｉｖａｃｙｉｎｐａｒｔｉｃｉｐａｔｏｒｙｓｅｎｓｉｎｇ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ
３１ｓｔＩＥＥＥＩｎｔｅｒｎａｔｉｏｎａｌＣｏｎｆｅｒｅｎｃｅｏｎＣｏｍｐｕｔｅｒＣｏｍｍｕｎｉ
ｃａｔｉｏｎｓ（ＩＮＦＯＣＯＭ２０１２）．Ｏｒｌａｎｄｏ，ＵＳＡ，２０１２：２３９９
２４０７
［２０］ＣｈｏｗＣＹ，ＭｏｋｂｅｌＭＦ，ＬｉｕＸ．Ａｐｅｅｒｔｏｐｅｅｒｓｐａｔｉａｌｃｌｏａｋｉｎｇ
ａｌｇｏｒｉｔｈｍｆｏｒａｎｏｎｙｍｏｕｓｌｏｃａｔｉｏｎｂａｓｅｄｓｅｒｖｉｃｅ／／Ｐｒｏｃｅｅｄｉｎｇｓ
ｏｆｔｈｅ１４ｔｈＡｎｎｕａｌＡＣＭＩｎｔｅｒｎａｔｉｏｎａｌＳｙｍｐｏｓｉｕｍｏｎ
ＡｄｖａｎｃｅｓｉｎＧｅｏｇｒａｐｈｉｃＩｎｆｏｒｍａｔｉｏｎＳｙｓｔｅｍｓ（ＧＩＳ２００６）．
Ａｒｌｉｎｇｔｏｎ，ＵＳＡ，２００６：１７１１７８
［２１］ＧｈｉｎｉｔａＧ，ＫａｌｎｉｓＰ，ＳｋｉａｄｏｐｏｕｌｏｓＳ．ＰＲＩＶ?：Ａｎｏｎｙｍｏｕｓ
ｌｏｃａｔｉｏｎｂａｓｅｄｑｕｅｒｉｅｓｉｎｄｉｓｔｒｉｂｕｔｅｄｍｏｂｉｌｅｓｙｓｔｅｍｓ／／Ｐｒｏ
ｃｅｅｄｉｎｇｓｏｆｔｈｅ１６ｔｈＩｎｔｅｒｎａｔｉｏｎａｌＣｏｎｆｅｒｅｎｃｅｏｎＷｏｒｌｄＷｉｄｅ
Ｗｅｂ（ＷＷＷ２００７）．Ｂａｎｆｆ，Ｃａｎａｄａ，２００７：３７１３８０
［２２］ＧｈｉｎｉｔａＧ，ＫａｌｎｉｓＰ，ＳｋｉａｄｏｐｏｕｌｏｓＳ．ＭＯＢＩＨＩＤＥ：Ａｍｏｂｉｌｅａ
ｐｅｅｒｔｏｐｅｅｒｓｙｓｔｅｍｆｏｒａｎｏｎｙｍｏｕｓｌｏｃａｔｉｏｎｂａｓｅｄｑｕｅｒｉｅｓ／／
Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ１０ｔｈＩｎｔｅｒｎａｔｉｏｎａｌＳｙｍｐｏｓｉｕｍｏｎＳｐａｔｉａｌ
ａｎｄＴｅｍｐｏｒａｌＤａｔａｂａｓｅｓ（ＳＳＴＤ２００７）．Ｂｏｓｔｏｎ，ＵＳＡ，
２００７：２２１２３８
［２３］ＣｈｏｗＣＹ，ＭｏｋｂｅｌＭＦ，ＢａｏＪ，ｅｔａｌ．Ｑｕｅｒｙａｗａｒｅｌｏｃａｔｉｏｎ
ａｎｏｎｙｍｉｚａｔｉｏｎｆｏｒｒｏａｄｎｅｔｗｏｒｋｓ．Ｇｅｏｉｎｆｏｒｍａｔｉｃａ，２０１１，１５
（３）：５７１６０７
［２４］ＳｕｎＧ，ＬｉａｏＤ，ＬｉＨ，ｅｔａｌ．Ｌ２Ｐ２：Ａｌｏｃａｔｉｏｎｌａｂｅｌｂａｓｅｄ
ａｐｐｒｏａｃｈｆｏｒｐｒｉｖａｃｙｐｒｅｓｅｒｖｉｎｇｉｎＬＢＳ．ＦｕｔｕｒｅＧｅｎｅｒａｔｉｏｎ
ＣｏｍｐｕｔｅｒＳｙｓｔｅｍｓ，２０１７，７４：３７５３８４
［２５］ＣｈｏｗＣＹ，ＭｏｋｂｅｌＭＦ，ＬｉｕＸ．Ｓｐａｔｉａｌｃｌｏａｋｉｎｇｆｏｒａｎｏｎｙ
ｍｏｕｓｌｏｃａｔｉｏｎｂａｓｅｄｓｅｒｖｉｃｅｓｉｎｍｏｂｉｌｅｐｅｅｒｔｏｐｅｅｒｅｎｖｉｒｏｎ
ｍｅｎｔｓ．Ｇｅｏｉｎｆｏｒｍａｔｉｃａ，２０１１，１５（２）：３５１３８０
［２６］ＫｉｍＨＩ，ＳｈｉｎＹＳ，ＣｈａｎｇＪＷ．Ａｇｒｉｄｂａｓｅｄｃｌｏａｋｉｎｇ
ｓｃｈｅｍｅｆｏｒｃｏｎｔｉｎｕｏｕｓｑｕｅｒｉｅｓｉｎｄｉｓｔｒｉｂｕｔｅｄｓｙｓｔｅｍｓ／／Ｐｒｏ
ｃｅｅｄｉｎｇｓｏｆｔｈｅ１１ｔｈＩｎｔｅｒｎａｔｉｏｎａｌＣｏｎｆｅｒｅｎｃｅｏｎＣｏｍｐｕｔｅｒ
ａｎｄＩｎｆｏｒｍａｔｉｏｎＴｅｃｈｎｏｌｏｇｙ（ＣＩＴ２０１１）．Ｐａｆｏｓ，Ｃｙｐｒｕｓ，
２０１１：７５８２
［２７］ＰｅｎｇＴ，ＬｉｕＱ，ＭｅｎｇＤ，ｅｔａｌ．Ｃｏｌｌａｂｏｒａｔｉｖｅｔｒａｊｅｃｔｏｒｙｐｒｉ
ｖａｃｙｐｒｅｓｅｒｖｉｎｇｓｃｈｅｍｅｉｎｌｏｃａｔｉｏｎｂａｓｅｄｓｅｒｖｉｃｅｓ．Ｉｎｆｏｒｍａ
ｔｉｏｎＳｃｉｅｎｃｅｓ，２０１７，３８７（Ｃ）：１６５１７９
［２８］ＺｈｏｎｇＧ，ＨｅｎｇａｒｔｎｅｒＵ．Ａｄｉｓｔｒｉｂｕｔｅｄ犽ａｎｏｎｙｍｉｔｙｐｒｏｔｏｃｏｌ
ｆｏｒｌｏｃａｔｉｏｎｐｒｉｖａｃｙ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ７ｔｈＡｎｎｕａｌＩＥＥＥ
ＩｎｔｅｒｎａｔｉｏｎａｌＣｏｎｆｅｒｅｎｃｅｏｎＰｅｒｖａｓｉｖｅＣｏｍｐｕｔｉｎｇａｎｄＣｏｍ
ｍｕｎｉｃａｔｉｏｎｓ（ＰｅｒＣｏｍ２００９）．Ｇａｌｖｅｓｔｏｎ，ＵＳＡ，２００９：１１０
［２９］ＴａｋａｂｉＨＪ，ＪｏｓｈｉＢＤ，ＫａｒｉｍｉＨＡ．Ａｃｏｌｌａｂｏｒａｔｉｖｅ犽
ａｎｏｎｙｍｉｔｙａｐｐｒｏａｃｈｆｏｒｌｏｃａｔｉｏｎｐｒｉｖａｃｙｉｎｌｏｃａｔｉｏｎｂａｓｅｄ
ｓｅｒｖｉｃｅｓ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ５ｔｈＩｎｔｅｒｎａｔｉｏｎａｌＣｏｎｆｅｒｅｎｃｅｏｎ
ＣｏｌｌａｂｏｒａｔｉｖｅＣｏｍｐｕｔｉｎｇ：Ｎｅｔｗｏｒｋｉｎｇ，Ａｐｐｌｉｃａｔｉｏｎｓａｎｄ
Ｗｏｒｋｓｈａｒｉｎｇ（ＣｏｌｌａｂｏｒａｔｅＣｏｍ２００９）．Ｗａｓｈｉｎｇｔｏｎ，ＵＳＡ，
２００９：１９
［３０］ＣｈｅＹ，ＹａｎｇＱ，ＨｏｎｇＸ．Ａｄｕａｌａｃｔｉｖｅｓｐａｔｉａｌｃｌｏａｋｉｎｇ
ａｌｇｏｒｉｔｈｍｆｏｒｌｏｃａｔｉｏｎｐｒｉｖａｃｙｐｒｅｓｅｒｖｉｎｇｉｎｍｏｂｉｌｅｐｅｅｒｔｏ
ｐｅｅｒｎｅｔｗｏｒｋｓ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ２０１２ＩＥＥＥＷｉｒｅｌｅｓｓＣｏｍ
ｍｕｎｉｃａｔｉｏｎｓａｎｄＮｅｔｗｏｒｋｉｎｇＣｏｎｆｅｒｅｎｃｅ（ＷＣＮＣ２０１２）．
Ｓｈａｎｇｈａｉ，Ｃｈｉｎａ，２０１２：２０９８２１０２
［３１］ＨｗａｎｇＲＨ，ＨｕａｎｇＦＨ．ＳｏｃｉａｌＣｌｏａｋｉｎｇ：Ａｄｉｓｔｒｉｂｕｔｅｄ
ａｒｃｈｉｔｅｃｔｕｒｅｆｏｒ犓ａｎｏｎｙｍｉｔｙｌｏｃａｔｉｏｎｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎ／／
Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ２０１４ＩｎｔｅｒｎａｔｉｏｎａｌＣｏｎｆｅｒｅｎｃｅｏｎＣｏｍｐｕ
ｔｉｎｇ，ＮｅｔｗｏｒｋｉｎｇａｎｄＣｏｍｍｕｎｉｃａｔｉｏｎｓ（ＩＣＮＣ２０１４）．Ｈｏｎｏ
ｌｕｌｕ，ＵＳＡ，２０１４：２４７２５１
［３２］ＨｗａｎｇＲＨ，ＨｓｕｅｈＹＬ，ＷｕＪＪ，ｅｔａｌ．ＳｏｃｉａｌＨｉｄｅ：Ａ
ｇｅｎｅｒｉｃｄｉｓｔｒｉｂｕｔｅｄｆｒａｍｅｗｏｒｋｆｏｒｌｏｃａｔｉｏｎｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎ．
ＪｏｕｒｎａｌｏｆＮｅｔｗｏｒｋａｎｄＣｏｍｐｕｔｅｒＡｐｐｌｉｃａｔｉｏｎｓ，２０１６，７６：
８７１００
［３３］ＹａｎｇＤ，ＦａｎｇＸ，ＸｕｅＧ．Ｔｒｕｔｈｆｕｌｉｎｃｅｎｔｉｖｅｍｅｃｈａｎｉｓｍｓｆｏｒ
犓ａｎｏｎｙｍｉｔｙｌｏｃａｔｉｏｎｐｒｉｖａｃｙ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ３２ｎｄＩＥＥＥ
ＩｎｔｅｒｎａｔｉｏｎａｌＣｏｎｆｅｒｅｎｃｅｏｎＣｏｍｐｕｔｅｒＣｏｍｍｕｎｉｃａｔｉｏｎｓ
（ＩＮＦＯＣＯＭ２０１３）．Ｔｕｒｉｎ，Ｉｔａｌｙ，２０１３：２９９４３００２
［３４］ＺｈａｎｇＹ，ＴｏｎｇＷ，ＺｈｏｎｇＳ．Ｏｎｄｅｓｉｇｎｉｎｇｓａｔｉｓｆａｃｔｉｏｎｒａｔｉｏ
ａｗａｒｅｔｒｕｔｈｆｕｌｉｎｃｅｎｔｉｖｅｍｅｃｈａｎｉｓｍｓｆｏｒ犓ａｎｏｎｙｍｉｔｙｌｏｃａｔｉｏｎ
ｐｒｉｖａｃｙ．ＩＥＥＥＴｒａｎｓａｃｔｉｏｎｓｏｎＩｎｆｏｒｍａｔｉｏｎＦｏｒｅｎｓｉｃｓａｎｄ
Ｓｅｃｕｒｉｔｙ，２０１６，１１（１１）：２５２８２５４１
［３５］ＬｉＸ，ＭｉａｏＭ，ＬｉｕＨ，ｅｔａｌ．Ａｎｉｎｃｅｎｔｉｖｅｍｅｃｈａｎｉｓｍｆｏｒ犓
ａｎｏｎｙｍｉｔｙｉｎＬＢＳｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎｂａｓｅｄｏｎｃｒｅｄｉｔｍｅｃｈａ
ｎｉｓｍ．ＳｏｆｔＣｏｍｐｕｔｉｎｇ，２０１７，２１（１４）：３９０７３９１７
９５９５期 刘　海等：基于区块链的分布式犓匿名位置隐私保护方案
《
 计
 算
 机
 学
 报
 》
［３６］ＣｈｏｗＣＹ，ＭｏｋｂｅｌＭＦ．Ｅｎａｂｌｉｎｇｐｒｉｖａｔｅｃｏｎｔｉｎｕｏｕｓｑｕｅｒｉｅｓ
ｆｏｒｒｅｖｅａｌｕｓｅｒｌｏｃａｔｉｏｎｓ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ１０ｔｈＩｎｔｅｒｎａ
ｔｉｏｎａｌＳｙｍｐｏｓｉｕｍｏｎＳｐａｔｉａｌａｎｄＴｅｍｐｏｒａｌＤａｔａｂａｓｅｓ（ＳＳＴＤ
２００７）．Ｂｏｓｔｏｎ，ＵＳＡ，２００７：２５８２７５
［３７］ＧｏｎｇＸ，ＣｈｅｎＸ，ＸｉｎｇＫ，ｅｔａｌ．Ｐｅｒｓｏｎａｌｉｚｅｄｌｏｃａｔｉｏｎｐｒｉｖａｃｙ
ｉｎｍｏｂｉｌｅｎｅｔｗｏｒｋｓ：Ａｓｏｃｉａｌｇｒｏｕｐｕｔｉｌｉｔｙａｐｐｒｏａｃｈ／／Ｐｒｏｃｅｅｄ
ｉｎｇｓｏｆｔｈｅ３４ｔｈＩＥＥＥＩｎｔｅｒｎａｔｉｏｎａｌＣｏｎｆｅｒｅｎｃｅｏｎＣｏｍｐｕｔｅｒ
Ｃｏｍｍｕｎｉｃａｔｉｏｎｓ（ＩＮＦＯＣＯＭ’１５）．ＨｏｎｇＫｏｎｇ，Ｃｈｉｎａ，
２０１５：１００８１０１６
［３８］ＧｏｎｇＸ，ＣｈｅｎＸ，ＸｉｎｇＫ，ｅｔａｌ．Ｆｒｏｍｓｏｃｉａｌｇｒｏｕｐｕｔｉｌｉｔｙ
ｍａｘｉｍｉｚａｔｉｏｎｔｏｐｅｒｓｏｎａｌｉｚｅｄｌｏｃａｔｉｏｎｐｒｉｖａｃｙｉｎｍｏｂｉｌｅｎｅｔ
ｗｏｒｋｓ．ＩＥＥＥ／ＡＣＭＴｒａｎｓａｃｔｉｏｎｓｏｎＮｅｔｗｏｒｋｉｎｇ，２０１７，２５
（３）：１７０３１７１６
［３９］ＳｈａｏＱＦ，ＪｉｎＣＱ，ＺｈａｏＺ，ｅｔａｌ．Ｂｌｏｃｋｃｈａｉｎ：Ａｒｃｈｉｔｅｃｔｕｒｅ
ａｎｄｒｅｓｅａｒｃｈｐｒｏｇｒｅｓｓ．ＣｈｉｎｅｓｅＪｏｕｒｎａｌｏｆＣｏｍｐｕｔｅｒｓ，２０１７，
４０（１）：１２１（ｉｎＣｈｉｎｅｓｅ）
（邵奇峰，金澈清，张召等．区块链技术：架构及进展．计算
机学报，２０１７，４０（１）：１２１）
犔犐犝犎犪犻，Ｐｈ．Ｄ．Ｈｉｓｒｅｓｅａｒｃｈ
ｉｎｔｅｒｅｓｔｓｉｎｃｌｕｄｅｌｏｃａｔｉｏｎｐｒｉｖａｃｙｐｒｏｔｅｃ
ｔｉｏｎａｎｄｓｅｃｕｒｉｔｙｐｒｏｔｏｃｏｌｄｅｓｉｇｎ．
犔犐犡犻狀犵犎狌犪，Ｐｈ．Ｄ．，ｐｒｏｆｅｓｓｏｒ，Ｐｈ．Ｄ．ｓｕｐｅｒｖｉｓｏｒ．
Ｈｉｓｒｅｓｅａｒｃｈｉｎｔｅｒｅｓｔｓｉｎｃｌｕｄｅｎｅｔｗｏｒｋａｎｄｉｎｆｏｒｍａｔｉｏｎｓｅｃｕｒｉｔｙ，
ｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎａｎｄｃｒｙｐｔｏｇｒａｐｈｙ．
犔犝犗犅犻狀，Ｐｈ．Ｄ．ｃａｎｄｉｄａｔｅ．Ｈｅｒｒｅｓｅａｒｃｈｉｎｔｅｒｅｓｔｓ
ｉｎｃｌｕｄｅｌｏｃａｔｉｏｎｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎａｎｄｔｒｕｓｔｅｖａｌｕａｔｉｏｎ．
犠犃犖犌犢狌狀犠犲犻，Ｐｈ．Ｄ．ｃａｎｄｉｄａｔｅ．Ｈｉｓｒｅｓｅａｒｃｈｉｎｔｅｒｅｓｔｓ
ｉｎｃｌｕｄｅｂｌｏｃｋｃｈａｉｎａｎｄｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎ．
犚犈犖犢犪狀犅犻狀犵，Ｍ．Ｓ．ｃａｎｄｉｄａｔｅ．Ｈｉｓｒｅｓｅａｒｃｈｉｎｔｅｒｅｓｔｓ
ｉｎｃｌｕｄｅｌｏｃａｔｉｏｎｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎａｎｄｂｌｏｃｋｃｈａｉｎ．
犕犃犑犻犪狀犉犲狀犵，Ｐｈ．Ｄ．，ｙａｎｇｔｚｅｒｉｖｅｒｓｃｈｏｌａｒｐｒｏｆｅｓｓｏｒ，
Ｐｈ．Ｄ．ｓｕｐｅｒｖｉｓｏｒ．Ｈｉｓｒｅｓｅａｒｃｈｉｎｔｅｒｅｓｔｓｉｎｃｌｕｄｅｎｅｔｗｏｒｋ
ａｎｄｉｎｆｏｒｍａｔｉｏｎｓｅｃｕｒｉｔｙ，ｃｏｄｉｎｇｔｈｅｏｒｙａｎｄｃｒｙｐｔｏｇｒａｐｈｙ．
犇犐犖犌犎狅狀犵犉犪，Ｐｈ．Ｄ．ｃａｎｄｉｄａｔｅ，ｌｅｃｔｕｒｅｒ．Ｈｉｓｒｅｓｅａｒｃｈ
ｉｎｔｅｒｅｓｔｓｉｎｃｌｕｄｅｄａｔａｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎａｎｄｓｅｃｕｒｉｔｙｐｒｏｔｏｃｏｌ
ｄｅｓｉｇｎ．
犅犪犮犽犵狉狅狌狀犱
　　Ｗｉｔｈｔｈｅｄｅｖｅｌｏｐｍｅｎｔｏｆｗｉｒｅｌｅｓｓｃｏｍｍｕｎｉｃａｔｉｏｎａｎｄ
ｐｏｓｉｔｉｏｎｉｎｇｔｅｃｈｎｏｌｏｇｉｅｓ，ｌｏｃａｔｉｏｎｂａｓｅｄｓｅｒｖｉｃｅ（ＬＢＳ）ｈａｓ
ｂｅｃｏｍｅａｐａｒｔｏｆｏｕｒｄａｉｌｙｌｉｆｅ．Ｈｏｗｅｖｅｒ，ｓｉｎｃｅＬＢＳａｌｗａｙｓ
ｒｅｑｕｉｒｅｓｔｈｅｕｓｅｒｓｔｏｓｕｂｍｉｔｔｈｅｉｒｌｏｃａｔｉｏｎｓ，ａｎｕｎｐｒｅｃｅｄｅｎｔｅｄ
ｔｈｒｅａｔａｂｏｕｔｌｏｃａｔｉｏｎｐｒｉｖａｃｙｏｆｍｏｂｉｌｅｕｓｅｒｓｃｏｍｅｓｗｉｔｈｔｈｅ
ｃｏｎｖｅｎｉｅｎｃｅｏｆｗｉｄｅｌｙｕｓｅｄｔｅｃｈｎｉｑｕｅ．Ｔｈｅｒｅｆｏｒｅ，ＬＢＳｌｏｃａ
ｔｉｏｎｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎｈａｓａｔｔｒａｃｔｅｄｓｕｂｓｔａｎｔｉａｌａｔｔｅｎｔｉｏｎ．
Ｄｉｓｔｒｉｂｕｔｅｄ犓ａｎｏｎｙｍｉｔｙｉｓｏｎｅｏｆｔｈｅｍｏｓｔｃｏｍｍｏｎａｎｄ
ｃｌａｓｓｉｃｓｏｌｕｔｉｏｎｓｆｏｒＬＢＳｌｏｃａｔｉｏｎｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎ．Ｉｎｔｈｉｓ
ｔｅｃｈｎｉｑｕｅ，ｔｈｅｒｅｑｕｅｓｔｕｓｅｒｃａｎａｃｑｕｉｒｅｔｈｅｃｏｏｐｅｒａｔｉｖｅｕｓｅｒｓ’
ｌｏｃａｔｉｏｎｓｂｙｈｉｍｓｅｌｆ／ｈｅｒｓｅｌｆｔｏｃｏｎｓｔｒｕｃｔａｎａｎｏｎｙｍｏｕｓｃｌｏａｋｉｎｇ
ｒｅｇｉｏｎａｎｄｓｕｂｍｉｔｔｈｅａｎｏｎｙｍｏｕｓｃｌｏａｋｉｎｇｒｅｇｉｏｎｔｏｌｏｃａｔｉｏｎ
ｂａｓｅｄｓｅｒｖｉｃｅｐｒｏｖｉｄｅｒ（ＬＳＰ）ｉｎｓｔｅａｄｏｆｈｉｓ／ｈｅｒｒｅａｌｌｏｃａｔｉｏｎ．
Ｃｏｍｐａｒｅｄｗｉｔｈｏｔｈｅｒｌｏｃａｔｉｏｎｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎｍｅｔｈｏｄｓ，
ｓｕｃｈａｓｄｉｆｆｅｒｅｎｔｉａｌｐｒｉｖａｃｙ，ｏｂｆｕｓｃａｔｉｏｎｏｒｃｒｙｐｔｏｇｒａｐｈｙ
ｂａｓｅｄｍｅｔｈｏｄｓ，ｄｉｓｔｒｉｂｕｔｅｄ犓ａｎｏｎｙｍｉｔｙｃａｎｐｒｏｖｉｄｅｐｒｅｃｉｓｅ
ｑｕｅｒｙｒｅｓｕｌｔｓｗｉｔｈｏｕｔａｎｙｒｅｑｕｉｒｅｍｅｎｔｆｏｒａｔｈｉｒｄｐａｒｔｙｏｒ
ｃｏｍｐｌｉｃａｔｅｄｃｒｙｐｔｏｇｒａｐｈｉｃｔｅｃｈｎｏｌｏｇｉｅｓ．
Ｕｎｆｏｒｔｕｎａｔｅｌｙ，ｔｈｅｅｘｉｓｔｉｎｇｄｉｓｔｒｉｂｕｔｅｄ犓ａｎｏｎｙｍｉｔｙ
ｌｏｃａｔｉｏｎｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎｓｃｈｅｍｅｓｄｏｎｏｔｃｏｎｓｉｄｅｒｌｏｃａｔｉｏｎ
ｌｅａｋｉｎｇｏｒｃｈｅａｔｉｎｇｂｅｈａｖｉｏｒｓｄｕｒｉｎｇｔｈｅｃｏｎｓｔｒｕｃｔｉｏｎｏｆ
ａｎｏｎｙｍｏｕｓｃｌｏａｋｉｎｇｒｅｇｉｏｎ．Ｔｈｉｓｃａｎｌｅａｄｔｏ，ｆｏｒｅｘａｍｐｌｅ，ａ
ｓｅｌｆｉｓｈｒｅｑｕｅｓｔｕｓｅｒｔｈａｔｄｉｓｃｌｏｓｅｓｔｈｅｃｏｏｐｅｒａｔｉｖｅｕｓｅｒｓ’ｌｏｃａ
ｔｉｏｎｓｔｏｇａｉｎｉｌｌｅｇａｌｂｅｎｅｆｉｔｓ．Ａｌｔｅｒｎａｔｉｖｅｌｙ，ａｓｅｌｆｉｓｈｃｏｏｐｅｒａ
ｔｉｖｅｕｓｅｒｃｏｕｌｄｐｒｏｖｉｄｅａｆａｋｅｌｏｃａｔｉｏｎ，ｉｎｗｈｉｃｈｃａｓｅｔｈｅｃｏｎ
ｓｔｒｕｃｔｅｄａｎｏｎｙｍｏｕｓｃｌｏａｋｉｎｇｒｅｇｉｏｎｃａｎｎｏｔｅｎｓｕｒｅｔｈｅｐｒｉｖａｃｙ
ｐｒｏｔｅｃｔｉｏｎｒｅｑｕｉｒｅｍｅｎｔｏｆｔｈｅｒｅｑｕｅｓｔｕｓｅｒａｎｄ，ｍｏｒｅｓｅｒｉｏｕｓｌｙ，
ＬＳＰｃｏｕｌｄｂｅｕｓｅｄｔｏｉｄｅｎｔｉｆｙｔｈｅｒｅｑｕｅｓｔｕｓｅｒ’ｓｌｏｃａｔｉｏｎ．
Ｔｏａｄｄｒｅｓｓｔｈｉｓｐｒｏｂｌｅｍ，ｔｈｉｓｐａｐｅｒｐｒｏｐｏｓｅｓａｎｏｖｅｌ
ｄｉｓｔｒｉｂｕｔｅｄ犓ａｎｏｎｙｍｉｔｙｌｏｃａｔｉｏｎｐｒｉｖａｃｙｐｒｏｔｅｃｔｉｏｎｓｃｈｅｍｅ
ｂａｓｅｄｏｎｂｌｏｃｋｃｈａｉｎ．Ｉｎｔｈｅｐｒｏｐｏｓｅｄｓｃｈｅｍｅ，ｗｅｕｔｉｌｉｚｅ
ｂｌｏｃｋｃｈａｉｎｔｏｒｅｃｏｒｄｔｈｅｕｓｅｒｓｉｎｖｏｌｖｅｄｉｎｔｈｅｃｏｎｓｔｒｕｃｔｉｏｎｏｆ
ｔｈｅａｎｏｎｙｍｏｕｓｃｌｏａｋｉｎｇｒｅｇｉｏｎａｎｄｔｈｅｐｒｏｖｉｄｅｄｌｏｃａｔｉｏｎｓａｓ
ｅｖｉｄｅｎｃｅｓ．Ｉｆｌｏｃａｔｉｏｎｌｅａｋｉｎｇｏｒｃｈｅａｔｉｎｇｂｅｈａｖｉｏｒｓｏｃｃｕｒ，
ｔｈｅｃｏｒｒｅｓｐｏｎｄｉｎｇｕｓｅｒｓｃａｎｎｏｔｓｕｃｃｅｓｓｆｕｌｌｙｃｏｎｓｔｒｕｃｔｔｈｅ
ａｎｏｎｙｍｏｕｓｃｌｏａｋｉｎｇｒｅｇｉｏｎｗｈｅｎｔｈｅｙｉｎｉｔｉａｔｅｑｕｅｒｉｅｓ．Ｔｈｉｓ
ｐｕｎｉｓｈｍｅｎｔｔｅｃｈｎｉｑｕｅｅｎｓｕｒｅｓｔｈａｔｎｏｕｓｅｒｓｃａｎｄｅｖｉａｔｅｆｒｏｍ
ｔｈｅｐｒｅｓｃｒｉｂｅｄｓｃｈｅｍｅ．Ｔｈｅｐｒｅｓｅｎｔｅｄｓｅｃｕｒｉｔｙａｎａｌｙｓｉｓ
ｄｅｍｏｎｓｔｒａｔｅｓｔｈａｔｔｈｅｐｒｏｐｏｓｅｄｓｃｈｅｍｅｎｏｔｏｎｌｙｐｒｅｖｅｎｔｓｔｈｅ
ｒｅｑｕｅｓｔｕｓｅｒｆｒｏｍｄｉｓｃｌｏｓｉｎｇｔｈｅｌｏｃａｔｉｏｎｓｂｕｔａｌｓｏｉｎｃｅｎｔｉｖｉｚｅｓ
ｔｈｅｃｏｏｐｅｒａｔｉｖｅｕｓｅｒｓｔｏｐｒｏｖｉｄｅｔｈｅｉｒｒｅａｌｌｏｃａｔｉｏｎｓ，ｔｈｅｒｅｂｙ
ｐｒｏｔｅｃｔｉｎｇｔｈｅｐｒｉｖａｃｙｏｆｔｈｅｕｓｅｒｓ’ｌｏｃａｔｉｏｎｓｅｆｆｅｃｔｉｖｅｌｙ．
Ｅｘｔｅｎｓｉｖｅｅｘｐｅｒｉｍｅｎｔｓｉｎｄｉｃａｔｅｔｈａｔｔｈｅｐｒｏｐｏｓｅｄｍｅｔｈｏｄｃａｎ
ｃｏｎｓｔｒｕｃｔｔｈｅａｎｏｎｙｍｏｕｓｃｌｏａｋｉｎｇｒｅｇｉｏｎｅｆｆｉｃｉｅｎｔｌｙ．
ＴｈｉｓｗｏｒｋｗａｓｓｐｏｎｓｏｒｅｄｉｎｐａｒｔｙｂｙｔｈｅＮａｔｉｏｎａｌＮａｔｕｒａｌ
ＳｃｉｅｎｃｅＦｏｕｎｄａｔｉｏｎｏｆＣｈｉｎａ（Ｎｏｓ．Ｕ１７０８２６２，Ｕ１７３６２０３，
ａｎｄＵ１４０５２５５）；ｔｈｅＮａｔｉｏｎａｌＫｅｙＲｅｓｅａｒｃｈａｎｄＤｅｖｅｌｏｐｍｅｎｔ
ＰｒｏｇｒａｍｏｆＣｈｉｎａ（Ｎｏ．２０１７ＹＦＢ０８０１８０５）；ｔｈｅｔａｌｅｎｔｉｎｔｒｏ
ｄｕｃｔｉｏｎｐｒｏｇｒａｍｏｆＧｕｉｚｈｏｕＵｎｉｖｅｒｓｉｔｙｏｆＦｉｎａｎｃｅａｎｄ
Ｅｃｏｎｏｍｉｃｓ（Ｎｏ．２０１８ＹＪ１６）．
０６９ 计　　算　　机　　学　　报 ２０１９年
《
 计
 算
 机
 学
 报
 》