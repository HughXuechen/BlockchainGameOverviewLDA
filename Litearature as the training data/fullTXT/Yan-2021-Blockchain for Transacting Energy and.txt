Blockchain for Transacting Energy and Carbon Allowance in Networked Microgrids
4702 IEEE TRANSACTIONS ON SMART GRID, VOL. 12, NO. 6, NOVEMBER 2021
Blockchain for Transacting Energy and Carbon
Allowance in Networked Microgrids
Mingyu Yan, Graduate Student Member, IEEE, Mohammad Shahidehpour , Life Fellow, IEEE,
Ahmed Alabdulwahab , Senior Member, IEEE, Abdullah Abusorrah , Senior Member, IEEE,
Niroj Gurung , Member, IEEE, Honghao Zheng, Member, IEEE, Oladipupo Ogunnubi, Member, IEEE,
Aleksandar Vukojevic, Member, IEEE, and Esa Aleksi Paaso, Senior Member, IEEE
Abstract—This paper proposes a blockchain application
for transacting energy and carbon allowance in networked
microgrids (MGs). MGs submit trading energy and carbon
allowance data to the centralized distribution system opera-
tor (DSO) operation, which would optimize the provision of
energy and carbon allowance trading among MGs for satisfy-
ing power distribution network constraints. The hourly demand
response along with onsite MG generation and the DSO’s trad-
ing exchanges with ISO are considered among market options
to maximize MG payoffs and satisfy distribution network con-
straints. A cooperative game with externalities is applied to
model the market behavior of networked MGs. A two-stage pay-
off allocation problem is devised to allocate the grand coalition
payoff to participating MGs. A solution algorithm is proposed
which consists of column-and-constraint generation (C&CG) and
Karush-Kuhn-Tucker (KKT) conditions to solve the proposed
two-stage market optimization problem with acceptable computa-
tional performance. Also, blockchain is applied to provide secure
and effective transaction settlements and transparent distribution
market operations in the proposed transactive energy and carbon
allowance trading strategy. The proposed centralized transactive
market is tested on a 4-MG system, the IEEE 33-bus system, and
the IEEE 123-bus system. The numerical results show the effec-
tiveness of the proposed method in incentivizing MGs to trade
energy and carbon allowance while satisfying the distribution
network constraints.
Manuscript received January 25, 2021; revised June 23, 2021; accepted
August 13, 2021. Date of publication August 31, 2021; date of current version
October 21, 2021. This work was supported by the Deanship of Scientific
Research (DSR), King Abdulaziz University, Jeddah, Saudi Arabia, under
Grant RG-10-135-41. Paper no. TSG-00117-2021. (Corresponding author:
Mohammad Shahidehpour.)
Mingyu Yan is with the ECE Department, Illinois Institute of Technology,
Chicago, IL 60616 USA (e-mail: myan9@iit.edu).
Mohammad Shahidehpour is with the ECE Department, Illinois Institute of
Technology, Chicago, IL 60616 USA, and also with the Center of Research
Excellence in Renewable Energy and Power Systems, King Abdulaziz
University, Jeddah 21589, Saudi Arabia (e-mail: ms@iit.edu).
Ahmed Alabdulwahab and Abdullah Abusorrah are with the Department
of Electrical and Computer Engineering, Faculty of Engineering and
Center of Research Excellence in Renewable Energy and Power Systems,
King Abdulaziz University, Jeddah 21589, Saudi Arabia (e-mail: aabdul-
whab@kau.edu.sa; aabusorrah@kau.edu.sa).
Niroj Gurung, Honghao Zheng, Oladipupo Ogunnubi,
Aleksandar Vukojevic, and Esa Aleksi Paaso are with ComEd,
Chicago, IL 60181 USA (e-mail: niroj.gurung@comed.com;
honghao.zheng@comed.com; oladipupo.ogunnubi@comed.com;
aleksandar.vukojevic@comed.com; esa.paaso@comed.com).
Color versions of one or more figures in this article are available at
https://doi.org/10.1109/TSG.2021.3109103.
Digital Object Identifier 10.1109/TSG.2021.3109103
Index Terms—Transacting energy and carbon market, net-
worked microgrids, blockchain, cooperative game with external-
ities, two-stage payoff allocation problem.
NOMENCLATURE
Indices and Sets
i, ij, t Indices for MGs, power distribution lines
connecting MGs i to j, and dispatch periods.
m, w Indices for MTs and DERs.
� M,� MC Set of MTs without/with carbon capture.
N Set of MGs in cooperative games.
ST Set of substation buses.
Parameters
Vmin
i , Vmax
i Min/Max voltage magnitude for MG i.
Fmax
ij Capacity of line ij.
PDmin
i,t , PDmax
i,t Min/Max load for MG i at hour t.
gij, bij Conductance and susceptance of line ij.
PWmax
i,w,t DER w power forecast in MG i at hour t.
PGmax
i,m Capacity of MT m in MG i.
λi,t, βi,t MG i revenue parameters at hour t.
ai,m, bi,m, ci,m MT n cost parameters in MG i.
Cmax
i CO2 emission allowance for MG i.
π s
t , β
s
t Selling prices for energy and carbon
allowance to DSO/wholesale market at
hour t.
πb
t , βb
t Purchase prices for energy and carbon
allowance from DSO/wholesale market at
hour t.
Variables
PGi,m,t Power output of MT m in MG i at hour t.
PWi,w,t DER w power in MG i at hour t.
PGN
i,m,t MT m net power output with carbon capture
device in MG i at hour t.
PCi,m,t Power consumed by carbon capture device
in MT m of MG i at hour t.
PBi,t, CBi,t Power and carbon allowance purchase for
MG i at hour t.
PSi,t, CSi,t Power and carbon allowance sale for MG i
at hour t.
U(N) Payoff of grand coalition.
1949-3053 c© 2021 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See https://www.ieee.org/publications/rights/index.html for more information.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:07:54 UTC from IEEE Xplore.  Restrictions apply. 
https://orcid.org/0000-0002-8994-1688
https://orcid.org/0000-0003-4223-7930
https://orcid.org/0000-0001-8025-0453
https://orcid.org/0000-0002-0765-2365
YAN et al.: BLOCKCHAIN FOR TRANSACTING ENERGY AND CARBON ALLOWANCE IN NETWORKED MGs 4703
U(S, ρ) Payoff of coalition S.
PLij,t, QLij,t Active/reactive flow on line ij at hour t.
θi,t Voltage angle on MG i at hour t.
PDi,t, QDi,t Active and reactive load of MG i at hour t.
CEi,m,t CO2 emission of MT m in MG i at hour t.
CCi,m,t Carbon captured in MT m of MG i at hour t.
Vi,t Voltage magnitude on bus i at hour t.
ki 1 if MG i is in coalition S, 0 otherwise.
PBST
i,t , PSST
i,t Substation power import/export at hour t.
Pi,t, Qi,t Active/reactive net load of MG i at hour t.
I. INTRODUCTION
IN POWER systems, power demands are often supplied
by large and centralized fossil generators, which could
result in excessive carbon emission and enormous air pollu-
tion. The excessive CO2 emission could cause global warming
and more intense natural disasters (hurricane, draught, flood,
fire). The installation of renewable-based microgrid (MG)
is one of the promising solutions to address environmental
challenges [1]. MGs, which aggregate onsite loads and dis-
tributed energy resources (DERs), are small and autonomous
distribution power systems which can satisfy specific objec-
tives such as reliability, resilience, economics, security,
and sustainability [2]. Geographically-close MGs can also
be networked to broaden the MG merits. The transactive
energy market in power distribution networks is regarded
as a silver bullet that can utilize large DER penetrations
by incentivizing networked MGs to flexibly trade energy,
and thus achieve a low carbon sustainable development
locally [3].
Meanwhile, carbon market is another effective method to
control the vented CO2 by charging those who resort to carbon
emission. One of the most popular carbon markets is a carbon
cap-and-trade market, in which each market participant uses
its carbon allowance. Here, MG participants in a carbon cap-
and-trade market, which opts to vent additional CO2, would
purchase carbon allowance from the market to satisfy their
power generation obligations.
Carbon trading markets can incentivize MG participants to
curb their vented CO2 and trade their allowance, thus attain
a sustainable human society. Two issues should be discussed
before establishing a successful transactive energy and car-
bon market: (1) how would the market decide on trading
prices and quantities among MGs while satisfying power dis-
tribution network constraints and incentivizing MGs to make
transactions? This issue is especially important in a com-
bined transactive energy and carbon market since MGs can
trade both energy and carbon allowance simultaneously. If
the energy price is high, MGs could purchase the carbon
allowance for generating onsite energy. If the carbon allowance
price is high, MGs could purchase energy instead of carbon
allowance. (2) how would the market be processed and trad-
ing contracts be settled in an effective, secure, and transparent
manner? In the transactive market, there could be several
active participants. The existing settlement system could take
a long time to process all contracts. Additionally, the existing
trading settlement system lacks transparency since the central
system operator is the sole entity which can effectively view
the trading process and final contracts. Such non-transparency
in electricity market could effectively increase electricity
prices [4].
There are several studies for the transactive energy mar-
ket that focus on the first issue. Reference [5]–[6] studied the
transactive energy market using the centralized optimization
method, in which the distribution system operator (DSO) col-
lects the data on all MGs and clears the market based on
distribution locational marginal prices. References [7]–[8] pro-
vided the decentralized optimization of the transactive energy
market which can protect the privacy of individual MGs.
Game methods have been widely utilized in the transactive
energy market to capture market participants’ specifications.
References [9] applied a noncooperative game to a transactive
energy market to highlight competitive MG behaviors. A two-
level transactive energy market is provided in [10] in which
MGs trade energy at the lower level using a non-cooperative
Stackelberg game, while the DSO at the upper level instructs
MGs to adjust their energy trading as necessary for adminis-
tering a secure distribution network operation. However, the
market optimization method and noncooperative game can-
not be applied if some participating MGs possess market
power [11]. In addition, the above method could obtain subop-
timal MG trading results, which could further encourage some
participants to seek alternative market trading results which are
economically preferable [11].
Several references have applied cooperative gaming to the
transactive energy market. Cooperative gaming can incen-
tivize market participants to form a coalition and allo-
cate the coalition payoff fairly to individual participants.
References [12]–[13] proposed a cooperative grand coali-
tional game for community MGs. Reference [14] provided
a cooperative coalition formation method, in which MGs
can flexibly choose their cooperating partners. However,
power network constraints are not considered in the above
cooperative games applied to a transactive energy market,
which could result in infeasible energy trading among MGs.
In practice, MGs’ transactive trading decisions (e.g., DER
energy outputs) are linked via distribution network constraints.
However, classical cooperative game methods used in ref-
erences did not consider such interdependencies. Some of
the references focus on the coordination between whole-
sale and transactive energy markets. Reference [15] studied
the framework for the coordinated wholesale and transactive
energy markets. References [16]–[17] provided the hierarchi-
cal operation of wholesale and transactive energy market.
References [18]–[19] demonstrated that the inclusion of trans-
active energy in the wholesale market could regulate wholesale
market prices.
Other studies focus on the wholesale energy and car-
bon market. Reference [20] analyzed the equilibrium in the
energy and carbon market. Reference [21] provided a unit
commitment model considering the carbon allowance trad-
ing. Reference [22] provided a low-carbon dispatch solution
considering carbon capture devices. Reference [23] provided
a low-carbon operation for multi-energy systems with inte-
grated energy-carbon prices.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:07:54 UTC from IEEE Xplore.  Restrictions apply. 
4704 IEEE TRANSACTIONS ON SMART GRID, VOL. 12, NO. 6, NOVEMBER 2021
For the second issue (i.e., secure settlement of trading
contracts), blockchain applications can provide a promising
solution. Blockchain is an immutable and distributed ledger
which stores transaction data and the updated blockchain
is broadcasted synchronously to all participants to maintain
the same blockchain records. All blockchain network partic-
ipants collaborate to audit and maintain the consistency of
the data stored in the blockchain [24]. Therefore, blockchain
maintains the integrity of stored data in a secure and fast man-
ner and provides a trustworthy environment for participants’
interactions without a third party overseeing the process. The
stored blockchain data are traceable, secure, verifiable and
tamper-proof. Additionally, smart contracts in a blockchain
can automatically execute transactions, thus increasing the effi-
ciency and the reliability of a transactive energy and carbon
market. Some other references studied the use of blockchain
in a transactive energy market. References [25]–[27] proposed
the framework for blockchain in a transactive energy mar-
ket. However, the detailed market mechanism is not provided.
Reference [28] used blockchain for an automated trading
settlement in an auction-based transactive energy market.
Reference [29] compared the performances of a blockchain-
based transactive energy market for using several differ-
ent blockchain software packages. Reference [30] utilized
blockchain for energy trading among electric vehicles. Overall,
the introduction of blockchain in a transactive energy and car-
bon market can increase efficiency, reduce operational costs,
lower the trading barriers, and devise an automatic trading
process.
Several other studies have considered the blockchain in
a transactive energy and carbon market. Reference [32] pro-
vided the blockchain-based transactive energy and carbon mar-
ket solutions for distributed photovoltaic (PV). However, the
detailed market mechanism is not discussed. Reference [33]
proposed an auction-based transactive energy and carbon mar-
ket for prosumers located inside a MG. The blockchain is
applied to help prosumers trade and securely settle contracts.
However, the distribution network constraints were not con-
sidered. Additionally, the auction-based method could obtain
suboptimal MG trading results.
The following issues will be further discussed while apply-
ing the cooperative game to the combined energy and carbon
allowance trading for networked MGs: 1) The distribution
power network constraints will be considered in the transactive
energy and carbon market to ensure the feasibility of trading
results. 2) A scalable payoff allocation method will be con-
sidered for applying the cooperative game to the transactive
energy and carbon market. The computational complexity of
the existing payoff allocation method used in the coopera-
tive game grows exponentially as the number of participants
increases. 3) Different market mechanisms require specific
blockchain-based transaction settlement methods, which lack
an efficient blockchain-based settlement method for the coop-
erative game in transactive market. The differences between
those in the proposed method and the existing studies are
shown in Table I.
This paper proposes a blockchain-based transactive energy
and carbon market for networked MGs by using the
TABLE I
COMPARATIVE FEATURES OF PREVIOUS TRANSACTIVE ENERGY
MARKET STUDIES
cooperative game with externalities. The MGs can trade both
energy and carbon allowance through the centralized DSO
market. The contributions of this paper are summarized as
follows:
1) A transactive energy and carbon market, administered by
the DSO, is proposed for networked MGs, in which MGs
cooperate in a grand coalition to transact energy and
carbon allowance. The proposed cooperative MG game
with externalities will model cooperative MG behaviors
considering the power distribution network. The demand
response is considered for maximizing MG payoffs and
satisfying DSO’s network constraints.
2) A two-stage payoff allocation problem is developed to
allocate the grand coalition payoff to MGs. An algo-
rithm consisting of column-and-constraint generation
(C&CG) and Karush-Kuhn-Tucker (KKT) conditions is
proposed to solve this two-stage problem with superior
computation performance.
3) The blockchain is applied to devise a decentralized,
secure, and effective transaction settlement method in
a transparent MG market operation for energy and
carbon trading which uses a cooperative game with
distribution network constraints.
The rest of this paper is structured as follows: Section II
introduces the cooperative game with externalities and the
blockchain-based transactive energy and carbon market.
Section III develops the mathematical formulation for the mar-
ket and the two-stage payoff allocation problem. Section IV
introduces the solution techniques consisting of C &CG and
KKT conditions. Case studies are conducted in Section V to
show the effectiveness of the proposed market. Section VI
draws the conclusion and further work.
II. TRANSACTIVE ENERGY AND CARBON MARKET
A. Cooperative Game With Externalities
Consider a set of players in the game given by N =
{1, 2, . . . , n}. Each subset of players N can formulate a coali-
tion S. If all players cooperate, they will form a grand coalition
N. In the cooperative game, players will first cooperate to
maximize the coalition payoff (i.e., the sum of all players’ pay-
offs in the coalition) rather than their individual payoffs. Then,
the coalition payoff will be allocated fairly to each player.
In practice, players’ actions and payoffs are interdependent.
In other words, the payoff of coalition S is not only decided by
the actions of members in coalition S, but also by the actions
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:07:54 UTC from IEEE Xplore.  Restrictions apply. 
YAN et al.: BLOCKCHAIN FOR TRANSACTING ENERGY AND CARBON ALLOWANCE IN NETWORKED MGs 4705
Fig. 1. Centralized market structure for transacting energy and carbon.
of members outside the coalition S. Such interdependencies
are known as the externalities in a cooperative game [36]. In
a cooperative game with externalities, the payoff of coalition S
is defined as U(S, ρ) [37], where ρ is a subset of N with S ∈ p
to represent the actions of members outside the coalition. The
payoff U(S, ρ) is obtained by solving the following problem:
max U(S, ρ)
s.t. G(S, ρ) ≤ 0 (1)
where G(S, ρ) represents the constraints in the cooperative
game with externalities. The problem (1) is labeled as J(S, ρ).
B. Transactive Energy and Carbon Market
In the transactive energy and carbon market, players
are MGs. Here a carbon cap-and-trade market is consid-
ered in which each MG uses its carbon allowance to vent
a limited amount of CO2. MGs can trade energy and car-
bon allowance with their peers and the DSO. Considering
network constraints, each MG’s actions (e.g., DER power out-
put) will influence other MGs’ actions, thus MGs’ payoffs
are interdependent. Such interdependencies are modeled by
a cooperative game with externalities. Here we consider that
all MGs cooperate to form a grand coalition for transacting
energy and carbon allowance.
Fig. 1 shows the proposed transactive energy and carbon
market. The DSO collects each MG’s energy and carbon
trading data and determines the optimal trading schedule to
maximize the grand coalition payoff which is subject to pre-
vailing distribution network operation constraints. The DSO
allocates the grand coalition payoff fairly to participating MGs.
C. Blockchain for Transactive Energy and Carbon Market
In a centralized market, the DSO settles the trading options
by collecting payments from purchasing MGs to pay off the
selling MGs. However, such centralized trading markets have
certain drawbacks including a single point of failure and pri-
vacy concerns. Blockchain is thus applied to achieve a decen-
tralized, effective, and secure trading settlement. Here we
simply introduce how blockchain works and how blockchain
is applied for settlements in a transactive energy and carbon
market.
Blockchain is a shared and distributed ledger for record-
ing transaction data. Fig. 2 shows a simple example for
making transactions in blockchain: 1) Participants send trans-
actions for trading to other participants, which are stored as
data blocks. 2) Data blocks are broadcasted to all participants
who audit and validate them collaboratively. 3) Data blocks are
stored in the blockchain upon confirmation and transactions
are executed subsequently. The stored transaction data are
Fig. 2. Blockchain process for making transactions.
Fig. 3. Blockchain for transactive energy market.
accessible for transparency by all blockchain participants.
Accordingly, blockchain network participants audit and main-
tain the data stored in the blockchain rather than relying on
a third party. The contracts recorded in blockchain cannot
be tampered with, which provides a decentralized and secure
contract settlement function without a third-party intervention.
Overall, the proposed participants in our blockchain network
are the DSO and MGs. MGs are market participants which
trade energy and carbon allowance with their peers through
the DSO. Smart meters located in MGs record trading/dispatch
transactions and store them in the blockchain. The DSO
administers the trading using a communication network avail-
able to MGs. Both MGs and the DSO participate in the
blockchain validation and consensus processes. Accordingly,
the DSO and MGs exchange transactions, create data blocks,
and store them in the blockchain. Figure 3 shows the use of
smart contracts in transactive market operation.
The detailed steps are listed as follow:
1) Initialization. Before MGs use blockchain to make trans-
actions, each MG will be assigned a pair of public and private
keys. The public key is a unique identifier that makes each
participant addressable in the blockchain network. The private
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:07:54 UTC from IEEE Xplore.  Restrictions apply. 
4706 IEEE TRANSACTIONS ON SMART GRID, VOL. 12, NO. 6, NOVEMBER 2021
key is served as the digital signature. MGs will use public and
private keys for interactions in the blockchain network [25].
2) Trading data submission. MGs participate in energy and
carbon allowance trading by submitting their trading data to
the DSO. A smart contract is an agreement among participants,
which will be self-executed if preset conditions are satisfied.
Smart contracts will facilitate the submission of trading data.
The market-clearing smart contracts in Fig. 3 provide a public
interface for all MGs to submit their trading data. These smart
contracts have a preset schedule for data submission in which
they will collect and deliver the trading data to the DSO.
3) Market clearing. The DSO will clear the market once
the trading data are provided by all MGs, i.e., it calculates the
optimal dispatch and payoff allocations among MGs, which
satisfy distribution network constraints. The market-clearing
process is an online process since the DSO collects trading
data and makes decisions online. The detailed payoff alloca-
tion using a mathematical optimization method is provided in
Section III. Once the market is cleared, the market-clearing
smart contracts will correspondingly broadcast the clearing
results to all MGs.
4) Transaction settlement. Here, a transaction settlement
smart contract is used, which queries smart meters to get
the real-time data (i.e., energy and carbon allowance gener-
ation/consumption) and compare them with market clearing
results facilitated by market-clearing smart contracts. If MGs
have fulfilled their market commitment and constraints, the
transaction settlement smart contracts will settle the payments
automatically. Otherwise, the transaction settlement smart con-
tracts will penalize MGs by charging them an extra fee
according to a preset penalty mechanism [34]–[35]. After
smart contracts are executed, the MGs’ accounts will be
balanced and updated.
Overall, there are two types of smart contracts in the
proposed market. One is used for market-clearing and the other
is used for transaction settlement. The two types of smart
contracts interact with each other as transaction settlement
smart contracts query market-clearing results from market-
clearing smart contracts. Additionally, all data (e.g., trading
data, market-clearing results, and payments) are validated by
all participants and stored in the blockchain. Here we use
the proof-of-work consensus algorithm for all participants to
collaboratively validate the respective data [24]. The market-
clearing results stored in the blockchain cannot be tampered
with as they will be executed according to a set of prevailing
agreements. In addition, transaction settlements are reviewed
and completed by all MGs rather than the DSO alone, which
improves the transparency of the transactive market operation.
III. FORMULATION OF THE PROPOSED
TRANSACTIVE MARKET
The transactive market based on the cooperative MG game
with externalities includes two steps. First, the DSO deter-
mines the constrained optimal schedule of each MG for
maximizing the grand coalition payoff. Second, the DSO
allocates the total coalition payoff to each participant based
on the optimal schedule.
A. Mathematical Formulation of the Grand Coalition
In the proposed market, DSO acts as the mediator for MGs
to trade energy and carbon allowance. On the one hand, DSO
collects energy and carbon allowance from all MGs. On the
other hand, the DSO considers trading energy and carbon
allowance with the wholesale market (i.e., ISO’s transmis-
sion market) to balance individual MG’s onsite energy and
carbon demand. Since all MGs act in a grand coalition, the
objective of DSO is to maximize the grand coalition pay-
off (i.e., sum of all MGs’ payoffs) considering the trading
with the DSO/wholesale market by adjusting onsite genera-
tions through energy and carbon allowance market, and MGs’
loads through demand response.
We consider that each MG is equipped with an aggregated
adjustable load and several microturbines (MTs) and renewable
DERs. The total grand coalition payoff is calculated as the
revenue minus cost. The energy trading revenues include those
of selling energy to the DSO/wholesale market and onsite loads,
while the costs include those of purchasing energy from the
DSO/wholesale market and generating by onsite MTs. Similarly,
the carbon trading payoff is calculated as the revenue for
selling carbon allowance minus the cost for purchasing carbon
allowance. The formulation is stated in (2)-(20).
Constraint (3) represents the MG’s revenue by consum-
ing power. Constraint (4) represents the generation cost of
MT. Constraints (5)-(6) represent the power balance and
carbon balance for MGs, respectively. Constraints (7)-(8) rep-
resent the CO2 emission for MTs with and without carbon
capture devices, respectively. Constraints (9)-(10) represent
the net power output of MTs with carbon capture devices,
in which the carbon capture devices consume the power gen-
erated by the MTs to capture CO2. The other constraints
for carbon capture devices are found in [22]. Constraint (11)
represents the net active power load and net power genera-
tion for each MG. Constraints (12)-(13) represent active and
reactive power injections into buses. The DSO exchanges
power with the transmission grid through substation buses.
Constraint (14) is for the power exchange at the substation
bus. Constraints (15)-(16) restrict line power flows using a lin-
earized AC optimal power flow model [38]. Constraint (17) is
for bus voltage magnitudes. Constraint (18) limits the MG load
by applying the demand response and any load curtailment as
required. The MG load PDi,t is adjustable and the optimal
load is calculated after the proposed optimization problem is
solved. Constraint (19) limits for the MT generation capacity
in an MG. Constraint (20) limits for the DER power output in
an MG. The solution of this problem provides the optimal MG
schedule (i.e., optimal load and DERs’ outputs). The traded
quantities for each MG with DSO can be decided accordingly.
For instance, the energy sale to DSO of a MG is calculated
as: the energy generated by DERs minus the load.
max
∑
t
∑
i
(
π s
t PSi,t + Ri,t
(
PDi,t
) − πb
t PBi,t −
∑
n
C
(
PGi,n,t
)
)
︸ ︷︷ ︸
Energy
+
∑
t
(
βs
t CSt − βb
t CBt
)
︸ ︷︷ ︸
Carbon
(2)
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:07:54 UTC from IEEE Xplore.  Restrictions apply. 
YAN et al.: BLOCKCHAIN FOR TRANSACTING ENERGY AND CARBON ALLOWANCE IN NETWORKED MGs 4707
Ri,t
(
PDi,t
) = λi,tPDi,t − βi,t
(
PDi,t
)2 (3)
C
(
PGi,m,t
) = ai,m
(
PGi,m,t
)2 + bi,mPGi,m,t + ci,m (4)
∑
i
(
PDi,t + PSi,t
) =
∑
i
(
∑
m
PGi,m,t +
∑
w
PWi,w,t + PBi,t
)
∀t
(5)
∑
i
(
Cmax
i + CSi
) =
∑
i
(
∑
t
∑
m
CEi,m,t + CBi
)
(6)
CEi,m,t = βi,mPGi,m,t ∀m ∈ � M,∀i, ∀t (7)
CEi,m,t = βi,mPGi,m,t − CCi,m,t ∀m ∈ � MC,∀i, ∀t (8)
CCi,m,t = ωPCi,m,t ∀m ∈ � MC, ∀i, ∀t (9)
PGN
i,m,t = PGi,m,t − PCi,m,t ∀m ∈ � MC, ∀i, ∀t (10)
Pi,t = PSi,t − PBi,t ∀i, ∀t (11)
Pi,t =
∑
j
PLji,t −
∑
i
PLij,t ∀i, ∀t
Qi,t =
∑
j
QLji,t −
∑
i
QLij,t ∀i, ∀t (12)
Pi,t + PBST
i,t − PSST
i,t =
∑
j
PLji,t −
∑
i
PLij,t ∀i ∈ ST, ∀t
Qi,t + QBST
i,t =
∑
j
QLji,t −
∑
i
QLij,t ∀i ∈ ST, ∀t (13)
∑
i∈ST
PBST
i,t ≥
∑
i
PBi,t ∀t
∑
i∈ST
PSST
i,t ≤
∑
i
PSi,t ∀t (14)
PLij,t = gij
(
Vi,t − Vj,t
) − bij
(
θi,t − θj,t
) ∀ij, ∀t
QLij,t = −gij
(
θi,t − θj,t
) + bij
(
Vi,t − Vj,t
) ∀ij, ∀t (15)
(
PLij,t
)2 + (
QLij,t
)2 ≤
(
Smax
ij
)2 ∀ij, ∀t (16)
Vmin ≤ Vi,t ≤ Vmax ∀i, ∀t (17)
PDmin
i,t ≤ PDi,t ≤ PDmax
i,t ∀i, ∀t (18)
0 ≤ PGi,m,t ≤ PGmax
i,m ∀i, ∀m, ∀t (19)
0 ≤ PWi,w,t ≤ PWmax
i,w,t ∀i, ∀w,∀t (20)
B. Stability of Grand Coalition
In this section, we prove the stability of the grand coalition,
i.e., MGs would prefer to cooperate rather than acting individ-
ually. We first provide several definitions and lemmas in the
cooperative game with externalities.
Definition 1 (Imputation): The vector x is considered as the
payoff allocation representing the payment to each MG. An
imputation is defined as a payoff allocation if the following
conditions are satisfied:
1) Efficiency: The payoff allocation x is efficient if
∑
i xi =
U(N), indicating that the grand coalition payoff is allocated
to all MGs.
2) Individual Rationality: The payoff allocation x is rational
if xi ≥ U({i}, ρ) ∀i, indicating that MGs will gain higher
payoffs if they join the grand coalition.
Definition 2 (γ -Core): γ -core is a set of imputations which
satisfy the following condition:
RD:
{
x|
∑
i
xi = U(N),
∑
i∈S
xi ≥ U(S, ρ) ∀S
}
(21)
Equation (21) indicates that the imputations in γ -core make
sure that MGs can receive higher payoffs by participating
in the grand coalition. All MGs will accept the imputations
in γ -core rather than abandoning the imputations. In γ -core,
members that do not want to cooperate will act individually.
Accordingly, non-cooperating MGs shall only trade energy and
carbon allowance with the DSO rather than their counterparts.
Definition 3 (Superadditivity): The cooperative game with
externalities is superadditive if the following conditions are
satisfied for any S, G ⊆ N and any ρ of N − S ∪ G:
U(S ∪ G, {S ∪ G} ∪ ρ) ≥
U(S, {S, G} ∪ ρ) + U(G, {S, G} ∪ ρ) (22)
Definition 4 (Positive Homogeneity): The cooperative game
with externalities is positive homogeneous if the following
condition is satisfied for any S, G ⊆ N and ρ of N − S ∪ G:
J(βS, βρ) = βJ(S, ρ) (23)
where β is a constant.
Definition 5 (Balanced Game): A map ω is a balanced map
if
∑
S ωS = 1. The cooperative game with externalities is
a balanced game if the following condition is satisfied for
any balanced map:
∑
S
ωSU(S, ρ) ≤ U(N) (24)
Balanced map is a definition used in cooperative game [37].
Any map ω which satisfies
∑
S ωS = 1 is defined as a balanced
map in the cooperative game.
Definition 6 (Excess): The coalition dissatisfaction with
respect to the imputation x is measured by its excess defined
as ε(x, S, ρ) = U(S, ρ) − ∑
i∈S xi.
Lemma 1: The grand coalition is stable if γ -core is
nonempty [36].
Lemma 2: If a cooperative game with externalities is
a balanced game, then γ -core is nonempty [37].
Theorem 1: The proposed cooperative game with external-
ities is superadditive and positively homogenous.
Proof: See [39, Appendix A].
Theorem 2: The grand coalition in this transactive energy
and carbon market is stable.
Proof: See [39, Appendix B].
C. Two-Stage Payoff Allocation Problem
After calculating the grand coalition payoff, the DSO will
calculate each MG’s fair payoff allocation. The nucleolus
method and Shapley value are the two most popular methods
to determine the payoff allocation in a classical cooperative
game, i.e., cooperative game without externalities. However,
these methods cannot be applied in the cooperative game with
externalities. We thus propose a two-stage MG payoff alloca-
tion problem in the cooperative game with externalities, which
minimizes the worst-case excess for all potential coalitions.
The payoff allocation in the proposed problem belongs to the
γ -core. The two-stage payoff allocation problem is stated as
follow:
min
x
max
k
(
U(S, ρ) −
∑
i∈S
kixi
)
(25)
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:07:54 UTC from IEEE Xplore.  Restrictions apply. 
4708 IEEE TRANSACTIONS ON SMART GRID, VOL. 12, NO. 6, NOVEMBER 2021
∑
i
xi = U(N) (26)
U(S, ρ) −
∑
i∈S
kixi ≤ 0 (27)
1 ≤
∑
i
ki ≤ N − 1 (28)
U(S, ρ) =
∑
t
∑
i∈S
ki
(
Ui,t
(
PDi,t
) −
∑
m
C
(
PGi,m,t
) + πb
t PBi,t
−π s
t PSi,t + cb
t CBi,t − cs
t CSi,t
)
(29)
PDi,t, PGi,n,t, PBi,t, PSi,t, CBi,t, CBi,t ∈
arg
{
max
∑
t
∑
i
(
Ui,t
(
PDi,t
) −
∑
n
C
(
PGi,n,t
) + πb
t PBi,t
−π s
t PSi,t + cb
t CBi,t − cs
t CSi,t
)
;
s.t. Constraints (31)−(35)
}
(30)
∑
i∈S
(
PDi,t + PSi,t
)
=
∑
i∈S
(
∑
m
PGi,m,t +
∑
w
PWi,w,t + PBi,t
)
∀t (31)
∑
i∈S
(
Cmax
i + CSi
) =
∑
i∈S
(
∑
t
∑
m
CEi,m,t + CBi
)
(32)
PDi,t + PSi,t =
∑
m
PGi,m,t +
∑
w
PWi,w,t + PBi,t ∀i /∈ S, ∀t
(33)
Cmax
i + CSi =
∑
t
∑
m
CEi,m,t + CBi ∀i /∈ S (34)
Constraints (3)−(4), (7)−(20) (35)
Constraints (26)-(27) ensure that the payoff allocation
belongs to γ -core. Constraint (28) limits the number of
members in coalition S. Constraints (29)-(30) represents the
payoff of coalition S. Constraints (31)-(32) represents the
power and carbon balance for the members in coalition S,
while (33)-(34) represent the power and carbon balance for the
members outside collation S. Constraint (35) includes power
network constraints. This two-stage payoff allocation problem
is a nonlinear problem with quadratic constraints (3)-(4) and
conic constraint (16). The quadratic constraints can be eas-
ily linearized using the piecewise linear function [40] while
the conic constraint is linearized using the method proposed
in [41].
IV. SOLUTION TECHNIQUES
The compact form of the two-stage payoff allocation
problem is stated as follows:
min
x
max
y
(A · x + B · z)
s.t. C · x ≤ H, D · x + E · y ≤ J
z ∈ arg
{
max
z
F · z; G · y + K · z ≤ L
}
(36)
Fig. 4. Flowchart of the proposed algorithm.
where x donates the set of variables decided at the first stage,
while y and z donate the sets of binary and continuous vari-
ables decided at the second stage, respectively. C · x ≤ H
collects the first-stage constraints, while D · x + E · y ≤ J
donates the second stage constraints. Fig. 4 provides the
flowchart of the proposed solution technique. This two-stage
problem cannot be solved directly. We first utilize the C&CG
algorithm [40] to decouple the primal problem into a single-
level master problem and a two-level subproblem. The Karush-
Kuhn-Tucker condition [42] is further applied to convert the
two-level subproblem into a single level problem.
A. Master Problem
The master problem decides the payoff allocation for each
MG, which is illustrated as follows:
min
x
α
s.t. C · x ≤ H, α ≥ αmin (37)
where α is an auxiliary variable and αmin is the estimated
lower bound for α.
B. Subproblem
The subproblem finds the coalition in which the excess is
the largest with respect to the payoff allocation obtained in
the master problem. The subproblem is illustrated as follow:
max
y
(
A · x∗ + B · z
)
s.t. D · x∗ + E · y ≤ J
z ∈ arg
{
max
z
F · z; G · y + K · z ≤ L
}
(38)
The subproblem is a two-level problem which cannot be
solved by the existing commercial solvers. Therefore, the KKT
condition is applied to convert the two-level problem into a sin-
gle level problem. The subproblem is reformulated as (39) with
the introduction of KKT conditions:
max
y
(
A · x∗ + B · z
)
s.t. D · x∗ + E · y ≤ J, G · y + K · z ≤ L
K · λ = F, (G · y + K · z − L)λ = 0 (39)
where λ is the dual variable of constraint F · y + G · z ≤ L.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:07:54 UTC from IEEE Xplore.  Restrictions apply. 
YAN et al.: BLOCKCHAIN FOR TRANSACTING ENERGY AND CARBON ALLOWANCE IN NETWORKED MGs 4709
Fig. 5. 4-Microgrid system topology.
The bilinear term in (39) can be linearized using the big-
M approach. Once the subproblem is solved and the optimal
solution z∗ is calculated, the optimal payoff allocation will be
obtained and the algorithm will be terminated if criteria (40)
is satisfied. Otherwise, we add (41) to the master problem for
calculating the next iteration:
∣∣α∗ − (
A · x∗ + B · z∗)∣∣ ≤ ε (40)
D · x + E · yh,∗ ≤ J, G · yh,∗ + K · zh ≤ L
K · λh = F,
(
G · yh,∗ + K · zh − L
)
λh = 0 (41)
where h is the current iteration and ε is a small number.
C. Solution Procedure
The proposed solution steps are listed as follows:
1. Input all parameters.
2. Solve (37) to calculatex∗ and α∗.
3. Set h = 1. Solve (39) to calculatey∗ and z∗.
4. If criteria (40) is satisfied, terminate the algorithm and
list the optimal payoff allocation. Otherwise, add (41) to the
master problem (37) and repeat steps 2) to 4).
V. CASE STUDIES
The proposed transactive energy and carbon market are
tested on a 4-Microgrid system, the IEEE 33-bus test system,
and the IEEE 123-bus test system. The dispatch period is set
at 24 hours. MGs can curtail 15% of their maximum load in
demand response. The carbon allowance for each MG during
the dispatch period is set at 0.2 tons. The detailed data are
provided in [43]. The mathematical models are solved using
a MATLAB 2018a platform in Gurobi 9.1. The blockchain is
built using the Go Ethereum.
A. 4-Microgrid System
The 4-Microgrid system is shown in Fig. 5. The MG param-
eters like generator and demand response costs are provided
in [10]. MG1 acts as the slack bus. Six cases are considered
here to analyze the proposed transactive energy and carbon
market.
Case I: There is no clearing process by the DSO. MGs trade
energy and carbon allowance at the fixed price [43] with the
DSO/wholesale market. Demand response is not considered.
TABLE II
COST ALLOCATIONS IN DIFFERENT CASES
Case II: There is a transactive market only for energy.
The carbon allowance is traded at a fixed price with the
DSO/wholesale market. Demand response is not considered.
Case III: The proposed transactive energy and carbon mar-
ket for MGs is applied in which there is a clearing process for
both energy and carbon allowance. Demand response is not
considered.
Case IV: The same as Case III except the demand response
is applied.
Case V: The same as Case IV except the DSO/wholesale
price for carbon allowance is 20 % cheaper than that in
Case IV.
Case VI: The same as Case V except the DSO/wholesale
price for energy is 20% cheaper than that in Case V.
Table II presents the cost allocation in Cases I-VI. MG2
and MG4 with renewable DERs sell carbon allowance
while MG1 and MG3 with MTs buy carbon allowance. In
Case I, MGs do not transact with each other. They purchase
energy and carbon allowance at a high fixed price from the
DSO/wholesale market and sell energy and carbon allowance
to the DSO/wholesale market at a low fixed price, which
leads to the lowest total payoff for MGs. In Case II, there
is a transactive market for energy and MGs are incentivized
to trade energy through the DSO. Hence, energy and car-
bon allowance purchases from the DSO/wholesale market are
reduced. In Case III, the total MG payoff is increased as there
is a transactive market for both energy and carbon allowance.
MGs can transact low-cost carbon allowance through the
DSO to generate more onsite energy rather than trading with
the DSO/wholesale market. So, energy and carbon allowance
trades with the DSO/wholesale market is reduced.
In Case IV, the demand response is introduced and the
energy purchase from the DSO/wholesale market is reduced
and the total MG payoff is increased. In Case V, MGs pur-
chase cheap carbon allowance from the DSO/wholesale market
to generate onsite energy and the carbon purchase is thus
increased. Compared with Case V, the cheap energy purchase
is increased in Case VI, while the carbon allowance purchase
is reduced.
In Case IV, the demand response is introduced and the
energy purchase from the DSO/wholesale market is reduced
and the total MG payoff is increased. In Case V, MGs pur-
chase cheap carbon allowance from the DSO/wholesale market
to generate onsite energy and the carbon purchase is thus
increased. Compared with Case V, the cheap energy purchase
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:07:54 UTC from IEEE Xplore.  Restrictions apply. 
4710 IEEE TRANSACTIONS ON SMART GRID, VOL. 12, NO. 6, NOVEMBER 2021
TABLE III
OPTIMAL MG3 SOLUTION IN DIFFERENT CASES
Fig. 6. Payoff of each MG in Case VI.
is increased in Case VI, while the carbon allowance purchase
is reduced.
The optimal solutions of MG3 in different cases are shown
in Table III. MG3 is equipped with MT and would purchase
carbon allowance to generate onsite energy. In Cases I-III,
energy consumptions are the same because demand response
is not considered. In Case I, MG3 purchases energy and car-
bon allowance at a fixed price from the DSO/wholesale market
to supply its load. In Case II, MG3 transact low-cost energy
through the DSO and both energy production and carbon
allowance purchase are reduced. In Case III, MG3’s energy
production is increased as compared with those in Cases I
and II since MG3 can transact low-cost energy and carbon
allowance through the DSO to produce onsite energy.
In Case IV, energy consumptions and purchases are reduced
as compared with those in Case III since MG3 considers
demand response and curtails its load when the purchase
prices are high for energy and carbon allowance. The car-
bon allowance purchase price in the DSO/wholesale market is
low in Case V and MG3 purchases carbon allowance to gener-
ate onsite energy. Therefore, the carbon allowance purchase is
increased while the energy purchase is decreased. Additionally,
MG3 can generate onsite energy at a low cost, so its energy
consumption is increased. In Case VI, MG3 prefers to pur-
chase electricity rather than carbon allowance from the DSO/
wholesale market which increases the energy purchase while
reducing the purchase of carbon allowance.
Fig. 6 presents the payoff for each MG in Case VI, where
MG2 and MG4 with low DER cost supply onsite loads at
a low cost without any CO2 emission. Therefore, the two MGs
sell carbon allowances for maximizing their payoffs. MG1 and
MG3 with MTs purchase carbon allowance for MTs, which
reduces their payoffs of MGs and will incentivize investments
on renewable DERs.
TABLE IV
PUBLIC KEYS OF ALL PARTICIPANTS IN BLOCKCHAIN NETWORK
TABLE V
PAYMENT TRANSFER USING SMART CONTRACTS
Fig. 7. IEEE 33-bus test system topology.
Table IV shows public keys for the DSO and MG inter-
changes in the blockchain network, where smart contracts
are implemented in the Solidity programming language. The
proposed market includes two steps: First MGs trade energy
and carbon allowance. Then, payments are allocated to MGs
based on traded quantities. Table V illustrates how smart con-
tracts allocate payments among MGs. The smart contracts will
first check whether MGs obey the transactions and transfer
the corresponding payments among MGs accordingly. Here,
MG2 and MG4 sells energy and carbon allowance to MG1
and MG3. Therefore, smart contracts will transfer correspond-
ing payments from MG1 and MG3 to MG2 and MG4. In
Table IV, payoffs for MG1 and MG3 are reduced after smart
contracts are executed and payments are provided from MG1
and MG3 to MG2 and MG4. The MG’s payoff is the same as
that in Table II.
B. IEEE 33-Bus Test System
The IEEE 33-bus test system is used to test the proposed
model. Fig. 7 shows the topology of this 33-bus system, which
includes 33 MGs and 32 distribution lines. Bus 01 is the slack
bus. Two cases are proposed to analyze the transactive energy
and carbon market.
TEM: Transactive energy market in which the carbon
allowance is not limited.
TECM: The proposed transactive energy and carbon market.
In Table VI, MGs which do not need to pay for CO2 emis-
sion in TEM, can dispatch MTs to produce energy extensively
which results in large CO2 emissions. In TECM, the payoff is
decreased when such MGs would have to purchase allowance.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:07:54 UTC from IEEE Xplore.  Restrictions apply. 
YAN et al.: BLOCKCHAIN FOR TRANSACTING ENERGY AND CARBON ALLOWANCE IN NETWORKED MGs 4711
TABLE VI
OPTIMAL SOLUTIONS IN TEM AND TECM
Fig. 8. (a) Total payoff and (b) carbon emission as a function of electricity
and carbon allowance prices.
Therefore, the energy produced by MTs and the respective
carbon emission in TECM.
In Fig. 8 (a), as the prices of electricity and carbon
allowance are increased, the total payoff is decreased since
MGs purchase energy and carbon allowance at a higher price.
In Fig. 8 (b), when carbon allowance price is increased, the
CO2 emission is decreased since MGs would purchase carbon
allowance at a higher price. When electricity price is increased,
the CO2 emission is increased since MGs purchase carbon
allowance to produce onsite energy rather than purchasing
energy.
Next, we compare the proposed transactive energy and car-
bon market without and with network constraints (labeled as
TECM-I and TECM-II, respectively). Fig. 9 compares line
flows in TECM-I and TECM-II, in which the MG trades in
TECM-I would result in line overloads and threaten a secure
network operation. In TECM-II, line flows are restricted
within their capacities, which secure the distribution network
operation.
Table VII presents the optimal solutions in TECM-I and
TECM-II, respectively, in which the total payoff and traded
energy is high in TECM-I. However, the total payoff and
traded energy is decreased in TECM-II. Accordingly, MGs in
TECM-II would produce onsite DER generation rather than
Fig. 9. Line flows at hour 9 in TECM-I and TECM-II.
TABLE VII
OPTIMAL SOLUTIONS IN TECM-I AND TECM-II
TABLE VIII
OPTIMAL SOLUTIONS FOR TEM AND TECM
TABLE IX
RESULTS FOR THE PROPOSED PAYOFF ALLOCATION METHOD
purchasing energy from other MGs. MGs which vent more
CO2 would offer a larger market trade of carbon allowance.
C. IEEE 123-Bus Test System
The IEEE 123-bus test system, which includes 123 MGs,
is used to test the proposed model. Table VIII compares the
optimal solutions of TEM and TECM. MGs can dispatch MTs
to produce energy extensively in TEM since they do not have
CO2 limitation, which further results in large CO2 emissions.
The CO2 emission is reduced since MGs have to buy the
carbon allowance for CO2 emission.
Table IX shows the computation time and the number of
iterations used in the proposed payoff allocation method. The
proposed method applies the C&CG method to decompose
the original two-level problem into a master and a subprob-
lem. The KKT conditions are further applied to solve the
subproblem. The total computation time is 7,359 s, while
the computation times for the master problem and subprob-
lem are 437s and 6,922s, respectively. The C&CG algorithm
takes 104 iterations to converge. Compared with the exist-
ing payoff allocation method that generally requires at least
2123-1 iterations in this case study, the proposed method can
obtain the payoff allocation with much fewer iterations. It
can be observed that the computational burden is caused
by the subproblem when the big-M method is applied. The
method proposed in [44] can be further utilized to enhance
the computational performance of the subproblem.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:07:54 UTC from IEEE Xplore.  Restrictions apply. 
4712 IEEE TRANSACTIONS ON SMART GRID, VOL. 12, NO. 6, NOVEMBER 2021
TABLE X
PERFORMANCE OF THE PROPOSED BLOCKCHAIN CONTRACT
SETTLEMENT SYSTEM
Table X shows the blockchain performance for contract set-
tlement. We use the Go Ethereum to build a private blockchain
network for participating MGs on a personal computer. The Go
Ethereum allows users to flexibly adjust the consensus time.
The average consensus time for verification is about 5 min
and the cost for achieving consensus is about 0.001 ETH (the
digital currency used in the Ethereum). To further reduce the
consensus time, the proposed method can be applied using
other software packages like Hyperledger which could enhance
the computational performance.
VI. DISCUSSION
In practice, any forecast errors in loads and renewable DERs
could result in load unbalances in real-time operations. To
accommodate the variability of loads and renewable DERs,
the proposed energy market can be expanded to consider
a combined energy and reserve market [45]. We assume MTs,
renewable DERs, and loads can participate in the provision of
reserves. The mathematical formulation of the grand coalition
in the combined energy and reserve market is listed as follow:
max UR(N) (42)
0 ≤ PGi,m,t + RGi,m,t ≤ PGmax
i,m ∀i,∀m,∀t (43)
0 ≤ PWi,w,t + RWi,w,t ≤ PWmax
i,w,t ∀i,∀w,∀t (44)
PDmin
i,t ≤ PDi,t + RDi,t ≤ PDmax
i,t ∀i,∀t (45)
Constraints (2)−(17) (46)
where UR(N) represents the total payoff for the grand coali-
tion N [45]. RGi,m,t, RWi,w,t, and RDi,t represent the reserve
provided by MTs, renewable DERs, and loads. After solving
the proposed problem (42)-(46), the grand coalition pay-
off is obtained and allocated to each MG as discussed in
Section III-C. The provision of reserve in this market can
accommodate potential uncertainties and each MG’s payoff
allocation includes those of energy and reserve.
VII. CONCLUSION
In this paper, blockchain is applied to the transactive
energy and carbon market for networked MGs. DSO col-
lects data from all MGs and calculates the energy and carbon
allowance trading among MGs for delivering a secure distribu-
tion network operation. A cooperative game with externalities
is applied to model the MGs’ cooperative behaviors consid-
ering the power distribution network constraints. A two-stage
payoff allocation problem and the corresponding solution tech-
niques are proposed to allocate the coalition payoff to each
MG within a reasonable solution time. The use of blockchain
will ensure secure and transparent MG transactions by apply-
ing an unsymmetric encryption, i.e., public and private keys.
Smart contracts increase the market operation efficiency and
transaction settlement. Simulation results illustrate the effec-
tiveness, computational performance, and scalability of the
proposed transactive energy and carbon market. In the test
systems, the total provision of carbon emission is decreased
to 76.8%, which proves the validity of the proposed method
for market operation. Meanwhile, MGs are incentivized to
trade energy and carbon allowance since their total payoff
is increased by over 25% by using the proposed method.
Our future work will study the transactive energy market for
energy hubs and test the proposed method on other blockchain
platforms.
REFERENCES
[1] Z. Li, M. Shahidehpour, F. Aminifar, A. Alabdulwahab, and Y. Al-Turki,
“Networked microgrids for enhancing the power system resilience,”
Proc. IEEE, vol. 105, no. 7, pp. 1289–1310, Jul. 2017.
[2] F. A. Rahimi and A. Ipakchi, “Transactive energy techniques: Closing
the gap between wholesale and retail markets,” Electricity J., vol. 28,
no. 5, pp. 29–35, Oct. 2012.
[3] A. Adeyemi, M. Yan, M. Shahidehpour, S. Bahramirad, and A. Paaso,
“Transactive energy markets for managing energy exchanges in power
distribution systems,” Electricity J., vol. 33, no. 9, Nov. 2020,
Art. no. 106868.
[4] L. Molyneaux and B. Head, “Why information and transparency about
electricity matter: Fragmentation of governance and accountability under
new public management,” Aust. J. Public Admin., vol. 79, no. 1,
pp. 143–164, 2020.
[5] Y. Du and F. Li, “A hierarchical real-time balancing market considering
multi-microgrids with distributed sustainable resources,” IEEE Trans.
Sustain. Energy, vol. 11, no. 1, pp. 72–83, Jan. 2020.
[6] L. Bai, J. Wang, C. Wang, C. Chen, and F. Li, “Distribution loca-
tional marginal pricing (DLMP) for congestion management and voltage
support,” IEEE Trans. Power Syst., vol. 33, no. 4, pp. 4061–4073,
Jul. 2018.
[7] W. Liu, J. Zhan, and C. Y. Chung, “A novel transactive energy control
mechanism for collaborative networked microgrids,” IEEE Trans. Power
Syst., vol. 34, no. 3, pp. 2048–2060, May 2019.
[8] Y. Wang, Z. Huang, M. Shahidehpour, L. L. Lai, Z. Wang, and Q. Zhu,
“Reconfigurable distribution network for managing transactive energy
in a multi-microgrid system,” IEEE Trans. Smart Grid, vol. 11, no. 2,
pp. 1286–1295, Mar. 2020.
[9] W. Liu, W. Gu, J. Wang, W. Yu, and X. Xi, “Game theoretic non-
cooperative distributed coordination control for multi-microgrids,” IEEE
Trans. Smart Grid, vol. 9, no. 6, pp. 6986–6997, Nov. 2018.
[10] M. Yan, M. Shahidehpour, A. Paaso, L. Zhang, A. Alabdulwahab,
and A. Abusorrah, “Distribution network-constrained optimization
of peer-to-peer transactive energy trading among multi-microgrids,”
IEEE Trans. Smart Grid, vol. 12, no. 2, pp. 1033–1047, Mar. 2021,
doi: 10.1109/TSG.2020.3032889.
[11] W. Gan, M. Yan, W. Yao, and J. Wen, “Peer to peer transactive energy
for multiple energy hub with the penetration of high-level renewable
energy,” Appl. Energy, vol. 25, Aug. 2021, Art. no. 117027.
[12] C. Feng, F. Wen, S. You, Z. Li, F. Shahnia, and M. Shahidehpour,
“Coalitional game-based transactive energy management in local energy
communities,” IEEE Trans. Power Syst., vol. 35, no. 3, pp. 1729–1740,
May 2020.
[13] J. Li, Y. Ye, and G. Strbac, “Stabilizing peer-to-peer energy trading
in prosumer coalition through computational efficient pricing,” Elect.
Power Syst. Res., vol. 189, Dec. 2020, Art. no. 106764.
[14] W. Tushar et al., “A coalition formation game framework for peer-to-peer
energy trading,” Appl. Energy, vol. 261, Mar. 2020, Art. no. 114436.
[15] M. Mukherjee, L. D. Marinovici, T. D. Hardy, and J. Hansen,
“Framework for large-scale implementation of wholesale-retail trans-
active control mechanism,” Int. J. Elect. Power Energy Syst., vol. 115,
Feb. 2020, Art. no. 105464.
[16] Y. K. Renani, M. Ehsan, and M. Shahidehpour, “Optimal transac-
tive market operations with distribution system operators,” IEEE Trans.
Smart Grid, vol. 9, no. 6, pp. 6692–6701, Nov. 2018.
[17] L. Marinovici, T. Hardy, and J. Hansen, “Hierarchical architecture for
transactive wholesale-retail market integration,” in Proc. IEEE Power
Energy Soc. Gen. Meeting (PESGM), Atlanta, GA, USA, 2019, pp. 1–5.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:07:54 UTC from IEEE Xplore.  Restrictions apply. 
http://dx.doi.org/10.1109/TSG.2020.3032889
YAN et al.: BLOCKCHAIN FOR TRANSACTING ENERGY AND CARBON ALLOWANCE IN NETWORKED MGs 4713
[18] J. Hansen, T. Hardy, and L. Marinovici, “Transactive energy: Stabilizing
oscillations in integrated wholesale-retail energy markets,” in Proc.
IEEE Power Energy Soc. Innovat. Smart Grid Technol. Conf. (ISGT),
Washington, DC, USA, 2019, pp. 1–5.
[19] M. Ghamkhari, “Transactive energy versus demand response in cutting
wholesale electricity prices,” in Proc. 3rd Int. Conf. Smart Grid Smart
Cities (ICSGSC), Berkeley, CA, USA, 2019, pp. 182–187.
[20] J. MacCormack, H. Zareipour, and W. D. Rosehart, “Long-term market
equilibrium model with strategic, competitive, and inflexible generation,”
IEEE Trans. Power Syst., vol. 27, no. 4, pp. 2291–2292, Nov. 2012.
[21] N. Zhang, Z. Hu, D. Dai, S. Dang, M. Yao, and Y. Zhou, “Unit com-
mitment model in smart grid environment considering carbon emissions
trading,” IEEE Trans. Smart Grid, vol. 7, no. 1, pp. 420–427, Jan. 2016.
[22] Z. Ji et al., “Low-carbon power system dispatch incorporating car-
bon capture power plants,” IEEE Trans. Power Syst., vol. 28, no. 4,
pp. 4615–4623, Nov. 2013.
[23] Y. Cheng, N. Zhang, B. Zhang, C. Kang, W. Xi, and M. Feng,
“Low-carbon operation of multiple energy systems based on energy-
carbon integrated prices,” IEEE Trans. Smart Grid, vol. 11, no. 2,
pp. 1307–1318, Mar. 2020.
[24] A. Adeyemi et al., “Blockchain technology applications in power distri-
bution systems,” Electricity J., vol. 33, no. 8, Oct. 2020, Art. no. 106817.
[25] M. Shahidehpour, M. Yan, P. Shikhar, S. Bahramirad, and A. Paaso,
“Blockchain for peer-to-peer transactive energy trading in networked
microgrids: Providing an effective and decentralized strategy,” IEEE
Electrif. Mag., vol. 8, no. 4, pp. 80–90, Dec. 2020.
[26] M. R. Hamouda, M. E. Nassar, and M. M. A. Salama, “A novel energy
trading framework using adapted blockchain technology,” IEEE Trans.
Smart Grid, vol. 12, no. 3, pp. 2165–2175, May 2021.
[27] Z. Li, J. Kang, R. Yu, D. Ye, Q. Deng, and Y. Zhang, “Consortium
blockchain for secure energy trading in industrial Internet of Things,”
IEEE Trans. Ind. Informat., vol. 14, no. 8, pp. 3690–3700, Aug. 2018.
[28] M. K. AlAshery et al., “A blockchain-enabled multi-settlement quasi-
ideal peer-to-peer trading framework,” IEEE Trans. Smart Grid, vol. 12,
no. 1, pp. 885–896, Jan. 2021.
[29] J. Abdella, Z. Tari, A. Anwar, A. Mahmood, and F. Han, “An archi-
tecture and performance evaluation of blockchain-based peer-to-peer
energy trading,” IEEE Trans. Smart Grid, vol. 12, no. 4, pp. 3364–3378,
Jul. 2021, doi: 10.1109/TSG.2021.3056147.
[30] Y. Li and B. Hu, “An iterative two-layer optimization charging
and discharging trading scheme for electric vehicle using consortium
blockchain,” IEEE Trans. Smart Grid, vol. 11, no. 3, pp. 2627–2637,
May 2020.
[31] W. Huang, N. Zhang, Y. Cheng, J. Yang, Y. Wang, and C. Kang,
“Multienergy networks analytics: Standardized modeling, optimization,
and low carbon analysis,” Proc. IEEE, vol. 108, no. 9, pp. 1411–1436,
Sep. 2020.
[32] H. He et al., “Joint operation mechanism of distributed photovoltaic
power generation market and carbon market based on cross-chain trading
technology,” IEEE Access, vol. 8, pp. 66116–66130, 2020.
[33] W. Hua, J. Jiang, H. Sun, and J. Wu, “A blockchain based peer-to-
peer trading framework integrating energy and carbon markets,” Appl.
Energy, vol. 279, Dec. 2020, Art. no. 115539.
[34] R. Ghorani, M. Fotuhi-Firuzabad, and M. Moeini-Aghtaie, “Main chal-
lenges of implementing penalty mechanisms in transactive electricity
markets,” IEEE Trans. Power Syst., vol. 34, no. 5, pp. 3954–3956,
Sep. 2019.
[35] E. Du et al., “Managing wind power uncertainty through strate-
gic reserve purchasing,” IEEE Trans. Power Syst., vol. 32, no. 4,
pp. 2547–2559, Jul. 2017.
[36] P. Chander and H. Tulkens, “The core of an economy with multi-
lateral environmental externalities,” in Public Goods, Environmental
Externalities and Fiscal Competition. Boston, MA, USA: Springer,
2006, pp. 153–175.
[37] I. E. Hafalir, “Efficiency in coalition games with externalities,” Games
Econ. Behav., vol. 61, no. 2, pp. 242–258, Mar. 2007.
[38] J. Yang, N. Zhang, C. Kang, and Q. Xia, “A state-independent linear
power flow model with accurate estimation of voltage magnitude,” IEEE
Trans. Power Syst., vol. 32, no. 5, pp. 3607–3617, Sep. 2017.
[39] Appendix. Accessed: Sep. 2021. [Online]. Available: https://drive.
google.com/file/d/1CERmCYTUaDs5ut1zgQ7bPU-FnV6QH9OF/view?
usp=sharing
[40] M. Yan, N. Zhang, X. Ai, M. Shahidehpour, C. Kang, and J. Wen,
“Robust two-stage regional-district scheduling of multi-carrier energy
systems with a large penetration of wind power,” IEEE Trans. Sustain.
Energy, vol. 10, no. 3, pp. 1227–1239, Jul. 2019.
[41] Y. Zhou, M. Shahidehpour, Z. Wei, Z. Li, G. Sun, and S. Chen,
“Distributionally robust co-optimization of energy and reserve for com-
bined distribution networks of power and district heating,” IEEE Trans.
Power Syst., vol. 35, no. 3, pp. 2388–2398, May 2020.
[42] M. Yan, Y. He, M. Shahidehpour, X. Ai, Z. Li, and J. Wen, “Coordinated
regional-district operation of integrated energy systems for resilience
enhancement in natural disasters,” IEEE Trans. Smart Grid, vol. 10,
no. 5, pp. 4881–4892, Sep. 2019.
[43] Price for Buying Energy From External Market. Accessed:
Sep. 2021. [Online]. Available: https://drive.google.com/file/d/
1ZfkkNlOG43yLGRAERdZC8EK7P7C-U2ul/view?usp=sharing
[44] G. Huang, J. Wang, C. Chen, J. Qi, and C. Guo, “Integration of preven-
tive and emergency responses for power grid resilience enhancement,”
IEEE Trans. Power Syst., vol. 32, no. 6, pp. 4451–4463, Nov. 2017.
[45] Z. Guo, P. Pinson, S. Chen, Q. Yang, and Z. Yang, “Chance-constrained
peer-to-peer joint energy and reserve market considering renewable
generation uncertainty,” IEEE Trans. Smart Grid, vol. 12, no. 1,
pp. 798–809, Jan. 2021.
Mingyu Yan (Graduate Student Member, IEEE) received the B.S. degree
from the College of Electrical Engineering, Zhejiang University, Hangzhou,
China, in 2016, the M.S. degree from the Huazhong University of Science
and Technology, Wuhan, China, in 2018, and the Ph.D. degree from the
Department of Electrical and Computer Engineering, Illinois Institute of
Technology, Chicago, IL, USA, in 2021. His research interests include
power system operation and planning, power market, multiple energy system
integration, smart cities, and power system reliability.
Mohammad Shahidehpour (Life Fellow, IEEE) received the Honorary
Doctorate degree from the Polytechnic University of Bucharest, Bucharest,
Romania, in 2009. He is the Bodine Chair Professor and the Director of
the Robert W. Galvin Center for Electricity Innovation, Illinois Institute of
Technology. He is listed as a Highly Cited Researcher on the Web Science
(ranked in the top 1% by citations demonstrating significant influence among
his peers). He is a Fellow of the American Association for the Advancement of
Science and the National Academy of Inventors, a Laureate of the Khwarizmi
International Award, and an elected member of the U.S. National Academy
of Engineering.
Ahmed Alabdulwahab (Senior Member, IEEE) received the Ph.D. degree in
electrical engineering from the University of Saskatchewan, Saskatoon, SK,
Canada. He is a Professor with the Department of Electrical Engineering and
Computer Engineering, King Abdulaziz University. He is also the Dean of
the Jeddah Community College, Saudi Arabia.
Abdullah Abusorrah (Senior Member, IEEE) received the Ph.D. degree
in electrical engineering from the University of Nottingham, Nottingham,
U.K. He is a Professor with the Department of Electrical and Computer
Engineering, King Abdulaziz University, Jeddah, Saudi Arabia, where he also
is the Head of the Center for Renewable Energy and Power Systems. His
research interest includes power quality, smart grid, and system analyzes.
Niroj Gurung (Member, IEEE) received the undergraduate degree in elec-
trical engineering from Tribhuvan University, Nepal, and the M.S.E.E. and
Ph.D. degrees in electrical engineering from the University of North Carolina
at Charlotte. He is currently a General Engineer with ComEd and serves as the
Technical Lead in microgrid dynamics, protection and control, DER integra-
tion, distribution sensors, state estimation, and hardware-in-loop testing. His
research interest includes power system dynamics and stability, microgrids,
optimization, and management of high DER power grid.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:07:54 UTC from IEEE Xplore.  Restrictions apply. 
http://dx.doi.org/10.1109/TSG.2021.3056147
4714 IEEE TRANSACTIONS ON SMART GRID, VOL. 12, NO. 6, NOVEMBER 2021
Honghao Zheng (Member, IEEE) received the B.S. degree from the
Huazhong University of Science and Technology in 2009, and the M.S.
and Ph.D. degrees from UW-Madison in 2012 and 2015, respectively. He
worked for Siemens Industry Inc., in smart grid Research and Development,
digital grid. He is currently working with Voltage Optimization Group,
Commonwealth Edison, an Exelon Company. He is also a registered
Professional Engineer.
Oladipupo Ogunnubi (Member, IEEE) received the B.S. degree in electrical
engineering from Clarkson University in 2009, and the M.S. and M.B.A.
degrees in power systems engineering and corporate governance with the
University of Illinois, Urbana-Champaign, in 2015. He is a member of
the Emerging Technology Group, ComEd Smart Grid, where he leads and
supports the execution of beneficial electrification projects as well as deploy-
ment of emerging technologies on ComEd’s distribution grid. He joined
ComEd/Exelon in 2015 as a Transmission Planning Engineer performing stud-
ies to ensure the long-term reliability of the high-voltage network. In 2018,
he transitioned to Exelon’s Corporate Strategy Team, where he helped shape
Exelon’s Beneficial Electrification strategy and supported the company’s Fleet
Electrification endeavors.
Aleksandar Vukojevic (Member, IEEE) received the first bachelor’s degree in
applied mathematics from Kennesaw State University, Kennesaw, GA, USA,
in 2001, the second bachelor’s and master’s degrees in electrical engineering
from the Georgia Institute of Technology, Atlanta, GA, USA, in 2003 and
2004, respectively, and the second master’s degree in business administration
from the Robinson College of Business, Georgia State University, Atlanta,
in 2009. He is currently pursuing the Ph.D. degree with the Department
of Electrical and Computer Engineering, North Carolina State University,
Raleigh, NC, USA. He is a Registered Professional Engineer in state of North
Carolina. He has over 15 years of experience working for electrical utilities,
and has been awarded several patents during his career. His research interests
include design, construction, commissioning, modeling and protection, and
control of microgrids.
Esa Aleksi Paaso (Senior Member, IEEE) received the Ph.D. degree in elec-
trical engineering from the University of Kentucky, Lexington, KY, USA, in
2014. He is currently the Director of Distribution Planning, Smart Grid and
Innovation with ComEd, Chicago, IL, USA. He is responsible for ComEd’s
distribution planning activities, distributed energy resource interconnection,
as well as smart grid strategy and project execution. He is a Technical Co-
Chair for the 2020 IEEE PES Transmission and Distribution Conference and
Exposition.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:07:54 UTC from IEEE Xplore.  Restrictions apply. 
<<
  /ASCII85EncodePages false
  /AllowTransparency false
  /AutoPositionEPSFiles false
  /AutoRotatePages /None
  /Binding /Left
  /CalGrayProfile (Gray Gamma 2.2)
  /CalRGBProfile (sRGB IEC61966-2.1)
  /CalCMYKProfile (U.S. Web Coated \050SWOP\051 v2)
  /sRGBProfile (sRGB IEC61966-2.1)
  /CannotEmbedFontPolicy /Warning
  /CompatibilityLevel 1.4
  /CompressObjects /Off
  /CompressPages true
  /ConvertImagesToIndexed true
  /PassThroughJPEGImages true
  /CreateJobTicket false
  /DefaultRenderingIntent /Default
  /DetectBlends true
  /DetectCurves 0.0000
  /ColorConversionStrategy /LeaveColorUnchanged
  /DoThumbnails false
  /EmbedAllFonts true
  /EmbedOpenType false
  /ParseICCProfilesInComments true
  /EmbedJobOptions true
  /DSCReportingLevel 0
  /EmitDSCWarnings false
  /EndPage -1
  /ImageMemory 1048576
  /LockDistillerParams true
  /MaxSubsetPct 100
  /Optimize true
  /OPM 0
  /ParseDSCComments false
  /ParseDSCCommentsForDocInfo false
  /PreserveCopyPage true
  /PreserveDICMYKValues true
  /PreserveEPSInfo false
  /PreserveFlatness true
  /PreserveHalftoneInfo true
  /PreserveOPIComments false
  /PreserveOverprintSettings true
  /StartPage 1
  /SubsetFonts false
  /TransferFunctionInfo /Remove
  /UCRandBGInfo /Preserve
  /UsePrologue false
  /ColorSettingsFile ()
  /AlwaysEmbed [ true
    /Arial-Black
    /Arial-BoldItalicMT
    /Arial-BoldMT
    /Arial-ItalicMT
    /ArialMT
    /ArialNarrow
    /ArialNarrow-Bold
    /ArialNarrow-BoldItalic
    /ArialNarrow-Italic
    /ArialUnicodeMS
    /BookAntiqua
    /BookAntiqua-Bold
    /BookAntiqua-BoldItalic
    /BookAntiqua-Italic
    /BookmanOldStyle
    /BookmanOldStyle-Bold
    /BookmanOldStyle-BoldItalic
    /BookmanOldStyle-Italic
    /BookshelfSymbolSeven
    /Century
    /CenturyGothic
    /CenturyGothic-Bold
    /CenturyGothic-BoldItalic
    /CenturyGothic-Italic
    /CenturySchoolbook
    /CenturySchoolbook-Bold
    /CenturySchoolbook-BoldItalic
    /CenturySchoolbook-Italic
    /ComicSansMS
    /ComicSansMS-Bold
    /CourierNewPS-BoldItalicMT
    /CourierNewPS-BoldMT
    /CourierNewPS-ItalicMT
    /CourierNewPSMT
    /EstrangeloEdessa
    /FranklinGothic-Medium
    /FranklinGothic-MediumItalic
    /Garamond
    /Garamond-Bold
    /Garamond-Italic
    /Gautami
    /Georgia
    /Georgia-Bold
    /Georgia-BoldItalic
    /Georgia-Italic
    /Haettenschweiler
    /Helvetica
    /Helvetica-Bold
    /HelveticaBolditalic-BoldOblique
    /Helvetica-BoldOblique
    /Impact
    /Kartika
    /Latha
    /LetterGothicMT
    /LetterGothicMT-Bold
    /LetterGothicMT-BoldOblique
    /LetterGothicMT-Oblique
    /LucidaConsole
    /LucidaSans
    /LucidaSans-Demi
    /LucidaSans-DemiItalic
    /LucidaSans-Italic
    /LucidaSansUnicode
    /Mangal-Regular
    /MicrosoftSansSerif
    /MonotypeCorsiva
    /MSReferenceSansSerif
    /MSReferenceSpecialty
    /MVBoli
    /PalatinoLinotype-Bold
    /PalatinoLinotype-BoldItalic
    /PalatinoLinotype-Italic
    /PalatinoLinotype-Roman
    /Raavi
    /Shruti
    /Sylfaen
    /SymbolMT
    /Tahoma
    /Tahoma-Bold
    /Times-Bold
    /Times-BoldItalic
    /Times-Italic
    /TimesNewRomanMT-ExtraBold
    /TimesNewRomanPS-BoldItalicMT
    /TimesNewRomanPS-BoldMT
    /TimesNewRomanPS-ItalicMT
    /TimesNewRomanPSMT
    /Times-Roman
    /Trebuchet-BoldItalic
    /TrebuchetMS
    /TrebuchetMS-Bold
    /TrebuchetMS-Italic
    /Tunga-Regular
    /Verdana
    /Verdana-Bold
    /Verdana-BoldItalic
    /Verdana-Italic
    /Vrinda
    /Webdings
    /Wingdings2
    /Wingdings3
    /Wingdings-Regular
    /ZapfChanceryITCbyBT-MediumItal
    /ZWAdobeF
  ]
  /NeverEmbed [ true
  ]
  /AntiAliasColorImages false
  /CropColorImages true
  /ColorImageMinResolution 200
  /ColorImageMinResolutionPolicy /OK
  /DownsampleColorImages false
  /ColorImageDownsampleType /Average
  /ColorImageResolution 300
  /ColorImageDepth -1
  /ColorImageMinDownsampleDepth 1
  /ColorImageDownsampleThreshold 1.50000
  /EncodeColorImages true
  /ColorImageFilter /DCTEncode
  /AutoFilterColorImages false
  /ColorImageAutoFilterStrategy /JPEG
  /ColorACSImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /ColorImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /JPEG2000ColorACSImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /JPEG2000ColorImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /AntiAliasGrayImages false
  /CropGrayImages true
  /GrayImageMinResolution 200
  /GrayImageMinResolutionPolicy /OK
  /DownsampleGrayImages false
  /GrayImageDownsampleType /Average
  /GrayImageResolution 300
  /GrayImageDepth -1
  /GrayImageMinDownsampleDepth 2
  /GrayImageDownsampleThreshold 1.50000
  /EncodeGrayImages true
  /GrayImageFilter /DCTEncode
  /AutoFilterGrayImages false
  /GrayImageAutoFilterStrategy /JPEG
  /GrayACSImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /GrayImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /JPEG2000GrayACSImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /JPEG2000GrayImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /AntiAliasMonoImages false
  /CropMonoImages true
  /MonoImageMinResolution 400
  /MonoImageMinResolutionPolicy /OK
  /DownsampleMonoImages false
  /MonoImageDownsampleType /Bicubic
  /MonoImageResolution 600
  /MonoImageDepth -1
  /MonoImageDownsampleThreshold 1.50000
  /EncodeMonoImages true
  /MonoImageFilter /CCITTFaxEncode
  /MonoImageDict <<
    /K -1
  >>
  /AllowPSXObjects false
  /CheckCompliance [
    /None
  ]
  /PDFX1aCheck false
  /PDFX3Check false
  /PDFXCompliantPDFOnly false
  /PDFXNoTrimBoxError true
  /PDFXTrimBoxToMediaBoxOffset [
    0.00000
    0.00000
    0.00000
    0.00000
  ]
  /PDFXSetBleedBoxToMediaBox true
  /PDFXBleedBoxToTrimBoxOffset [
    0.00000
    0.00000
    0.00000
    0.00000
  ]
  /PDFXOutputIntentProfile (None)
  /PDFXOutputConditionIdentifier ()
  /PDFXOutputCondition ()
  /PDFXRegistryName ()
  /PDFXTrapped /False
  /CreateJDFFile false
  /Description <<
    /CHS <FEFF4f7f75288fd94e9b8bbe5b9a521b5efa7684002000410064006f006200650020005000440046002065876863900275284e8e55464e1a65876863768467e5770b548c62535370300260a853ef4ee54f7f75280020004100630072006f0062006100740020548c002000410064006f00620065002000520065006100640065007200200035002e003000204ee553ca66f49ad87248672c676562535f00521b5efa768400200050004400460020658768633002>
    /CHT <FEFF4f7f752890194e9b8a2d7f6e5efa7acb7684002000410064006f006200650020005000440046002065874ef69069752865bc666e901a554652d965874ef6768467e5770b548c52175370300260a853ef4ee54f7f75280020004100630072006f0062006100740020548c002000410064006f00620065002000520065006100640065007200200035002e003000204ee553ca66f49ad87248672c4f86958b555f5df25efa7acb76840020005000440046002065874ef63002>
    /DAN <FEFF004200720075006700200069006e0064007300740069006c006c0069006e006700650072006e0065002000740069006c0020006100740020006f007000720065007400740065002000410064006f006200650020005000440046002d0064006f006b0075006d0065006e007400650072002c0020006400650072002000650067006e006500720020007300690067002000740069006c00200064006500740061006c006a006500720065007400200073006b00e60072006d007600690073006e0069006e00670020006f00670020007500640073006b007200690076006e0069006e006700200061006600200066006f0072007200650074006e0069006e006700730064006f006b0075006d0065006e007400650072002e0020004400650020006f007000720065007400740065006400650020005000440046002d0064006f006b0075006d0065006e0074006500720020006b0061006e002000e50062006e00650073002000690020004100630072006f00620061007400200065006c006c006500720020004100630072006f006200610074002000520065006100640065007200200035002e00300020006f00670020006e0079006500720065002e>
    /DEU <FEFF00560065007200770065006e00640065006e0020005300690065002000640069006500730065002000450069006e007300740065006c006c0075006e00670065006e0020007a0075006d002000450072007300740065006c006c0065006e00200076006f006e002000410064006f006200650020005000440046002d0044006f006b0075006d0065006e00740065006e002c00200075006d002000650069006e00650020007a0075007600650072006c00e40073007300690067006500200041006e007a006500690067006500200075006e00640020004100750073006700610062006500200076006f006e00200047006500730063006800e40066007400730064006f006b0075006d0065006e00740065006e0020007a0075002000650072007a00690065006c0065006e002e00200044006900650020005000440046002d0044006f006b0075006d0065006e007400650020006b00f6006e006e0065006e0020006d006900740020004100630072006f00620061007400200075006e0064002000520065006100640065007200200035002e003000200075006e00640020006800f600680065007200200067006500f600660066006e00650074002000770065007200640065006e002e>
    /ESP <FEFF005500740069006c0069006300650020006500730074006100200063006f006e0066006900670075007200610063006900f3006e0020007000610072006100200063007200650061007200200064006f00630075006d0065006e0074006f0073002000640065002000410064006f00620065002000500044004600200061006400650063007500610064006f007300200070006100720061002000760069007300750061006c0069007a00610063006900f3006e0020006500200069006d0070007200650073006900f3006e00200064006500200063006f006e006600690061006e007a006100200064006500200064006f00630075006d0065006e0074006f007300200063006f006d00650072006300690061006c00650073002e002000530065002000700075006500640065006e00200061006200720069007200200064006f00630075006d0065006e0074006f00730020005000440046002000630072006500610064006f007300200063006f006e0020004100630072006f006200610074002c002000410064006f00620065002000520065006100640065007200200035002e003000200079002000760065007200730069006f006e0065007300200070006f00730074006500720069006f007200650073002e>
    /FRA <FEFF005500740069006c006900730065007a00200063006500730020006f007000740069006f006e00730020006100660069006e00200064006500200063007200e900650072002000640065007300200064006f00630075006d0065006e00740073002000410064006f006200650020005000440046002000700072006f00660065007300730069006f006e006e0065006c007300200066006900610062006c0065007300200070006f007500720020006c0061002000760069007300750061006c00690073006100740069006f006e0020006500740020006c00270069006d007000720065007300730069006f006e002e0020004c0065007300200064006f00630075006d0065006e00740073002000500044004600200063007200e900e90073002000700065007500760065006e0074002000ea0074007200650020006f007500760065007200740073002000640061006e00730020004100630072006f006200610074002c002000610069006e00730069002000710075002700410064006f00620065002000520065006100640065007200200035002e0030002000650074002000760065007200730069006f006e007300200075006c007400e90072006900650075007200650073002e>
    /ITA (Utilizzare queste impostazioni per creare documenti Adobe PDF adatti per visualizzare e stampare documenti aziendali in modo affidabile. I documenti PDF creati possono essere aperti con Acrobat e Adobe Reader 5.0 e versioni successive.)
    /JPN <FEFF30d330b830cd30b9658766f8306e8868793a304a3088307353705237306b90693057305f002000410064006f0062006500200050004400460020658766f8306e4f5c6210306b4f7f75283057307e305930023053306e8a2d5b9a30674f5c62103055308c305f0020005000440046002030d530a130a430eb306f3001004100630072006f0062006100740020304a30883073002000410064006f00620065002000520065006100640065007200200035002e003000204ee5964d3067958b304f30533068304c3067304d307e305930023053306e8a2d5b9a3067306f30d530a930f330c8306e57cb30818fbc307f3092884c3044307e30593002>
    /KOR <FEFFc7740020c124c815c7440020c0acc6a9d558c5ec0020be44c988b2c8c2a40020bb38c11cb97c0020c548c815c801c73cb85c0020bcf4ace00020c778c1c4d558b2940020b3700020ac00c7a50020c801d569d55c002000410064006f0062006500200050004400460020bb38c11cb97c0020c791c131d569b2c8b2e4002e0020c774b807ac8c0020c791c131b41c00200050004400460020bb38c11cb2940020004100630072006f0062006100740020bc0f002000410064006f00620065002000520065006100640065007200200035002e00300020c774c0c1c5d0c11c0020c5f40020c2180020c788c2b5b2c8b2e4002e>
    /NLD (Gebruik deze instellingen om Adobe PDF-documenten te maken waarmee zakelijke documenten betrouwbaar kunnen worden weergegeven en afgedrukt. De gemaakte PDF-documenten kunnen worden geopend met Acrobat en Adobe Reader 5.0 en hoger.)
    /NOR <FEFF004200720075006b00200064006900730073006500200069006e006e007300740069006c006c0069006e00670065006e0065002000740069006c002000e50020006f0070007000720065007400740065002000410064006f006200650020005000440046002d0064006f006b0075006d0065006e00740065007200200073006f006d002000650072002000650067006e0065007400200066006f00720020007000e5006c006900740065006c006900670020007600690073006e0069006e00670020006f00670020007500740073006b007200690066007400200061007600200066006f0072007200650074006e0069006e006700730064006f006b0075006d0065006e007400650072002e0020005000440046002d0064006f006b0075006d0065006e00740065006e00650020006b0061006e002000e50070006e00650073002000690020004100630072006f00620061007400200065006c006c00650072002000410064006f00620065002000520065006100640065007200200035002e003000200065006c006c00650072002e>
    /PTB <FEFF005500740069006c0069007a006500200065007300730061007300200063006f006e00660069006700750072006100e700f50065007300200064006500200066006f0072006d00610020006100200063007200690061007200200064006f00630075006d0065006e0074006f0073002000410064006f00620065002000500044004600200061006400650071007500610064006f00730020007000610072006100200061002000760069007300750061006c0069007a006100e700e3006f002000650020006100200069006d0070007200650073007300e3006f00200063006f006e0066006900e1007600650069007300200064006500200064006f00630075006d0065006e0074006f007300200063006f006d0065007200630069006100690073002e0020004f007300200064006f00630075006d0065006e0074006f00730020005000440046002000630072006900610064006f007300200070006f00640065006d0020007300650072002000610062006500720074006f007300200063006f006d0020006f0020004100630072006f006200610074002000650020006f002000410064006f00620065002000520065006100640065007200200035002e0030002000650020007600650072007300f50065007300200070006f00730074006500720069006f007200650073002e>
    /SUO <FEFF004b00e40079007400e40020006e00e40069007400e4002000610073006500740075006b007300690061002c0020006b0075006e0020006c0075006f0074002000410064006f0062006500200050004400460020002d0064006f006b0075006d0065006e007400740065006a0061002c0020006a006f0074006b006100200073006f0070006900760061007400200079007200690074007900730061007300690061006b00690072006a006f006a0065006e0020006c0075006f00740065007400740061007600610061006e0020006e00e400790074007400e4006d0069007300650065006e0020006a0061002000740075006c006f007300740061006d0069007300650065006e002e0020004c0075006f0064007500740020005000440046002d0064006f006b0075006d0065006e00740069007400200076006f0069006400610061006e0020006100760061007400610020004100630072006f0062006100740069006c006c00610020006a0061002000410064006f00620065002000520065006100640065007200200035002e0030003a006c006c00610020006a006100200075007500640065006d006d0069006c006c0061002e>
    /SVE <FEFF0041006e007600e4006e00640020006400650020006800e4007200200069006e0073007400e4006c006c006e0069006e006700610072006e00610020006f006d002000640075002000760069006c006c00200073006b006100700061002000410064006f006200650020005000440046002d0064006f006b0075006d0065006e007400200073006f006d00200070006100730073006100720020006600f60072002000740069006c006c006600f60072006c00690074006c006900670020007600690073006e0069006e00670020006f006300680020007500740073006b007200690066007400650072002000610076002000610066006600e4007200730064006f006b0075006d0065006e0074002e002000200053006b006100700061006400650020005000440046002d0064006f006b0075006d0065006e00740020006b0061006e002000f600700070006e00610073002000690020004100630072006f0062006100740020006f00630068002000410064006f00620065002000520065006100640065007200200035002e00300020006f00630068002000730065006e006100720065002e>
    /ENU (Use these settings to create PDFs that match the "Recommended"  settings for PDF Specification 4.01)
  >>
>> setdistillerparams
<<
  /HWResolution [600 600]
  /PageSize [612.000 792.000]
>> setpagedevice