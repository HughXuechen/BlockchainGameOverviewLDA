A Novel Layered GSP Incentive Mechanism for Federated Learning Combined with Blockchain
A Novel Layered GSP Incentive Mechanism
for Federated Learning Combined
with Blockchain
Jiangfeng Sun, Guangwei Zhan(B), Jiaxi Liu, and Yu Feng
Engineering Research Center of Information Networks, Ministry of Education,
Beijing University of Posts and Telecommunications, Beijing, China
sun2017@bupt.edu.cn
Abstract. Federated Learning (FL) has shown great potential as a solution to
the problem of data islands. It enables collaborative modeling while adhering to
data privacy and security. But how to ensure participants remain active in FL and
make rewards reasonable are issues. Although various game theory models, such
as Stackelberg, Cournot, and Leader price, give a pricing method for participants,
these models don’t consider the roles in FL and the security. We presented the
FL incentive mechanism, B-LSP, based on the Generalized Second Price Auc-
tion (GSP). This mechanism can overcome the issue of unmanageable incentives
while calculating the reward values. Furthermore, a magnitude stratification is
introduced to ensure the participants remain active and the basic need for data
volume in FL. The requester sets the basic volume requirement for participants,
Initial, and volume comparison standard, Interval, to ensure the basic effectiveness
of FL and categorize participants into different layers according to their data vol-
ume. In B-LSP, requester can control its costs and keep the federation’s stability.
And the blockchain is a crucial part to audit everyone’s contribution and guarantee
our mechanism safe. The analysis results show that the B-LSP is more reasonable
and scientific, and it satisfies both security and traceability when compared to
other game theory models.
Keywords: Federated Learning · Incentive mechanism · Smart Contract · B-LSP
1 Introduction
Enterprises’ decisions are largely reliant on the power of data. However, their data
often contain considerable amount of private information, and according to data privacy
and protection laws, these data cannot be centralized or exchanged directly, posing
challenges to mining data value. Federated Learning (FL), which has been proposed in
recent years, may provide a solution of allowing users to collaborate without exchanging
genuine facts [1]. Each member in FL retains its data locally to ensure that it does not
breach existing laws and regulations. During the collaborative model training, members
merely transmit the intermediate parameters, and subsequently utilize the aggregation
algorithm to construct a complete model.
© The Author(s), under exclusive license to Springer Nature Singapore Pte Ltd. 2022
S. Sun et al. (Eds.): ICSINC 2021, LNEE 895, pp. 310–318, 2022.
https://doi.org/10.1007/978-981-19-4775-9_38
http://crossmark.crossref.org/dialog/?doi=10.1007/978-981-19-4775-9_38&domain=pdf
https://doi.org/10.1007/978-981-19-4775-9_38
A Novel Layered GSP Incentive Mechanism for Federated Learning 311
Though FL is a viable answer, the key to applying FL is to persuade participants
to share their data and keep the federation active. The primary issue is the incentive
mechanism. Members will be unmotivated to join the federation if there are no fair
incentives [2]. Most mechanisms concern about how to allocate the benefits provided by
the final model, and many studies are based on the theory of Output Competition, Price
Leader, and Analytic Hierarchy Procedure methods, such as Cournot and Stackelberg
models [3]. These models show that price is negatively correlated with the output, which
means that higher output causes lower price. However, this may not be consistent with
the FL condition. Additionally, these methods ignore the cost generated by data and
don’t distinguish requester and participants.
1.1 Contribution
B-LSP considers the energy costs of various roles and is designed to cover the complete
procedure of the FL task. The contributions of this article are as follows:
• Introduce GSP to encourage members to compete for bonus: we treat extra bonus
as auction objects and the data volume provided by members as their quotations, so
that members compete for bonus on the data volume they agreed to share [4]. Each
participant will be ranked based on volume, and the first one will get the bonus.
• Introduce Magnitude Stratification Mechanism to regulate incentives: the requester
determines the volume requirement and comparison standard for distinct layers, and
the Incentive Control Line (ICL). Members are classified into layers based on the
quotations. The ICL and member’s location decide the auction winner’s bonus.
• Introduce Smart Contracts to ensure open and effective rules: B-LSP uses blockchain
to implement data auditing and automatic incentives. The data audit will run automati-
cally before FL training to checkmember’s data. The Shapley value is used to calculate
member’s contribution to the federation [5]. The data authentication, quotation, win-
ner’s information, bonus, and basic cost information aremerged by a blockchain based
smart contract [6] (Fig. 1).
Fig. 1. A novel layered GSP incentive mechanism
312 J. Sun et al.
The follow-up arrangements for this article are Part II, related work; Part III, B-LSP
in FL; Part IV, Theoretical Analysis; Part V, Conclusion and Outlook.
2 Related Work
Yufeng Zhan, Peng Li, Zhihao Qu and others have proposed a deep reinforcement learn-
ing (DRL) based incentive mechanism combined with the Stackelberg model [2]; Latif
U. Khan, Shashi Raj Pandey, Nguyen H. Tran and others designed an incentive mech-
anism based on the Stackelberg model for the application of FL in mobile scenarios
[7]. The Stackelberg model is widely used in incentive mechanism design which can
ensure profitability and steady decisions for advantageous enterprises. However, Stack-
elberg model is lack of concern for SMEs (Small andMedium Enterprises) which are the
essential part of FL. Jiawen Kang, Zehui Xiong, Dusit Niyato and others think that it is
necessary to consider the cost of themembers, this paper uses the hardware parameters of
each member to calculate the energy consumption [8]; Ismael Martinez, Sreya Francis,
Abdel-hakim Senhaji Hafid and others combined blockchain with federated learning by
using Enterprise Operation System (EOS) to record and reward members’ contributions
of FL, and proposed Class-Sampled Validation-Error Scheme (CSVES) to verify valu-
able participants and only reward these valuable members [9]; In addition, Yuan Liu,
Zhengpeng Ai, Shuai sun and others proposed to build a FedCoin combined blockchain
with FL which is a payment system for federated learning [10]. The combination of
energy costs, blockchain, and member contributions makes incentive mechanism more
reasonable and scientific, but we still lack a comprehensive solution to organically link
these technologies. To meet all our objectives for fairness, security, and profit, we pre-
sented the B-LSP mechanism, which comprises of GSP, Magnitude Stratification, and
Blockchain.
3 B-LSP in FL
To separate members into distinct layers in B-LSP, the requester will set Initial and
Interval. The member layer and Incentive Control Line are determined by the Initial and
Interval. B-LSP ensures data quantity for federated learning by Initial and controls the
maximum amount of extra bonus via Interval. The ICL is denoted as:
Separatek = Initial + k ∗ Interval, k = 0, 1, 2, . . . ,N (1)
In B-LSP, the requester can ensure its basic interests by Initial and Interval, while
the requester will pay the basic cost of members during the FL and the benefits from
collaborative model will be allocated based on the contributions of each participant. B-
LSP consists of three essential technologies: 1. Layered GSP with blockchain; 2. Basic
Cost Calculation Method; 3. Shapley Value Method and Smart contract.
3.1 B-LSP Process
This paper proposes a mechanism that combines GSP and Magnitude Stratification (B-
LSP) to motivate members to provide as much data as possible while also rewarding
members fairly for their contributions [11]. The procedure details of B-LSP are:
A Novel Layered GSP Incentive Mechanism for Federated Learning 313
1. The requester establishes the fundamental requirement for data volume based on
its revenue aim, and the payment for participants’ base costs can be controlled by
volume comparison standard. Additionally, B-LSP will calculate the bonus using
the requester’s hardware parameters.
2. Participants compete for the extra bonus by their quotation, and for each quotation,
they must upload data authentication to the blockchain. If the first and second quo-
tations are at the same layer, the extra bonus is calculated by the difference between
them; If they are not at the same layer, the extra bonus is calculated by the difference
between the first quotation and the nearest ICL.
3. The quotation, data authentication, data date, hardware parameters and winner are
all uploaded to blockchain for subsequent verification and data auditing.
4. After passing the data audit, start federated training using the quotations (promised
data from each member) and record the training iteration, training time and
communicating times for next computation.
5. After completing the federated model training, compute each member’s basic cost
in the training procedure using the hardware parameters and allow the requester of
this FL job pay the basic cost for each member. Furthermore, the extra bonus is cal-
culated by requester and allocated to the winner based on the winner’s identification
information on the blockchain.
6. Shapley Value can be used to calculate member contributions and upload them to
the blockchain. When the final model creates business profits, the income will be
allocated to members in proportion to their contribution.
The above process is carried out automatically as a smart contract, and the requester
will pay the costs of operation and maintenance in the FL job. The B-LSP process is
shown in the Fig. 2 and the algorithm is Algorithm 1:
Fig. 2. B-LSP workflow with blockchain
314 J. Sun et al.
Algorithm 1 B-LSP
Parameter: Users’ information and quotations, <user, quotation>
Results: Contract, (Cost, V, Allocation ratio) 
1: if Every user agrees the contract then
2: Each member executes:
3: Price for the bonus
4: Requester executes:
5: Set Initial and Interval
6: Ranking and select winner
7: Get H(r), winner’s δ and Separatek
8: if winner - Separatek ≤ winner – second then
9: Num=winner - Separatek
10: else
11: Num = winner - second
12: end
13: V = f Num + g δ , Upload V and quotation to blockchain
14: Starting Federated Learning
15: Calculate allocation ratio and Cost
16: else
17: Restart the auction
18: end
3.2 Basic Cost Calculation Method
The basic cost of FL can be estimated using hardware parameters [8]. The hardware
detection can be expressed as H (i), the cost of computing power of the participants is
calculated via f (Num), the calculation of the participants’ communication costs is g(δ).
Suppose the amount of data provided by member i isNumi, its CPU cycle frequency is fi
and the number of CPU cycles required for training one single data is Ci; The effective
chip capacitance is ξ.
Table 1. Basic cost parameters and functions
Parameters and functions Denotation
Amount of data provided by member i Numi
CPU cycle frequency f i
Number of CPU cycles required for training one single data Ci
Effective chip capacitance ξ
Member i’s intermediate parameter size δi
Hardware detection function H(i)
Computing power f(Num)
(continued)
A Novel Layered GSP Incentive Mechanism for Federated Learning 315
Table 1. (continued)
Parameters and functions Denotation
Communication cost g(δ)
Transmission power ρi
Transmission bandwidth B
Channel gain hi
Background noise N0
Then, the local training time of member i is ci ·Numi
fi
, the energy consumption of
computing in a local iteration is f (Numi) = ξ · ci · Numi · f 2i . Suppose that local
iterations beforemember i communicates with the coordinator is iterationi, transmission
bandwidth is B, transmission power is ρi, channel gain between i and coordinator is hi,
background noise isN0, the size of intermediate parameter transmitted is δi.We calculate
the time for one communication between i and coordinator is δi
B ln
(
1+ ρihi
N0
) , the energy
consumption of one communication between i and coordinator is g(δi) = δiρi
B ln
(
1+ ρihi
N0
) .
If i communicates with the coordinator t a second, the basic cost in federated learning is
Costi = t · (iterationi · f (Numi) + g(δi)). The hardware detection obtains the hardware
parameters of each participant: H (i) = ci, fi, ξ,B, ρi, hi,N0. If i obtains benefits in FL
as Ui, then only when Ui ≥ Costi, members will join the federation and keep active.
Therefore, the requester must pay the basic cost of FL for each member �Costi. The
basic cost calculation algorithm is as followed:
Algorithm 2 Basic Cost Calculation
Input: User i, Number of iterations iterationi, Size of data set Numi, Size of i’s in-
termediate parameter δi, Total times of communication in FL total
Output: Basic Cost of user i Costi
1: Initialize ci, fi, ξ, B, ρi, hi, N0 = H(i), Costk = 0, Costi = 0
2: Each data provider i executes:
3: for round t = 0; t < total; t++ do
4: for round k = 0; k < iterationi; k++ do
5: Costk Costk + f(Numi)
6: end
7: end
8: Costi Costi + Costk + g(δi)
9: Upload Costi to the blockchain
10: return Costi to requester
11: Requester executes:
12: Aggregate all users’ cost: Cost = ΣCosti
316 J. Sun et al.
3.3 Shapley Value and Smart Contract
Shapley Value is a way of calculating the data’s contribution to the model. If the data of
participant i isDi; Xj is the eigenvalue vector of the j-th feature; S is a subset of the entire
feature space, |S| is the number of features in the subset; k is the number of features. The
Shapley value calculation method is defined as:
τj =
∑
S⊆x1,x2,...,xk\xj
|S|!(k − |S| − 1)!
k!
(
val
(
S ∪ xj
) − val(S)
)
(2)
The contribution of data to the model is τDi = ∑n
j=1 τj. The relative contribution of
each member is pi = τDi∑
τD
. If the model creates incomeM, participant i will get pi ∗M .
The Smart Contract consists of the whole procedure of B-LSP and a business contract
which contains the members’ quotations, winners, extra bonus, and basic costs.
Table 2. Commercial contract content
Participant type Name Winner Quotation Basic cost Allocation ratio Extra bonus
Requester name No Volume �Costi P None
Participants name Yes Volume Costi Pi V
4 Theoretical Analysis
By combining blockchain and game theory, B-LSP can give more data security and
traceability than many existing solutions. Table 3 compares the advantages of B-LSP to
other game theory models. Now, let’s pay more attention on the profit analysis.
First, we consider no cost for members in FL. If the extra bonus for the winner is V,
the income of the collaborative model used once is M, then member i can get benefits
pi ∗ M . The member’s revenue in FL can be expressed as:
Ui =
{
V + M ∗ Pi, i wins bonus
M ∗ Pi, i loses bonus
(3)
we can deduct from this formula that if M ∗ Pi ≥ 0 (the utility of each member is
more than zero), it will satisfy the individual rational assumptions in economics, then
members will be willing to join the federation [12].
The B-LSP determine the extra bonus for the winner using the requester’s own
hardware parameters:
V =
{
f (Numi − Separatek) + g(Numi − Separatek), i and others in different layer
f
(
Numi − Numj
) + g
(
Numi − Numj
)
, i and others in the same layer
(4)
A Novel Layered GSP Incentive Mechanism for Federated Learning 317
from the equation, we can know that 0 ≤ V ≤ f (Interval) + g(Interval) which means
requester can control the amount of V.
Second, let’s consider about cost. The cost of requester can be expressed as:Costr =
V + �Costi. Assume the requester’s expected revenue from the collaborative model is
W, the income for the model used once by requester is r, the income of the model used
once by others is M, and the requester can get p ∗ M per time. If there are k members,
the requester’s revenue can be expressed as:
Ur = W − V −
∑
train
[
f (Num) + g(δ)
]
(5)
W =
{∑∞
1 r − ∑k
1 (f (Num) + g(δ)), requester use∑∞
1 p ∗ M + ∑∞
1 r, others use
(6)
Due to the individual rationality, the requester’s income must be more than zero. It’s
obvious that
∑∞
1 p ∗M + ∑∞
1 r ≥ 0 which means
∑∞
1 r − ∑k
1 (f (Num) + g(δ)) ≥ 0
is the key for requester to initiate a FL job.
Table 3. The advantage of B-LSP than other methods
Methods Controllability Stability Security Traceability
B-LSP ✓ ✓ ✓ ✓
Stackelberg ✓ ✓ × ×
Cournot ✓ ✓ × ×
Leader price ✓ ✓ × ×
5 Conclusion and Outlook
The B-LSP help members in getting benefits and requesters in controlling their costs
and FL model quality. Through B-LSP, all members can gain greater benefits than the
existing widely used Stackelberg model and all members can be continually rewarded.
The B-LSP mechanism in this article is a continuous, multi-party, fair and effective
incentive mechanism for FL.
The basic cost of FL is defined in this article as computing and communication
energy cost. As a result, the remainder of this article will concentrate on fundamental
cost accounting and data value appraisal in FL. Furthermore, how to assess the model’s
value should also be studied in the future.
Acknowledgements. This work is supported in part by the National Key Research and Devel-
opment Program of China (No.2018YFB1403000). Engineering Research Center of In-formation
Networks, Ministry of Education.
318 J. Sun et al.
References
1. Yang, Q., et al.: Federated machine learning: concept and applications. ACM Trans. Intell.
Syst. Technol. (TIST) 10(2), 1–19 (2019)
2. Yufeng, Z., Peng, L., Zhihao, Q., Deze, Z., Song, G.: A learning based incentive mechanism
for federated learning. IEEE Internet Things J. 7(7), 6360–6368 (2020)
3. Jingfeng, Z., Cheng, L., Antonio, R.K., Mohan, K.: Hierarchically fair federated learning.
ArXiv 2004.10386 (2020)
4. Dinh, C.N., et al.: Federated learning meets blockchain in edge computing: opportunities
and challenges. IEEE Internet Things J. 8(16), 12806–12825 (2021). https://doi.org/10.1109/
JIOT.2021.3072611
5. Wang, G.: Interpret federated learning with shapley values. ArXiv 1905.04519 (2019)
6. Hyesung, K., Jihong, P., Mehdi, B., Seong, L.K.: Blockchained on-device federated learning.
IEEE Commun. Lett. 24(6), 1279–1283 (2019)
7. Latif, U.K., et al.: Federated learning for edge networks: Resource optimization and incentive
mechanism. IEEE Commun. Mag. 58(10), 88–93 (2020). https://doi.org/10.1109/MCOM.
001.1900649
8. Jiawen, K., Zehui, X., Dusit, N., Shengli, X., Junshan, Z.: Incentive mechanism for reliable
federated learning: a joint optimization approach to combining reputation and contract theory.
IEEE Internet Things J. 6(6), 10700–10714 (2019)
9. Martinez, I., Francis, S., Hafid, A.S.: Record and Reward Federated Learning Contributions
withBlockchain. In: 2019 InternationalConference onCyber-EnabledDistributedComputing
and Knowledge Discovery (CyberC), vol. 1, pp. 50–57. IEEE, Guilin, China (2019)
10. Liu, Y., Ai, Z., Sun, S., Zhang, S., Liu, Z., Yu, H.: FedCoin: a peer-to-peer payment system for
federated learning. In: Yang, Q., Fan, L., Yu,H. (eds.) Federated Learning. LNCS (LNAI), vol.
12500, pp. 125–138. Springer, Cham (2020). https://doi.org/10.1007/978-3-030-63076-8_9
11. Kang, L.N., Zichen, C., Liu, Z., Yu, H., Liu, Y., Yang, Q.: A multi-player game for studying
federated learning incentive schemes. In: 29th International Joint Confer-ence on Artificial
Intelligence (IJCAI 2020), pp. 5279–5281. IJCAI, Japan (2020)
12. Lyu, L., Xu, X., Wang, Q., Yu, H.: Collaborative fairness in federated learning. In: Yang, Q.,
Fan, L., Yu, H. (eds.) Federated Learning. LNCS (LNAI), vol. 12500, pp. 189–204. Springer,
Cham (2020). https://doi.org/10.1007/978-3-030-63076-8_14
https://doi.org/10.1109/JIOT.2021.3072611
https://doi.org/10.1109/MCOM.001.1900649
https://doi.org/10.1007/978-3-030-63076-8_9
https://doi.org/10.1007/978-3-030-63076-8_14
	A Novel Layered GSP Incentive Mechanism for Federated Learning Combined with Blockchain
	1 Introduction
	1.1 Contribution
	2 Related Work
	3 B-LSP in FL
	3.1 B-LSP Process
	3.2 Basic Cost Calculation Method
	3.3 Shapley Value and Smart Contract
	4 Theoretical Analysis
	5 Conclusion and Outlook
	References