Qin Y, Hu Q, Yu DX et al. Generous or selfish? Weighing transaction forwarding against malicious attacks in payment
channel networks. JOURNAL OF COMPUTER SCIENCE AND TECHNOLOGY 37(4): 888–905 July 2022. DOI
10.1007/s11390-022-2032-x
Generous or Selfish? Weighing Transaction Forwarding Against
Malicious Attacks in Payment Channel Networks
Yi Qin1 ( ), Qin Hu2,∗, Dong-Xiao Yu1 (), Senior Member, IEEE, and
Xiu-Zhen Cheng1 (), Fellow, IEEE
1School of Computer Science and Technology, Shandong University, Qingdao 266237, China
2Department of Computer and Information Science, Indiana University-Purdue University Indianapolis
Indianapolis 46202, U.S.A.
E-mail: qinyi@sdu.edu.cn; qinhu@iu.edu; {dxyu, xzcheng}@sdu.edu.cn
Received November 19, 2021; accepted June 8, 2022.
Abstract Scalability has long been a major challenge of cryptocurrency systems, which is mainly caused by the delay
in reaching consensus when processing transactions on-chain. As an effective mitigation approach, the payment channel
networks (PCNs) enable private channels among blockchain nodes to process transactions off-chain, relieving long-time
waiting for the online transaction confirmation. The state-of-the-art studies of PCN focus on improving the efficiency and
availability via optimizing routing, scheduling, and initial deposits, as well as preventing the system from security and
privacy attacks. However, the behavioral decision dynamics of blockchain nodes under potential malicious attacks is largely
neglected. To fill this gap, we employ the game theory to study the characteristics of channel interactions from both the
micro and macro perspectives under the situation of channel depletion attacks. Our study is progressive, as we conduct the
game-theoretic analysis of node behavioral characteristics from individuals to the whole population of PCN. Our analysis
is complementary, since we utilize not only the classic game theory with the complete rationality assumption, but also the
evolutionary game theory considering the limited rationality of players to portray the evolution of PCN. The results of
numerous simulation experiments verify the effectiveness of our analysis.
Keywords blockchain, payment channel network, game theory
1 Introduction
As Bitcoin 1○ prevails in the cryptocurrency mar-
ket, blockchain has received explosively increasing at-
tention from both academia and industry, making the
development of this distributed ledge technology ad-
vance greatly. By employing the decentralized cryp-
tocurrency system, financial transactions can be suc-
cessfully conducted without the help and management
of third-party centralized institutions but all by dis-
tributed blockchain nodes, providing transparency and
manipulation-proof experiences to users. However,
there exists one major disadvantage that it takes a
long time to achieve transaction confirmation among
a large number of peer-to-peer nodes, thus leading to
low scalability, e.g., Bitcoin handling seven transactions
per second, and impeding the large-scale application of
cryptocurrency in real-world applications. Even though
Ethereum operates with a relatively higher transaction
processing speed of 15 transactions per second [1], it is
still far below the needs in practice.
To solve this problem, the concept of payment chan-
nel has emerged recently to provide an off-chain trans-
action processing method, which is established between
two blockchain nodes with each depositing a certain
Regular Paper
Special Section of MASS 2020–2021
A preliminary version of the paper was published in the Proceedings of MASS 2021.
The work was partially supported by the National Key Research and Development Program of China under Grant
No. 2019YFB2102600, and the National Natural Science Foundation of China under Grant Nos. 62122042, 61971269 and 61832012.
∗Corresponding Author
1○Nakamoto S. Bitcoin: A peer-to-peer electronic cash system. https://bitcoin.org/bitcoin.pdf, Apr. 2022.
©Institute of Computing Technology, Chinese Academy of Sciences 2022
http://dx.doi.org/10.1007/s11390-022-2032-x
Yi Qin et al.: Weighing Transaction Forwarding Against Malicious Attacks 889
amount of funds for future instant transactions with-
out waiting for the global on-chain confirmation. Only
when the channel is closed will the latest state of the
balance be published on the main chain. By this means,
the blockchain system can process transactions in an ef-
ficient way. Further, with the help of Hashed Time-lock
Contract (HTLC) 2○, transactions can be completed
through multiple channels even if the sender and the
receiver nodes are not directly connected, forming the
payment channel network (PCN).
Existing studies about PCN mainly focus on sys-
tematic performance improvement, including the rout-
ing and scheduling algorithm design to improve the
transaction processing speed [2, 3], channel deposit op-
timization to extend the availability of channels [1, 4],
and security and privacy issues [5–9]. Nevertheless, the
node-level behavior and decision inspections are largely
overlooked, which turns out to be the essential proce-
dure affecting the formation and sustainability of PCN,
especially in the case of malicious attacks aiming at ex-
hausting channel deposits or isolating certain nodes.
In this paper, we analyze the PCN from the perspec-
tive of individual node’s decision on whether to help in
forwarding incoming transactions for others, with the
concern of potential malicious attacks depleting the bal-
ance of channels during the relaying process. Specifi-
cally, we employ the game theory to model the inter-
actions between connected nodes with the awareness of
various channel attacks, and analyze the behavior char-
acteristics of nodes from both the micro (individual)
and the macro (group) angles. Our study is progres-
sive as the individual behavior is first investigated in
the PCN game between any two adjacent channels, and
then the collective characteristics of all channels’ inter-
actions are uncovered in the evolutionary PCN game.
Our analysis is also complementary. We study the equi-
librium state and the powerful control strategy of indi-
vidual players, i.e., the zero-determinant (ZD) strategy,
in the realm of the classic game theory with the assump-
tion that all players are wise and intelligent enough;
then, we examine the evolutionarily stable points and
strategy by taking advantage of the evolutionary game
theory with the relaxed assumption of ideal game play-
ers. In summary, our main contributions can be listed
as follows.
• We establish a game-theoretic model, termed as
the PCN game, to capture the dynamic interactions
between blockchain nodes, based on which extensive
analysis is conducted to inspire a better PCN system
design.
• From the micro perspective, we study the Nash
equilibrium of the PCN game; afterwards, the existence
and the power of the ZD strategy regarding the unilat-
eral control of expected payoffs are explored in both
the infinite and the finite rounds of repetitive games to
cover all possible situations.
• From the macro perspective, we utilize the replica-
tion dynamic equation to derive the evolutionarily sta-
ble points of the generalized evolutionary PCN game,
and we also investigate the evolutionary stability of the
ZD strategy in a simple-to-complex manner, discussing
the case of playing against one other strategy and mul-
tiple other strategies to draw some insights on eliciting
mutual cooperation in the PCN.
• Extensive simulation experiments are carried out
with the observations indicating that the experimental
and analytical results are well-matched and therefore
our analysis is effective.
The organization of the rest paper is as follows. We
summarize related work in Section 2. We propose the
PCN game model in Section 3. And Section 4 analyzes
the Nash equilibrium and the applicability of the pow-
erful ZD strategy. Section 5 calculates the evolution-
arily stable points and the evolutionary stability of the
ZD strategy. Section 6 verifies the effectiveness of our
analysis by extensive simulation experiments. Section 7
concludes the whole paper.
2 Related Work
As representative PCNs, lightning network (LN) 2○
was designed for Bitcoin, while Raiden network 3○
was proposed as an off-blockchain scaling solution for
Ethereum. Many existing studies have been devoted to
improving the transaction speed and the success rate
in the PCN. Specifically, some of them focus on the
relationship between the topological structure and the
efficiency of transaction processing. The formation of
the PCN topology was analyzed in [10], showing that
the centralized structure can make the PCN more ef-
ficient and stable. Lange et al. [11] studied the attach-
ment strategies’ influence on the PCN topology, which
further affects the connectivity and the benefit of par-
ticipating nodes. There is also related literature fo-
2○The Bitcoin lightning network: Scalable off-chain instant payments, Jan. 2016. http://lightning.network/lightning-network-
paper.pdf, Apr. 2022.
3○https://raiden.network, Apr. 2022.
890 J. Comput. Sci. & Technol., July 2022, Vol.37, No.4
cusing on designing routing algorithms and transaction
scheduling mechanisms for a higher payment success
rate. A new routing algorithm for reducing the balance
skewness of channels was proposed in [2], which took
advantage of both the static and the dynamic routing
to improve the success rate while decreasing latency and
expense. Bagaria et al. designed a multi-path routing
scheme named Boomerang [3], which could build redun-
dant channels to eliminate the risk of participants not
performing transaction agreements.
In addition, the optimization of the channel bal-
ance has been widely studied because the depletion of
one-way funds can easily lead to the closure of channels
and result in higher costs for PCN nodes to re-establish
channels. Khalil and Gervais [4] proposed the first solu-
tion of rebalancing channels’ funds, and Pickhardt and
Nowostawski [12] continued to study the redistribution
of the balance to improve channels’ capacity, which laid
the foundation for processing more big transactions.
Besides, Li et al. [1] proposed an algorithm to determine
the best amount of initial funds put into the channels
to extend the channel lifetime and increase the number
of transactions that can be processed.
Recently, the security issue of PCN has received
great attention from researchers. Rohrer et al. [5]
demonstrated two attacks, namely exhausting channels
and isolating nodes attacks, where the detailed attack-
ing steps were presented with quantified success rates.
Lu et al. [13] proposed a low-cost attack named bank run
attack which can significantly reduce the transaction
capacity to paralyze the whole PCN. These attacks are
based on the principle of the griefing attack [8] which is
mounted by controlling a channel on the payment path
to refuse the contract and then locking the deposits of
each channel from the payer to the receiver for a pe-
riod of time. Harris and Zohar [9] presented a flood
and loot attack by creating multiple conflicting trans-
actions, which may cause the congestion of submitting
arbitration to blockchain, and thus the malicious nodes
are able to steal the funds before the victims receive ar-
bitration results. Other studies are committed to solv-
ing or mitigating malicious attacks in PCN. Banerjee
et al. [8] imposed a new HTLC protocol with a penalty
on the adversary to mitigate griefing attacks, which
has not been put in practice because the processing
speed has to be sacrificed in this solution. Some basic
defense mechanisms against the flood and loot attack
were also presented in [9] although the authors claimed
that the attack cannot be completely eliminated due to
the function of HTLC. For various private properties of
the PCN, i.e., channel, balance, routing, and payment,
Kappos et al. [6] analyzed the potential attacks. Tang
et al. [7] studied the trade-off between the privacy and
the utility in releasing noisy channel balances for the
shortest-path routing mechanism.
Given the variety of attacks in PCN without effec-
tive control schemes, the participation behavior of PCN
nodes can be unpredictable, which may negatively af-
fect the formation and the sustainability of PCN. The
recent work using the infinitely repeated game and the
evolutionary game with two strategies to model this
problem is studied in [14]. Considering the potential
attacks aiming at reducing the channel lifetime, we
model the interactions of PCN nodes and analyze the
characteristics of both individuals and groups by consi-
dering infinitely and finitely repeated games, as well
as two strategies (ZD strategy and one other strategy)
and multiple strategies (ZD strategy and multiple other
strategies) in the evolutionary game, so as to provide
a more scientific and comprehensive perspective with
some insights to enhance the system design of the PCN.
3 Game Formulation
To mitigate the challenge of blockchain scalability,
payment channels are established between two nodes
to process transactions in an off-chain manner. By us-
ing the deposits in the channel, both ends can con-
duct frequent transactions quickly. A PCN composed
of multiple channels allows payments to cross the chan-
nel network under the condition that the intermedi-
ate channels cooperate to forward transactions. Here
we represent the PCN as a graph G 〈V,E〉, where
V = {v1, v2, · · · , vN} denotes the set of nodes with
N denoting the total number of blockchain nodes in
the PCN and E = {e1, e2, · · · , eK} denotes the set of
payment channels with K being the total number of
channels. An exemplary PCN is illustrated in Fig.1.
Each intermediate node can decide whether to use
its own existing channel with the limited deposit to
assist in forwarding others’ transactions. Considering
that forwarding transactions is via a concrete channel
which has a certain amount of deposits available to be
used for transactions, we focus on the action of each
node in terms of deciding whether to forward a com-
ing transaction through a specific channel or not. In
detail, we consider the interactions between any pair
of adjacent channels with the choices of cooperation
and defection, denoted as C and D, respectively, which
can be modeled as a two-player game. Here the chan-
Yi Qin et al.: Weighing Transaction Forwarding Against Malicious Attacks 891
nel choosing strategy C will participate in forward-
ing transactions to help complete transactions between
non-adjacent nodes, while the channel with strategy D
will refuse to forward the coming transactions and only
use the deposits to meet its own transaction needs.
v
v
v
v
v
.
.
.
.
.
.
.
.
Fig.1. Example of the PCN. This graph contains five blockchain
nodes and four channels, and the numbers at both ends of the
channel represent the deposits invested by the nodes, which can
be used to conduct instant transactions between the connected
nodes. For example, there is a channel between v2 and v5 with
1.4 and 0.5 respectively, which means that v2 has the ability to
pay 1.4 to v5 immediately while v5 can pay 0.5 to v2 instantly.
Clearly, different behaviors bring different payoffs to
the channels in the PCN. To capture all possible situ-
ations, we define the parameters affecting any channel
ek’s payoff as follows.
• Natural Profit (denoted as rk). Compared with
processing a transaction on the blockchain, using the
payment channel can reduce block packing cost and
time delay for committing the transaction to the main
chain, which is defined as the natural profit of a chan-
nel.
• Profit from Helping Relay Transactions (denoted
as fk). When ek chooses strategy C, assisting in rout-
ing a neighbor’s transactions, it obtains some profits by
collecting transaction fees from the forwarded transac-
tions.
• Profit from Transactions Being Relayed by a
Neighbor (denoted as ak). When ek’s neighboring chan-
nel cooperates in relaying transactions from ek, it can
benefit from reducing the cost of sending these trans-
actions on-chain.
• Loss of Being Attacked (denoted as ck). General
attacks include but are not limited to denial-of-service,
channel exhaustion, and node isolation, which result in
cooperative channels’ funds being locked for a period
of time or even being terminated, thus leading to eco-
nomic loss.
For the simplicity and the brevity of expression, we
consider two adjacent channels ex, ey ∈ E, which have
a point of the intersection node in the PCN. Both ex
and ey can select either C or D, which means that they
will relay transactions for each other or not respectively.
The four strategy combinations for channels ex and ey
generate different payoffs as follows. 1) When ex and
ey cooperate concurrently, they both obtain transaction
fees and payoffs from their own transactions being re-
layed. And they also need to bear the potential losses
caused by malicious attacks. Thus, ex and ey obtain
payoffs rx + fx + ax − cx and ry + fy + ay − cy, respec-
tively. 2) If ex chooses cooperation while ey chooses
defection, ex does not get the benefit of transaction de-
mand being satisfied by ey, and ey cannot collect trans-
action fees but avoid potential loss cy, so that ex can
obtain rx + fx − cx while ey has payoff ry + ay. 3)
On the contrary, when ex defects but ey cooperates, ex
obtains rx + ax and ey gains ry + fy − cy. 4) In the
case that both ex and ey choose defection, they cannot
meet transaction needs of each other; therefore, they
only have the basic payoffs rx and ry. Subsequently,
channels’ payoff vectors can be denoted as follows.
Sx = (S1
x, S
2
x, S
3
x, S
4
x)T =

rx + fx + ax − cx
rx + fx − cx
rx + ax
rx
 ,
Sy = (S1
y , S
2
y , S
3
y , S
4
y)T =

ry + fy + ay − cy
ry + ay
ry + fy − cy
ry
 .
(1)
And the payoff matrix is shown in Fig.2.
Cooperation
Defection
Cooperation Defection
ey
ex
ry+fy+ay-cy
rx+fx+ax-cx
ry+ay
rx+ax
ry+fy-cy
rx+fx-cx
ry
rx
Fig.2. Payoff matrix of two adjacent channels in the PCN.
Definition 1 (PCN Game). In the PCN game, any
two adjacent channels ex and ey as players can choose
strategies C and D, indicating whether the channels
participate in forwarding transactions or not, and get
payoffs Sx and Sy, respectively.
892 J. Comput. Sci. & Technol., July 2022, Vol.37, No.4
In the following, we first study the problem of dom-
inant interest in the interactions between any pair of
channels from a micro perspective, which can reveal
some clues about the optimal actions of individual play-
ers in the PCN game. After that, we study the evolu-
tion process of the PCN game from a macro perspec-
tive to show the overall behavior trend, which may help
us understand the collective characteristics of the PCN
and thus direct us to better design and use it.
4 Microscopic Analysis of PCN Game
In this section, we study the interactions between
any two adjacent channels in the PCN game as defined
above from a microscopic perspective. Specifically, we
first analyze the Nash equilibrium of the PCN game,
and then investigate a powerful control strategy under
both the infinitely and the finitely repeated game sce-
narios.
4.1 Nash Equilibrium
Given the payoff matrix defined in Section 3, we can
derive the Nash equilibrium in two different parameter
cases.
Theorem 1. When cx < fx and cy < fy, a Nash
equilibrium is reached when both ex and ey choose strat-
egy C.
Proof. To derive the Nash equilibrium in the two-
player game, we can start from focusing on the best
action of one of the players. In our problem, we first
study the optimal strategy of channel ex by considering
all possible actions of ey. When ey chooses strategy C,
ex’s payoff of choosing strategy C is more than that of
choosing strategy D since rx + fx + ax − cx > rx + ax
given the condition cx < fx. When ey chooses strategy
D, ex’s payoff of choosing strategy C is more than that
of choosing strategy D according to rx + fx − cx > rx.
Thus, no matter whether channel ey chooses strategy
C or D, ex prefers cooperation to obtain the better
payoff. In the same way, we can conclude that ey will
choose cooperation for more payoffs. Therefore, both
players in the game choosing cooperation constitute a
Nash equilibrium. �
Theorem 2. If cx > fx and cy > fy, there is
a Nash equilibrium when both channels choose strategy
D.
The proof of Theorem 2 is similar to that of The-
orem 1. For the sake of brevity, we omit the details
here.
4.2 Control Analysis of Zero-Determinant
Strategy
The emergence of the zero-determinant (ZD) strat-
egy allows a player to unilaterally enforce a linear re-
lationship between the payoffs of its own and the op-
ponents, regardless of the opponent strategy [15]. In
the PCN, since a large number of transactions need
to be processed, there are long-term interactions be-
tween channels, and the result of the strategy choice
will leave an impact on the next round of interaction.
Under the condition of ex and ey choosing strategy pro-
file (CC,CD,DC,DD) in the previous round, we de-
fine ex’s mixed strategy as p = (p1, p2, p3, p4), where
each component represents the probability of choosing
cooperation correspondingly. And ey’s mixed strategy
is denoted as q = (q1, q2, q3, q4) analogously.
With the above definitions of p and q, the process
of the repeated game can be regarded as a Markov de-
cision process, and its transition matrix M is expressed
as
M
=

p1q1 p1(1− q1) (1− p1)q1 (1− p1)(1− q1)
p2q3 p2(1− q3) (1− p2)q3 (1− p2)(1− q3)
p3q2 p3(1− q2) (1− p3)q2 (1− p3)(1− q2)
p4q4 p4(1− q4) (1− p4)q4 (1− p4)(1− q4)
 . (2)
Let v be the stable vector of the above transition
matrix. According to [15], after the determinant ele-
mentary transformation and based on Cramer’s rule,
the dot product of v and any vector f = (f1, f2, f3, f4)
is
v · f = G(p, q,f)
= det

−1 + p1q1 −1 + p1 −1 + q1 f1
p2q3 −1 + p2 q3 f2
p3q2 p3 −1 + q2 f3
p4q4 p4 q4 f4
. (3)
Besides, the expected payoffs of channels ex and ey can
be calculated as follows:
Ex =
v · Sx
v · 1
=
G(p, q,Sx)
G(p, q,1)
,
Ey =
v · Sy
v · 1
=
G(p, q,Sy)
G(p, q,1)
,
(4)
where 1 is a unit vector with four elements being 1.
We can find the payoffs in (4) are linearly related with
their payoff vectors. Hence, when computing a linear
Yi Qin et al.: Weighing Transaction Forwarding Against Malicious Attacks 893
combination of the above two expected payoffs, with α,
β, and γ being constant parameters, we have
αEx + βEy + γ
=
v · (αSx + βSy + γ1)
v · 1
=
G(p, q, αSx + βSy + γ1)
G(p, q,1)
. (5)
And (5) can be calculated by substituting f in (3) with
αSx+βSy +γ1 in the numerator and 1 in the denomi-
nator. By observing (3), we can realize that the second
and the third columns of the determinant are only re-
lated to the strategies of ex and ey, respectively, which
means both ex and ey are capable of choosing strate-
gies to make one column proportional to f , resulting in
the determinant being zero. Taking ex as an example,
if its strategy p makes the second column of (3) pro-
portionate to αSx + βSy + γ1, then the numerator in
(5) becomes zero. Therefore, the linear combination of
the two payoffs, i.e., αEx +βEy +γ = 0, is established.
Without the loss of generality, we continue to assume
that ex uses the ZD strategy as an exemplary case in
the following.
4.2.1 Analysis of ey’s Payoff
When α = 0, Ey = −γ/β holds, which means that
ex’s strategy p makes the second column of (3) equal to
βSy + γ1, ex can unilaterally set ey’s expected payoff
Ey. Specifically, p can be solved by the following four
equations,
p1 = 1 + β(ry + fy + ay − cy) + γ,
p2 = 1 + β(ry + ay) + γ,
p3 = β(ry + fy − cy) + γ,
p4 = βry + γ.
Then p2 and p3 can be resolved with p1 and p4 to elim-
inate parameters β and γ,
p2 =
p1(S2
y − S4
y)− (1 + p4)(S2
y − S1
y)
S1
y − S4
y
=
p1ay − (1 + p4)(cy − fy)
fy + ay − cy
,
p3 =
(1− p1)(S4
y − S3
y) + p4(S1
y − S3
y)
S1
y − S4
y
=
(1− p1)(cy − fy) + p4ay
fy + ay − cy
.
(6)
Therefore ey’s expected payoff is:
Ey =
(1− p1)ry + p4(ry + fy + ay − cy)
(1− p1) + p4
. (7)
Now we discuss the controlling results of the ZD strat-
egy with different parameter settings.
Theorem 3. If cy < fy, we divide the situation
into two cases according to the relationship between
fy − ay and cy: 1) if cy > fy − ay, ex can control
Ey ∈ [ry + fy − cy, ry + ay]; 2) if cy 6 fy − ay, ex
cannot set Ey’s range unilaterally.
Proof. By observing (7), Ey is the weighted average
of ry and ry+fy+ay−cy, and the weights are 1−p1 and
p4 respectively. We can re-express Ey as ry +
fy+ay−cy
1+λ
with λ = 1−p1
p4
. Since both p1 and p4 belong to (0,1),
λ cannot be negative. Under the condition of cy < fy,
p2 > 0 and p3 6 1 are satisfied with any feasible p1 and
p4. Subsequently, we calculate the constraints p2 6 1
and p3 > 0, and obtain
λ >
fy − cy
ay
,
λ 6
ay
fy − cy
.
When cy > fy − ay, λ has solutions and Ey is inversely
proportional to λ. Therefore we get the maximum Ey
when λ =
fy−cy
ay
, and the minimum Ey with λ =
ay
fy−cy .
While if cy 6 fy − ay, there is not a feasible solution
or no more than one fixed value; therefore ex cannot
control Ey’s range. �
Theorem 4. If cy > fy +ay, ex cannot unilaterally
set Ey’s range.
Proof. According to (6), 0 6 p2, p3 6 1 can only be
met at a single point of p = (1, 1, 0, 0) in the case of
cy > fy + ay. Thus, ex cannot control Ey’s range. �
Theorem 5. In the case of fy < cy < fy + ay,
if p4 ∈ (0,
ay+fy−cy
cy−fy+ay ), Ey has the minimum value of
ry +
p4ay
1+p4
; if p4 ∈ (
ay+fy−cy
cx−fx+ax ,
ay+fy−cy
ay
), Ey has the
minimum value of ry +
p4(cy−fy)
1−p4 . In addition, Ey is ry
when p4 = 0 and p1 6= 1, and Ey has a maximum value
of ry + fy + ay − cy when p1 = 1 and p4 6= 0.
Proof. Because of ry < ry+fy+ay−cy in this case,
the larger the parameter λ is, the smaller the payoff Ey
is. To derive the minimum value of Ey, we need to cal-
culate the maximum value of λ under the constraints
of p1, p2, p3 and p4 belonging to [0, 1]. For any feasible
p1 and p4, two inequalities are naturally satisfied, i.e.,
p2 6 1 and p3 > 0. Thus, we only need to focus on the
conditions of making p2 > 0 and p3 6 1, which leads to
λ 6
ay + fy − cy
ayp4
− cy−fy
ay
,
λ 6
ay + fy − cy
(cy − fy)p4
− ay
cy−fy .
894 J. Comput. Sci. & Technol., July 2022, Vol.37, No.4
Because these two inequalities need to be satisfied at
the same time, we need to compare the values of two
expressions on the right side of the inequalities and
take the smaller one as the maximum value of λ. Sub-
tracting the second expression from the first one, we
can get a function of p4 that can be expressed as
f(p4) =
cy−fc−ay
ay(cy−fy) (
fy+ay−cy
p4
+fy−ay−cy). Since λ > 0,
we can derive the domain of f(p4) as p4 ∈ (0,
ay+fy−cy
ay
).
By calculating the first derivative of f(p4), we can ob-
tain that f(p4) is a monotonically increasing function
with a zero point p4 =
ay+fy−cy
cx−fx+ax , which means when
p4 ∈ (0,
ay+fy−cy
cy−fy+ay ), we have f(p4) 6 0, and thus the
first inequality limits a smaller value of λ; while if
p4 ∈ (
ay+fy−cy
cx−fx+ax ,
ay+fy−cy
ay
), f(p4) > 0 and we know that
the second inequality becomes the limits of λ. Given
the maximum λ, we can get Ey’s minimum value as
ry +
p4ay
1+p4
and ry +
p4(cy−fy)
1−p4 . Finally, two special cases
are considered. When p4 = 0 and p1 6= 1, according to
(7), there exists Ey = ry. And when p1 = 1 and p4 6= 0,
which means λ = 0, we have Ey with a maximum value
of ry + fy + ay − cy. �
4.2.2 Analysis of ex’s Payoff
Specifically, ex may set β = 0, yielding Ex = −γ/α.
In this way, ex can set its own expected payoff uni-
laterally without any impact of ey’s strategy. Through
the analogous calculation with the second column of (3)
equal to αSx + γ1, we can express p2 and p3 with p1
and p4 as follows:
p2 =
(1 + p4)(S1
x − S2
x)− p1(S4
x − S2
x)
S1
x − S4
x
=
(1 + p4)ax − p1(cx − fx)
fx + ax − cx
,
p3 =
−(1− p1)(S3
x − S4
x)− p4(S3
x − S1
x)
S1
x − S4
x
=
−(1− p1)ax − p4(cx − fx)
fx + ax − cx
.
By calculating the expressions of α and γ, we have
Ex =
(1− p1)rx + p4(rx + fx + ax − cx)
(1− p1) + p4
. (8)
Then we consider the scope limitation under different
parameter cases.
Theorem 6. When cx < fx, we can derive two
types of results according to the relationship between
fx − ax and cx: 1) when cx < fx − ax, ex can control
Ex ∈ [rx+ax, rx+fx−cx]; 2) in the case of cx > fx−ax,
ex cannot set the range of Ex unilaterally.
Theorem 7. When cx > fx + ax, if
p4 ∈ (0, cx−fx−axcx−fx+ax ), the maximum of Ex is rx+
p4(cx−fx)(fx+ax−cx)
(1+p4)(cx−fx−ax) , while if p4 ∈ ( cx−fx−axcx−fx+ax ,
cx−fx−ax
cx−fx ), the maximum of Ex is rx+ p4ax(fx+ax−cx)
(1−p4)(cx−fx)−ax .
And in the case of p1 = 1, p4 6= 0, the minimum value
of Ex is rx + fx + ax − cx, and if p4 = 0, p1 6= 1, the
maximum value of Ex is rx.
Theorem 8. When fx < cx < fx + ax, ex cannot
unilaterally set its own payoff range.
The proofs of the Theorems 6–8 are similar to those
of Theorems 3–5, which are omitted here to avoid re-
dundancy.
4.3 Existence of Zero-Determinant Strategy in
Finitely Repeated Games
Most of the existing researches on the ZD strategy
are carried out in the scenario of infinitely repeated
games. While in our considered PCN game, it can be
observed that the channels are bound to exhaust the
preallocated deposits and then deconstruct the pay-
ment channels temporarily or permanently from the
PCN. In this subsection, we consider a more realistic
scenario where channels are playing finitely repeated
games with each other, and then the new version of the
ZD strategy in this case is analyzed.
We define a discount factor ω ∈ (0, 1) to present the
probability of a next game round taking place given
the current round. Then ωn is the probability for the
occurrence of the n-th round and the probability that
the next round does not happen is 1 − ω. We give the
probability of cooperation of any two players in the t-th
round (t ∈ {0, 1, 2, · · · }) game with different combina-
tions of strategies as
u(t) = (uCC(t), uCD(t), uDC(t), uDD(t)),
where uCC(t) is the probability that both players co-
operate in round t, uCD(t) is the probability that ex
cooperates and ey defects in round t, and so forth. The
normalization is given by uCC(t) + uCD(t) + uDC(t) +
uDD(t) = 1. We refer to the first round of the re-
peated game as round 0 and denote the cooperation
probabilities of ex and ey in the first round as ηx and
ηy respectively. The initial probability corresponding
to different states is
u(0) = (ηxηy, ηx(1− ηy), (1− ηx)ηy, (1− ηx)(1− ηy)).
Then the expected payoff of channel ex in round t can
be calculated by u(t)Sx, and thus, the expected per-
round payoff of ex in the finitely repeated game is the
Yi Qin et al.: Weighing Transaction Forwarding Against Malicious Attacks 895
accumulated expected payoffs until the t-th round di-
vided by the number of rounds, which is
Ex =
∑∞
t=0 ω
tu(t)Sx
(1− ω)−1
= (1− ω)
∞∑
t=0
ωtu(t)Sx.
Given the state transition probability matrix M in
(2), we have u(t) = u(0)M t. By substituting u(t) and
calculating the limit of the summation M t, the above
equation can be further written as
Ex = (1− ω)u(0)
∞∑
t=0
(ωM)tSx
= (1− ω)u(0)(I − ωM)−1Sx,
where I is a 4×4 identity matrix. Similarly, the ex-
pected per-round payoff of ey is given by
Ey = (1− ω)u(0)(I − ωM)−1Sy. (9)
Similar to the infinitely repeated game, we study the
case of ex using the ZD strategy as an example to
make a linear relationship between the payoffs hold,
i.e., αEx + βEy + γ = 0. Via setting α = 0, ex can
control Ey, and with β = 0, ex can control its own pay-
off Ex. Considering that ey’s strategy has no impact
on the effectiveness of ZD, we set q = (1, 1, 1, 1) and
q = (0, 0, 0, 0) to calculate ex’s strategy.
4.3.1 Analysis of ey’s Payoff
As mentioned earlier, Ey = −γ
β . When ey adopts
strategies q = (1, 1, 1, 1) and q = (0, 0, 0, 0), we de-
note the matrix in (2) as My,1111 and My,0000, respec-
tively. Then, referring to (9) we have (1 − ω)u(0)(I −
ωMy,0000)−1 = (1 − ω)u(0)(I − ωMy,1111)−1 for any
ηy ∈ [0, 1]. According to the conclusion in [16], we can
derive p2 and p3 as follows:
p2 =
p1ay − ( 1
ω + p4)(cy − fy)
fy + ay − cy
,
p3 =
( 1
ω − p1)(cy − fy) + p4ay
fy + ay − cy
.
(10)
By substituting p in (9) we can obtain
Ey =
(1− ω̄ηx − ωp1)S4
y + (ω̄ηx + ωp4)S1
y
1− ωp1 + ωp4
,
which is clearly independent of the strategy and the
initial cooperation probability of ey, i.e., q and ηy. In
the above equation, ω̄ = 1 − ω for brevity. This equa-
tion indicates that ex’s control over Ey depends on the
value of ηx, ω, and p. Besides, ω is related to the
expected number of repeated rounds in the finitely re-
peated game. In the following, we identify the condition
for ω under which the ZD strategy exists. According to
(10), we can see that the ZD strategy exists if and only
if
0 6 p1ay −
(
1
ω
+ p4
)
(cy − fy) 6 fy + ay − cy, (11)
and
0 6
(
1
ω
− p1
)
(cy − fy) + p4ay 6 fy + ay − cy, (12)
for 0 6 p1, p4 6 1 and fy +ay− cy > 0. If cy > fy +ay,
by calculating 0 6 p2, p3 6 1, we have ω > 1 and the
ZD strategy does not work. Therefore, we only need to
analyze the limitation that fy + ay > cy as following.
Theorem 9. When cy < fy, ω needs to be satisfied
as ω > fy−cy
fy+ay−cy .
Proof. In this case, we can figure out
ω >
fy − cy
(1− p1)ay + (1− p4)(fy − cy)
,
ω >
fy − cy
p1(fy − cy) + p4ay
.
ω must be greater than the minimum values on the
right side of the two inequalities. Therefore, we obtain
the condition of ω > fy−cy
fy+ay−cy . �
Theorem 10. When fy < cy < fy + ay, the basic
condition ω needs to meet is ω > cy−fy
ay
.
Proof. Any effective assignments of p1 and p4 satisfy
the second inequality of (11) and the first inequality of
(12), thereby we focus on the other two inequalities,
respectively. We have
ω >
cy − fy
p1ay − p4(cy − fy)
,
ω >
cy − fy
(p1 − 1)(cy − fy) + (1− p4)ay
.
Under the most relaxed conditions, ω needs to be
greater than the minimum on the right side of the in-
equalities. Obviously, both inequalities have a mini-
mum of
cy−fy
ay
. �
4.3.2 Analysis of ex’s Payoff
We continue to analyze player ex trying to unilat-
erally set its own payoff in the finitely repeated game.
By setting β = 0, ex sets its own payoff, at this point,
896 J. Comput. Sci. & Technol., July 2022, Vol.37, No.4
Ex is independent of ey’s strategy, and p2 and p3 can
be expressed as follows:
p2 =
( 1
ω + p4)ax − p1(cx − fx)
fx + ax − cx
,
and
p3 =
−( 1
ω − p1)ax − p4(cx − fx)
fx + ax − cx
.
Further, the payoff of ex becomes
Ex =
(1− ω̄ηx − ωp1)S4
x + (ω̄ηx + ωp4)S1
x
1− ωp1 + ωp4
,
which is only dependent on the strategy and initial
cooperation probability of ex, i.e., p and ηx. Then we
identify the condition for ω under which the ZD strat-
egy works. p2 and p3 must be in the range of [0, 1] on
the condition that p1 and p4 also fall into this range,
thereby we have
0 6
(
1
ω
+ p4
)
ax − p1(cx − fx) 6 fx + ax − cx,
and
0 6 −
(
1
ω
− p1
)
ax − p4(cx − fx) 6 fx + ax − cx.
When fx < cx < fx + ax, ω has a minimum of 1, which
does not satisfy the condition for a finite number of
repetitions. Therefore we study the other two cases as
follows.
Theorem 11. When cx < fx, ω needs to be satis-
fied as ω > ax
fx+ax−cx .
Theorem 12. When cx > fx + ax, the condition of
ω > ax
cx−fx should be satisfied.
The proof of these two theorems is similar to those
of the previous Theorem 9 and Theorem 10, and thus
we omit them for brevity.
5 Macroscopic Analysis of PCN Game
Generally, since there are a number of channels in
PCN, they can be regarded as a population, where each
channel interacts with the adjacent channels in a con-
tinuous manner. By investigating the large number
of two-player PCN games between each pair of adja-
cent channels, we can study the evolution of the whole
population with the help of the evolutionary game the-
ory, which is termed as the evolutionary PCN game.
Specifically, we analyze the state that the entire popu-
lation can reach from two aspects: replication dynamic
analysis and the evolutionary stability of the ZD strat-
egy.
5.1 Replication Dynamic Analysis
A channel is defined as an evolutionary player if
it adjusts strategies such as cooperation or defection
according to some optimization scheme to maximize
its payoff. In this paper, we use the Fermi evolution-
ary rule [17, 18] as an update rule of channels’ strategies,
which is based on the assumption that players’ strate-
gies in an evolutionary game obtain more payoffs by im-
itating neighbors’ strategies and converging to a stable
state. The specific manifestation of this rule is that all
the channels in the evolutionary PCN game, randomly
select one adjacent channel to compare their payoffs and
decide whether or not to learn this neighbor’s strategy
after each round of the game. Following the update
rule, the final channels’ payoffs and strategies reach a
stable state. In this case, we want to figure out what
state the channels will converge to during the evolution
process and the effect of the parameters on the stable
state.
Theoretical Analysis. The replication dynamics can
well describe how players in a game gradually achieve
the stability of their strategies by imitating and learn-
ing the strategies of their opponents. In the following,
we use this method to study the stable state of strate-
gies in the evolutionary PCN game.
We assume that θ is the percentage of channels
choosing the cooperation strategy and then 1 − θ is
the percentage of channels adopting the defection strat-
egy. In other words, in the evolutionary PCN game,
the probability of each participant channel, e.g., ez, en-
countering the opponent with the strategy C is θ, and
the probability of encountering the opponent with the
strategy D is 1−θ. We define the payoff vector of ez as
Sz = (S1
z , S
2
z , S
3
z , S
4
z )T, corresponding to the payoff of
ez when the strategy combinations of ez and its oppo-
nents are (CC,CD,DC,DD), which can be similarly
defined according to (1),
Sz =

rz + fz + az − cz
rz + fz − cz
rz + az
rz
.
Then the expected payoff of ez choosing cooperation,
denoted as ECz , can be expressed as the weighted sum
of S1
z and S2
z corresponding to the strategies of ez and
the opponent being CC, and CD, where the probabi-
lities of the two cases are θ and 1−θ, respectively. Thus,
we have
ECz = θS1
z + (1− θ)S2
z .
Yi Qin et al.: Weighing Transaction Forwarding Against Malicious Attacks 897
While if ez chooses defection, ez and any opponent can
produce strategy combinations of DC and DD. Then
we can calculate the expected payoff of ez choosing de-
fection, denoted as EDz , based on S3
z and S4
z as follows,
EDz = θS3
z + (1− θ)S4
z .
As a random player, ez also adopts C and D with the
probabilities θ and 1 − θ, respectively, leading to its
average expected payoff being expressed as
Êz = θECz + (1− θ)EDz .
According to Malthusian replication dynamic
equation [19], the growth rate of θ, denoted as F (θ),
can be expressed by:
F (θ) = θ(ECz − Êz) = θ(1− θ)(fz − cz), (13)
which is based on the fact that the higher the payoff
brought by the strategy C for any player, the higher
the growth rate of the percentage of channels adopting
the strategy C.
Given F (θ∗) = 0, we name that θ∗ is the evolu-
tionary stable solution of the replication dynamic equa-
tion if F ′(θ∗) < 0. It means that even any accidental
changes in the strategies of some players make θ devi-
ate from θ∗, the replication dynamic can restore θ to
θ∗. In mathematics, this is equivalent to that when
θ < θ∗, the dynamic equation leads to F (θ) > 0 in
order to guarantee θ’s increasing trend. On the con-
trary, if θ > θ∗, then F (θ) < 0 has to hold to make θ
decline. Therefore the derivative of F (θ) must be less
than zero in the steady state θ∗. Therefore, we calcu-
late the equilibrium points by setting F (θ) = 0, which
has two feasible solutions, i.e., θ1 = 0, and θ2 = 1. And
we can calculate the derivative of F (θ) as
F ′(θ) = (1− 2θ)(fz − cz). (14)
Theorem 13. If cz < fz, θ = 1 is an evolutionarily
stable point of the evolutionary PCN game.
Proof. When cz < fz, there exists F (θ) > 0 for any
θ ∈ (0, 1) according to (13), which indicates that θ in-
creases over time until θ = 1. By substituting θ = 1 into
(13) and (14), we have F (1) = 0 and F ′(1) < 0. There-
fore, θ = 1 is the evolutionarily stable point in this
case. If some channels’ strategies accidentally change
to D leading to θ < 1, the growth rate F (θ) > 0 makes
θ increase toward 1. �
Theorem 14. If cz > fz, θ = 0 is an evolutionarily
stable point of the evolutionary PCN game.
Proof. In the case of cz > fz, F (θ) < 0 holds for
θ ∈ (0, 1) referring to (13), and θ is decreasing over
time as long as there are channels choosing C in the
PCN. When θ = 0, we can calculate F (0) = 0 and
F ′(0) = fz − cz < 0 from (13) and (14). Therefore
θ = 0 is the evolutionarily stable point when cz > fz.
If there are few mutations of channels’ strategies result-
ing in θ > 0, these channels will update their strategies
to bring θ back to 0 gradually owing to the growth rate
F (θ) < 0. �
Theorem 15. If cz = fz, the current system is in
a stable state.
Proof. When cz = fz, F (θ) = 0 is always true,
which means that the change rate of θ is 0; therefore
each channel in the PCN does not change its strategy,
and the initial state remains stable. �
5.2 Evolutionary Stability of ZD Strategy
In this subsection, we explore the evolutionarily sta-
ble strategy (ESS) of the evolutionary PCN game with
the involvement of the ZD strategy. In order to scien-
tifically reveal the stability of the ZD strategy in popu-
lation and comprehensively understand the role of the
ZD strategy in the evolutionary game, we consider two
cases: 1) there is only one other strategy in the popu-
lation of channels besides the ZD strategy, and 2) there
exist multiple strategies in the population in addition to
the ZD strategy. To carry out the analysis in a simple-
to-complex way, we first investigate the case of the ZD
strategy vs one other strategy, and then the case of the
ZD strategy vs multiple other strategies in the follow-
ing.
5.2.1 ZD vs One Other Strategy
In the evolutionary PCN game involving the ZD
strategy, we first consider that there are two types of
strategies for channels, i.e., the ZD strategy and the
other well-known strategies (denoted as OT). For a
strategy T to be an ESS, it has to satisfy the following
definition [20].
Definition 2 (Evolutionarily Stable Strategy). T is
an ESS if for an arbitrary strategy J 6= T , there exists
either E(T, T ) > E(J, T ), or E(T, T ) = E(J, T ) and
E(T, J) > E(J, J), where the profit function E(T, J) is
the payoff of the player with strategy T when playing
against the other one taking strategy J .
We define the channel choosing the ZD strategy
as eZD, and its mixed strategy is denoted as p̃ =
(p̃1, p̃2, p̃3, p̃4). Similarly, a channel adopting OT is
expressed as eOT, and its strategy is denoted as q̃ =
898 J. Comput. Sci. & Technol., July 2022, Vol.37, No.4
(q̃1, q̃2, q̃3, q̃4). Here we consider four classical strate-
gies as examples, including the unconditional defec-
tion (ALLD), unconditional cooperation (ALLC), win-
stay-lose-shift (WSLS) and tit-for-tat (TFT) strategies.
When eOT chooses the ALLD strategy, q̃ = (0, 0, 0, 0);
when eOT chooses the ALLC strategy, q̃ = (1, 1, 1, 1);
when eOT chooses the WSLS strategy, q̃ = (1, 0, 0, 1);
and if eOT chooses the TFT strategy, q̃ = (1, 0, 1, 0).
Next, under several strategies introduced above,
when ZD players choose to control the opponents’ or
their own payoffs, we can analyze ZD’s ESS features in
the evolutionary PCN game as follows.
1) Analysis of eOT’s Payoff. The payoffs of channels
playing against eZD are determined by p̃1 and p̃4, such
as Ey in (7). When eZD plays the game with eOT, we
have eOT’s payoff
E(OT, ZD)
=
(1− p̃1)rOT + p̃4(rOT + fOT + aOT − cOT)
(1− p̃1) + p̃4
,
and eZD’s payoff
E(ZD, OT) =
G(p̃, q̃,SZD)
G(p̃, q̃,1)
,
which is dependent on both players’ strategies, and can
be calculated using (3). Since the above equation can
be over-length, we do not fully expand the expression
here. We know that eZD enforces the payoff regard-
less of the opponent’s strategy, which implies that it
also enforces this on another ZD player. Therefore,
when the opponent takes the ZD strategy, we have
E(ZD, ZD) = E(OT, ZD). When eOT plays the game
with another eOT, the payoff of eOT changes according
to what the specific OT strategy eOT adopts. In de-
tail, when OT is the ALLD strategy, E(OT, OT) = rOT.
When OT is the ALLC strategy or the WSLS strategy,
E(OT, OT) = rOT + fOT + aOT − cOT. When OT is the
TFT strategy, E(OT, OT) = rOT+(fOT+aOT−cOT)/2.
Here we have the payoff vectors SZD,SOT for eZD and
eOT, respectively, which represent their respective pay-
offs under different combinations of strategies.
In the above cases, we compare the relationship be-
tween different payoffs to determine which strategy is
the ESS.
Theorem 16. If E(ZD, OT) > E(OT, OT), the ZD
strategy is ESS. If E(ZD, OT) < E(OT, OT), the opposing
strategy is ESS.
Proof. When eZD chooses to set the opponent’s pay-
off, both eOT and eZD who play with eZD have the pay-
off controlled by eZD, thereby the payoffs E(ZD, ZD) and
E(OT, ZD) are equivalent. We determine the existence
of ESS by using the second condition in Definition 2.
In our case, only when E(ZD, OT) > E(OT, OT), ZD is
the ESS and vice versa. �
2) Analysis of eZD’s Payoff. We denote eZD’s payoff
according to (8) as
E(ZD, OT) =
(1− p̃1)rZD + p̃4(rZD + fZD + aZD − cZD)
(1− p̃1) + p̃4
,
while E(ZD, ZD) = E(ZD, OT). And the payoff of eOT
playing against eZD is denoted as
E(OT, ZD) =
G(p̃, q̃,SOT)
G(p̃, q̃,1)
.
The payoff of eOT against another eOT is E(OT, OT),
and its value is decided by the specific OT strategy
adopted. Similarly, the determination of the ESS de-
pends on the four payoffs of both sides in the game.
Theorem 17. If E(ZD, OT) > E(OT, ZD), or
E(ZD, OT) = E(OT, ZD) and E(ZD, OT) > E(OT, OT), the
ZD strategy is the ESS. If E(OT, OT) > E(ZD, OT), or
E(OT, OT) = E(ZD, OT) and E(OT, ZD) > E(ZD, ZD), the
opposing strategy is the ESS.
The procedure of the proof is similar to that of The-
orem 16, thereby we omit it for brevity.
5.2.2 ZD vs Multiple Other Strategies
In Subsection 5.2.1, we analyze the evolutionar-
ily stable strategies between the ZD strategy and one
other well-known strategy. However, in reality, diffe-
rent channels may choose different strategies in order to
achieve high payoffs, resulting in multiple other strate-
gies coexisting in the population. Therefore, in this
subsection, we consider whether the ZD strategy can
maintain the stability in the process of population evo-
lution by controlling ZD players’ opponents’ payoffs or
ZD players’ own payoffs given the existence of multi-
ple other strategies. We assume that the number and
the distribution of channels with different strategies are
uniform in the population, and the probability of each
channel encountering different opponents with different
strategies is the same. At the end of each round of the
game, all channels utilize the Fermi evolutionary rule
to update their strategies to attain higher payoffs in the
next round of the game. As the repeated game evolves,
the strategy selection of channels in the population will
be stable. If it turns out to be a single strategy dom-
inating the whole population, the final output of the
evolutionarily stable strategy is similar to what we stu-
died in Subsection 5.2.1; or there may be a mixed evo-
lutionarily stable state of multiple strategies.
Yi Qin et al.: Weighing Transaction Forwarding Against Malicious Attacks 899
We study the performance of eZD in terms of con-
trolling the opponent’s and its own payoffs when there
are multiple different strategies {OT1,OT2, ...,OTk}
with the number of other strategies k > 2 in the popu-
lation besides the ZD strategy. In the following, we
discuss two situations where eZD is utilized to set up
its opponent’s and its own payoffs.
1) Analysis of eOT’s Payoff. When eZD unilater-
ally controls the benefits of its opponents, any chan-
nel in the PCN that plays a game with eZD receives
the same average expected payoff, including eZD, i.e.,
E(ZD, ZD) = E(OTi, ZD), ∀i ∈ {1, 2, ..., k}. Then we
explore the constraints that need to be satisfied when
different strategies are evolutionarily stable strategies
in the population.
Theorem 18. If there exists
∑k
j=1E(ZD, OTj) >∑k
j=1E(OTi, OTj), ∀i ∈ {1, 2, ..., k}, the ZD strategy
is the ESS. If
∑k
j=1E(OTi, OTj) >
∑k
j=1E(ZD, OTj)
and
∑k
j=1E(OTi, OTj) >
∑k
j=1E(OTm, OTj), ∀m ∈
{1, 2, ..., k},m 6= i, the OTi strategy is the ESS.
Proof. In each round of the game, we assume that
the total number of games between each channel and
adjacent channels is t, and each channel has the same
probability of interaction with channels of other strate-
gies. Therefore, the expected payoff of the channels
with different strategies can be denoted as
EZD =
t
k + 1
E(ZD, ZD) +
k∑
j=1
E(ZD, OTj)
 ,
EOTi =
t
k + 1
E(OTi, ZD) +
k∑
j=1
E(OTi, OTj)
 .
Channels randomly select an adjacent channel at
the end of each round and compare their pay-
offs to determine whether to imitate the opponent’s
strategy. Therefore, when eZD’s expected payoff
is higher than that of other strategies, the ZD
strategy is the learning goal of the whole popu-
lation, and the evolution of the population will
present only ZD as an ESS. Because E(ZD, ZD) =
E(OTi, ZD), the comparison of payoffs between diffe-
rent strategies only needs to focus on
∑k
j=1E(ZD, OTj)
and
∑k
j=1E(OTi, OTj), ∀i ∈ {1, 2, ..., k}, where∑k
j=1E(ZD, OTj) >
∑k
j=1E(OTi, OTj), ∀i ∈ {1, 2, ..., k}
means eZD obtains the highest expected payoff, and
thus the ZD strategy is the ESS. For an arbitrary OTi
strategy, when
∑k
j=1E(OTi, OTj) >
∑k
j=1E(ZD, OTj)
and
∑k
j=1E(OTi, OTj) >
∑k
j=1E(OTm, OTj), ∀m ∈
{1, 2, ..., k},m 6= i, OTi obtains a higher payoff than
the ZD and other strategies; therefore the OTi is the
ESS. �
2) Analysis of eZD’s Payoff. In this case, the eZD’s
expect payoff is not influenced by its opponents’ strate-
gies. We use the following theorem to illustrate the evo-
lutionary stability of the ZD strategy in a population
where multiple strategies coexist.
Theorem 19. If E(ZD, ZD) > 1
k+1 (E(OTi, ZD)
+
∑k
j=1E(OTi, OTj)), ∀i ∈ {1, 2, ..., k}, the
ZD strategy is the ESS. If E(OTi, ZD) +∑k
j=1E(OTi, OTj) > E(ZD, ZD) +
∑k
j=1E(ZD, OTj)
and E(OTi, ZD) +
∑k
j=1E(OTi, OTj) > E(OTm, ZD) +∑k
j=1E(OTm, OTj), ∀m ∈ {1, 2, ..., k},m 6= i, the OTi
strategy is the ESS.
The proof is similar to that of Theorem 18. For the
sake of brevity, we omit the details here.
Through Theorem 18 and Theorem 19, we derive the
conditions for the ZD strategy to become an ESS when
multiple strategies exist in the population. In the con-
tinuous repeated games, players with different strate-
gies will get different payoffs, which can be utilized to
speculate on the opponent’s strategy and then consider
whether they should imitate the opponent’s strategy to
obtain higher payoffs. Therefore, in the population of
payment channels, when eZD obtains the highest profit,
it will be finally adopted by all channels in the PCN.
However, note that if the conditions for any strat-
egy to become an ESS cannot be fully satisfied, which
means no single strategy can outperform the others,
then the population will eventually reach a mixed evo-
lutionary stable state consisting of multiple strategies.
6 Experimental Evaluation
In this section, we conduct a series of experiments
to validate the control power and the existence of the
ZD strategy in the cases of infinitely and finitely re-
peated games, as well as the evolutionarily stable points
and the evolutionary stability of the ZD strategy when
playing against one other strategy and multiple other
strategies in the evolutionary PCN game.
6.1 ZD Strategy in Infinitely Repeated Game
To evaluate the control power of the ZD strategy
in the infinitely repeated game, we conduct a series of
simulations to study the impact of payoff parameters
on the payoff range and report the results in Figs.3–10.
When ex sets ey’s payoff, we set ry, fy, ay, and cy as
900 J. Comput. Sci. & Technol., July 2022, Vol.37, No.4
2, 1.5, 1.2 and 0.9, respectively, to testify Ey’s range
when cy < fy and cy > fy − ay hold in Theorem 3,
where the experimental results are shown in Figs.3 and
4. We can see from Fig.3 that Ey’s range is [2.6, 3.2],
which satisfies the boundary range given by λ. We set
Ey as 0 when p2 /∈ [0, 1] or p3 /∈ [0, 1], to distinguish
the effective range that ex can control. Fig.4(a) and
Fig.4(b) show the change of Ey with p4 when p1 = 0.4
and p1 = 0.8 respectively, and Fig.4(c) and Fig.4(d) in-
dicate the effect of p1 on Ey when p4 = 0.2 and p4 = 0.6
respectively.
2.0
1.0
2.5
1.0
3.0
0.8
3.5
0.5 0.6
4.0
0.4
0.2
0.0 0.0
p
p
E
y
Fig. 3. Range of Ey controlled by the ZD strategy when
fy − ay < cy < fy [14].
0.0 0.5 1.0
0
1
2
3
0.0 0.5 1.0
0
1
2
3
0.0 0.5 1.0
0
1
2
3
4
0.0 0.5 1.0
0
1
2
3
4
p p
p p
E
y
E
y
E
y
E
y
(b)(a)
(c) (d)
Fig.4. Effect of p1 and p4 on Ey when fy − ay < cy < fy [14].
(a) p1 = 0.4. (b) p1 = 0.8. (c) p4 = 0.2. (d) p4 = 0.6.
Via adjusting cy to 1.8, Figs.5 and 6 show the pay-
off range of ey that ex can control under the condition
of fy < cy < fy + ay. Fig.6 is with the same setting
as Fig. 10. Based on the experimental results, when
p4 ∈ (0, 0.6), Ey has the minimum value of 2 + 1.2p4
1+p4
;
when p4 ∈ (0.6, 0.75), Ey has the minimum value of
2 + 0.3p4
1−p4 . And when p4 = 0, p1 6= 1, Ey reaches the
minimum 2; when p1 = 1, p4 6= 0, Ey obtains the maxi-
mum 2.9.
1.8
0.8
2.0
2.2
0.6 1.0
2.4
2.6
0.8
0.4
2.8
0.6
3.0
0.40.2 0.2
0.0 0.0
p
p
E
y
Fig. 5. Range of Ey controlled by the ZD strategy when
fy < cy < fy + ay [14].
0.0 0.5 1.0
0.0
0.5
1.0
1.5
2.0
2.5
E
y
E
y
E
y
E
y
p p
p p
(b)(a)
(c) (d)
0.0 0.5 1.0
0
1
2
3
0.0 0.5 1.0
0
1
2
3
0.0 0.5 1.0
0
1
2
3
Fig.6. Effect of p1 and p4 on Ey when fy < cy < fy + ay [14].
(a) p1 = 0.4. (b) p1 = 0.8. (c) p4 = 0.2. (d) p4 = 0.6.
Fig.7 and Fig.8 show that when ex uses the ZD strat-
egy to control its own payoff, where we set ry, fy, ay,
and cy as 2, 1.5, 1.2 and 0.06 respectively, cx < fx and
cx < fx − ax hold. According to the experimental re-
sults, the range of Ex is [3.2, 3.44]. And Fig.8 shows
the range of Ex when p1 = 0.4, p1 = 0.8, p4 = 0.2, and
p4 = 0.6. As shown in Figs.9 and 10, when we set cx as
3 so that cx > fx + ax is satisfied as mentioned in The-
orem 7, the maximum value of Ex is 2 − p4
6(1+p4)
when
p4 ∈ (0, 19 ), and the maximum value of Ex is 2 − 1.2p4
1−p4
when p4 ∈ ( 1
9 ,
1
5 ). And in the case of p1 = 1, p4 6= 0,
there is a minimum payoff of 1.7, while if p4 = 0, p1 6= 1,
Ex has a maximum value of 2. In this case, the feasible
region of Ex is small, and thus we fix p1 as 0.9 and 1
Yi Qin et al.: Weighing Transaction Forwarding Against Malicious Attacks 901
respectively, and p4 as 0 and 0.1 respectively in Fig.10
to show the change of Ex.
2.0
1.0
2.5
1.0
3.0
0.8
3.5
0.5 0.6
4.0
0.4
0.2
0.0 0.0
p
p
E
x
Fig. 7. Range of Ex controlled by the ZD strategy when
cx < fx − ax [14].
0.0 0.5 1.0
0
1
2
3
4
0.0 0.5 1.0
0
1
2
3
4
0.0 0.5 1.0
0
1
2
3
4
0.0 0.5 1.0
0
1
2
3
4
p p
p p
(b)(a)
(c) (d)
E
x
E
x
E
x
E
x
Fig.8. Effect of p1 and p4 on Ex when cx < fx − ax [14]. (a)
p1 = 0.4. (b) p1 = 0.8. (c) p4 = 0.2. (d) p4 = 0.6.
0.5
0.20
1.0
0.15 1.0
1.5
0.9
2.0
0.10 0.8
2.5
0.70.05 0.6
0.00 0.5
p p
E
x
Fig. 9. Range of Ex controlled by the ZD strategy when
cx > fx + ax [14].
0.0 0.5 1.0
0.0
0.5
1.0
1.5
2.0
0.0 0.5 1.0
0.0
0.5
1.0
1.5
2.0
0.0 0.5 1.0
0.0
0.5
1.0
1.5
2.0
0.0 0.5 1.0
0.0
0.5
1.0
1.5
2.0
p p
p p
(b)(a)
(c) (d)
E
x
E
x
E
x
E
x
Fig.10. Effect of p1 and p4 on Ex when cx > fx + ax [14]. (a)
p1 = 0.9. (b) p1 = 1. (c) p4 = 0. (d) p4 = 0.1.
In the cases of other parameters discussed, including
the case of cy < fy − ay in Theorem 3 and Theorem 4,
and the case of cx > fx − ax in Theorem 6 and Theo-
rem 8, Ey and Ex cannot be controlled in a range, and
we do not show their results here.
6.2 ZD Strategy in Finitely Repeated Game
We carry out a set of simulations to explore the im-
pacts of payoff parameters on ω enabling the ZD strat-
egy in the finitely repeated game. In detail, we focus
on whether p2 and p3 belong to [0, 1] when ω changes.
When ex uses the ZD strategy to control ey’s payoff,
we set fy, ay and cy as 1.5, 0.6 and 0.1, respectively.
When cy < fy, we set p1, p4 = 1, and calculate p2 and
p3 to determine the condition ω needs to satisfy. To
better distinguish the eligibility of p2 and p3, we set
them as −0.1 when they are not in [0, 1]. As shown
in Fig.11(a), we can see that when ω is greater than
0.7, that is, ω > fy−cy
fy+ay−cy and p2 and p3 are feasi-
ble. Similarly, when we set cy to 1.8, the condition of
fy < cy < fy + ay is satisfied. As shown in Fig.11(b),
we can see that ω must be greater than 0.5, that is,
ω > cy−fy
ay
, which is the most basic condition for the
ZD strategy to be effective. Figs.12(a) and 12(b) show
the lower bounds of ω when ex chooses to control its
own payoff, when cx < fx and cx > fx + ax, respec-
tively.
902 J. Comput. Sci. & Technol., July 2022, Vol.37, No.4
0.0 0.2 0.4 0.6 0.8 1.00.1 0.3 0.5 0.7 0.9
ω
1.0
0.8
0.6
0.4
0.2
0.0
-0.2
p
p
0.0 0.2 0.4 0.6 0.8 1.00.1 0.3 0.5 0.7 0.9
ω
1.0
0.8
0.6
0.4
0.2
0.0
-0.2
p
p
(b)(a)
Fig.11. Impact of ω on ZD strategy controlling Ey in the finitely repeated games. (a) cy < fy . (b) fy < cy < fy + ay .
0.0 0.2 0.4 0.6 0.8 1.00.1 0.3 0.5 0.7 0.9
ω
1.0
0.8
0.6
0.4
0.2
0.0
-0.2
p
p
0.0 0.2 0.4 0.6 0.8 1.00.1 0.3 0.5 0.7 0.9
ω
1.0
0.8
0.6
0.4
0.2
0.0
-0.2
p
p
(b)(a)
Fig.12. Impact of ω on ZD strategy controlling Ex in the finitely repeated games. (a) cx < fx. (b) cx > fx + ax.
6.3 Replication Dynamic of Evolutionary
PCN Game
We validate the results of replication dynamic ana-
lysis by simulating the process of the evolutionary PCN
game. We simulate 1 000 channels to represent the PCN
with random connections between channels. Further-
more, we set rz, fz, and az as 2, 1.5, and 1.2, respec-
tively, while cz as 0.5, 2.5, 1.5 to satisfy the relation-
ship between cz and fz in three different cases shown
in Fig.13. We assume that the initial proportion of the
channels choosing the cooperation strategy in the whole
PCN population is 0.4 and the channels play a random
pairing game with their neighbors. After each round
of the game, each channel randomly selects an oppo-
nent. If the opponent’s payoff is higher than its own,
it learns the opponent’s strategy. We verify our ana-
lysis by observing the evolution of the popular strategy
in 100 consecutive rounds of the game. According to
Fig.13, when cx < fx, the channels tend to take the
strategy C, and accordingly, θ = 1 is the evolutionarily
stable point. In the case of cx > fx, the channels tend
to take the strategy D finally, and thus θ = 0 is an evo-
lutionarily stable point. In addition, when cx = fx, the
channels remain stable without changing their strate-
gies.
6.4 Stability of ZD Strategy in Evolutionary
PCN Game
To verify the stability of the ZD strategy in the evo-
lutionary PCN game, we design several experiments to
simulate the situations of the ZD strategy vs one other
strategy and the ZD strategy vs multiple other strate-
gies, and the results are shown in Fig.14 and Fig.15,
respectively. We construct a PCN with 1 000 channels.
Yi Qin et al.: Weighing Transaction Forwarding Against Malicious Attacks 903
And we assume that when a ZD player, i.e., eZD, sets
the payoff of the opponent, eZD makes the payoff as
small as possible; while when eZD sets its own payoff,
eZD makes the payoff as large as possible.
10 20 30 40 50 60 70 80 90 100
Number of Rounds
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
θ
cz < fz
cz > fz
cz=fz
Fig.13. Evolutionarily stable points of the replication dynamic.
For the case of ZD vs one other strategy, we play
100 consecutive rounds of the game and set the initial
percentage of the ZD players as 0.4. Fig.14(a) shows
the change in the number of ZD players playing against
four different strategies when setting the payoff range of
eOT, where we set rOT, fOT, aOT, cOT as 2, 1.5, 1.2, 1.8
and p̃1 = 0.99, p̃4 = 0.01, respectively. Fig.14(b) shows
the convergence of the number of ZD players when eZD
controls its own payoff, where we set rZD, fZD, aZD, cZD
as 2, 1.8, 1.2, 0.3 and p̃1 = 0.2, p̃4 = 1, respectively.
By observing Fig.14, we can see that when eZD con-
trols the opponent’s payoff, if OT is ALLD, E(ZD, OT)
< E(OT, OT) is satisfied, and then ZD players will grad-
ually disappear; while if eOT takes the ALLC, WSLS or
TFT strategy, E(ZD, OT) > E(OT, OT) holds, and chan-
nels tend to learn the ZD strategy, which means that
the ZD strategy is an ESS. This is consistent with The-
orem 16. When eZD sets its own optimal payoff, if OT
is ALLC or TFT, eZD will learn from eOT gradually be-
cause E(OT, OT) > E(ZD, OT); while if OT is ALLD or
20 40 60 80 100
Number of Rounds
0
2
4
6
8
10
N
u
m
b
e
r 
o
f 
Z
D
 P
la
y
e
rs
 (
Τ
1
0
2
)
ZD-ALLD
ZD-ALLC
ZD-WSLS
ZD-TFT
20 40 60 80 100
Number of Rounds
0
2
4
6
8
10
N
u
m
b
e
r 
o
f 
Z
D
 P
la
y
e
rs
 (
Τ
1
0
2
)
ZD-ALLD
ZD-ALLC
ZD-WSLS
ZD-TFT
(b)(a)
Fig.14. Evolution of the ZD players when one other strategy exists in the PCN. (a) eZD sets the opponent’s payoff. (b) eZD sets its
own payoff.
100 200 300 400 500
Number of Rounds
0
1
2
3
4
5
N
u
m
b
e
r 
o
f 
Z
D
 P
la
y
e
rs
 (
Τ
1
0
2
)
ZD-ALLC-ALLD
ZD-ALLD-TFT
ZD-TFT-WSLS
100 200 300 400 500
Number of Rounds
0
2
4
6
8
10
N
u
m
b
e
r 
o
f 
Z
D
 P
la
y
e
rs
 (
Τ
1
0
2
)
ZD-ALLC-ALLD
ZD-ALLD-TFT
ZD-TFT-WSLS
(b)(a)
Fig.15. Evolution of the ZD players when multiple strategies coexist in the PCN. (a) eZD sets the opponent’s payoff. (b) eZD sets its
own payoff.
904 J. Comput. Sci. & Technol., July 2022, Vol.37, No.4
WSLS, E(ZD, OT) > E(OT, ZD) holds, and then the ZD
strategy will spread to the whole population, becoming
an ESS in this case, which verifies Theorem 17.
Next, we set the initial state of the PCN population
containing the ZD strategy and two other strategies to
study whether the ZD strategy is an ESS for the case of
ZD vs multiple other strategies. As mentioned in Sub-
section 5.2.2, we assume that channels adopting each
strategy are evenly distributed throughout the popu-
lation, and they are homogeneous with the impact fac-
tors in the payoff component under different situations,
which are represented as r, f, a, c respectively. We sim-
ulate 500 consecutive rounds of the game and three
different scenarios with multiple strategies coexisted,
including {ZD, ALLC, ALLD}, {ZD, ALLD,TFT}, and
{ZD, TFT, WSLS}. When eZD controls the opponent’s
payoff, we set r, f, a, and c to be 2, 1.5, 1.2, and 1.8,
respectively, with p1 and p4 being 0.26 and 0.11, re-
spectively. From Fig. 15(a), we can see that the ZD
strategy is not an ESS in any of the three scenarios.
ZD players gradually evolve to learn other strategies in
the evolution process. In other words, eZD cannot help
itself to get the most out of the game by controlling its
opponent’s payoff at a low level. Fig.15(b) shows the
evolution of the population when eZD chooses to control
its own payoff. Here we set r, f, a and c to be 2, 1.5, 1.2,
and 0.2, respectively, and p1 and p4 to be 0.9 and 0.1,
respectively. When ZD coexists with ALLC and ALLD
or TFT and WSLS, the number of ZD players will grad-
ually decrease to 0, which means that in both scenarios,
eZD cannot control their expected payoffs higher than
other strategies. Thus, the ZD strategy is not an ESS
in the corresponding evolutionary PCN games. While
if ZD coexists with ALLD and TFT, eZD’s payoff is
higher than those of ALLD and TFT, and thus the ZD
strategy gradually expands into the whole population.
At this time, the ZD strategy is an ESS.
7 Conclusions
To investigate the characteristics of channels’ trans-
action forwarding behaviors in the presence of malicious
attacks in PCN, we proposed a game model and proceed
with progressive and complementary analyses. Rely-
ing on the classical game theory and the assumption of
complete rationality, we studied the Nash equilibrium
of the PCN game, as well as the existence and power
of the ZD strategy in both the infinitely and finitely re-
peated games from a micro perspective. Furthermore,
we resorted to the evolutionary game theory for the
case of bounded rationality to analyze the evolutionar-
ily stable points and the evolutionary stability of the
ZD strategy when playing against other strategies from
a macro perspective.
Through analyzing the behavioral characteristics
of channel interactions from individuals to the whole
population of PCN, we can derive the following con-
clusions. Studying the impact of forwarding costs and
attacked losses on Nash equilibrium could act as a refe-
rence for PCN users to initiate transactions. Besides,
users may adopt the ZD strategy to empower them-
selves to gain comparative advantages. Furthermore,
the management agency of the PCN can check the ar-
eas with high risks of malicious attacks according to
the overall evolution status, based on which appropri-
ate incentives can be supplied to promote widespread
forwarding of transactions.
In the future, we plan to relax the assumptions of
the PCN game model to adapt to more realistic scenar-
ios for revealing further results. In addition, we propose
to detect the malicious nodes and evaluate the benefits
of different behaviors under attack risks accurately with
the help of reinforcement learning, so as to enable users
to make wise decisions for transaction forwarding.
References
[1] Li P, Miyazaki T, Zhou W. Secure balance plan-
ning of off-blockchain payment channel networks. In
Proc. the IEEE Conference on Computer Communi-
cations, Jul. 2020, pp.1728-1737. DOI: 10.1109/INFO-
COM41043.2020.9155375.
[2] Lin S, Zhang J, Wu W. FSTR: Funds skewness aware
transaction routing for payment channel networks. In Proc.
the 50th Annual IEEE/IFIP International Conference on
Dependable Systems and Networks, Jun. 29-Jul. 2, 2020,
pp.464-475. DOI: 10.1109/DSN48063.2020.00060.
[3] Bagaria V K, Neu J, Tse D. Boomerang: Redundancy
improves latency and throughput in payment-channel net-
works. In Proc. the 24th International Conference on Fi-
nancial Cryptography and Data Security, Feb. 2020, pp.304-
324. DOI: 10.1007/978-3-030-51280-4 17.
[4] Khalil R, Gervais A. Revive: Rebalancing off-blockchain
payment networks. In Proc. the 2017 ACM SIGSAC Confe-
rence on Computer and Communications Security, Oct. 30-
Nov. 3, 2017, pp.439-453. DOI: 10.1145/3133956.3134033.
[5] Rohrer E, Malliaris J, Tschorsch F. Discharged payment
channels: Quantifying the lightning network’s resilience
to topology-based attacks. In Proc. the 2019 IEEE Euro-
pean Symposium on Security and Privacy Workshops, Aug.
2019, pp.347-356. DOI: 10.1109/EuroSPW.2019.00045.
[6] Kappos G, Yousaf H, Piotrowska A M, Kanjalkar S,
Delgado-Segura S, Miller A, Meiklejohn S. An empiri-
cal analysis of privacy in the lightning network. In Proc.
https://doi.org/10.1109/INFOCOM41043.2020.9155375
https://doi.org/10.1109/INFOCOM41043.2020.9155375
https://doi.org/10.1109/DSN48063.2020.00060
https://doi.org/10.1007/978-3-030-51280-4_17
https://doi.org/10.1145/3133956.3134033
https://doi.org/10.1109/EuroSPW.2019.00045
Yi Qin et al.: Weighing Transaction Forwarding Against Malicious Attacks 905
the 25th International Conference on Financial Cryptog-
raphy and Data Security, Mar. 2021, pp.167-186. DOI:
10.1007/978-3-662-64322-8 8.
[7] Tang W, Wang W, Fanti G C, Oh S. Privacy-utility trade-
offs in routing cryptocurrency over payment channel net-
works. Proc. ACM Meas. Anal. Comput. Syst., 2020, 4(2):
Article No. 29. DOI: 10.1145/3392147.
[8] Banerjee P, Mazumdar S, Ruj S. Griefing-penalty: Coun-
termeasure for griefing attack in bitcoin-compatible PCNs.
arXiv:2005.09327, 2020. https://arxiv.org/abs/2005.09327,
May 2022.
[9] Harris J, Zohar A. Flood & loot: A systemic attack on the
lightning network. In Proc. the 2nd ACM Conference on
Advances in Financial Technologies, Oct. 2020, pp.202-213.
DOI: 10.1145/3419614.3423248.
[10] Avarikioti Z, Heimbach L, Wang Y, Wattenhofer R. Ride
the lightning: The game theory of payment channels.
In Proc. the 24th International Conference on Financial
Cryptography and Data Security, Feb. 2020, pp.264-283.
DOI: 10.1007/978-3-030-51280-4 15.
[11] Lange K, Rohrer E, Tschorsch F. On the impact
of attachment strategies for payment channel net-
works. In Proc. the IEEE International Conference
on Blockchain and Cryptocurrency, May 2021. DOI:
10.1109/ICBC51069.2021.9461104.
[12] Pickhardt R, Nowostawski M. Imbalance measure and
proactive channel rebalancing algorithm for the light-
ning network. In Proc. the IEEE International Confe-
rence on Blockchain and Cryptocurrency, May 2020. DOI:
10.1109/ICBC48266.2020.9169456.
[13] Lu Z, Han R, Yu J. General congestion attack on HTLC-
based payment channel networks. In Proc. the 3rd Inter-
national Conference on Blockchain Economics, Security
and Protocols, Nov. 2021, Article No. 2. DOI: 10.4230/OA-
SIcs.Tokenomics.2021.2.
[14] Qin Y, Hu Q, Yu D, Cheng X. Malice-aware transac-
tion forwarding in payment channel networks. In Proc.
the 18th IEEE International Conference on Mobile Ad
Hoc and Smart Systems, Oct. 2021, pp.297-305. DOI:
10.1109/MASS52906.2021.00046.
[15] Press W H, Dyson F J. Iterated prisoner’s dilemma con-
tains strategies that dominate any evolutionary opponent.
Proceedings of the National Academy of Sciences of the
United States of America, 2012, 109(26): 10409-10413.
DOI: 10.1073/pnas.1206569109.
[16] Govaert A, Cao M. Zero-determinant strategies in
finitely repeated n-player games. arXiv:1910.07858, 2019.
http://arxiv.org/abs/1910.07858, Oct. 2021.
[17] Traulsen A, Nowak M A, Pacheco J M. Stochastic dynam-
ics of invasion and fixation. Physical Review E, 2006, 74(1):
Article No. 011909. DOI: 10.1103/PhysRevE.74.011909.
[18] Szabó G, Tőke C. Evolutionary prisoner’s dilemma game
on a square lattice. Physical Review E, 1998, 58(1): 69-73.
DOI: 10.1103/PhysRevE.58.69.
[19] Taylor P D, Jonker L B. Evolutionary stable strategies and
game dynamics. Mathematical Biosciences, 1978, 40(1/2):
145-156. DOI: 10.1016/0025-5564(78)90077-9.
[20] Smith J M. Evolution and the Theory of Games (1st edi-
tion). Cambridge University Press, 1982.
Yi Qin received his B.E. degree
in computer science and technology
from Shandong University, Qingdao, in
2019, where he is currently pursuing
his Master degree with the School of
Computer Science and Technology. His
research interests include blockchain
and payment channel networks.
Qin Hu received her Ph.D. degree
in computer science from the George
Washington University, Washington,
in 2019. She is currently an assistant
professor with the Department of
Computer and Information Science,
Indiana University-Purdue University
Indianapolis, Indianapolis. Her research
interests include wireless network, mobile security and
privacy, crowdsourcing/crowdsensing, and blockchain.
Dong-Xiao Yu received his B.Sc.
degree in information and com-
putational science from Shandong
University, Qingdao, in 2006, and his
Ph.D. degree in computer science from
The University of Hong Kong, Hong
Kong, in 2014. He became an associate
professor in the School of Computer Sci-
ence and Technology, Huazhong University of Science and
Technology, Wuhan, in 2016. He is currently a professor in
the School of Computer Science and Technology, Shandong
University, Qingdao. His research interests include wire-
less networks, distributed computing and graph algorithms.
Xiu-Zhen Cheng received her M.S.
and Ph.D. degrees in computer science
from University of Minnesota, Twin
Cities, in 2000 and 2002, respectively.
She was a faculty member at the
Department of Computer Science, The
George Washington University, Wash-
ington, from 2002–2020. Currently she
is a professor of computer science at Shandong University,
Qingdao. Her research focuses on blockchain computing,
security and privacy, and Internet of Things. She is a
fellow of IEEE.
https://doi.org/10.1007/978-3-662-64322-8_8
https://doi.org/10.1145/3392147
https://doi.org/10.1145/3419614.3423248
https://doi.org/10.1007/978-3-030-51280-4_15
https://doi.org/10.1109/ICBC51069.2021.9461104
https://doi.org/10.1109/ICBC48266.2020.9169456
https://doi.org/10.4230/OASIcs.Tokenomics.2021.2
https://doi.org/10.4230/OASIcs.Tokenomics.2021.2
https://doi.org/10.1109/MASS52906.2021.00046
https://doi.org/10.1073/pnas.1206569109
https://doi.org/10.1103/PhysRevE.74.011909
https://doi.org/10.1103/PhysRevE.58.69
https://doi.org/10.1016/0025-5564(78)90077-9
	1 Introduction
	2 Related Work
	3 Game Formulation
	4 Microscopic Analysis of PCN Game
	4.1 Nash Equilibrium
	4.2 Control Analysis of Zero-DeterminantStrategy
	4.2.1 Analysis of ey's Payoff
	4.2.2 Analysis of ex's Payoff
	4.3 Existence of Zero-Determinant Strategy in Finitely Repeated Games
	4.3.1 Analysis of ey's Payoff
	4.3.2 Analysis of ex's Payoff
	5 Macroscopic Analysis of PCN Game
	5.1 Replication Dynamic Analysis
	5.2 Evolutionary Stability of ZD Strategy
	5.2.1 ZD vs One Other Strategy
	5.2.2 ZD vs Multiple Other Strategies
	6 Experimental Evaluation
	6.1 ZD Strategy in Infinitely Repeated Game
	6.2 ZD Strategy in Finitely Repeated Game
	6.3 Replication Dynamic of Evolutionary PCN Game
	6.4 Stability of ZD Strategy in Evolutionary PCN Game
	7 Conclusions