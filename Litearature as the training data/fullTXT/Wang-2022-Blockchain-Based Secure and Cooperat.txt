Blockchain-Based Secure and Cooperative Private Charging Pile Sharing Services for Vehicular Networks
IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 71, NO. 2, FEBRUARY 2022 1857
Blockchain-Based Secure and Cooperative Private
Charging Pile Sharing Services for
Vehicular Networks
Yuntao Wang , Zhou Su , Senior Member, IEEE, Jiliang Li , Ning Zhang , Senior Member, IEEE,
Kuan Zhang , Kim-Kwang Raymond Choo , Senior Member, IEEE, and Yiliang Liu
Abstract—With the proliferation of electric vehicles (EVs), pri-
vate charging pile (PCP) sharing networks are likely to be an
integral part of future smart cities, especially in places with limited
public charging infrastructure. However, there are a number of
operational challenges associated with the deployment of PCPs
in such a shared and untrusted environment. For example, how
do we formulate efficient PCP sharing strategies in PCP sharing
networks, while also taking into consideration the dynamic charg-
ing behaviors of EVs? Therefore, in this paper, we propose an en-
ergy blockchain-based secure PCP sharing scheme (BBC) for PCP
sharing networks. First, an energy blockchain-based framework is
designed for PCP sharing networks to facilitate energy sharing
services for EVs and PCPs, using both distributed ledgers and
cryptocurrency. Then, we devise a reputation-based secure PCP
sharing algorithm to improve consensus efficiency with smaller
signature sizes. In addition, a distributed reputation mechanism
is constructed to assess the trustworthiness of consensus nodes
in blockchain, based on ratings, behaviors, and fading. We also
model the interactions among EVs and cooperative PCPs as a
joint coalition-matching game, and obtain the optimal strategies
of PCPs and EVs by analyzing the Nash-stable coalitional struc-
ture and stable many-to-one matching pairs. Extensive simulations
and the real-world implementation demonstrate that the proposed
approach improves the utility of EV users and renewable energy
efficiency in PCP sharing networks.
Index Terms—Electric vehicle (EV), private charging pile (PCP),
energy blockchain, coalition-matching game.
Manuscript received December 7, 2020; revised March 18, 2021 and Septem-
ber 17, 2021; accepted November 24, 2021. Date of publication December 1,
2021; date of current version February 14, 2022. This work was supported in part
by NSFC under Grants U20A20175, U1808207, and 62102305 and in part by
the Fundamental Research Funds for the Central Universities. The work of K.-K.
R. Choo was supported by the Cloud Technology Endowed Professorship. An
earlier version of this paper was presented at IEEE BigdataSE2019. The review
of this article was coordinated by Prof. L. Zhu. (Corresponding author: Jiliang
Li.)
Yuntao Wang, Zhou Su, Jiliang Li, and Yiliang Liu are with the School of Cy-
ber Science and Engineering, Xi’an Jiaotong University, Xi’an 710049, China (e-
mail: yuntao.wang@stu.xjtu.edu.cn; zhousu@ieee.org; jiliangli@foxmail.com;
liuyiliang@hit.edu.cn).
Ning Zhang is with the Department of Electrical and Computer Engineering,
University of Windsor Windsor, ON, Canada (e-mail: ning.zhang@ieee.org).
Kuan Zhang is with the Electrical and Computer Engineering De-
partment, University of Nebraska-Lincoln, Lincoln, NE USA (e-mail:
kuan.zhang@unl.edu).
Kim-Kwang Raymond Choo is with the Department of Information Systems
and Cyber Security, University of Texas at San Antonio, San Antonio, TX USA
(e-mail: raymond.choo@fulbrightmail.org).
Digital Object Identifier 10.1109/TVT.2021.3131744
I. INTRODUCTION
E LECTRIC vehicles (EVs) can reduce our reliance on fossil
fuel and mitigate greenhouse gas emissions [1]–[3]. It is,
therefore, unsurprising that there will be 140 million EVs by
the year of 2030, constituting almost a third of the new-vehicle
market [4]. However, not all cities (or counties) are able to
afford building and maintaining an extensive network of public
charging piles, especially in remote and underpopulated areas. In
addition, the utilization of private charging piles (PCPs) by their
owners is usually low [5]. Given the current trend in sharing
economy, PCP sharing networks (PCPSNs) can facilitate EV
charging and improve PCP utilization [6]–[8].
PCPSNs consist of a group of publicly shared PCPs powered
by renewable energy (RE) generators, such as photovoltaic (PV)
systems and wind turbines in the communities, and a fleet of EVs
on road with charging demands. By publicly sharing PCPs in
PCPSNs, EVs users can achieve higher quality of experience
(QoE) and decrease their charging costs, while PCP owners
can financially benefit through leasing their private charging
facilities to EVs [9]. In addition, direct integration of RE with
PCPs may contribute to energy sustainability and help balance
the peak-to-average ratio of power grids [10], [11].
However, existing EV charging mechanisms [5]–[7], [9], [12],
[13] cannot be directly applied in PCPSNs for optimal sharing
and charging for PCPs and EVs, since they do not support both
competition and cooperation among users. For instance, when
PCPs with limited RE generation can collaboratively establish
coalitions and share solar energy with each other, EVs can select
the optimal PCP coalition to purchase their energy. Moreover,
existing literature seldom consider the social features among
EV users and PCP owners, as well as the practical charging con-
straints (e.g., constrained RE supply of PCP, and charging outlets
of PCP coalition). For example, PCP owners are willing to share
his/her private charging facility with EVs that have higher social
ties with the particular PCP. Therefore, when scheduling the
sharing and charging process for connected PCPs and EVs, it is
necessary to consider their competition, cooperation and social
features, and other practical constraints of PCPSNs.
In PCPSNs, EV users and PCP owners are generally strangers
without prior direct experience (similar to other sharing econ-
omy applications such as Airbnb and Uber). As a result, there
exist inherent risks such as fraud in such a shared and untrusted
0018-9545 © 2021 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See https://www.ieee.org/publications/rights/index.html for more information.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
https://orcid.org/0000-0003-3810-7076
https://orcid.org/0000-0002-6518-3130
https://orcid.org/0000-0001-9506-3634
https://orcid.org/0000-0001-9518-1622
https://orcid.org/0000-0002-4262-153X
https://orcid.org/0000-0001-9208-5336
mailto:yuntao.wang@stu.xjtu.edu.cn
mailto:zhousu@ieee.org
mailto:jiliangli@foxmail.com
mailto:liuyiliang@hit.edu.cn
mailto:ning.zhang@ieee.org
mailto:kuan.zhang@unl.edu
mailto:raymond.choo@fulbrightmail.org
1858 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 71, NO. 2, FEBRUARY 2022
environment [14]–[16]. The conventional centralized PCPSNs
rely on a central sharing platform for security-critical operations,
including user account management, transaction validation, and
ledger maintenance. However, such a central sharing platform
is vulnerable to single point of failure and distributed denial-
of-service (DDoS) attacks. Hence, we posit the potential of
using blockchain to provide a decentralized solution and achieve
enhanced security. For example, a blockchain-based approach
removes the reliance on a central sharing platform and facilitates
the establishment of trustworthy energy interactions among
various energy entities in the untrusted environment [17]–[19].
However, the widely-used proof-of-work (PoW) mechanism in
blockchain systems incurs significant power consumption and
has low consensus efficiency. In addition, we have to assume
that not all EVs and PCPs have significant storage, computa-
tion, and communication capacities. Also, EVs are generally
(highly) mobile, and consequently this can result in low network
connectivity and potential network partitions in the blockchain.
Therefore, designing and implementing an efficient and secure
blockchain network among resource-constrained EVs and PCPs
in PCPSNs remains a topic of ongoing interest, and this is the
contribution we seek to make in this paper.
Specifically, in this paper, we propose a novel energy
blockchain-based secure and efficient PCP sharing scheme
(BBC), designed to support EV charging in PCPSNs. In our
approach, PCPs and EVs can publicly share energy transac-
tions and ledgers in a decentralized manner. We also design
a reputation-based secure PCP sharing algorithm with lower
signature sizes to improve both consensus efficiency and security
in the blockchain. The difficulty of PoW for each consensus node
is adjustable according to its reputation value. Furthermore, a
distributed reputation mechanism is employed to assess the trust-
worthiness of consensus nodes, i.e., local aggregators (LAGs),
based on the ratings and behaviors stored in the blockchain.
We also develop a joint coalition-matching game to model the
energy interactions among EVs and PCPs. The coalition game is
used to analyze the coalition formulation process among PCPs,
while the many-to-one matching game is employed to select the
best candidate to connect for both EVs and PCP coalitions. A
summary of our approach is as follows:
1) We propose a secure and cooperative PCP sharing frame-
work in an energy blockchain ecosystem to safeguard and
improve the efficiency of PCP sharing and EV charg-
ing process in PCPSNs. By leveraging edge computing,
multi-signature mechanism, and reputation-based PoW
mechanism, the cost of establishing a blockchain network
among resource-limited EVs and PCPs can be reduced.
2) We design a decentralized reputation mechanism to assess
the trustworthiness of LAG operators in PCPSNs by in-
corporating the rating effects, behavior effects, and fading
effects. Using reputation assessment, malicious LAGs can
be identified and excluded from the set of consensus
nodes while trustworthy LAGs can be selected to mitigate
security risks of consensus process.
3) We leverage the joint coalition-matching game to optimize
the decision-making process between PCPs and EVs while
incorporating their cooperation and competition. We carry
out extensive simulations and a real implementation to
validate the effectiveness of the proposed scheme. It is
demonstrated that our proposed scheme can improve the
QoE of EV users and strengthen the security of consensus
process, compared with conventional schemes.
The remainder of this work is organized as follows. We
present the related work and system model in Sections II and
III, respectively. We then present the proposed BBC scheme in
Section IV and its performance evaluation in Section V. Finally,
we conclude this paper in Section VI.
II. RELATED WORK
In this section, we will briefly discuss the related literature on
EV charging management and blockchain-based approaches for
energy trading (see Sections II-A and II-B).
A. EV Charging Management
In recent times, many efforts have been made on the optimiza-
tion of EV charging scheduling. Zhang et al. [20] presented a
flexible bidirectional energy transfer mechanism for cooperative
EV charging and discharging management, in order to acquire
stable matching results between charging EVs and discharging
EVs through a max-weight EV-to-EV matching algorithm. To
obtain desired load profile and minimize on-off switching times
of EVs, Sun et al. [21] formulated a coordinated EV charging
scheduling problem in a discrete and distributed manner, while
considering the capacity constraints of distribution transformers.
To coordinate the large-scale EV charging issue using local wind
turbines installed in buildings, Yang et al. [22] developed two
real-time charging scheduling approaches for EVs in both cen-
tralized and decentralized ways by incorporating the intermittent
wind energy supply and random driving cycles of EVs. Wei
et al. [23] studied the EV charging problem under parking lot
scenarios to minimize the EV battery degradation cost, while
meeting the characteristics of battery charging via a dynamic
power adjustment algorithm and a vacant energy allocation
algorithm. Zhang and Cai [24] proposed a dynamic charging
management mechanism for EVs in a workplace parking garage
integrated with both PV systems and the power grid to opti-
mally schedule the EV charging process, where the time-varying
charging requirements of EVs and the fluctuation of solar energy
are taken into account. One can observe that security challenges
in the EV charging process and the social characteristics of PCP
owners and EV users are topics that are understudied in the
existing literature.
B. Blockchain-Based Solutions for Energy Trading
There has been increasing interest in using blockchain to
ensure the security of energy trading systems. Wang et al. [25]
proposed a blockchain-assisted crowdsourced energy system for
secure, efficient, and seamless peer-to-peer (P2P) energy trad-
ing in the real-time, hour-ahead, and day-ahead energy market
scenarios via a two-phase operation algorithm. Dang et al. [26]
studied the optimal demand-side scheduling (DSM) problem for
big industrial consumers in blockchain-enabled P2P electricity
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
WANG et al.: BLOCKCHAIN-BASED SECURE AND COOPERATIVE PCP SHARING SERVICES FOR VEHICULAR NETWORKS 1859
TABLE I
EXISTING BLOCKCHAIN-BASED ENERGY TRADING APPROACHES: A COMPARATIVE SUMMARY
† reference [8] is the conference version of this work. ‡ n is the number of consensus nodes in the blockchain network.
trading platforms, while the cost of PoW in the blockchain is
also modeled. To support PoW mining tasks execution for EVs,
Zhou et al. [27] presented a permissioned blockchain-oriented
mechanism in the large-scale vehicle-to-grid (V2G) context by
incorporating edge computing. This allows them to achieve
improved security and efficiency in the block building process.
Chaudharya et al. [28] presented a blockchain-enabled secure
energy trading framework with EVs, designed to achieve low
latency and provide real-time services. In addition, software-
defined networking is implemented to facilitate the transfer
of EVs’ energy requests to a logically centralized controller.
Nevertheless, these blockchain systems in energy trading mainly
rely on the PoW protocol for consensus and ledger management,
which cannot be directly applied in PCPSNs owing to the high
mobility of EVs and the resource constraints of EVs and PCPs.
To efficiently deploy a blockchain network for energy trading,
a variety of works have been focused on the improvement of
intrinsic consensus protocols. For example, in [29], the proof-
of-stake (PoS) consensus mechanism was adopted for reliable
energy loss tracing and attribution in microgrids, where the
PoW difficulty is adjusted by the invested coin days to mitigate
computation overhead. In [30], the delegated PoS (DPoS) con-
sensus mechanism was utilized to secure wireless power transfer
for battery-restricted Internet of things devices, where only
preselected validators by voting can be the consensus node for
blockchain management. In DeepCoin [31], the practical BFT
(PBFT), as a typical BFT algorithm, was employed to secure
P2P energy exchange in energy blockchain networks with high
throughput. However, in PoS-based blockchains, nodes holding
more coins have a higher probability to generate the block and
receive rewarding coins, which may lead to the Matthew effect,
namely, the more coins that a node holds, the more coins are
rewarded. Besides, since nodes in DPoS may be off-line most
of the time, the inactive voting of participants may increase the
probability of malicious validators, which eventually deterio-
rates the security of blockchain. In PBFT, the communication
overhead reaches O(n2) in a consortium blockchain network
with n participants, which can be unbearable in a large network
(such as PCPSN) with a huge number of participants. Compared
with BFT algorithms, a key advantage of PoW-based blockchain
is that it only has O(n) communication complexity, which
trades off the computation and communication overhead. A
TABLE II
SUMMARY OF NOTATIONS
comparison of our work with other competing approaches is
given in Table I.
III. SYSTEM MODEL
The network model and the adversary model are presented in
Sections III-A and III-B, respectively. A summary of notations
used in the remaining of this paper is also presented in Table II.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
1860 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 71, NO. 2, FEBRUARY 2022
Fig. 1. System model.
A. Network Model
As illustrated in Fig. 1, the proposed blockchain-enabled
PCPSN is mainly composed of a fleet of EVs, multiple com-
munities, PCPs, smart meters, LAGs, and an energy blockchain
network.
Private charging piles (PCPs): The set of communi-
ties located in an area of interest is denoted as M =
{1, . . . ,m, . . . ,M}. There exist Jm shared PCPs in each
community m ∈M, the set of which is denoted as Jm =
{1, . . . , j, . . . , Jm}, where J =
⋃M
m=1 Jm denotes the set of
shared PCPs in the network. Each PCP j ∈ Jm is managed and
operated by its owner, i.e., resident j in community m, and is
provisioned with an EV charging outlet to enable EV’s charging
operation. Furthermore, multiple solar panels on the rooftop of
local buildings in each community can provide RE supply for
local PCPs. We define Lj as the number of rooftop solar panels
owned by resident j. The real-time energy output of Lj solar
panels at time slot t in the time horizon T = [1, . . . , t, . . . , T ]
can be expressed as:
EPV
j (t) = γ ·APV · Lj · IPV (t), (1)
where γ is the energy conversion efficiency, APV is the area
of each solar panel, and IPV (t) is the solar irradiance at time
slot t. Here, IPV (t) is determined by various environmental
factors (e.g., temperature, wind regime and sunlight), and there-
fore EPV
j (t) is intermittent and fluctuating. Each PCP in the
community has two statuses, i.e., busy and idle in different
time slots. Let statusj(t) = {0, 1} denote the binary status of
PCP j ∈ J at time slot t. Here, statusj(t) = 0 means that the
charging outlet of PCP j is occupied by an EV at time slot t,
while statusj(t) = 1 implies that PCP j’s charging outlet is idle
at time slot t.
Electric vehicles (EVs): There are I EVs in motion with
charging desires in the network, the set of which is denoted
as I = {1, . . . , i, . . . , I}. Let SoCi be the remaining state of
charge (SoC) of EV i. For convenient EV charging operations,
each EV i ∈ I sends its energy charging request to neighboring
PCPs when its battery SoC is low. To prolong EV’s battery life,
the SoC of EVs is constrained by SoCmin
i ≤ SoCi ≤ 1, where
SoCmin
i is the minimum SoC of EV i [3]. Let ηi ∈ (0, 1) be
the charging efficiency of EV i, and CEV
i be EV i’s battery
capacity. The battery dynamics of EV i in time horizon T are
linearly related to its energy demand di(t) at time slot t, i.e.,
SoCi(t+ 1) = SoCi(t) + ηidi(t)/C
EV
i , ∀t ∈ T . (2)
To improve EV users’ charging experience, EVs only request
charging energy from idle PCPs (i.e., statusj(t) = 1) to avoid
waiting a long time for receiving charging services.
Smart meters: The build-in smart meter in each PCP and EV
can automatically and truthfully record the amount of produced
and consumed energy, respectively. The smart meter can track
the energy trading between an EV and a PCP, as well as the
energy sharing among PCPs within a coalition, to verify whether
the pre-established energy purchase or sharing agreement has
been accomplished.
Local aggregators (LAGs): A group of LAGs with wireless
interfaces and energy exchange facilities can be deployed as
edge computing nodes in the network to provide both proximal
wireless communication and local energy exchange services
for both PCPs and EVs in their coverage areas [32]. Each
community m ∈M is equipped with an LAG m to facilitate
energy exchange for local PCPs and connect with local PCPs
and EVs through wireless links. Each LAG m ∈M is run by
its operator m in each community m. Furthermore, each LAG
receives energy requests from nearby EVs and gets the latest
information such as the location, status, and residual solar energy
from local shared PCPs.
Energy blockchain network: In the energy blockchain net-
work, LAGs serve as the full nodes (i.e., miners) which synchro-
nize the full ledgers (i.e, all the blocks) in the blockchain and
can participate in the consensus management process including
transaction verification, block audit and ledger maintenance,
while EVs and PCPs act as lightweight nodes (i.e., non-mining
nodes) which only relay, accept and exchange ledger data in
the blockchain [17]. In addition, due to the limited storage and
computing capacities of EVs and PCPs, each EV and PCP only
need to store the metadata of blocks (i.e., block header) instead of
the full ledgers in the blockchain for decreasing their cost [3]. As
such, the computation-intensive PoW processes are performed
by edge computing nodes (i.e., LAGs), while EVs and PCPs can
receive efficient blockchain services by synchronizing the latest
blockchain metadata from LAGs.
B. Adversary Model and Assumptions
In the network, both internal malicious participants and exter-
nal attackers may threaten PCP owners and EV users’ privacy
and security [33], [34]. Specifically, the following kinds of
attacks are considered:
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
WANG et al.: BLOCKCHAIN-BASED SECURE AND COOPERATIVE PCP SHARING SERVICES FOR VEHICULAR NETWORKS 1861
Repudiation and fraud attacks: On one hand, malicious PCP
owners may launch the fraud attack by advertising fraudulent
energy charging services to neighboring EVs. On the other hand,
a malicious EV user may launch the refuse-to-pay attack by
denying that it has not received any energy charging services
from the corresponding PCP.
Compromised sharing platform: In centralized PCPSNs, the
central sharing platform can be accessed by any registered
entities including malicious parties and may be compromised by
diverse attacks (e.g., single point of failure and DDoS attack),
and consequently its locally stored energy transactions may be
tampered, forged, replaced and removed, as well as users’ private
and sensitive information may be leaked [3].
Collusion and 51% attacks: Since LAGs are deployed and
run by third parties in different communities, a portion of LAG
operators may be malicious. Malicious LAGs may collude to
control over 50% computing capacities of all LAGs in the
PoW-based blockchain to illegally fork the blockchain (referred
to as 51% attack [36])1. For example, in 2019, the ETC was
attacked by attackers who collusively control over 50% comput-
ing power, causing a loss of about $271 000. Hence, malicious
LAGs can launch various malicious exploitations (e.g., double-
spending and generating wrong blocks) to threaten the security
of blockchain.
Other attacks: Malicious participants may carry out the fol-
lowing attacks to threaten the reputation evaluation process and
gain profits.
� Any malicious PCP or EV may perform the bad-mouthing
attack [35] by carrying out multiple energy transactions
with small traded energy volume and generating a series
of dishonest (i.e., too low or too high) ratings to illegally
decrease or increase the reputation values of participants
in PCPSNs.
� In the rating credibility calculation, a genuine latest
but lower/higher rating given by a legitimate user may
be ignored due to the high deviation from previous n
higher/lower ratings given by malicious users (referred
to as first-rating advantage attack). The following two
cases are considered in conducting first-rating advantage
attack. Case 1: an adversary creates multiple successive
higher/lower ratings by conducting a series of energy
transactions with small energy amounts. Case 2: adver-
saries collusively or coincidentally generate successive n
untruthful ratings to a specific LAG.
The following assumptions are made in the system design:
1) Honest EVs/PCPs always give truthful ratings that reflect
the true quality of service provided by the LAG, and honest
LAGs will always behave legitimately in the blockchain
network.
2) In the blockchain network, all LAGs (i.e., consensus
nodes) hold the same computing capacity. This assump-
tion is to simplify the analysis of 51% attack.
3) All participants in the system are assumed to be rational
and selfish, aiming to maximize their own utilities.
1Other blockchain vulnerabilities (e.g., selfish mining attack and Eclipse
attack) are not considered in this work.
Fig. 2. Workflow of the proposed BBC scheme.
IV. OUR PROPOSED BBC SCHEME
In this section, we present our BBC scheme to address secure
and efficient energy sharing among untrusted EVs and PCPs in
PCPSNs. It is composed of a secure PCP sharing algorithm for
efficient consensus management in energy blockchain, a reputa-
tion mechanism for evaluating the trustworthiness of consensus
nodes, and a joint coalition-matching game-based algorithm for
optimizing the decision-making process of each energy entity.
A. System Overview
As illustrated in Fig. 2, the workflow of our proposed BBC
scheme can be described by the following steps.
� Based on the collected public information, each EV runs
Algorithms 1–2 to decide its optimal energy demand and
the optimal PCP coalition to connect; meanwhile, each PCP
runs Algorithms 1–2 to determine its optimal coalition to
join and the optimal EVs to offer charging services (step
1©).
� The smart meter of each EV/PCP executes a program to
listen to the request from LAGs (i.e., full nodes) and sends
energy reports to the blockchain network (step 2©).
� After the charging process between an EV and a PCP
coalition, the EV sends an energy transaction tx1 (defined
in (5)) to the blockchain network; meanwhile, each PCP
in that coalition sends a redeem transaction tx2 (defined
in (6)) to the blockchain network to redeem its reward in
energy trading (step 3©). Each LAG independently runs
the proposed reputation-based PoW consensus protocol to
reach consensus in the blockchain (step 4©).
B. Energy Blockchain
In the consortium blockchain context, only authorized indi-
viduals can participate in the decentralized network, and only
consensus nodes can process new transactions in the consensus
phase [17]. In essence, the proposed energy blockchain network
is a kind of consortium blockchain which records the energy
transactions among various energy entities. For secured PCP
sharing and EV charging process, we propose a reputation-based
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
1862 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 71, NO. 2, FEBRUARY 2022
secure PCP sharing algorithm in the energy blockchain network,
where the following steps need to be undertaken:
1) Entity registration: To facilitate the entity registration
and key distribution process, the registration authority (RA)
is served as an authorized agent and maintains a certificate
repository which stores all registered entities and the corre-
sponding identities in the network. The RA is determined and
recorded in the genesis block of the blockchain. For system ini-
tialization, RA first selects a bilinear pairing e : G0 ×G1 → G2
in groups G0,G1,G2 of prime order q, where g0 and g1 are
the generators of G0 and G1, respectively. Then, RA chooses
two hash functions, i.e.,H0 : {0, 1}∗ → G2 andH1 : {0, 1}∗ →
Zq . Next, RA broadcasts the system parameters params =
(e,G0,G1,G2, q, g0, g1) to the network. Each EV, PCP, and
LAG become authorized in the blockchain network after regis-
tration with RA by using its real identity RID (e.g., the unique
vehicle identification number of EV, and the business license of
PCP and LAG). The set of authorized nodes in the blockchain
is denoted as K = [1, . . . , k, . . . ,K]. Each authorized node
k ∈ K obtains a set of V public/private key pairs {yvk , xvk}Vv=1,
certificates {Cervk}Vv=1, and wallet addresses {wv
k}Vv=1, and
stores them into its tamper-proof device. We have xvk
S←− Zq ,
yvk = g
xv
k
1 , and Cervk = SigxRA
(yvk ||time||exT ime), where
S←− means randomly sampling, xRA is the private key of RA,
time is the timestamp for certificate creation, and exT ime is
the expiration time of certificate.
2) BLS multi-signature for PCP coalition: Within a PCP
coalition Φn, each PCP member j ∈ Φn signs the same trans-
action which is agreed by both the EV i and all PCPs in the
coalition Φn during each energy trading process. To ease the
communication and storage cost of multiple signatures on the
same transaction in the blockchain, the Boneh-Lynn-Shacham
(BLS) multi-signature [37] is employed for energy transaction
generation and verification by aggregating all the signatures of
PCPs within a coalition. BLS signature is far shorter in terms
of signature size in comparison with other digital signature
mechanisms, e.g., digital signature standard (DSS) is 320 b
long while BLS signature is only 160 b long. The security of
BLS multi-signature mechanism depends on the assumption that
computational co-Diffie-Hellman (co-CDH) problem is hard in
the bilinear group (G0,G1) [38]. The set of public keys of PCPs
in coalition Φn is denoted as L = {y1, . . . , y|Φn|}. Specifically,
each PCP j in coalition Φn signs message Msg and generates
its signature as:
σj = H0(Msg)H1(yj ,{y1,...,y|Φn |})·xj . (3)
Within a PCP coalition Φn, a secretary node is designated to
compute the BLS multi-signature σn =
∏|Φn|
j=1 σj by aggregat-
ing all members’ signatures. In addition, by using the set of
public keys L, the aggregated public key can be computed as
apkn =
∏|Φn|
j=1
y
H1(yj ,{y1,...,y|Φn |})
j . (4)
Given (Msg, apkn, σn), each verifier can validate the correct-
ness of generated BLS multi-signature σn by checking whether
e(σ, g−1
1 ) · e(H0(Msg), apk) = 1G2 . If verification passes, the
verification function outputs accept; otherwise, it outputs
reject.
3) Energy trading process: After offering charging service for
EV i, PCP coalition Φn generates an energy transaction tx1 as
tx1 =
{
tx1
ID||yvi ||wn||{sj}|Φn|
j=1 ||rating
||coin||time||Sigi||MulSign} , (5)
where tx1
ID is the hash of transaction tx1, yvi is EV i’s v-th public
key, andwn is the generated wallet address of coalition Φn. sj is
the energy contribution of PCP j in coalition Φn and is defined
in Section IV-D. The rating tuple rating = {rai,m||raĵ,m} is
composed of the rating value rai,m that EV i gives to LAG
m and the rating value raĵ,m that PCP ĵ gives to LAG m.
Here, PCP ĵ is the one in coalition Φn that provides EV i
with the charging outlet for battery charging, coin is the energy
coin (i.e., a digital secure cryptocurrency) that EV i should
pay to coalition Φn for energy services, time is the timestamp
for transaction creation, Sigi = σi is the signature of tx1
ID of
EV i, and MulSign = ({yvj }
|Φn|
j=1 , σn) is the generated BLS
multi-signature of tx1
ID signed by all PCPs in coalition Φn.
Meanwhile, each member in coalition Φn (i.e., PCP j) can
redeem its reward coinj from the coalition’s wallet address wn
by generating a redeem transaction tx2. Here, the reward of each
member in the coalition is allocated according to its contribution,
i.e., coinj = sj · coin. The transaction tx2 is formulated as:
tx2 = {tx1
ID||tx2
ID||wn||yvj ||coinj ||time||Sigj}, (6)
where tx2
ID is the hash of transaction tx2, and Sigj = σj is the
signature of tx2
ID by using PCP j’s private key xvj .
4) Consensus process: In the blockchain network, each au-
thorized LAG can vote for a consensus node for consensus
management. The voting weight of each LAG m is determined
by its stake, i.e., reputation value Rm (defined in Section IV-
C). The reputation value of each LAG can be computed and
verified based on the blockchain. The top Q LAG delegates
are selected by voting to form the consensus committee Q =
{1, . . . , q, . . . , Q}. In the energy blockchain, each consensus
node q ∈ Q is responsible for transaction verification, block
building, and ledger management. Specifically, each consensus
node independently collects and verifies transactions (i.e., en-
ergy transaction tx1 and redeem transaction tx2) during each
consensus interval ΔT in the network. All valid transactions
during ΔT are sorted by their timestamps and compressed into
a local block Bq independently by each consensus node q. To
reach consensus, each consensus node q is required to compete
with each other to find a valid solution string nonceq of its
PoW puzzle with a certain difficulty [35]. The PoW puzzle for
consensus node q is denoted as:
H
(
yvq ||H (bHeaderq) ||pHash||nonceq
)
< targetq, (7)
where bHeaderq is the block header of block Bq, pHash is
the hash of the previous block in the blockchain, and targetq =
2targetmax−�q is the target of consensus node q’s PoW puzzle
and can be described as a series of binary bits with several
consecutive prefix zeros. Here, targetmax is the fixed maximum
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
WANG et al.: BLOCKCHAIN-BASED SECURE AND COOPERATIVE PCP SHARING SERVICES FOR VEHICULAR NETWORKS 1863
PoW target indicating the bits of the hash value which depends
on the hash algorithm such as 256 for SHA-256 and 160 for
SHA-1. �q ≥ 0 is the difficulty of PoW puzzle for consensus
node q indicating the number of consecutive prefix zero of
targetq .
The larger �q , the smaller PoW target targetq and the harder
to calculate a valid nonceq [39]. The difficulty of PoW puzzle
can be dynamically adjusted for different consensus nodes and
is inversely related to their stakes in the blockchain [39], [40].
Here, we employ the reputation value Rq as the stake of each
consensus node q, since user’s reputation value can grow gradu-
ally over time if it behaves legitimately while it can be destroyed
significantly once the misbehavior is detected. Hence, we have
�q =
⎢⎢⎢⎣ ς
log2
(
1 +Rq(
∑
q′∈QRq′)
−1
)
⎥⎥⎥⎦ , (8)
where ς is a positive scale factor, and �·� is the floor function.
According to (8), a consensus node with a higher reputation can
find a valid PoW solution more easily, which can motivate LAG
nodes to improve their reputation values to save their cost and
earn mining rewards by behaving cooperatively and legitimately.
Besides, to prevent the consensus node with too large stake
becoming the block producer continuously (which may cause
unfairness and threaten the decentralization of blockchain [35]),
we adopt the logarithmic function and relative reputation value
(i.e., Rq∑
q′∈QRq′
) in (8) to slow down the stake increment of
consensus nodes with large Rq .
The fastest consensus node q̂ ∈ Q who first solves the PoW
puzzle becomes the block producer and broadcasts its block
proposal B attached with its signature to the whole network.
Once receiving block B, each consensus node q ∈ Q\q̂ verifies
the correctness of the PoW solution and all the transactions in the
received block B. If the received block is successfully audited
by consensus node q, the newly built block B is appended to its
local copy of the blockchain in a linear and chronological order.
Otherwise, each LAG obeys the longest chain principle and
adopts the longest blockchain as the right one. After achieving
the consensus, the block producer (i.e., LAG q̂) who generates
the new block in the longest chain is rewarded with certain
energy coins r1 and the transaction fee r2 charged in each
transaction. Besides, the PCP coalition Φ̂∗n who contributes the
most clean energy during ΔT for EV charging is rewarded with
certain energy coins r3 as an incentive.
C. Reputation Evaluation
In this section, the reputation mechanism is designed to eval-
uate the trustworthiness of LAG operators in the blockchain
context, which is constructed from three aspects, namely, rat-
ing effect, behavior effect, and fading effect. The rating effect
means the effect of rating values given by EVs and PCPs to
the services provided by an LAG operator. The behavior effect
implies the effect of LAG’s behaviors in the consensus process
in blockchain. The fading effect arises from the fact that latest
behaviors and ratings are more important than previous ones
in reputation management. For each LAG operator m ∈M, its
reputation value Rm can be expressed as:
Rm = λRf (ratingm) + λBf (behaviorm) , (9)
where λR and λB are positive weight coefficients and satisfy
λR + λB = 1. f(ratingm) and f(behaviorm) are the rating
effect and behavior effect in reputation computing, respectively.
1) Rating effect: Let Im(t) = {1, . . . , i, . . . , Im(t)} and
Jm(t) = {1, . . . , j, . . . , Jm(t)} be the set of EVs and PCPs
which have interacted with LAG m during time interval
[0, t], t ∈ T , respectively. Let qi,m(t) and qj,m(t) be number of
interactions of EVs and PCPs with LAG m during time interval
[0, t], respectively. After h-th service offered by LAG m, EV
i ∈ Im(t) and PCP j ∈ Jm(t) generate a rating value rahi,m
and rahj,m to LAG m, respectively, which indicates the user
experience of the service. As shown in (5), the rating values
are recorded in the rating tuples of transaction tx1 and can
be recorded in the blockchain after reaching consensus. Here,
rahi,m, ra
h
j,m ∈ [0, 1], where 1 indicates absolutely positive ex-
perience, and 0 implies totally negative experience. Generally,
legitimate participants always offer true ratings, while malicious
ones may send untruthful feedbacks to launch attacks and earn
illegal profits. Therefore, the credibility of each rating given from
EVs and PCPs should be measured. Here, the cumulative sum
(CUSUM) control chart method, as a widely used sequential
analysis technology for monitoring change detection based on
hypothesis testing, is adopted to detect the abnormal ratings
before credibility evaluation. For the detailed detection proce-
dure using the CUSUM control chart method, please refer to the
works [41], [42]. Next, the credibility of each rating is related
to the level of confidence and similarity value.
Firstly, let coni,m(t) be the level of confidence of EV i in
LAG m based on the number of interactions until time slot
t. As shown in Section III-B, malicious users may launch the
bad-mouthing attack by generating a series of transactions with
small energy volume and dishonest ratings. Thus, the traded en-
ergy quantity in each energy transaction should be considered in
credibility computing. Here, if the traded energy di,Φn
between
PCP coalition Φn and EV i exceeds the predefined quantity
D in an energy transaction tx1, we define tx1 as an important
interaction. Otherwise, tx1 is a common interaction. We have
coni,m(t) = χ1 min
(
q1
i,m(t)
N1
, 1
)
+ χ2 min
(
q2
i,m(t)
N2
, 1
)
,
(10)
whereN1,N2 are predefined thresholds for the number of impor-
tant interactions and common interactions, respectively. q1
i,m(t),
q2
i,m(t) are the number of important interactions and common
interactions of EV i until time slot t, respectively, which satisfy
q1
i,m(t) + q2
i,m(t) = qi,m(t). χ1 and χ2 are weighted factors,
which satisfy χ1 + χ2 = 1 and χ1 ≥ χ2.
Secondly, in general, the higher similarity value (i.e., smaller
deviation) between a rating and other users’ ratings, the higher
credibility of that rating [1]. Here, the similarity of a specific rat-
ing is evaluated by the mean rating similarity (MRS)mrshi,m(t),
which is defined as the similarity value between the rating rahi,m
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
1864 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 71, NO. 2, FEBRUARY 2022
and the weighted average rating given to LAG m, i.e.,
mrshi,m(t) = 1−
∣∣rahi,m − avem(t)
∣∣ , (11)
where avem(t) is the weighted average rating which is given
from EVs and PCPs to LAG m and is calculated by
avem(t) =
∑
k∈Im(t)∪Jm(t)
∑
h∈qk,m(t)
rahk,md
h
k,mΛ∑
k∈Im(t)∪Jm(t)
∑
h∈qk,m(t)
dhk,mΛ
, (12)
where dhk,m is the amount of traded energy in h-th service, Λ =
e−λ(t−th) is the exponential fading function since latest ratings
are more essential than older ones, λ is the fading factor, and th
is the occurring time of h-th service.
Based on these dimensions, the credibility value of rating
rahi,m given from EV i ∈ Im(t) can be attained by
crehi,m(t) = coni,m(t) ·mrshi,m(t). (13)
Similarly, the credibility value of rating rahj,m given from PCP
j ∈ Jm(t) can be attained. Based on [43], [44], the rating effect
f(ratingm) in calculating LAG m’s reputation can be attained
by aggregating the ratings while considering the credibility and
time decay effect of each rating, as shown in (14) at the bottom
of this page. At the initial time t = 0, we set f(ratingm) = 0.5,
∀m ∈M.
2) Behavior effect: Commonly, legitimate behaviors of a node
can gradually improve its reputation over time, while mali-
cious behaviors can significantly destroy its trustworthiness [39].
Here, the behavior effect f(behaviorm) of LAGm in reputation
computing is associated with the positive behavior effect (i.e.,
ΞP
m) and negative behavior effect (i.e., ΞN
m), i.e.,
f(behaviorm) =
[
1 + e−ι(Ξ
P
m+ω·ΞN
m)
]−1
, (15)
where ι > 0 is an adjustment factor, andω ≥ 1 is a penalty factor
to punish LAG’s misbehaviors. We consider two types of pos-
itive behaviors, namely, successful block audit (SBA) behavior
after being a consensus node and successful block generation
(SBG) behavior after being a block producer. Let βb = {0, 1}
be the binary type of positive behavior, where βb = 0 means the
SBA behavior and βb = 1 indicates the SBG behavior. Then, the
positive behavior effect can be formulated as:
ΞP
m=
∑NSBA+NSBG
b=1
[
1−βb
βb
]T
×
[
rewardSBA
rewardSBG
]
e−λ1(t−tb),
(16)
where NSBA and NSBG are the numbers of SBA and SBG be-
haviors of LAG m, respectively. rewardSBA and rewardSBG
are the positive reward values for SBA behavior and SBG
behavior, respectively. λ1 > 0 is the rate of decay, and tb is the
occurring time of behavior b.
Let NMAL be the total number of malicious behaviors con-
ducted by LAG m (e.g., generating fake block), the negative
behavior effect can be formulated as:
ΞN
m = −
∑NMAL
b=1
punishb · e−λ2(t−tb), (17)
where punishb > 0 is the punishment value for misbehavior
b, and λ2 > 0 is the rate of decay. Note that all positive and
negative behaviors of LAGs are traced in the blockchain with
cryptographic evidence (e.g., the signatures of generated true
block and fake block). Additionally, all the valid ratings given
from EVs and PCPs are recorded in the energy transactions in the
blockchain. Thus, both the rating effect and the behavior effect of
LAGm can be calculated based on the blockchain. Since ΞP
m =
ΞN
m = 0 at the initial time t = 0, we have f(behaviorm) = 0.5
and Rm = 0.5, ∀m ∈M. It is obvious that f(ratingm) lies
within [0,1] and f(behaviorm) lies in (0,1), resulting in that
Rm ∈ (0, 1), ∀m ∈M. The reputation values of LAGs are com-
puted by the consensus nodes through mutual supervision and
can be recorded in the blockchain after consensus process. In
what follows, we remove all subscript t for simplicity.
D. Problem Formulation
Utility functions of PCP owners: In PCPSNs, since the amount
of available solar energy resources in each PCP is limited,
PCP owners in the same LAG can behave cooperatively and
form coalitions to improve resource efficiency and increase
their utilities by sharing their limited RE resources with each
other. In PCPSN, the set of PCP coalitions in all communities
is defined as Π = {Π1, . . . ,Πm, . . . ,ΠM}, where Πm is the set
of PCP coalitions in the coverage area of LAGm and is denoted
as Πm = {Φ1, . . . ,Φn, . . . ,ΦNm
}. Here, |Πm| = Nm, |Π| =∑M
m=1 |Πm|,Φn ∩ Φn′ = ∅, ∀n �= n′ and
⋃Nm
n=1 Φn = Jm. The
utility function of PCP coalition Φn in LAG m can be defined
as the revenue minus its cost in charging services, which can
be expressed as: Ω(Φn) = F(Φn)− C(Φn), where F(Φn) and
C(Φn) denote the revenue and the cost of PCP coalition Φn
for providing charging services to EVs, respectively. Since
there can be multiple EVs receiving charging services at a
PCP coalition Φn, we have F(Φn) =
∑
i∈Γn
pΦn
di,Φn
, where
Γn = {1, . . . , i, . . . , |Γn|} is the set of EVs receiving charging
services in PCP coalition Φn, |Γn| is the cardinality of set Γn,
pΦn
is the energy charging price of PCP coalition Φn, and di,Φn
is EV i’s energy demand in PCP coalition Φn. The cost of PCP
coalition Φn for providing solar energy resources to EVs in the
set Γn can be attained by C(Φn) =
∑
i∈Γn
cΦn
di,Φn
+ |Γn|δ1,
where cΦn
is the charging cost of PCP coalition Φn, and δ1 is
the fixed cost of a PCP in each charging operation such as the
operating fee for EV charging. Therefore, the overall utility of
f(ratingm) =
∑
i∈Im(t)
∑
h∈qi,m(t)
rahi,mcre
h
i,m(t)Λ +
∑
j∈Jm(t)
∑
h∈qj,m(t)
rahj,mcre
h
j,m(t)Λ∑
i∈Im(t)
∑
h∈qi,m(t)
crehi,m(t)Λ +
∑
j∈Jm(t)
∑
h∈qj,m(t)
crehj,m(t)Λ
(14)
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
WANG et al.: BLOCKCHAIN-BASED SECURE AND COOPERATIVE PCP SHARING SERVICES FOR VEHICULAR NETWORKS 1865
PCP coalition Φn in LAG m can be expressed as:
Ω(Φn)=
∑
i∈Γn
pΦn
di,Φn
−
∑
i∈Γn
cΦn
di,Φn
−|Γn| δ1.
(18)
In a coalition, different PCPs make different contributions to
provide solar energy resources for EV charging. The utility of
each PCP member in coalition Φn is in proportion to its contri-
bution in the coalition. Let sj be PCP j’s energy contribution in
coalition Φn, which is linearly related to its available solar en-
ergy resources EPV
j , i.e., sj = EPV
j
/∑
j∈Φn
EPV
j . Therefore,
the utility of PCP owner j who joins in coalition Φn in LAG m
can be calculated as:
Vj(Φn) = sjΩ(Φn) =
EPV
j∑
j∈Φn
EPV
j
(∑
i∈Γn
pΦn
di,Φn
−
∑
i∈Γn
cΦn
di,Φn
− |Γn| δ1
)
.
(19)
Here, if PCP j in LAG m does not join any coalition, we define
the coalition Φn = {j}. Let Π∗m = {Φ∗1, . . . ,Φ∗n, . . . ,Φ∗Nm
} be
the optimal coalition partition of PCPs in LAG m, where Φ∗n ∩
Φ∗n′ = ∅, ∀n �= n′. The objective of each PCP owner j ∈ Jm is
to maximize his/her utility function defined in (19) by forming
the optimal coalition structure Π∗m such that:
Problem 1 : Vj(Φ∗n) ≥ Vj(Φ∗n′), ∀j ∈ Jm, (20)
where Φ∗n ∈ Π∗m is the optimal coalition which includes PCP j.
For each PCP coalitionΦ∗n ∈ Π∗m, its objective is to maximize
its utility function defined in (18) by selecting the optimal set of
EVs to charge. The optimization problem for PCP coalition Φ∗n
can be formulated as:
Problem 2 : max
Γn
Ω(Φ∗n), ∀Φ∗n ∈ Π∗m,m ∈M, (21)
s.t.
⎧⎨⎩
|Γn| ≤ |Φ∗n| , (22a)
0 ≤ pΦ∗n ≤ pgrid, (22b)∑
i∈Γn
di,Φ∗n ≤
∑
j∈Φ∗n E
PV
j . (22c)
Here, constraint (22a) is the charging outlet constraint, imply-
ing that the number of EVs that are charging in PCP coalitionΦ∗n
should be less than or equal to the available charging outlets |Φ∗n|
in the coalition. Constraint (22b) is the charging price constraint,
indicating that the charging price of PCP coalitions should be
positive and no more than the charging price of public charging
stations (i.e., pgrid). Constraint (22c) indicates that the total
energy demand of EVs in the set Γn should be less than or
equal to the available RE resources in coalition Φ∗n.
Utility functions of EV users: The utility function of EV user
i ∈ I who requests energy demand di,Φn
from PCP coalition
Φn in LAG m can be defined as its payoff minus its cost,
which is given as: Ui(Φn) = �i(Φn)− Gi(Φn), where �i(Φn)
denotes the payoff of EV i for consuming energy di,Φn
from
PCP coalition Φn, and Gi(Φn) is the cost of EV i during energy
charging process. The payoff of EV i is associated with the user
satisfaction, saved purchase cost, and saved distance cost, which
can be obtained by
�i(Φn)=Qi(Φn)+(pgrid − pΦn
) di,Φn
+ξi (li,grid−li,Φn
) ,
(23)
where Qi(Φn) is the satisfaction function of EV i in energy
consumption. The second term in (23) represents the saved
expenditure of EV i that gets energy service in PCP coalition
Φn with unit price pΦn
, instead of the public charging stations
with unit price pgrid. The third term in (23) means the saved
distance cost of EV i that gets charged in PCP coalition Φn with
distance li,Φn
, instead of the nearest public charging station with
distance li,grid. ξi is the unit energy consumption rate of EV i on
the route. According to [45], [46], the user satisfaction function
Qi(Φn), as a measurement of EV user’s QoE, can be modeled as
a natural logarithmic function of the energy consumption, i.e.,
Qi(Φn) = κiαisoi,Φn
ln (1 + ηidi,Φn
) , (24)
where κi > 0 is an adjustment coefficient. αi is a willingness to
pay parameter, which represents EV i’s desire or range anxiety
for energy charging behaviors. αi is in direct proportion to
the distance with PCP coalition (i.e., li,Φn
) and is inversely
proportional to the initial SoC of EV i when arriving at the
PCP (i.e., SoCarr
i ) [47]. We have αi =
li,Φn
SoCarr
i
.
In general, a PCP owner is more willing to share his/her
charging outlet with EVs that have higher social relationships.
Let soi,k ∈ [0, 1] be the social relation value between user i
and user k in the social network, which can be calculated
by soi,k =
z·li,k
max(z) , where O = {1, . . . , o, . . . , O} is the set of
social relationships among users [1], e.g., friends, relatives, and
colleagues. z = [z1, . . . , zo, . . . , zO] is the vector of social rela-
tion values, zo ≥ 0 is the social relation value between two users
with relationship o, and li,k = (li,k,1, . . . , li,k,o, . . . , li,k,O) is
the binary vector between user i and user k. If li,k,o = 1, it
means that user i and user k have a relationship o; otherwise,
li,k,o = 0. In (24), soi,Φn
= �+ 1
|Φn|
∑
j∈Φn
soi,j is the average
social relation between EV i and PCP coalition Φn, where
� is a small positive value to ensure Qi(Φn) > 0. The cost
of EV i during energy charging process can be obtained by
Gi(Φn) = εidi,Φn
+ δ2, where εi is the unit battery degradation
cost of EV i, and δ2 is the fixed cost of an EV during energy
charging process (e.g., the operating fee for battery charging
and transaction fee in the blockchain). Therefore, the utility of
EV i that requests solar energy from PCP coalitionΦn is denoted
as:
Ui(Φn) = κiαisoi,Φn
ln (1 + ηidi,Φn
) + (pgrid − pΦn
) di,Φn
+ ξi (li,grid − li,Φn
)− εidi,Φn
− δ2. (25)
The objective of each EV user i ∈ I is to maximize his/her
utility function by choosing the optimal energy demand strategy
and the optimal charging service provider. Thus, the optimiza-
tion problem for EV i can be formulated as:
Problem 3 : max
di,Φn ,Φn
Ui(Φn), ∀i ∈ I,Φn ∈ Πm, (26)
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
1866 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 71, NO. 2, FEBRUARY 2022
s.t.
⎧⎨⎩Eini
i − ξili,Φn
≥ SoCmin
i CEV
i , (27a)
Eini
i − ξili,Φn
+ ηidi,Φn
≤ CEV
i , (27b)
0 ≤ di,Φn
≤ vmax. (27c)
Here, constraints (27a) and (27b) are battery energy constraints.
Constraint (27a) indicates that the battery energy of EV i when
arriving at PCP coalition before charging (i.e., Earr
i = Eini
i −
ξili,Φn
) should be no less than its minimum battery energy
(i.e., SoCmin
i CEV
i ), where Eini
i is the initial battery energy
when requesting charging services, and ξili,Φn
is EV i’s energy
consumption on route to the community. Constraint (27b) means
that the battery energy of EV iwhen leaving PCP coalition after
charging (i.e., Elea
i = Earr
i + ηidi,Φn
) should be no more than
its battery capacity (i.e.,CEV
i ). Constraint (27c) implies that the
energy demand of EV i is constrained by the lower bound (i.e.,
0) and upper bound (i.e., vmax). In what follows, we analyze the
optimal decision-making process of EVs and PCPs in detail and
devise a joint coalition-matching game-theoretical algorithm to
address the Problems 1, 2, and 3.
E. Many-to-One Matching Game
In PCPSNs, a coalition of PCPs in an LAG can offer energy
charging services for a group of EVs and each EV can only
charge at a specific PCP coalition. Thus, the energy scheduling
problem for EVs and PCP coalitions in Problems 2− 3 can
be formulated as a many-to-one matching game [12], [48]. In
the following, the definition of many-to-one matching game
between EVs and PCP coalitions is first given.
Definition 1 (Many-to-one matching): LetΨ be a many-to-one
matching, which is defined as a bidirectional mapping between
the set of EVs I and the set of PCP coalitions Π, satisfying the
following requirements:
� ∀Φn ∈ Π, each PCP coalition Φn is assigned to at most
|Φn| EVs, namely, Ψ(Φn) ∈ I ∪ {∅} and |Ψ(Φn)| ∈
{0, . . . , |Φn|}.
� ∀i ∈ I, each EV i is assigned to at most one PCP coalition,
namely, Ψ(i) ∈ Π ∪ {∅} and |Ψ(i)| ∈ {0, 1}.
Definition 2 (Preference relation): If PCP coalitionΦn prefers
EV i to i′ (∀i, i′ ∈ I, i �= i′), the strict preference relation �Φn
is defined such that:
i�Φn
i′ ⇔ Ωi (Φn) > Ωi′ (Φn) , (28)
where Ωi(Φn) is the utility of PCP coalition Φn for offering
energy service to EV i, i.e., Ωi(Φn)=(pΦn
−cΦn
)di,Φn
−δ1.
Similarly, if EV i prefers PCP coalition Φn to Φn′ (∀Φn,Φn′ ∈
Π, n �= n′), the strict preference relation�i is defined such that:
Φn�iΦn′ ⇔ Ui (Φn) > Ui (Φn′) . (29)
Compared with existing matching approaches [12], [48], [49],
our matching algorithm has two features: 1) we derive the opti-
mal resource demands of users in establishing their preference
orders with consideration of the charging anxiety, charging price,
and social ties; 2) we consider the cooperation of participants
and integrate the coalition game into the matching process
to promote the resource utilization. In the proposed matching
game, each EV can determine its optimal charging demand in the
coalition of PCPs to establish its preference list. The following
theorem is given to determine EV’s optimal energy demand
strategy.
Theorem 1: In the many-to-one matching game, the optimal
energy demand of EV i in PCP coalition Φn is
d∗i,Φn
=
⎧⎨⎩
vmax, 0 < pΦn
≤ pθ2 ,
κiαisoi,Φn
εi+pΦn−pgrid
− 1
ηi
, pθ2 < pΦn
< pθ1 ,
0, pθ1 ≤ pΦn
≤ pgrid.
(30)
where pθ1 andpθ2 are critical prices and are separately defined
as: {
pθ1 = κiαiηisoi,Φn
− εi + pgrid, (31)
pθ2 =
κiαiηisoi,Φn
1+ηivmax
− εi + pgrid. (32)
Proof: To attain EV’s optimal energy demand strategy,
we take the first derivative of Ui(Φn) with respect to
di,Φn
as ∂Ui(Φn)
∂di,Φn
=
κiαisoi,Φnηi
1+ηidi,Φn
− εi + pgrid − pΦn
. The sec-
ond derivative of Ui(Φn) with respect to di,Φn
is ∂2Ui(Φn)
∂di,Φn
2 =
−κiαisoi,Φnηi
2
(1+ηidi,Φn )2 < 0. It implies that the utility function Ui(Φn)
is strictly concave with respect to di,Φn
, and Ui(Φn) has the
maximum value. We can further obtain limdi,Φn→0
∂Ui(Φn)
∂di,Φn
=
pθ1 − pΦn
and limdi,Φn→vmax
∂Ui(Φn)
∂di,Φn
= pθ2 − pΦn
. Next, the
following cases are considered.
Case 1: If pθ1 ≤ pΦn
≤ pgrid, since pθ1 > pθ2 , we can derive
that limdi,Φn→0
∂Ui(Φn)
∂di,Φn
≤ 0 and limdi,Φn→vmax
∂Ui(Φn)
∂di,Φn
< 0.
Therefore, the optimal energy demand is d∗i,Φn
= 0. In this case,
EV i will not trade energy with the PCP coalition Φn.
Case 2: If 0 < pΦn
≤ pθ2 , we can derive that limdi,Φn→0
∂Ui(Φn)
∂di,Φn
> 0 and limdi,Φn→vmax
∂Ui(Φn)
∂di,Φn
≥ 0. Hence, the opti-
mal energy demand of EV i is d∗i,Φn
= vmax.
Case 3: If pθ2 < pΦn
< pθ1 , we have limdi,Φn→0
∂Ui(Φn)
∂di,Φn
>
0 and limdi,Φn→vmax
∂Ui(Φn)
∂di,Φn
< 0. Therefore, the optimal en-
ergy demand can be resolved by ∂Ui(Φn)
∂di,Φn
= 0, i.e., d∗i,Φn
=
κiαisoi,Φn
εi+pΦn−pgrid
− 1
ηi
. This completes the proof. �
Next, we give the definition of stable matching and develop a
stable many-to-one matching algorithm in Algorithm 1 to search
the stable matching results between PCP coalitions and EVs in
a distributed manner.
Definition 3 (Stable matching): Ψ is a stable many-to-one
matching, iff there does not exists any blocking pair (Φn, i),
i.e.,
�(Φn, i), s.t. i�Φn
Ψ(Φn) andΦn�iΨ(i), (33)
where i /∈ Ψ(Φn) andΨ(i) �= Φn. Here,Ψ(Φn) andΨ(i)denote
the current matching pairs for PCP coalition Φn and EV i,
respectively.
Theorem 2: The matching results Ψ∗ of the proposed Algo-
rithm 1 is stable.
Proof: Since both PCP coalitions and EVs’ preference lists
(i.e.,CPLn andEPLi) are finite, it is obvious that Algorithm 1
can converge. Without loss of generality, we assume that EV
i and EV i′ (i, i′ ∈ I) are assigned to PCP coalition Φn and
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
WANG et al.: BLOCKCHAIN-BASED SECURE AND COOPERATIVE PCP SHARING SERVICES FOR VEHICULAR NETWORKS 1867
Algorithm 1: Stable Many-to-One Matching Algorithm.
1: Initialization: Each PCP coalition Φn ∈ Π broadcasts
its charging price pΦn
, the amount of total charging
outlets |Φn|, and the amount of total available solar
energy EΦn
=
∑
j∈Φn
EPV
j .
2: Each EV i ∈ I computes its optimal energy demand
d∗i,Φn
in each PCP coalition based on (30).
3: Repeat
4: Each EV i establishes its preference list EPLi by
ranking the PCP coalitions in a decreasing order based
on the utility Ui(Φn) in (25) and constraints
(27a)–(27c).
5: Each EV i sends its charging request with the optimal
energy demand d∗i,Φn
to the first item in EPLi.
6: Each PCP coalition Φn establishes its preference list
CPLn by ranking the EVs that have sent energy
requests to itself in a decreasing order based on the
utility Ω(Φn) in (18).
7: if |CPLn| ≤ |Φn| and
∑
i∈CPLn
di,Φn
≤ EΦn
then
8: Each PCP coalition Φn accepts all EVs’ charging
requests in CPLn and updates its charging
acceptance list as AccListn=CPLn.
9: else
10: Each PCP coalition Φn chooses a part of EVs, i.e.,
the set Γn ⊆ CPLn, to offer charging services by
resolving the following problem:
argmax
Γn
{Ω(Φn)}=argmax
Γn
{∑
i∈Γn
d∗i,Φn
}
,
s.t. (22a)(22c).
(34)
11: Each PCP coalition Φn updates the charging
acceptance list as AccListn = Γn, and rejects other
EVs in the set CPLn\Γn.
12: Each PCP coalition Φn updates the used clean
energy resources as DΦn
=
∑
i∈AccListn
d∗i,Φn
, and
the number of available charging outlets as
|Φn| − |AccListn|.
13: end if
14: Until AccListn in each PCP coalition remains
unchanged.
15: Output: Stable matching outcome
Ψ∗={AccListn}|Π|n=1.
PCP coalition Φn′ (Φn,Φn′ ∈ Π) in the matching results Ψ∗
of Algorithm 1, respectively. Next, we prove the theorem by
contradiction. Assuming that a blocking pair (Φn, i
′) exists in the
matching outcomeΨ∗ such that i′�Φn
Ψ∗(Φn)and Φn�i′Ψ
∗(i′).
In other words, coalition Φn prefers EV i′ to EV i, and EV
i′ prefers coalition Φn to coalition Φn′ . According to lines 3–
13 in Algorithm 1, we have Ψ∗(i) = Φn, which means that EV
i′ is assigned to coalition Φn and contradicts with the primary
assumption. Hence, any blocking pair (Φn, i
′) does not exist in
the final matching outcome of Algorithm 1 and the proposed
matching algorithm is stable. This completes the proof. �
Theorem 3: The computational complexity of Algorithm 1 is
O(I · |Π|2).
Proof: In line 2, each EV calculates the optimal energy de-
mands for all PCP coalitions, yielding O(I · |Π|). Within the
while-loop, the complexity of building an EV’s preference list
in lines 4-5 is O(I · |Π|), and the complexity of preference list
building and acceptance list update of a PCP coalition in lines
6-12 is O(|Π| ·max{|Γn|}). Based on [48], it is guaranteed
that our matching algorithm can terminate after t ≤ Π steps
since no EV sends energy request to a PCP coalition twice.
Hence, the overall complexity isO(I · |Π|+ |Π|{I · |Π|+ |Π| ·
max{|Γn|}}) = O(I · |Π|2). �
F. Coalition Formation Game for PCPs
In PCPSNs, the energy interactions among PCPs in each LAG
(i.e., Problem 1) can be modeled as a coalition formation game
with a transferable utility, whereby each PCP can collaborate
with each other by constructing a coalition to share the limited
solar energy and improve its utility [46]. Since the local RE
exchange process is managed by the LAG in each community,
PCPs can only exchange RE with others in the coverage of the
same LAG. The definition of coalition formulation game among
PCPs is given as below.
Definition 4 (Coalition game): A coalition game for PCPs is
defined by the pair (Π,Ω), where Π = {Π1, . . . ,Πm, . . . ,ΠM}
is a partition structure of PCPs, and Ω is a mapping that assigns
each PCP coalitionΦn ∈ Πwith a coalition utilityΩ(Φn), where
Ω(Φn) is defined in (18).
Given a current coalition structure, each cooperative PCP can
choose three options: i) split from the current coalition and act
alone; ii) merge with any other coalition; iii) stay in the current
coalition. Since a part of PCPs may transfer from one coalition to
another one, then the partition of the network (i.e., Π) changes.
The solution of the proposed coalition formulation game is a
stable coalitional structure (i.e., stable partition Π∗). Generally,
the stable partition result of a coalition game can be obtained
through exhaustive search, where the possible partition iteration
times increase exponentially with the number of cooperative
PCPs [50]. Here, by implementing the following transfer and
acceptance rules, a coalition formation algorithm with low com-
putational complexity is presented in lines 2–17 of Algorithm 2
to attain the optimal coalition forming decision of each player
(i.e., PCP j) in the game.
Definition 5 (Transfer rule): Given a partition structureΠm =
{Φ1, . . . ,Φn, . . . ,ΦNm
} in LAG m, any cooperative PCP j ∈
Jm can transfer from its current coalition Φn ∈ Πm to another
coalitionΦn′ ∈ Πm ∪ {∅}, whereΦn ∩ Φn′ = ∅,∀n �= n′, if the
following conditions are satisfied:
1) Vj(Φn′ ∪ {j}) > Vj(Φn),
2) PCP j is accepted by coalition Φn′ .
where Vj(·) is the utility of PCP j who joins in coalition (·).
Definition 6 (Acceptance rule): Given a partition structureΠm
in LAGm, a coalition Φn′ ∈ Πm will accept PCP j ∈ Jm if the
following conditions are satisfied:
1) V×(Φn′ ∪ {j}) ≥ V×(Φn′), ∀× ∈ Φn′ ,
2) constraints (22a) and (22c).
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
1868 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 71, NO. 2, FEBRUARY 2022
where V×(·) is the utility of PCP × who is in coalition (·).
It is noteworthy that the transfer order can make an effect
on the utilities of coalitions and the coalition formation results,
when multiple PCPs request to transfer to the same coalition. For
example, both PCP j1 ∈ Φ1 and PCP j2 ∈ Φ2 desire to transfer
to coalition Φ3, and both of them meet the transfer rule. When
PCP j1 or j2 is accepted by coalition Φ3, the other PCP may not
satisfy the transfer rule any more. To capture PCP coalition’s
preference for the transfer order, a transfer priority is defined
for any PCP j ∈ Φn that attempts to transfer to another coalition
Φn′ , n �= n′ as:
ψj (Φn,Φn′)=Ω (Φn\{j})+Ω (Φn′ ∪{j})−Ω(Φn)−Ω(Φn′) .
(35)
Therefore, when multiple PCPs request to transfer to the same
coalition Φn′ and satisfy the acceptance rule, the PCP with the
largest transfer priority will be accepted by coalition Φn′ , i.e.,
j∗ = argmaxψj (Φj ,Φn′) , j ∈ Φj , ∀j ∈ Σn′ , (36)
where Φj is the current coalition of PCP j, and Σn′ is the set
of PCPs that request to transfer to coalition Φn′ . Then, based
on the transfer rule, acceptance rule and the transfer priority,
PCP j∗ will leave the current coalition Φj∗ through the split
operation, i.e., Φj∗
split−−−→ {Φj∗\{j∗}, {j∗}}, and join the coali-
tion Φn′ through the merge operation, i.e., {Φn′ , {j∗}}
merge−−−−→
Φn′ ∪ {j∗}.
Next, we give the definition of Nash-stable partition and prove
that the proposed coalition formulation algorithm in Algorithm 2
is Nash-stable.
Definition 7 (Nash-stable partition): A partition Π∗ =
{Π∗m}Mm=1 is Nash-stable [50], if ∀j ∈ Jm,Φj′ ∈ Π∗m ∪
{∅},m ∈M such that:
Φj�j{Φj′ ∪ {j}} ⇔ Vj (Φj) ≥ Vj (Φj′ ∪ {j}) , (39)
whereΦj is the current coalition of PCP j inΠ∗, andΦj ∩ Φj′ =
∅. The Nash-stable partition Π∗ means that no PCP intends to
move from its present coalition to another coalition in Π∗ or opt
to work alone (i.e., join the empty coalition {∅}).
Lemma 1: Each PCP’s transfer operation, i.e., spilt-and-
merge operation, can improve the total utility of PCPs in J .
Proof: Given any initial partition Π0, the coalition formation
process of PCPs can be denoted as a sequence, namely, {Π0 →
· · · → Πt → · · · → Π∗}, where Πt = {Φt
1, . . . ,Φ
t
n, . . . ,Φ
t
|Πt|}
is a partition of PCPs after t-th iteration.
For any partition Πt, if EV i transfers from coalition Φt
n to
Φt
n′ (i.e., EV i splits from coalition Φt
n and merges into coalition
Φt
n′ ), based on Definitions 5− 6, the following inequality holds:
Ω
(
Φt
n\ {j}
)
+Ω
(
Φt
n′ ∪ {j}
)
> Ω
(
Φt
n
)
+Ω
(
Φt
n′
)
. (40)
Besides, EV i’s transfer operation does not influence the utilities
of other coalitions in the set Πt\{Φt
n,Φ
t
n′ }. Thus, for any
transfer operation Πt → Πt+1, the following inequality always
holds: ∑
Φt
n∈Πt
Ω
(
Φt
n
)
<
∑
Φt+1
n ∈Πt+1
Ω
(
Φt+1
n
)
. (41)
Algorithm 2: Joint Coalition-Matching Algorithm in
PCPSNs.
1: Initialization: Set t = 0, {T listj}Jj=1 = ∅. Partition
all the PCPs in LAG m by
Πm = Π0
m = {Φ0
n}Jm
n=1 = {j}Jm
j=1, ∀m ∈M.
2: Coalition formulation phase:
3: Repeat
4: for m ∈M do
5: for j ∈ Jm do
6: Calculate all transferable PCP coalitions including
the empty set {∅} according to the transfer rule in
Definition 5, and record them into the set T listj .
7: Calculate the most preferred PCP coalition to
transfer through the following equation:
Φt
n
∗
=argmaxVj
(
Φt
n ∪ {j}
)
, ∀Φt
n ∈ T listj .
(37)
8: end for
9: for Φt
n ∈ Πt
m do
10: Filter PCPs’ transfer requests according to the
acceptance rule in Definition 6, and record them
into its acceptable list Σn.
11: Accept PCP j∗ with the largest transfer priority
through the following equation:
j∗ = argmaxψj
(
Φt
j ,Φ
t
n
)
, ∀j ∈ Σn, (38)
where Φt
j is the current coalition of PCP j at t-th
iteration.
12: Reject other PCPs in the set Σn\{j∗}.
13: Do split operation, i.e., Φt
j∗
split−−−→ {Φt+1
j∗ , {j∗}},
where Φt+1
j∗ = Φt
j∗\{j∗}.
14: Do merge operation, i.e., {Φt
n, {j∗}}
merge−−−−→ Φt+1
n ,
where Φt+1
n = Φt
n ∪ {j∗}.
15: end for
16: t = t+ 1
17: Update the coalition structure in LAG m as
Πt
m = {Φt
1, . . . ,Φ
t
n, . . . ,Φ
t
Nm
}.
18: Many-to-one matching phase:
19: Get the stable matching pairs Ψ∗t through
Algorithm 1.
20: end for
21: Until no PCPs do split or merge operations in lines 13
and 14.
22: Output: Stable coalitional structure Π∗ = Πt, and
stable matching results Ψ∗ = Ψ∗t .
The above inequality indicates that PCP’s transfer operation will
eventually increase the total utility of all PCPs. This completes
the proof. �
Theorem 4: The proposed coalition formulation algorithm in
Algorithm 2 can converge to a Nash-stable coalitional partition.
Proof: First, from Lemma 1, we can conclude that for any
transfer operation Πt → Πt+1, the inequality Πt �= Πt+1 can
always hold. Next, the maximum number of partitions among
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
WANG et al.: BLOCKCHAIN-BASED SECURE AND COOPERATIVE PCP SHARING SERVICES FOR VEHICULAR NETWORKS 1869
Jm PCPs in community m can be calculated by using the Bell
number function [51], mathematically,
BJm
=
∑Jm
j=1
(
Jm−1
j
)
Bj , ∀j ≥ 1andB0 = 1. (42)
From (42), obviously, the number of coalitional partitions among
Jm PCPs is finite. In addition, the overall utility of the PCPs in
J is bounded. Thus, the coalition formulation sequence {Π0 →
Π1 → · · · → Πt → Πt+1 → · · · } can be converged to a final
stable partition Π∗.
Next, we prove that Π∗ is a Nash-stable partition by con-
tradiction. Assume that Π∗ is not Nash-stable. Consequently,
according to Definition 7, there exists a PCP j ∈ Φj ⊂ Π∗
and a coalition Φj′ ∈ Π∗ ∪ {∅} such that {Φj′ ∪ {j}}�jΦj . In
this case, PCP j will perform the split-and-merge operation to
improve its utility, which contradicts with the fact that Π∗ is the
convergent outcome of Algorithm 2. Therefore, any partition
result Π∗ derived from Algorithm 2 is Nash-stable, and the
theorem is proved. �
Theorem 5: The computational complexity of the coali-
tion formulation algorithm for each community m is
O(TmJm|Πm|), where Tm ≤ BJm
is the number of iterations
for Nash-stable partition in community m ∈M.
Proof: The complexity of the coalition algorithm in commu-
nity m (i.e., lines 5-17 of Algorithm 2) mainly contains two
parts: 1) the first for-loop (i.e., lines 5-8) for each PCP to attain
the most preferred transfer; 2) the second for-loop (i.e., lines
9-15) for each PCP coalition to select the PCP with the largest
transfer priority. The first part has a complexity ofO(|Πm|Jm),
and the second part has a complexity of O(|Πm|max{|Σn|}).
As max{|Σn|} ≤ Jm, the coalition formulation algorithm for
each community m has a complexity of O(TmJm|Πm|). �
To find the Nash-stable coalition formulation strategies for
collaborative PCPs and the stable matching outcome between
PCP coalitions and EVs simultaneously, a joint coalition-
matching algorithm is developed in Algorithm 2.
V. PERFORMANCE EVALUATION
We implement the proposed scheme based on Ethereum and
conduct simulations based on Matlab. We first analyze the
security of our system in Section V-A. Then, the implementation
details and experimental results are introduced in Section V-B,
followed by the simulation settings and findings in Section V-C.
A. Security Analysis
Through the blockchain technology and reputation assess-
ment, our proposed BBC approach can secure EV charging and
PCP sharing process in PCPSNs and defend against adversaries
defined in Section III-B.
� Compromised Sharing Platform. By replacing the central-
ized network with the decentralized blockchain network,
the security risks arisen from the central sharing platform
can be removed.
Fig. 3. Detection ratio of malicious LAGs vs. ratio of legitimate EVs/PCPs
by comparison with RRS and BRS schemes.
Fig. 4. Ratio of stakes owned by legitimate consensus nodes (RSoL) vs. ratio
of malicious LAGs by comparison with traditional PoW scheme.
� Repudiation and Fraud Attacks. If a compromised or mali-
cious PCP advertises fake charging services, its true iden-
tity can be revealed by RA, as well as the corresponding
penalty countermeasures can be enforced once detected.
Moreover, since all the valid energy transactions can be
stored in the verifiable and immutable blockchain after
reaching consensus, each EV user cannot deny the cor-
responding transactions and refuse to pay. Thus, the repu-
diation and fraud attacks can be defended.
� Collusion and 51% Attacks. With the assumption that all
LAGs (i.e., consensus nodes) hold the same computing
capacity, our proposed scheme can tolerate up to 50%
adversarial stakes (i.e., reputation values) in the consensus
committee. In other words, if the ratio of total reputation
values hold by collusive malicious LAGs is less than 50%,
our blockchain system is secure and can defend against the
51% attack [36]. The security of blockchain consensus can
be seen in Figs. 3–4 in Section V-B especially when the
ratio of honest LAGs is low.
� Other Attacks. By jointly considering the amount of traded
energy in each energy transaction, dishonest ratings in mul-
tiple transactions with small traded energy volume given
by malicious users are assigned with smaller credibility
values to reduce the effect of bad-mouthing attack. Note
that in similarity computing in (11), adversarial EVs/PCPs
may perform first-rating advantage attacks for profits. The
analysis for cases 1 and 2 of first-rating advantage attack
can be seen in Table IV in Section V-B.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
1870 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 71, NO. 2, FEBRUARY 2022
TABLE III
EXPERIMENT SETTING IN THE IMPLEMENTATION
TABLE IV
COMPARISON OF MEAN RATING SIMILARITY IN DEFENDING AGAINST
FIRST-RATING ADVANTAGE ATTACK
B. Implementation
Our prototype is established by configuring 15 Ethereum
full nodes using the Docker container environment in a private
Ethereum network. The EV and PCP clients are run on Android
devices and developed using the Android Studio environment.
EV/PCP client Apps act as lightweight nodes in the Ethereum
network and can connect to full nodes via remote procedure call
(RPC) interface. The functions of EV/PCP’s smart meters are
deployed on Raspberry Pi Model 3B devices. The experimental
hardware for testing our private Ethereum prototype is a com-
puter with Intel Core i7-8700 CPU, 3.6 GHz, 32 GB RAM, and
Ubuntu 16.04 OS. For the reputation model, the social relation
values among PCP owners and EV users are uniformly dis-
tributed in [0, 1]. The rating value of a legitimate PCP/EV given
to a legitimate or malicious LAG is randomly picked in [0.5, 1]
or [0, 0.5), respectively. Malicious PCPs/EVs may conduct the
bad-mouthing attack and first-rating advantage attack to LAGs,
and malicious LAGs may conduct the collusion attack and 51%
attack in the consensus process. Other experiment parameters
are summarized in Table III.
We employ the following metrics to evaluate the performance
of the proposed reputation-based PoW consensus algorithm.
� Detection ratio of malicious LAGs [18]: The ratio be-
tween the successfully detected malicious LAGs (i.e., full
nodes) and the total number of malicious LAGs in the
network.
� Ratio of stakes owned by legitimate consensus nodes
(RSoL): Inspired by [18], we define a similar metric RSoL,
which is defined as the ratio of the stakes (i.e., reputation
value) owned by legitimate consensus nodes to the total
reputation value of consensus nodes in the consensus com-
mittee Q.
The proposed scheme is compared with three other competing
approaches in terms of charging security, as described below.
� Rating-based Reputation Scheme (RRS): In this scheme,
LAGs’ reputation values are calculated based on the rating
effect by using Eqs. (10)–(14).
� Behavior-based Reputation Scheme (BRS): In this scheme,
the reputation of LAGs is evaluated based on the behavior
effect by using Eqs. (15)–(17).
� Traditional PoW Scheme: In this scheme, all LAGs serve
as the consensus nodes while the reputation evaluation of
LAGs is not considered. Here, the stakes of LAGs in the
blockchain means their computing capacities are the same.
Fig. 3 depicts the detection ratio of malicious LAGs in three
schemes with respect to the ratio of legitimate EVs/PCPs ranging
from 0.3 to 0.7. Here, the ratio of malicious LAGs is rLAG
m = 0.3
and other experiment settings are unchanged. From Fig. 3, we
can see that the proposed scheme acquires the highest detection
ratio of malicious LAGs given different ratios of legitimate users.
It can be explained as follows. In the BRS (or RRS) scheme, as
the rating (or behavior) effect in reputation evaluation is absent,
users cannot acquire the full profile of the trustworthiness of
LAGs, causing a relatively lower detection ratio of malicious
LAGs. Besides, in Fig. 3, compared with the RRS scheme, the
BRS scheme attains a higher detection result when the ratio of
malicious EVs/PCPs (i.e., ruserm ) is relatively high and a lower
one when ruserm is relatively low. The reason is that the higher
ruserm means the more produced untruthful ratings to LAGs,
causing a lower accuracy of reputation assessment in the RRS
scheme.
Fig. 4 illustrates the RSoL in two schemes when the ratio of
malicious LAGs ranges from 0.1 to 0.7. Here, ruserm is set as 0.6.
Other experiment settings are unchanged. From Fig. 4, it can be
observed that the proposed scheme outperforms the traditional
PoW scheme by achieving a higher RSoL when the ratio of
malicious LAGs rLAG
m grows. The reason behind is that in the
traditional PoW scheme, all LAGs including malicious ones
are responsible for consensus management in the blockchain
network since the reputation assessment of consensus nodes is
not considered. In the proposed scheme, through the reputation
evaluation mechanism, malicious LAGs are assigned with low
reputation values and can be excluded from the consensus
committee with a high probability, resulting in an improved
RSoL in the blockchain network. In particular, we can see that
when rLAG
m = 0.7, only about 30% of stakes are controlled by
adversaries in our proposed scheme, while that in traditional
PoW scheme is nearly 70%. As such, our blockchain system is
still secure and can defend against the collusion and 51% attacks
even when rLAG
m is high.
Fig. 5 shows the RSoL in two schemes with respect to the ratio
of malicious EVs/PCPs ranging from 0.2 to 0.8. Here, the ratio
of malicious LAGs is set as 0.3. Other settings keep unchanged.
As seen in Fig. 5, our proposed scheme attains a higher RSoL
than the traditional PoW scheme even the ratio of malicious
EVs/PCPs becomes large. Meanwhile, the RSoL in the tradi-
tional PoW scheme is unchanged as all LAGs other than EVs or
PCPs can publicly join the consensus process. Additionally, we
can observe that in the proposed scheme, the RSoL decreases
with the increase of the ratio of malicious EVs/PCPs (i.e., ruserm ).
The reason is that with a higher ruserm , more malicious feedbacks
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
WANG et al.: BLOCKCHAIN-BASED SECURE AND COOPERATIVE PCP SHARING SERVICES FOR VEHICULAR NETWORKS 1871
Fig. 5. Ratio of stakes owned by legitimate consensus nodes (RSoL) vs. ratio
of malicious EVs/PCPs by comparison with traditional PoW scheme.
will be generated to mislead and deteriorate the accuracy of
reputation evaluation. Besides, through credibility computing
in our proposal, the effect of malicious ratings can be mitigated
to ensure a high RSoL.
Table IV demonstrates the performance of our proposal in
defending against first-rating advantage attack (defined in Sec-
tion IV-C), compared with the naive approach. In the naive
approach, it takes the average of all ratings to attain the avem(t)
in computing the MRS mrshi,j(t) in (11). Here, we set the
fading parameter as λ = 0.1. In general, in the permissioned
blockchain-based reputation models, for reduced cost in pro-
ducing multiple dishonest and successive ratings, adversaries
are prone to generate a series of energy transactions with small
traded energy volume. As seen in Table IV, compared with
the naive approach, our proposal can effectively attain a much-
improved MRS of the latest benign rating (i.e., 26-th rating)
while significantly suppressing the MRS of the previous mali-
cious rating (i.e., 13-th rating). The reason is that our approach
jointly considers the fading effect and the amount of traded
energy in calculating the average weighted rating avem(t).
Therefore, the effect of the previous untruthful ratings with low
traded energy volume can be significantly reduced, resulting
in an improved performance in defending against first-rating
advantage attacks. Besides, from Table IV, we can observe that
when the traded energy volume in previous malicious ratings
becomes large (i.e., in [2,8] kWh), the performance of our
approach only decreases slightly.
C. Simulation
We consider a simulation scenario with three communities
in a PCPSN using a simulator in Matlab, and each community
consists of ten PCPs. The hourly solar energy supply of each
PCP is acquired from a typical day in [52], and the number of
EVs is set as I = 40. The distance that EV users drive to different
communities is randomly selected in the set {0.5, 1.2, 2.0}
mile. The parameters of the reputation model are the same as
Section V-B, and other parameters are concluded in Table V.
We employ the following metrics to evaluate the performance
of the proposed game-based energy scheduling mechanism.
� Average utility of EVs and PCPs: The average utility of
EVs and PCPs in the stable matching results Ψ∗ and the
stable coalitional structure Π∗.
TABLE V
PARAMETER SETTING IN THE SIMULATION
Fig. 6. Average utility of EVs vs. number of PCPs by comparison with MMS,
OMS, and RS schemes.
Fig. 7. Average utility of PCPs vs. number of EVs by comparison with MMS,
OMS, and RS schemes.
� RE Sharing Efficiency: The ratio of the amount of clean
energy consumed by EVs to the total RE supply of PCPs.
Next, we compare the proposed scheme with the following
three other competing approaches in terms of user utility and
charging efficiency.
� Many-to-One Matching-Based Scheme (MMS) [8]: In this
scheme, PCPs in the same community can form static
coalitions based on their social features, and each EV
computes the optimal PCP coalition to connect based on
the many-to-one matching game.
� One-to-One Matching-Based Scheme (OMS): In this
scheme, each EV chooses the best PCP for battery charging
based on the one-to-one matching game while the coalition
formulation process among PCPs is absent.
� Random Scheme (RS): In this scheme, each EV randomly
picks a PCP for battery charging and requests energy
demand from the selected PCP at random.
Figs. 6 and 7 describe the average utilities of EVs and PCPs in
four schemes, respectively. From these two figures, we can ob-
serve that our proposed scheme has the highest average utilities
for both EVs and PCPs, compared with the other three schemes.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
1872 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 71, NO. 2, FEBRUARY 2022
Fig. 8. RE sharing efficiency vs. number of matching iterations.
Additionally, in Fig. 6, it can be seen that the average utility of
EVs increases when the number of PCPs grows. Similarly, in
Fig. 7, as the number of EVs grows, the average utility of PCPs
keeps increasing. The reason is that in the MMS scheme, the
structure of PCP coalitions is fixed and predetermined, which
cannot be adapted to balance the dynamic solar energy gener-
ation and energy consumption of EVs. As a result, both EVs
and PCPs cannot acquire the maximized utilities in the MMS
scheme. In the OMS scheme, due to the limited solar energy
supply of each PCP and the absence of cooperation among
PCPs, EVs with high RE demand may not obtain satisfactory RE
resources, causing the relatively low average utilities of both EVs
and PCPs. In the RS scheme, the clean energy resources supplied
by PCPs are randomly allocated to EVs without considering the
cooperation and competition, resulting in the low average utili-
ties of both sides. In the proposed scheme, through the proposed
coalition formulation game, PCPs can cooperate to establish the
optimal coalition structure and reallocate RE resources within a
coalition. In addition, via the proposed many-to-one matching
game, PCP coalitions and EVs can construct the optimal match-
ing results in the competitive environment. Therefore, both EVs
and PCPs can attain the maximized utilities in our proposed
scheme.
Fig. 8 presents the evolution of RE sharing efficiency over
time, where three values of the number of EVs are exploited,
i.e., I = 20, I = 30, and I = 40. In this simulation, the number
of PCPs is set as J = 30. Other simulation settings keep un-
changed. As we can see, the RE sharing efficiency with 20, 30,
and 40 EVs reaches the stable value after 8, 13, and 19 iterations,
respectively. Moreover, we can observe that the fewer number
of EVs, the faster convergence rate to reach the stable value and
the lower stable RE sharing efficiency. The reason is that given
more number of EVs, more iterations will be required to form the
stable matching pairs while more RE resources will be requested
and consumed by EVs, resulting in a slower convergence rate
and a higher RE sharing efficiency.
Fig. 9 shows the optimal energy demand of a specific EV
when the charging price of the PCP coalition changes from
4.4 to 5.2 cent/kWh and the battery degradation cost is se-
lected from the set {2.4, 2.6, 2.8}. Here, an EV with parameters
CEV
i = 25 kWh, κi = 3.5, SoCarr
i = 0.45 and li,Φn
= 0.5 is
selected in this simulation. In Fig. 9, it can be seen that the EV’s
optimal energy demand keeps decreasing with the increase of
the charging price of PCP coalition. Moreover, with the higher
Fig. 9. Optimal energy demand of an EV vs. charging price of PCP coalition,
where εi = 2.4, εi = 2.6, and εi = 2.8 are separately adopted.
battery degradation cost, the optimal energy demand of the EV
declines. The reason is that if the charging price or the unit
battery degradation cost is high, each EV intends to reduce
its energy demand to maximize its utility as analyzed in (30),
resulting in a decline of EV’s energy demand and utility.
According to the aforementioned results, each EV user and
PCP owner can attain improved QoE and user utility in the
proposed scheme, while a higher RSoL can be acquired in the
consensus process in the blockchain. Additionally, the proposed
joint coalition-matching algorithm can be converged while the
RE efficiency and energy trading security can be enhanced
during the PCP sharing and EV charging process.
VI. CONCLUSION
In this paper, we proposed a secure and cooperative PCP
sharing scheme with EVs using blockchain. Specifically, we
designed an energy blockchain-enabled framework for PCP-
SNs to safeguard PCP sharing and EV charging process. A
reputation-based secure PCP sharing algorithm was also de-
veloped to efficiently reach consensus in the blockchain, and
a reputation mechanism was designed to evaluate the trust-
worthiness of LAGs in consensus process by incorporating
social features. A joint coalition-matching game model was
then presented for optimal energy scheduling in PCPSNs with
consideration of users’ cooperation, competition, social features,
and practical constraints. Findings from our simulations and real
implementation demonstrated the utility of the proposed scheme
in comparison to other existing approaches, particularly in terms
of improved QoE of participants, enhanced RE efficiency, and
strengthened consensus security. For future work, we will further
consider the discharging behaviors of EVs and investigating
EVs’ coordination in energy charging and discharging in PCP-
SNs.
REFERENCES
[1] Y. Wang, Z. Su, Q. Xu, T. Yang, and N. Zhang, “A novel charging scheme
for electric vehicles with smart communities in vehicular networks,” IEEE
Trans. Veh. Technol.. vol. 68, no. 9, pp. 8487–8501, Sep. 2019.
[2] Z. liu, Q. Wu, M. Shahidehpour, C. Li, S. Huang, and W. Wei, “Transactive
real-time electric vehicle charging management for commercial buildings
with PV on-site generation,” IEEE Trans. Smart Grid, vol. 10, no. 5,
pp. 4939–4950, Sep. 2019.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
WANG et al.: BLOCKCHAIN-BASED SECURE AND COOPERATIVE PCP SHARING SERVICES FOR VEHICULAR NETWORKS 1873
[3] Z. Su, Y. Wang, Q. Xu, M. Fei, Y. Tian, and N. Zhang, “A secure
charging scheme for electric vehicles with smart communities in en-
ergy blockchain,” IEEE Internet Things J., vol. 6, no. 3, pp. 4601–4613,
Jun. 2019.
[4] Global EV Outlook 2019: Scaling up the transition to electric mobility.
Nov. 2019. [Online]. Available: https://www.iea.org/publications/reports/
globalevoutlook2019/
[5] H. Zhang, Z. Hu, Z. Xu, and Y. Song, “An integrated planning framework
for different types of PEV charging facilities in urban area,” IEEE Trans.
Smart Grid, vol. 7, no. 5, pp. 2273–2284, Sep. 2016.
[6] L. Qi, X. L. Bin, and H. Q.Wang, “Shared economy model of charging pile
based on block chain ecosystem,” Electric Power Construction, vol. 38,
no. 9, pp. 1-7, Sep. 2017.
[7] Y. Hou et al., “A resolution of sharing private charging piles based on
smart contract,” in Proc. 13th Int. Conf. Natural Computation, Fuzzy Syst.
Knowl. Discovery, 2017, pp. 3004–3008.
[8] Y. Wang, Z. Su, and K. Zhang, “A secure private charging pile sharing
scheme with electric vehicles in energy blockchain,” in Proc. 13th IEEE
Int. Conf. Big Data Sci. And Eng., 2019, pp. 648–654.
[9] E. Thompson, R. Ordonez-Hurtado, W. Griggs, J. Y. Yu, B. Mulkeen, and
R. Shorten, “On charge point anxiety and the sharing economy,” in Proc.
IEEE 20th Int. Conf. Intell. Transp. Syst., 2017, pp. 1–6.
[10] F. Luo, G. Ranzi, C. Wan, Z. Xu, and Z. Y. Dong, “A multistage home
energy management system with residential photovoltaic penetration,”
IEEE Trans. Ind. Informat., vol. 15, no. 1, pp. 116–126, Jan. 2019.
[11] E. Scolari, F. Sossan, and M. Paolone, “Photovoltaic-model-based solar
irradiance estimators: Performance comparison and application to max-
imum power forecasting,” IEEE Trans. Sustain. Energy, vol. 9, no. 1,
pp. 35–44, Jan. 2018.
[12] M. Zeng, S. Leng, Y. Zhang, and J. He, “QoE-aware power management
in vehicle-to-grid networks: A matching-theoretic approach,” IEEE Trans.
Smart Grid, vol. 9, no. 4, pp. 2468–2477, Jul. 2018.
[13] J. Li, C. Li, Y. Xu, Z. Y. Dong, K. P. Wong, and T. Huang, “Nonco-
operative game-based distributed charging control for plug-in electric
vehicles in distribution networks,” IEEE Trans. Ind. Informat., vol. 14,
no. 1, pp. 301–310, Jan. 2018.
[14] S. Huckle, R. Bhattacharya, M. White, and N. Beloff, “Internet of Things,
blockchain and shared economy applications,” Procedia Comput. Sci.,
vol. 98, pp. 461–466, 2016.
[15] K. Gai and M. Qiu, “Blend arithmetic operations on tensor-based fully
homomorphic encryption over real numbers,” IEEE Trans. Ind. Informat.,
vol. 14, no. 8, pp. 3590–3598, Aug. 2018.
[16] K. Gai, M. Qiu, Z. Xiong, and M. Liu, “Privacy-preserving multi-channel
communication in edge-of-things,” Future Gener. Comput. Syst., vol. 85,
pp. 190–200, 2018.
[17] Y. Wang, Z. Su, and N. Zhang, “BSIS: Blockchain based secure incentive
scheme for energy delivery in vehicular energy network,” IEEE Trans. Ind.
Informat., vol. 15, no. 6, pp. 3620–3631, Jun. 2019.
[18] J. Kang, Z. Xiong, D. Niyato, D. Ye, D. I. Kim, and J. Zhao, “Toward
secure blockchain-enabled internet of vehicles: Optimizing consensus
management using reputation and contract theory,” IEEE Trans. Veh.
Technol., vol. 68, no. 3, pp. 2906–2920, Mar. 2019.
[19] Z. Su, Y. Wang, Q. Xu, and N. Zhang, “LVBS: Lightweight
vehicular blockchain for secure data sharing in disaster res-
cue,” IEEE Trans. Dependable Secure Comput., to be published,
doi: 10.1109/TDSC.2020.2980255.
[20] R. Zhang, X. Cheng, and L. Yang, “Flexible energy management protocol
for cooperative EV-to-EV charging,” IEEE Trans. Intell. Transp. Syst.,
vol. 20, no. 1, pp. 172–184, Jan. 2019.
[21] B. Sun, Z. Huang, X. Tan, and D. H. K. Tsang, “Optimal scheduling for
electric vehicle charging with discrete charging levels in distribution grid,”
IEEE Trans. Smart Grid, vol. 9, no. 2, pp. 624–634, 2018.
[22] Y. Yang, Q. Jia, X. Guan, X. Zhang, Z. Qiu, and G. Deconinck, “De-
centralized EV-based charging optimization with building integrated wind
energy,” IEEE Trans. Automat. Sci. Eng., vol. 16, no. 3, pp. 1002–1017,
Jul. 2019.
[23] Z. Wei, Y. Li, and L. Cai, “Electric vehicle charging scheme for a park-
and-charge system considering battery degradation costs,” IEEE Trans.
Intell. Veh., vol. 3, no. 3, pp. 361–373, Sep. 2018.
[24] Y. Zhang and L. Cai, “Dynamic charging scheduling for EV parking lots
with photovoltaic power system,” IEEE Access, vol. 6, pp. 56995–57005,
2018.
[25] S. Wang, A. F. Taha, J. Wang, K. Kvaternik, and A. Hahn, “Energy
crowdsourcing and peer-to-peer energy trading in blockchain-enabled
smart grids,” IEEE Trans. Syst., Man, Cybern. Syst., vol. 49, no. 8,
pp. 1612–1623, Aug. 2019.
[26] C. Dang, J. Zhang, C. Kwong, and L. Li, “Demand side load management
for big industrial energy users under blockchain-based peer-to-peer elec-
tricity market,” IEEE Trans. Smart Grid. vol. 10, no. 6, pp. 6426–6435,
Nov. 2019.
[27] Z. Zhou, B. Wang, M. Dong, and K. Ota, “Secure and efficient vehicle-to-
grid energy trading in cyber physical systems: Integration of blockchain
and edge computing,” IEEE Trans. Syst., Man, Cybern. Syst., vol. 50, no. 1,
pp. 43–57, Jan. 2020.
[28] R. Chaudhary, A. Jindal, G. S. Aujla, S. Aggarwal, N. Kumar, and K.-K. R.
Choo, “BEST: Blockchain-based secure energy trading in SDN-enabled
intelligent transportation system,” Comput. Secur., vol. 85, pp. 288–299,
Aug. 2019.
[29] M. L. Di Silvestre, P. Gallo, M. G. Ippolito, E. R. Sanseverino, and
G. Zizzo, “A technical approach to the energy blockchain in micro-
grids,” IEEE Trans. Ind. Informat., vol. 14, no. 11, pp. 4792–4803,
Nov. 2018.
[30] L. Jiang, S. Xie, S. Maharjan, and Y. Zhang, “Blockchain empowered
wireless power transfer for green and secure Internet of Things,” IEEE
Netw., vol. 33, no. 6, pp. 164–171, Nov./Dec. 2019.
[31] M. A. Ferrag and L. Maglaras, “DeepCoin: A novel deep learning and
blockchain-based energy exchange framework for smart grids,” IEEE
Trans. Eng. Manage., vol. 67, no. 4, pp. 1285–1297, Nov. 2020.
[32] Z. Li, J. Kang, R. Yu, D. Ye, Q. Deng, and Y. Zhang, “Consor-
tium blockchain for secure energy trading in industrial Internet of
Things,” IEEE Trans. Ind. Informat., vol. 14, no. 8, pp. 3690–3700,
Aug. 2018.
[33] K. Gai, K. R. Choo, M. Qiu, and L. Zhu, “Privacy-preserving content-
oriented wireless communication in Internet-of-Things,” IEEE Internet
Things J., vol. 5, no. 4, pp. 3059–3067, Aug. 2018.
[34] K. Gai, L. Zhu, M. Qiu, K. Xu, and K. R. Choo, “Multi-access filtering
for privacy-preserving fog computing,” IEEE Trans. Cloud Comput., to be
published, doi: 10.1109/TCC.2019.2942293.
[35] Z. Yang, K. Yang, L. Lei, K. Zheng, and V. C. M. Leung, “Blockchain-
based decentralized trust management in vehicular networks,” IEEE In-
ternet Things J., vol. 6, no. 2, pp. 1495–1505, Apr. 2019.
[36] S. Wang, C. Wang, and Q. Hu, “Corking by forking: Vulnerability analysis
of blockchain,” in Proc. IEEE IEEE Global Telecommun. Conf., 2019,
pp. 829–837.
[37] D. Boneh, B. Lynn, and H. Shacham, “Short signatures from the weil
pairing,” J. Cryptology, vol. 17, no. 4, pp. 297–319, 2004.
[38] D. Boneh, M. Drijvers, and G. Neven, “Compact Multi-signatures for
smaller blockchains,” in Proc. Adv. Cryptology - ASIACRYPT, 2018,
vol. 11273, pp. 435–464.
[39] J. Huang, L. Kong, G. Chen, M. Wu, X. Liu, and P. Zeng, “Towards
secure industrial IoT: Blockchain system with credit-based consensus
mechanism,” IEEE Trans. Ind. Informat. vol. 15, no. 6, pp. 3680–3689,
Jun. 2019.
[40] T. Xue, Y. Yuan, Z. Ahmed, K. Moniz, G. Cao, and C. Wang, “Proof of con-
tribution: A modification of proof of work to increase mining efficiency,”
in Proc. 42nd Annu. Comput. Softw. Appl. Conf., 2018, pp. 636–644.
[41] S. Wang, Z. Zheng, Z. Wu, M. R. Lyu, and F. Yang, “Reputation measure-
ment and malicious feedback rating prevention in web service recommen-
dation systems,” IEEE Trans. Services Comput., vol. 8, no. 5, pp. 755–767,
Sep./Oct. 2015.
[42] V. A. Siris and F. Papagalou, “Application of anomaly detection algorithms
for detecting SYN flooding attacks,” IEEE Global Telecommun. Conf.,
2004 vol. 4, pp. 2050–2054.
[43] A. Das and M. M. Islam, “SecuredTrust: A dynamic trust computation
model for secured communication in multiagent systems,” IEEE Trans.
Dependable Secure Comput., vol. 9, no. 2, pp. 261–274, Mar./Apr. 2012.
[44] E. Ayday and F. Fekri, “An iterative algorithm for trust management
and adversary detection for delay-tolerant networks,” IEEE Trans. Mobile
Comput., vol. 11, no. 9, pp. 1514–1531, Sep. 2012.
[45] W. Tushar, B. Chai, C., Yuen, and D. B. Smith, “Three-party energy
management with distributed energy resources in smart grid,” IEEE Trans.
Ind. Electron., vol. 62, no. 4, pp. 2487–2498, Apr. 2015.
[46] R. Yu, J. Ding, W. Zhong, Y. Liu, and S. Xie, “PHEV charging and
discharging cooperation in V2G networks: A coalition game approach,”
IEEE Internet Things J., vol. 1, no. 6, pp. 578–589, Dec. 2014.
[47] D. Pevec, J. Babic, A. Carvalho, Y. Ghiassi-Farrokhfal, W. Ketter, and V.
Podobnik, “Electric vehicle range anxiety: An obstacle for the personal
transportation revolution?” in Proc. 4th Int. Conf. Smart Sustain. Tech-
nologies, 2019, pp. 1–8.
[48] T. Hóßler, P. Schulz, E. A. Jorswieck, M. Simsek, and G. P. Fettweis, “Sta-
ble matching for wireless URLLC in multi-cellular, multi-user systems,”
IEEE Trans. Commun., vol. 68, no. 8, pp. 5228–5241, Aug. 2020.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
https://www.iea.org/publications/reports/globalevoutlook2019/
https://www.iea.org/publications/reports/globalevoutlook2019/
https://dx.doi.org/10.1109/TDSC.2020.2980255
https://dx.doi.org/10.1109/TCC.2019.2942293
1874 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 71, NO. 2, FEBRUARY 2022
[49] Y. Wu, B. Shi, L. P. Qian, F. Hou, J. Cai, and X. S. Shen, “Energy-efficient
multi-task multi-access computation offloading via NOMA transmission
for IoTs,” IEEE Trans. Ind. Informat., vol. 16, no. 7, pp. 4811–4822,
Jul. 2020.
[50] W. Saad, Z. Han, A. Hjorungnes, D. Niyato, and E. Hossain, “Coalition
formation games for distributed cooperation among roadside units in ve-
hicular networks,” IEEE J. Sel. Areas Commun., vol. 29, no. 1, pp. 48–60,
Jan. 2011.
[51] S. Bera, S. Misra, and D. Chatterjee, “C2C: Community-based cooperative
energy consumption in smart grid,” IEEE Trans. Smart Grid, vol. 9, no. 5,
pp. 4262–4269, Sep. 2018.
[52] University of Queensland, UQ solar photovoltaic data. Nov. 2019,
Accessed: Dec. 2020. [Online]. Available: http://solar.uq.edu.au/user/
reportPower.php
Yuntao Wang is currently working toward the Ph.D
degree with the School of Cyber Science and Engi-
neering, Xi’an Jiaotong University, Xi’an, China. His
research interests include security and privacy protec-
tion in wireless networks and vehicular networks.
Zhou Su (Senior Member, IEEE) research interests
include wireless networking, mobile computing, and
network security. He is currently an Associate Editor
for the IEEE INTERNET OF THINGS JOURNAL, IEEE
OPEN JOURNAL OF COMPUTER SOCIETY, and IET
Communications. He was the Track or Symosuim
Chair for several international conferences, including
IEEE VTC, IEEE/CIC ICCC, WCSP, and so on.
He was the recipient of the Best Paper Award of
IEEE ICC2020, IEEE BigdataSE2019, IEEE Cyber-
SciTech2017, and so on.
Jiliang Li received the Dr. rer. nat. degree in computer
science from the University of Goettingen, Goettin-
gen, Germany, in 2019. He is currently a Researcher
Professor and Ph.D. Supervisor with the School of
Cyber Science and Engineering, Xi’an Jiaotong Uni-
versity, Xi’an, China. His research interests include
information security, cryptography, blockchain, and
IoT security.
Ning Zhang (Senior Member, IEEE) received the
Ph.D degree from the University of Waterloo, Water-
loo, ON, Canada, in 2015. After that, he was a Postdoc
Research Fellow with the University of Waterloo and
University of Toronto, Toronto, ON, Canada, respec-
tively. He is currently an Associate Professor with
the University of Windsor, Windsor, ON, Canada.
He is an Associate Editor for the IEEE INTERNET
OF THINGS JOURNAL, IEEE TRANSACTIONS ON COG-
NITIVE COMMUNICATIONS AND NETWORKING, IEEE
ACCESS, and IET Communications, and Vehicular
Communications (Elsevier), and the Guest Editor of several international jour-
nals, such as the IEEE WIRELESS COMMUNICATIONS, IEEE TRANSACTIONS
ON INDUSTRIAL INFORMATICS, and IEEE TRANSACTIONS ON COGNITIVE COM-
MUNICATIONS AND NETWORKING. He is/was also the Track Chair for several
international conferences and the Co-Chair for several international workshops.
He was the recipient of the Best Paper Awards from IEEE Globecom in 2014,
IEEE WCSP in 2015, and Journal of Communications and Information Networks
in 2018, IEEE ICC in 2019, IEEE Technical Committee on Transmission Access
and Optical Systems in 2019, and IEEE ICCC in 2019, respectively.
Kuan Zhang received the Ph.D. degree in electri-
cal and computer engineering from the University
of Waterloo, Waterloo, ON, Canada, in 2016. He is
currently an Assistant Professor with the Department
of Electrical and Computer Engineering, University
of Nebraska-Lincoln, Lincoln, NE, USA. He has au-
thored or coauthored more than 100 papers in journals
and conferences. His research interests include cyber
security, Big Data, Internet of things, cloud or edge
computing. He was the recipient of the Best Paper
Award in IEEE WCNC 2013, Securecomm 2016 and
ICC 2020.
Kim-Kwang Raymond Choo (Senior Member,
IEEE) received the Ph.D. degree in information se-
curity from the Queensland University of Technol-
ogy, Brisbane City, QLD, Australia, in 2006. He
is currently holds the Cloud Technology Endowed
Professorship with The University of Texas at San
Antonio (UTSA), San Antonio, TX, USA. He is
the founding Co-Editor-in-Chief of ACM Distributed
Ledger Technologies: Research & Practice (com-
mencing June 2021), founding Chair of IEEE Tech-
nology and Engineering Management Society’s Tech-
nical Committee on Blockchain and Distributed Ledger Technologies. He is
an ACM Distinguished Speaker and IEEE Computer Society Distinguished
Visitor during 2021–2023, and included in Web of Science’s Highly Cited
Researcher in the field of Cross-Field2020. In 2015, he and his team won
the Digital Forensics Research Challenge organized by Germany’s University
of Erlangen-Nuremberg. He was the recipient of the 2019 IEEE Technical
Committee on Scalable Computing Award for Excellence in Scalable Computing
(Middle Career Researcher), the 2018 UTSA College of Business Col. Jean
Piccione and Lt. Col. Philip Piccione Endowed Research Award for Tenured
Faculty.
Yiliang Liu received the B.E and M.Sc degrees in
computer science and communication engineering
from Jiangsu University, Zhenjiang, China, in 2012
and 2015, respectively, and the Ph.D. degree from the
School of Electronics and Information Engineering,
Harbin Institute of Technology, Harbin, China, in
2020. He was a Visiting Research Student with the
Department of Engineering Science, National Cheng
Kung University, Tainan, Taiwan, from 2014 to 2015,
and the Department of Electrical and Computer En-
gineering, University of Waterloo, Waterloo, ON,
Canada, from 2018 to 2019. He is currently a Lecturer with the School of
Cyber Science and Engineering, Xi’an Jiaotong University, Xi’an, China. His
research interests include the security of wireless communications, physical
layer security, and intelligent connected vehicles. Dr. Liu was the recipient of
the Outstanding Doctoral Dissertation Award from China Education Society of
Electronics in 2020 and the Best Paper Award of IEEE SYSTEMS JOURNAL in
2021.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:46:17 UTC from IEEE Xplore.  Restrictions apply. 
http://solar.uq.edu.au/user/reportPower.php
http://solar.uq.edu.au/user/reportPower.php
<<
  /ASCII85EncodePages false
  /AllowTransparency false
  /AutoPositionEPSFiles true
  /AutoRotatePages /None
  /Binding /Left
  /CalGrayProfile (Gray Gamma 2.2)
  /CalRGBProfile (sRGB IEC61966-2.1)
  /CalCMYKProfile (U.S. Web Coated \050SWOP\051 v2)
  /sRGBProfile (sRGB IEC61966-2.1)
  /CannotEmbedFontPolicy /Warning
  /CompatibilityLevel 1.4
  /CompressObjects /Off
  /CompressPages true
  /ConvertImagesToIndexed true
  /PassThroughJPEGImages true
  /CreateJobTicket false
  /DefaultRenderingIntent /Default
  /DetectBlends true
  /DetectCurves 0.0000
  /ColorConversionStrategy /sRGB
  /DoThumbnails true
  /EmbedAllFonts true
  /EmbedOpenType false
  /ParseICCProfilesInComments true
  /EmbedJobOptions true
  /DSCReportingLevel 0
  /EmitDSCWarnings false
  /EndPage -1
  /ImageMemory 1048576
  /LockDistillerParams true
  /MaxSubsetPct 100
  /Optimize true
  /OPM 0
  /ParseDSCComments false
  /ParseDSCCommentsForDocInfo true
  /PreserveCopyPage true
  /PreserveDICMYKValues true
  /PreserveEPSInfo false
  /PreserveFlatness true
  /PreserveHalftoneInfo true
  /PreserveOPIComments false
  /PreserveOverprintSettings true
  /StartPage 1
  /SubsetFonts true
  /TransferFunctionInfo /Remove
  /UCRandBGInfo /Preserve
  /UsePrologue false
  /ColorSettingsFile ()
  /AlwaysEmbed [ true
    /Algerian
    /Arial-Black
    /Arial-BlackItalic
    /Arial-BoldItalicMT
    /Arial-BoldMT
    /Arial-ItalicMT
    /ArialMT
    /ArialNarrow
    /ArialNarrow-Bold
    /ArialNarrow-BoldItalic
    /ArialNarrow-Italic
    /ArialUnicodeMS
    /BaskOldFace
    /Batang
    /Bauhaus93
    /BellMT
    /BellMTBold
    /BellMTItalic
    /BerlinSansFB-Bold
    /BerlinSansFBDemi-Bold
    /BerlinSansFB-Reg
    /BernardMT-Condensed
    /BodoniMTPosterCompressed
    /BookAntiqua
    /BookAntiqua-Bold
    /BookAntiqua-BoldItalic
    /BookAntiqua-Italic
    /BookmanOldStyle
    /BookmanOldStyle-Bold
    /BookmanOldStyle-BoldItalic
    /BookmanOldStyle-Italic
    /BookshelfSymbolSeven
    /BritannicBold
    /Broadway
    /BrushScriptMT
    /CalifornianFB-Bold
    /CalifornianFB-Italic
    /CalifornianFB-Reg
    /Centaur
    /Century
    /CenturyGothic
    /CenturyGothic-Bold
    /CenturyGothic-BoldItalic
    /CenturyGothic-Italic
    /CenturySchoolbook
    /CenturySchoolbook-Bold
    /CenturySchoolbook-BoldItalic
    /CenturySchoolbook-Italic
    /Chiller-Regular
    /ColonnaMT
    /ComicSansMS
    /ComicSansMS-Bold
    /CooperBlack
    /CourierNewPS-BoldItalicMT
    /CourierNewPS-BoldMT
    /CourierNewPS-ItalicMT
    /CourierNewPSMT
    /EstrangeloEdessa
    /FootlightMTLight
    /FreestyleScript-Regular
    /Garamond
    /Garamond-Bold
    /Garamond-Italic
    /Georgia
    /Georgia-Bold
    /Georgia-BoldItalic
    /Georgia-Italic
    /Haettenschweiler
    /HarlowSolid
    /Harrington
    /HighTowerText-Italic
    /HighTowerText-Reg
    /Impact
    /InformalRoman-Regular
    /Jokerman-Regular
    /JuiceITC-Regular
    /KristenITC-Regular
    /KuenstlerScript-Black
    /KuenstlerScript-Medium
    /KuenstlerScript-TwoBold
    /KunstlerScript
    /LatinWide
    /LetterGothicMT
    /LetterGothicMT-Bold
    /LetterGothicMT-BoldOblique
    /LetterGothicMT-Oblique
    /LucidaBright
    /LucidaBright-Demi
    /LucidaBright-DemiItalic
    /LucidaBright-Italic
    /LucidaCalligraphy-Italic
    /LucidaConsole
    /LucidaFax
    /LucidaFax-Demi
    /LucidaFax-DemiItalic
    /LucidaFax-Italic
    /LucidaHandwriting-Italic
    /LucidaSansUnicode
    /Magneto-Bold
    /MaturaMTScriptCapitals
    /MediciScriptLTStd
    /MicrosoftSansSerif
    /Mistral
    /Modern-Regular
    /MonotypeCorsiva
    /MS-Mincho
    /MSReferenceSansSerif
    /MSReferenceSpecialty
    /NiagaraEngraved-Reg
    /NiagaraSolid-Reg
    /NuptialScript
    /OldEnglishTextMT
    /Onyx
    /PalatinoLinotype-Bold
    /PalatinoLinotype-BoldItalic
    /PalatinoLinotype-Italic
    /PalatinoLinotype-Roman
    /Parchment-Regular
    /Playbill
    /PMingLiU
    /PoorRichard-Regular
    /Ravie
    /ShowcardGothic-Reg
    /SimSun
    /SnapITC-Regular
    /Stencil
    /SymbolMT
    /Tahoma
    /Tahoma-Bold
    /TempusSansITC
    /TimesNewRomanMT-ExtraBold
    /TimesNewRomanMTStd
    /TimesNewRomanMTStd-Bold
    /TimesNewRomanMTStd-BoldCond
    /TimesNewRomanMTStd-BoldIt
    /TimesNewRomanMTStd-Cond
    /TimesNewRomanMTStd-CondIt
    /TimesNewRomanMTStd-Italic
    /TimesNewRomanPS-BoldItalicMT
    /TimesNewRomanPS-BoldMT
    /TimesNewRomanPS-ItalicMT
    /TimesNewRomanPSMT
    /Times-Roman
    /Trebuchet-BoldItalic
    /TrebuchetMS
    /TrebuchetMS-Bold
    /TrebuchetMS-Italic
    /Verdana
    /Verdana-Bold
    /Verdana-BoldItalic
    /Verdana-Italic
    /VinerHandITC
    /Vivaldii
    /VladimirScript
    /Webdings
    /Wingdings2
    /Wingdings3
    /Wingdings-Regular
    /ZapfChanceryStd-Demi
    /ZWAdobeF
  ]
  /NeverEmbed [ true
  ]
  /AntiAliasColorImages false
  /CropColorImages true
  /ColorImageMinResolution 150
  /ColorImageMinResolutionPolicy /OK
  /DownsampleColorImages false
  /ColorImageDownsampleType /Bicubic
  /ColorImageResolution 900
  /ColorImageDepth -1
  /ColorImageMinDownsampleDepth 1
  /ColorImageDownsampleThreshold 1.00111
  /EncodeColorImages true
  /ColorImageFilter /DCTEncode
  /AutoFilterColorImages false
  /ColorImageAutoFilterStrategy /JPEG
  /ColorACSImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /ColorImageDict <<
    /QFactor 0.40
    /HSamples [1 1 1 1] /VSamples [1 1 1 1]
  >>
  /JPEG2000ColorACSImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /JPEG2000ColorImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /AntiAliasGrayImages false
  /CropGrayImages true
  /GrayImageMinResolution 150
  /GrayImageMinResolutionPolicy /OK
  /DownsampleGrayImages false
  /GrayImageDownsampleType /Bicubic
  /GrayImageResolution 1200
  /GrayImageDepth -1
  /GrayImageMinDownsampleDepth 2
  /GrayImageDownsampleThreshold 1.00083
  /EncodeGrayImages true
  /GrayImageFilter /DCTEncode
  /AutoFilterGrayImages false
  /GrayImageAutoFilterStrategy /JPEG
  /GrayACSImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /GrayImageDict <<
    /QFactor 0.40
    /HSamples [1 1 1 1] /VSamples [1 1 1 1]
  >>
  /JPEG2000GrayACSImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /JPEG2000GrayImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /AntiAliasMonoImages false
  /CropMonoImages true
  /MonoImageMinResolution 1200
  /MonoImageMinResolutionPolicy /OK
  /DownsampleMonoImages false
  /MonoImageDownsampleType /Bicubic
  /MonoImageResolution 1600
  /MonoImageDepth -1
  /MonoImageDownsampleThreshold 1.00063
  /EncodeMonoImages true
  /MonoImageFilter /CCITTFaxEncode
  /MonoImageDict <<
    /K -1
  >>
  /AllowPSXObjects false
  /CheckCompliance [
    /None
  ]
  /PDFX1aCheck false
  /PDFX3Check false
  /PDFXCompliantPDFOnly false
  /PDFXNoTrimBoxError true
  /PDFXTrimBoxToMediaBoxOffset [
    0.00000
    0.00000
    0.00000
    0.00000
  ]
  /PDFXSetBleedBoxToMediaBox true
  /PDFXBleedBoxToTrimBoxOffset [
    0.00000
    0.00000
    0.00000
    0.00000
  ]
  /PDFXOutputIntentProfile (None)
  /PDFXOutputConditionIdentifier ()
  /PDFXOutputCondition ()
  /PDFXRegistryName ()
  /PDFXTrapped /False
  /CreateJDFFile false
  /Description <<
    /CHS <FEFF4f7f75288fd94e9b8bbe5b9a521b5efa7684002000410064006f006200650020005000440046002065876863900275284e8e55464e1a65876863768467e5770b548c62535370300260a853ef4ee54f7f75280020004100630072006f0062006100740020548c002000410064006f00620065002000520065006100640065007200200035002e003000204ee553ca66f49ad87248672c676562535f00521b5efa768400200050004400460020658768633002>
    /CHT <FEFF4f7f752890194e9b8a2d7f6e5efa7acb7684002000410064006f006200650020005000440046002065874ef69069752865bc666e901a554652d965874ef6768467e5770b548c52175370300260a853ef4ee54f7f75280020004100630072006f0062006100740020548c002000410064006f00620065002000520065006100640065007200200035002e003000204ee553ca66f49ad87248672c4f86958b555f5df25efa7acb76840020005000440046002065874ef63002>
    /DAN <FEFF004200720075006700200069006e0064007300740069006c006c0069006e006700650072006e0065002000740069006c0020006100740020006f007000720065007400740065002000410064006f006200650020005000440046002d0064006f006b0075006d0065006e007400650072002c0020006400650072002000650067006e006500720020007300690067002000740069006c00200064006500740061006c006a006500720065007400200073006b00e60072006d007600690073006e0069006e00670020006f00670020007500640073006b007200690076006e0069006e006700200061006600200066006f0072007200650074006e0069006e006700730064006f006b0075006d0065006e007400650072002e0020004400650020006f007000720065007400740065006400650020005000440046002d0064006f006b0075006d0065006e0074006500720020006b0061006e002000e50062006e00650073002000690020004100630072006f00620061007400200065006c006c006500720020004100630072006f006200610074002000520065006100640065007200200035002e00300020006f00670020006e0079006500720065002e>
    /DEU <FEFF00560065007200770065006e00640065006e0020005300690065002000640069006500730065002000450069006e007300740065006c006c0075006e00670065006e0020007a0075006d002000450072007300740065006c006c0065006e00200076006f006e002000410064006f006200650020005000440046002d0044006f006b0075006d0065006e00740065006e002c00200075006d002000650069006e00650020007a0075007600650072006c00e40073007300690067006500200041006e007a006500690067006500200075006e00640020004100750073006700610062006500200076006f006e00200047006500730063006800e40066007400730064006f006b0075006d0065006e00740065006e0020007a0075002000650072007a00690065006c0065006e002e00200044006900650020005000440046002d0044006f006b0075006d0065006e007400650020006b00f6006e006e0065006e0020006d006900740020004100630072006f00620061007400200075006e0064002000520065006100640065007200200035002e003000200075006e00640020006800f600680065007200200067006500f600660066006e00650074002000770065007200640065006e002e>
    /ESP <FEFF005500740069006c0069006300650020006500730074006100200063006f006e0066006900670075007200610063006900f3006e0020007000610072006100200063007200650061007200200064006f00630075006d0065006e0074006f0073002000640065002000410064006f00620065002000500044004600200061006400650063007500610064006f007300200070006100720061002000760069007300750061006c0069007a00610063006900f3006e0020006500200069006d0070007200650073006900f3006e00200064006500200063006f006e006600690061006e007a006100200064006500200064006f00630075006d0065006e0074006f007300200063006f006d00650072006300690061006c00650073002e002000530065002000700075006500640065006e00200061006200720069007200200064006f00630075006d0065006e0074006f00730020005000440046002000630072006500610064006f007300200063006f006e0020004100630072006f006200610074002c002000410064006f00620065002000520065006100640065007200200035002e003000200079002000760065007200730069006f006e0065007300200070006f00730074006500720069006f007200650073002e>
    /FRA <FEFF005500740069006c006900730065007a00200063006500730020006f007000740069006f006e00730020006100660069006e00200064006500200063007200e900650072002000640065007300200064006f00630075006d0065006e00740073002000410064006f006200650020005000440046002000700072006f00660065007300730069006f006e006e0065006c007300200066006900610062006c0065007300200070006f007500720020006c0061002000760069007300750061006c00690073006100740069006f006e0020006500740020006c00270069006d007000720065007300730069006f006e002e0020004c0065007300200064006f00630075006d0065006e00740073002000500044004600200063007200e900e90073002000700065007500760065006e0074002000ea0074007200650020006f007500760065007200740073002000640061006e00730020004100630072006f006200610074002c002000610069006e00730069002000710075002700410064006f00620065002000520065006100640065007200200035002e0030002000650074002000760065007200730069006f006e007300200075006c007400e90072006900650075007200650073002e>
    /ITA (Utilizzare queste impostazioni per creare documenti Adobe PDF adatti per visualizzare e stampare documenti aziendali in modo affidabile. I documenti PDF creati possono essere aperti con Acrobat e Adobe Reader 5.0 e versioni successive.)
    /JPN <FEFF30d330b830cd30b9658766f8306e8868793a304a3088307353705237306b90693057305f002000410064006f0062006500200050004400460020658766f8306e4f5c6210306b4f7f75283057307e305930023053306e8a2d5b9a30674f5c62103055308c305f0020005000440046002030d530a130a430eb306f3001004100630072006f0062006100740020304a30883073002000410064006f00620065002000520065006100640065007200200035002e003000204ee5964d3067958b304f30533068304c3067304d307e305930023053306e8a2d5b9a3067306f30d530a930f330c8306e57cb30818fbc307f3092884c3044307e30593002>
    /KOR <FEFFc7740020c124c815c7440020c0acc6a9d558c5ec0020be44c988b2c8c2a40020bb38c11cb97c0020c548c815c801c73cb85c0020bcf4ace00020c778c1c4d558b2940020b3700020ac00c7a50020c801d569d55c002000410064006f0062006500200050004400460020bb38c11cb97c0020c791c131d569b2c8b2e4002e0020c774b807ac8c0020c791c131b41c00200050004400460020bb38c11cb2940020004100630072006f0062006100740020bc0f002000410064006f00620065002000520065006100640065007200200035002e00300020c774c0c1c5d0c11c0020c5f40020c2180020c788c2b5b2c8b2e4002e>
    /NLD (Gebruik deze instellingen om Adobe PDF-documenten te maken waarmee zakelijke documenten betrouwbaar kunnen worden weergegeven en afgedrukt. De gemaakte PDF-documenten kunnen worden geopend met Acrobat en Adobe Reader 5.0 en hoger.)
    /NOR <FEFF004200720075006b00200064006900730073006500200069006e006e007300740069006c006c0069006e00670065006e0065002000740069006c002000e50020006f0070007000720065007400740065002000410064006f006200650020005000440046002d0064006f006b0075006d0065006e00740065007200200073006f006d002000650072002000650067006e0065007400200066006f00720020007000e5006c006900740065006c006900670020007600690073006e0069006e00670020006f00670020007500740073006b007200690066007400200061007600200066006f0072007200650074006e0069006e006700730064006f006b0075006d0065006e007400650072002e0020005000440046002d0064006f006b0075006d0065006e00740065006e00650020006b0061006e002000e50070006e00650073002000690020004100630072006f00620061007400200065006c006c00650072002000410064006f00620065002000520065006100640065007200200035002e003000200065006c006c00650072002e>
    /PTB <FEFF005500740069006c0069007a006500200065007300730061007300200063006f006e00660069006700750072006100e700f50065007300200064006500200066006f0072006d00610020006100200063007200690061007200200064006f00630075006d0065006e0074006f0073002000410064006f00620065002000500044004600200061006400650071007500610064006f00730020007000610072006100200061002000760069007300750061006c0069007a006100e700e3006f002000650020006100200069006d0070007200650073007300e3006f00200063006f006e0066006900e1007600650069007300200064006500200064006f00630075006d0065006e0074006f007300200063006f006d0065007200630069006100690073002e0020004f007300200064006f00630075006d0065006e0074006f00730020005000440046002000630072006900610064006f007300200070006f00640065006d0020007300650072002000610062006500720074006f007300200063006f006d0020006f0020004100630072006f006200610074002000650020006f002000410064006f00620065002000520065006100640065007200200035002e0030002000650020007600650072007300f50065007300200070006f00730074006500720069006f007200650073002e>
    /SUO <FEFF004b00e40079007400e40020006e00e40069007400e4002000610073006500740075006b007300690061002c0020006b0075006e0020006c0075006f0074002000410064006f0062006500200050004400460020002d0064006f006b0075006d0065006e007400740065006a0061002c0020006a006f0074006b006100200073006f0070006900760061007400200079007200690074007900730061007300690061006b00690072006a006f006a0065006e0020006c0075006f00740065007400740061007600610061006e0020006e00e400790074007400e4006d0069007300650065006e0020006a0061002000740075006c006f007300740061006d0069007300650065006e002e0020004c0075006f0064007500740020005000440046002d0064006f006b0075006d0065006e00740069007400200076006f0069006400610061006e0020006100760061007400610020004100630072006f0062006100740069006c006c00610020006a0061002000410064006f00620065002000520065006100640065007200200035002e0030003a006c006c00610020006a006100200075007500640065006d006d0069006c006c0061002e>
    /SVE <FEFF0041006e007600e4006e00640020006400650020006800e4007200200069006e0073007400e4006c006c006e0069006e006700610072006e00610020006f006d002000640075002000760069006c006c00200073006b006100700061002000410064006f006200650020005000440046002d0064006f006b0075006d0065006e007400200073006f006d00200070006100730073006100720020006600f60072002000740069006c006c006600f60072006c00690074006c006900670020007600690073006e0069006e00670020006f006300680020007500740073006b007200690066007400650072002000610076002000610066006600e4007200730064006f006b0075006d0065006e0074002e002000200053006b006100700061006400650020005000440046002d0064006f006b0075006d0065006e00740020006b0061006e002000f600700070006e00610073002000690020004100630072006f0062006100740020006f00630068002000410064006f00620065002000520065006100640065007200200035002e00300020006f00630068002000730065006e006100720065002e>
    /ENU (Use these settings to create PDFs that match the "Suggested"  settings for PDF Specification 4.0)
  >>
>> setdistillerparams
<<
  /HWResolution [600 600]
  /PageSize [612.000 792.000]
>> setpagedevice