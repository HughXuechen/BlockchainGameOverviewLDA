A Secure Private Charging Pile Sharing Scheme with Electric Vehicles in Energy Blockchain
A Secure Private Charging Pile Sharing Scheme
with Electric Vehicles in Energy Blockchain
Yuntao Wang1, Zhou Su1,2, and Kuan Zhang3
1MOE KLINNS Laboratory, School of Electronic and Information Engineering, Xi’an Jiaotong University, China
2School of Mechatronic Engineering and Automation, Shanghai University, China
3Electrical and Computer Engineering Department, University of Nebraska-Lincoln, USA
Corresponding author: zhousu@ieee.org
Abstract—With the rapid advance of electric vehicles (EVs)
and the sparse public charging infrastructure, the private
charging pile sharing networks (PCPSNs) hold the potential
to improve the quality of experience (QoE) of using EVs by
leveraging private charging piles (PCPs) as shared charging
points to charge a group of distributed EVs. However, due to
the potential security and privacy issues for EVs and PCPs
caused by untrusted participants in decentralized energy market,
it becomes a crucial challenge to optimally schedule the charging
and sharing strategies of EVs and PCPs in PCPSNs. In this
paper, we propose a secure and permissioned blockchain-based
PCP sharing scheme for EVs in PCPSNs. Firstly, we present
an energy blockchain-based PCPSN framework to enhance the
security of distributed energy trading. Secondly, we develop
a reputation-based secure PCP sharing protocol to efficiently
reach consensus in the blockchain with the implement of BLS
multi-signature. Thirdly, we investigate a distributed reputation
model to evaluate the trustworthiness of participants and identify
malicious users. In addition, based on the many-to-one matching
game, the optimal strategies of EVs and PCPs are analyzed by
searching the stable matching pairs. Finally, simulation results
show that the proposed scheme can not only improve the QoE
of users, but also protect the network from adversaries.
Index Terms—Electric vehicles, sharing security, blockchain,
reputation evaluation.
I. INTRODUCTION
Electric vehicles (EVs) hold the promise to ease fossil fuel
crisis and reduce gas emissions [1], have attracted worldwide
attentions from academia and industry. EVs on the road will
reach 140 million and constitute almost a third of new-car
market by 2030 [2]. Due to the lack of public charging
stations, the booming EV development has inevitably led to
serious problems for EV charging, especially in remote areas.
Besides, the utilization efficiency of private charging piles
(PCPs) is low since they only serve for their owners and
are left idle for a long time in a day [3]. Recently, the PCP
sharing networks (PCPSNs) have been developed as a potential
solution to facilitate the EV charging process and improve the
PCP utilization efficiency by sharing PCPs, which are scattered
throughout a city, with distributed foreign EVs [4].
PCPSNs basically consist of a group of publicly shared
PCPs powered by community renewable energy (RE) gener-
ators and a fleet of moving EVs with charging desires. In
PCPSNs, by publicly sharing PCPs, EVs users can attain a
better quality of experience (QoE) and reduce charging costs,
while PCP owners can earn extra profit by renting private
charging facilities to EVs [5]. However, several challenges
impede the current PCPSNs from being widely adopted.
On one hand, existing EV charging schemes [3]–[7] cannot
be directly applied in PCPSNs to develop optimal charging
strategies for connected EVs and PCPs, since the compe-
tition, cooperation and social features among users are not
jointly considered in PCPSNs with practical constraints [8].
For instance, PCPs with limited renewable generation can
cooperatively form coalitions with each other, and PCPs may
be more interested in sharing their private charging facilities
to EVs with higher social tie. Therefore, how to optimally
schedule the EV charging and PCP sharing process in PCPSNs
remains an issue of significance.
On the other hand, since PCP owners and EV users are
commonly strangers without prior direct experience, there
exist inherent risks and potential security and privacy issues
caused by malicious users and the compromised central shar-
ing platform during the PCP sharing process [9]. Recently,
the blockchain technique offers a potential solution to reduce
the reliance of the centralized sharing platform and defend
against attackers to enhance the security in PCP sharing [10].
However, due to the high mobility and resource-constraint
natures of EVs, it is still an open and vital issue to efficiently
implement a blockchain network among PCPs and EVs in
PCPSNs.
In this paper, we propose a novel permissioned blockchain-
based PCP sharing scheme for EVs in PCPSNs. Firstly, a de-
centralized blockchain-based PCPSN framework is developed,
where EVs and PCPs can publicly share energy transactions.
Secondly, with the implement of BLS multi-signature [11],
a novel reputation-based secure PCP sharing protocol with
lower signature size is developed to improve the efficiency
to reach consensus. For each consensus node, the difficulty of
proof-of-work (PoW) is adaptive according to its reputation
value. Thirdly, a reputation model is presented to assess the
trustworthiness of various nodes in PCPSNs and identify
malicious nodes based on ratings recorded in blockchain while
users’ social features are considered. In addition, we develop a
many-to-one matching game to model the interactions among
EVs and PCP coalitions. The stable matching pairs are derived
for both sides to select the best candidate to connect. Finally,
simulation results prove that the proposal outperforms other
conventional schemes in terms of security and efficiency.
The remainder of the work is organized as follows. Related
648
2019 18th IEEE International Conference On Trust, Security And Privacy In Computing And
Communications/13th IEEE International Conference On Big Data Science And Engineering
2324-9013/19/$31.00 ©2019 IEEE
DOI 10.1109/TrustCom/BigDataSE.2019.00092
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:20:36 UTC from IEEE Xplore.  Restrictions apply. 
work is reviewed in Section II. The system model is introduced
in Section III. The proposed scheme is presented in Section IV.
Performance evaluations are shown in Section V. Conclusion
and the future work are given in Section VI.
II. RELATED WORK
A. EV Charging Scheduling
Recently, a number of EV charging scheduling methods
have been proposed to improve the performance of energy
management in the vehicular networks and the smart grid. Luo
et al. [6] studied the multi-objective optimization framework
for EV charging stations integrated with RE sources and de-
signed a stochastic dynamic programming algorithm to derive
the optimal pricing and energy management policy. Cao et al.
[7] investigated a public charging station selection scheme in
distributed energy scheduling systems to minimize EVs’ trip
duration, where EVs’ parking duration, charging reservations
and mobility uncertainty are taken into consideration.
Zhang et al. [12] presented a three-party network archi-
tecture including the main grid, EVs and smart communities
in the smart grid and proposed a novel schedule-upon-request
energy scheduling framework to achieve flexiable and effective
energy management. To minimize the energy cost and charging
cost of substations with eased computational difficulty, Song et
al. [13] developed an optimal EV charging station scheduling
model in distributed power systems via convex relaxation
techniques. However, the security in the charging process of
EVs and the social features of EV users and PCP owners are
still not discussed sufficiently in most of the existing works.
B. Energy Blockchain
Recently, there have been an increasing number of studies
to improve the security of energy trading using the promising
blockchain technology. Silvestre et al. [14] reviewed dif-
ferent blockchain paradigms in microgrids and proposed a
blockchain-based real-time energy loss tracking and attribution
scheme for distributed energy transactions without reliance
on trusted intermediaries. To enhance transaction security and
privacy preservation in decentralized energy trading context,
Aitzhan et al. [15] developed a blockchain technology based
prototype named PriWatt by using anonymous encrypted mes-
sage propagation and multi-signature approaches.
Kang et al. [16] presented a local peer-to-peer energy ex-
changing model among plug-in hybrid EVs with decentralized
permissioned blockchain technique to improve the privacy
preservation and transaction security. Based on smart contracts
and lightning network in energy blockchain ecosystem, Huang
et al. [17] proposed a novel secure charging scheme for EVs
and charging piles in the Internet of energy to meet the security
requirements during energy trading process. However, due to
the resource constraints of EVs and PCPs and the existence of
multiple PCP coalitions, the above blockchain systems cannot
be directly applied in PCPSNs.
In contrast to the existing works, we investigate the secure
and incentive mechanism for EVs and PCPs in PCPSNs based
on the blockchain technology, reputation model, and game
theoretic model with the consideration of user’s competition,
cooperation, and social features.
III. SYSTEM MODEL
A. Network Model
As shown in Fig. 1, the energy blockchain-based PCPSN
consists of the following entities:
��������	�
	�����	
���������
�������	�������
������	��������	����
�����	���������
���	����
������	������	����������
������	��������	����	
�������	������
����������	������
�����	������
�����	����
�����
���	����
Fig. 1. System model of energy blockchain-based PCPSNs.
Electric Vehicles (EVs). The set of EVs with charging
request is denoted as I = {1, · · · , i, · · · , I}. To facilitate
the charging operations of EVs, each EV user i can send its
charging request with the desired energy demand to nearby
PCPs when its remaining state of charge (SoC) is low. Let
SoCi denote the SoC of EV i, which is constrained by
SoCmin
i ≤ SoCi ≤ 1, where SoCmin
i is the minimum SoC
of EV i to prolong its battery life [18].
Private Charging Piles (PCPs). There are M communities
located in a given investigated area. The set of PCPs in each
community m ∈ M is denoted as Jm = {1, · · · , j, · · · , Jm}.
Each PCP j ∈ Jm is privately owned and managed by its
owner and equipped with a charging outlet for EV charging.
Multiple solar panels are installed on the rooftop of community
buildings to provide clean energy supply for local PCPs. Let
EPV
j (t) be the clean energy supply for PCP j at time slot
t ∈ T = {1, · · · , t, · · · , T}. Furthermore, a group of PCP
owners in the same community with social relationships can
form social coalitions to exchange and share their limited
solar energy resources with each other to earn profit. The
set of PCP coalitions in community m is defined as Πm =
{Φ1, · · · ,Φn, · · · ,ΦNm}, where Φn ∩Φn′ = ∅, ∀n �= n′, and⋃Nm
n=1 Φn = Jm.
Local Aggregators (LAGs). Each community m is equipped
with a LAG m ∈ M={1, · · · ,m, · · · ,M} which can provide
both energy exchange and wireless communication services
for EVs and PCPs in its coverage area [19]. Specifically,
LAG m receives charging requests from multiple EVs and
obtains the latest information of local shared PCPs, e.g.,
location, residual solar energy, charging state (i.e., busy or
idle), etc. In the blockchain, LAGs are performed as full nodes
which store all the blockchain data and can participate in
the consensus process for global ledger management. Due to
resource constraints, EVs and PCPs are light nodes which only
649
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:20:36 UTC from IEEE Xplore.  Restrictions apply. 
store the metadata of blocks (i.e., the block header) and can
send, relay and accept ledger data in the blockchain [20].
B. Adversary Model
In the network, potential attacks will threaten user’s security
and privacy. We define the following kinds of adversaries:
Honest but curious EVs and PCPs. A EV or PCP may be
honest but curious by stealing the other’s privacy (e.g., identity,
occupation, habits, etc) during energy charging process.
Malicious EVs and PCPs. A malicious EV may pre-
tend that it has not received any charging service from the
corresponding PCP and refuses to pay. A malicious PCP
may advertise fraudulent charging services to nearby EVs.
Malicious EVs and PCPs may conduct the bad mouth attack by
conducting multiple small energy transactions and generating
multiple untruthful ratings to illegally increase or decrease the
reputation value of participants in PCPSNs.
Malicious LAGs. A malicious LAG may forge or tamper
with the data stored in it (e.g., local energy transactions) and
disclosure user’s privacy for profit.
Malicious sharing platform. Since all energy transactions
are stored in the sharing platform in traditional centralized
PCPSNs, a malicious sharing platform may conduct transac-
tion falsification attacks by modifying or forging transactions
to tamper with users’ account balances for self-interest.
IV. THE PROPOSED SCHEME
In this section, the energy blockchain is first introduced
followed with the reputation model. Then, we analyse the
optimal strategies of users by the matching game model.
A. Energy Blockchain
To secure the PCP sharing process, we propose a reputation-
based PCP sharing protocol in permissioned blockchain-based
PCPSNs, which contains the following steps:
1) Entity Registration: For system initialization, registra-
tion authority (RA) selects a bilinear pairing e : G0×G1 → G2
in groups G0,G1,G2 of prime order q, where g0 and g1 are
the generators of G0,G1, respectively. Two hash functions are
selected, i.e., H0 : {0, 1}∗ → G2 and H1 : {0, 1}∗ → Zq .
Each node k becomes authorized in the network after registra-
tion with RA by using its real identity. Then, each authorized
node k gets V public/private key pairs {yvk , xv
k}Vv=1, certificates
{Cervk}Vv=1, and wallet addresses {wv
k}Vv=1, where xk
S←− Zq ,
yk = gxk
1 , and S←− means randomly sampling.
2) BLS Multi-signature for PCP Coalition: Compared
with other digital signature schemes, BLS signatures [11]
are far shorter in the signature size. The security of BLS
multi-signature scheme relies on the standard computational
co-Diffie-Hellman (co-CDH) assumption. Each PCP j in
PCP coalition Φn ∈ Πm signs message Msg and gen-
erates its signature σj = H0(Msg)αj ·xj , where αj =
H1(yj , {y1, · · · , y|Φn|}). By computing the aggregated public
key apk =
∏|Φn|
j=1 y
αj
j , the BLS multi-signature is gener-
ated as σ =
∏|Φn|
j=1 σj . Given (Msg, apk, σ), if e(σ, g−1
1 ) ·
e(H0(Msg), apk) = 1G2
, the verification passes.
3) Energy Transaction: After PCP l ∈ Φn offers charging
service for EV i, an energy transaction tx1 is generated as
tx1 =
{
tx1
ID||wv
i ||wn||{sj}|Φn|
j=1 ||rating||coin
||time||Sigi||MulSign
}
, (1)
where tx1
ID is the hash of transaction tx1, wv
i is the vth wallet
address of EV i, wn is the wallet address of coalition Φn, sj
is the contribution of PCP j in coalition Φn defined in Section
IV-C. The tuple rating = {rai,l||ral,i||rai,m||ral,m} consists
of the rating rai,l that EV i gives to PCP l, the rating ral,i
that PCP l gives to EV i, the rating rai,m that EV i gives
to LAG m, and the rating ral,m that PCP l gives to LAG
m, where 1 means absolutely positive and 0 means totally
negative. coin is the energy coin that EV i should pay to
coalition Φn, time is the timestamp for transaction generation,
Sigi = σi is the signature of tx1
ID using EV i’s private key
xv
i , and MulSign = (apk, σ) is the BLS multi-signature of
tx1
ID signed by all members in coalition Φn. Then, each PCP
j in PCP coalition Φn can redeem its reward coinj in coalition
Φn’s wallet address wn by sending a redeem transaction tx2,
where the reward is allocated based on its contribution in the
coalition, i.e., coinj = sj · coin. Here, the transaction tx2 is
tx2 = {tx1
ID||tx2
ID||wn||wv
j ||yvj ||coinj ||time||Sigj}, (2)
where tx2
ID is the hash of transaction tx2, and Sigj = σj is
the signature of tx2
ID using PCP j’s private key xv
j .
4) Reputation-based Consensus Process:
All valid transactions during the consensus time slot ΔT
are ordered by timestamps and packaged into a local block by
each LAG. In the consensus process, LAGs compete with each
other to solve a proof-of-work (PoW) puzzle with a certain
difficulty. For each consensus node m, its difficulty of PoW
puzzle, �m, is adjusted dynamically and inversely proportional
to its reputation value Rm [21], [22] calculated in Section
IV-B, i.e.,
�m =
ς
log2(1 +Rm)
, (3)
where ς > 0 is the adjustment coefficient. Note that it is
easier for a consensus node with higher reputation value to
find a valid PoW solution. After the fastest LAG m̂ finds
a valid nonce which is audited successfully by other LAGs,
the consensus is reached. Then, the newly generated block
is added into the append-only blockchain, and LAG m̂ is
rewarded with a certain amount of energy coins. In addition,
the PCP coalition Φn̂ with the most contribution on energy
sharing during ΔT is rewarded with small amount of energy
coins as an incentive.
B. Reputation Evaluation
To assess the trustworthiness of EV users, PCP owners, and
LAG operators, a reputation model is presented based on the
ratings recorded in the blockchain. Let Λj(t) be the set of EVs
that have interacted with PCP j during time slot t. Let Raki,j
be the weighted rating of EV i in PCP j, i.e.,
Raki,j = log2
(
1 +
di,Φn
vmax
raki,j
)
, (4)
650
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:20:36 UTC from IEEE Xplore.  Restrictions apply. 
where di,Φn
is the energy demand of EV i in PCP j ∈ Φn,
vmax is the maximum energy demand, and raki,j is the rating
for kth interaction (i.e., charging operation). The credibility
value is used to measure the reliability of rating raki,j , which
is calculated by
creki,j(t) = sidi,j · simk
i,j(t) · e−λ(t−tk), (5)
where e(.) is the time decay function indicating that latest
interactions are more important than previous ones, λ is the
aging factor, and tk is kth service time. Here, sidi,j is the
social importance degree of EV i in PCP j, i.e.,
sidi,j =
∑
k∈Ni
soi,k∑
i∈Λj(t)
∑
k∈Ni
soi,k
, (6)
where Ni is the set of neighboring nodes of node i in the
social network, and soi,k ∈ [0, 1] is the social relationship
between node i and node k. Let drski,j and mrski,j be the dual
rating similarity and the mean rating similarity between EV i
and PCP j for rating rakj,i, respectively, i.e.,
drski,j = 1−
∣∣raki,j − rakj,i
∣∣ , (7)
mrski,j = 1−
∣∣raki,j − raj(t)
∣∣ , (8)
where raj(t) =
∑|Λj(t)|
i=1
∑qi,j(t)
h=1 rah
i,j
∑|Λj(t)|
i=1 qi,j(t)
is the average rating
given from EVs in the set Λj(t) to PCP j, and qi,j(t) is the
amount of interactions between EV i in PCP j during time slot
t. Then, the similarity value between EV i and PCP j for each
rating is simk
i,j(t) = drski,j · mrski,j . To ease computational
difficulty, the reputation value of PCP owner j at time slot t
can be attained by iteration, i.e.,
Rj(t) =
ΞR(t)
ΘR(t)
=
ΞR(t−1)e−λ+
∑|Λj(t)|
i=1
∑qi,j(t)
k=1 Rak
i,jcre
k
i,j(t)
ΘR(t−1)e−λ+
∑|Λj(t)|
i=1
∑qi,j(t)
k=1 creki,j(t)
. (9)
We set ΞR(0)=0.5 and ΘR(0)=1. Obviously, Rj(t)∈ [0, 1].
Similarly, the reputation value Ri(t) of EV user i, and the
reputation value Rm(t) of LAG operator m can be computed.
Security Analysis: Since all energy transactions are
recorded in the recognized and verifiable blockchain, mali-
cious EV users cannot deny the related transactions recorded
in the blockchain. Meanwhile, if any malicious PCP owner
advertises fraudulent charging services, RA can reveal its true
identity and penalize it correspondingly. Through reputation
evaluation, dishonest or unfair ratings given from malicious
users are assigned with low credibility. Therefore, the effect
of bad mouth attack can be reduced by credibility computing.
Since each user can dynamically change pseudonyms (i.e.,
wallet addresses) for different transactions to send and receive
energy coins, the anonymity and unlinkability of users can be
achieved for privacy preserving.
By adjusting the difficulty of PoW based on reputation
values in consensus phase, the power consumption of honest
LAGs is decreased while that of malicious LAGs is increased
to motivate LAGs to behave honestly. In addition, each LAG
stores a copy of the immutable blockchain which is managed
by all LAGs via the consensus process and cannot be tampered
with or forged by malicious LAGs. Through decentralized
permissioned blockchain technology, inherent security risks
arisen from centralized sharing platform can be removed in
blockchain-based PCPSNs.
C. Many-to-one Matching Game
A coalition of PCPs can provide charging services for
multiple EVs while each EV can only receive charging service
from a specific coalition of PCPs in PCPSNs. Therefore, the
charging scheduling problem between EVs and PCPs can be
modeled as a many-to-one matching game.
Definition 1 (Many-to-one matching): A many-to-one
matching Ψ is defined as a bidirectional mapping between
the set of PCP coalitions Π = {Π1, · · · ,Πm, · · · ,ΠM} and
the set of EVs I such that:
• ∀i ∈ I, each EV i is assigned to at most one PCP
coalition in Π, i.e., Ψ(i) ∈ Π∪{∅}, and |Ψ(i)| ∈ {0, 1}.
• ∀Φn ∈ Π, each PCP coalition Φn is assigned to at
most |Φn| EVs, i.e., Ψ(Φn) ∈ I ∪ {∅}, and |Ψ(Φn)| ∈
{0, · · · , |Φn|}.
Definition 2 (Preference relation): If EV i prefers PCP
coalition Φn to Φn′ , for any two disjoint coalitions Φn,Φn′ ∈
Π, the strict preference relation �i is defined over the set of
EVs such that:
Φn�iΦn′ ⇔ Ui (Φn) > Ui (Φn′) . (10)
Similarly, if PCP coalition Φn prefers EV i to i′, for any two
different EVs i, i′ ∈ I, i �= i′, the strict preference relation
�Φn
is defined over the set of PCP coalitions such that:
i�Φni
′ ⇔ Ωi (Φn) > Ωi′ (Φn) , (11)
where Ωi (Φn) is defined as the utility of PCP coalition
Φn providing charging service for EV i, i.e., Ωi (Φn) =
(pΦn − cΦn) di,Φn − δ1.
Definition 3 (Stable Matching): A many-to-one matching
Ψ is stable, if and only if there does not exist a blocking pair
(Φn ∈ Π, i ∈ I) to block the matching Ψ, i.e.,
�(Φn, i), s.t.Φn�iΨ(i) and i�Φn
Ψ(Φn) , (12)
where Ψ(i) �= Φn, i /∈ Ψ(Φn). Here, Ψ(i) and Ψ(Φn)
indicate the current matching results for EV i and PCP
coalition Φn, respectively.
To obtain the preference list in the proposed matching game,
firstly, the utility function of each user need to be established.
For EV i requesting energy from PCP coalition Φn in LAG
m, its utility function can be used to measure the QoE and is
defined as:
Ui(Φn) = αi ln (1 + ηiRΦn
di,Φn
)− εidi,Φn
+
ξ (li,grid − li,Φn
) + (pgrid − pΦn
) di,Φn
− δ1
, (13)
s.t.
⎧⎪⎪⎪⎨
⎪⎪⎪⎩
Eini
i − ξli,Φn ≥ SoCmin
i CEV
i , (14)
Eini
i − ξli,Φn + ηidi,Φn ≤ CEV
i , (15)
0 ≤ di,Φn ≤ vmax, (16)
RΦn ≥ θi, (17)
where αi is a non-negative satisfaction coefficient, ηi ∈ (0, 1)
is the charging efficiency, RΦn
=
∑
j∈Φn
Rj
|Φn| is the average
651
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:20:36 UTC from IEEE Xplore.  Restrictions apply. 
reputation value of PCP coalition Φn, and di,Φn
is the energy
demand of EV i in PCP coalition Φn. The first term in (13)
means the charging satisfaction [23]. εi is the unit cost of
battery degradation of EV i, ξ is the unit energy consumption
rate, li,Φn
is the distance between EV i and PCP coalition
Φn, and li,grid is the distance between EV i and the public
charging station. The fourth term in (13) means the saved
expenditure that charging in PCP coalition Φn with unit price
pΦn instead of the public charging station with unit price pgrid.
δ1 is the fixed cost for EVs, e.g., operation fee for charging
and transaction fee in the blockchain. (14) and (15) are battery
energy constraints, where CEV
i is the battery capacity of EV
i. (16) is the energy demand constraint. (17) means that only
PCP coalitions whose average reputation value is greater than
the threshold θi can provide charging service for EV i for
secure charging.
For PCP j in coalition Φn in LAG m, its utility function
can be used to measure the QoE and is defined as
Vj(Φn) = sj · (
∑
i∈Γn
pΦndi,Φn−∑
i∈Γn
cΦndi,Φn − |Φn| δ2) , (18)
s.t.
⎧⎪⎪⎪⎨
⎪⎪⎪⎩
pΦn
≤ pgrid, (19)
|Γn| ≤ |Φn| , (20)∑
i∈Γn
di,Φn ≤
∑
j∈Φn
EPV
j , (21)
Ri ≥ θΦn , ∀i ∈ Γn, (22)
where sj is the contribution of PCP j in PCP coalition Φn,
which is associated with its reputation value Rj and available
clean energy resources EPV
j , i.e., sj =
RjE
PV
j∑
j∈Φn
RjEPV
j
. Γn is
the set of EVs that is accepted to receive charging service in
coalition Φn, pΦn is the charging price of coalition Φn, cΦn
is the charging cost of coalition Φn, and δ2 is the fixed cost
for the coalition. (19) is the charging price constraint. (20)
means the number of EVs charging in coalition Φn should be
no more than the total available charging outlets. (21) means
the total charging demand of EVs in Γn should be no more
than the available solar energy resource in coalition Φn. (22)
means that only trustworthy EVs whose reputation value is
larger than the threshold θΦn can be accessed to coalition Φn
to enhance the sharing security.
Secondly, we analyze the optimal strategies of EV users on
the energy demand in different PCP coalitions. Here, the first
derivative of EV i’s utility function with respect to di,Φn is
∂Ui(Φn)
∂di,Φn
=
αiηiRΦn
1 + ηiRΦndi,Φn
− εi + pgrid − pΦn
. (23)
The second derivative of Ui(Φn) with respect to di,Φn
satisfies
∂2Ui(Φn)
∂di,Φn
2 =− αiηi
2RΦn
2
(1 + ηiRΦn
di,Φn
)
2 <0, (24)
which implies that Ui(Φn) is strictly concave with respect to
di,Φn . Furthermore, we have
lim
di,Φn→0
∂Ui(Φn)
∂di,Φn
=pθ1−pΦn
, (25)
lim
di,Φn→vmax
∂Ui(Φn)
∂di,Φn
=pθ2−pΦn . (26)
Here, we define pθ1 = αiηiRΦn
− εi + pgrid and pθ2 =
αiηiRΦn
1+ηiRΦnvmax
− εi + pgrid as the critical prices and consider
the following three cases:
Case 1: If pgrid ≥ pΦn
≥ pθ1 , since pθ1 > pθ2 , we have
lim
di,Φn→0
∂Ui(Φn)
∂di,Φn
≤ 0 and lim
di,Φn→vmax
∂Ui(Φn)
∂di,Φn
< 0. Therefore,
the optimal charging demand is d∗i,Φn
= 0. In this case, there
does not exist any energy trading between EV i and PCP
coalition Φn.
Case 2: If 0 < pΦn
≤ pθ2 , we can derive that
lim
di,Φn→0
∂Ui(Φn)
∂di,Φn
> 0 and lim
di,Φn→vmax
∂Ui(Φn)
∂di,Φn
≥ 0. Therefore,
the optimal charging demand is d∗i,Φn
= vmax.
Case 3: If pθ2 < pΦn < pθ1 , we have lim
di,Φn→0
∂Ui(Φn)
∂di,Φn
> 0
and lim
di,Φn→vmax
∂Ui(Φn)
∂di,Φn
< 0. Therefore, the optimal charging
demand can be resolved by ∂Ui(Φn)
∂di,Φn
= 0, i.e.,
d∗i,Φn
=
αi
εi + pΦn
− pgrid
− 1
ηiRΦn
. (27)
Above all, the optimal strategy of EV i on energy demand
from PCP coalition Φn is denoted as:
d∗i,Φn
=
⎧⎨
⎩
0, pθ1 ≤ pΦn ≤ pgrid
αi
εi+pΦn−pgrid
− 1
ηiRΦn
, pθ2 <pΦn
<pθ1
vmax, 0 < pΦn
≤ pθ2 .
(28)
To find the stable matching pairs between EVs and PCP
coalitions, a matching algorithm is presented in Algorithm 1.
Here, a linear pricing function is adopted to determine the
charging price of each PCP coalition by considering the
remaining energy resources, i.e.,
pΦn =
κΦnRΦn
EΦn
−DΦn
+ 1
+ χΦn
, (29)
where EΦn
− DΦn
denotes the residual solar energy of
coalition Φn, κΦn is the price parameter, and χΦn is the cost
parameter.
Theorem 1: The matching results Ψ∗ = {Ψ∗
m}Mm=1 derived
from the Algorithm 1 is stable.
Proof. Obviously, Algorithm 1 can converge since users’
preference lists, i.e., EPL and CPL, are finite. Assume that
there exists a case where EV i, i′ ∈ I are assigned to PCP
coalitions Φn,Φn′ ∈ Πm, respectively, in the stable matching
results. If there exists a blocking pair (Φn, i
′) such that EV i′
prefers PCP coalition Φn to Φn′ and PCP coalition Φn prefers
EV i′ to i. Then, according to steps 3–14 in Algorithm 1, EV
i′ should be assigned to PCP coalition Φn, which contradicts
with the condition that EV i′ is assigned to PCP coalition
Φn′ . Thus, the blocking pair does not exist and the matching
results obtained from Algorithm 1 is guaranteed to be stable.
Theorem 1 is proved.
V. PERFORMANCE EVALUATIONS
A. Simulation Setup
We consider three communities in PCPSN and each com-
munity contains 10 PCPs. The available hourly solar energy of
each PCP is uniformly distributed in [8, 15] kWh. The social
relation values among users follow a uniform distribution
652
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:20:36 UTC from IEEE Xplore.  Restrictions apply. 
Algorithm 1 Many-to-one Matching Algorithm
1: Input: The charging price of each PCP coalition pΦn
, the
total solar energy of each coalition EΦn
=
∑
j∈Φn
EPV
j ,
and the optimal energy demand of each EV d∗i,Φn
.
2: Output: The stable matching pairs Ψ∗
m =
{AccListn}|Πm|
n=1 , ∀m ∈ M.
3: Repeat
4: Each EV i ranks the order of coalitions and stores them
in its preference list EPLi based on its utility defined in
(13) and constraints (14)–(17).
5: EV i chooses the first item in EPLi to request energy.
6: Each PCP coalition Φn filters EVs that send charging
request to itself and satisfy constraint (22). Then, it stores
the ranking of EVs in its preference list CPLn in descend-
ing order based on its utility Ω (Φn) =
∑
j∈Φn
Vj(Φn),
where Vj(Φn) is defined in (18).
7: if |CPLn| ≤ |Φn| and
∑
i∈CPLn
di,Φn
≤ EΦn
then
8: Each PCP coalition Φn accepts all charging requests in
CPLn, and stores into its acceptance list AccListn.
9: else
10: Each PCP coalition Φn selects the set Γn ⊆ CPLn to
provide charging services by solving the problem:
argmax
Γn
{Ω (Φn)}=argmax
Γn
{∑
i∈Γn
di,Φn
}
s.t.(20)(21).
(30)
11: Each PCP coalition updates its acceptance list by
AccListn=Γn, and rejects other EVs in CPLn\Γn.
12: Each PCP coalition updates the number of available
charging outlets |Φn|, and the used clean energy re-
sources DΦn .
13: end if
14: Until AccListn of all PCP coalitions remains unchanged.
TABLE I
SIMULATION PARAMETERS
Parameters Values Parameters Values
vmax 15 kWh CEV
i [20, 30] kWh
αi [1.5, 2] soi,j [0, 1]
ηi, εi 0.85, 2.5 θi, θΦn 0.7, 0.7
ξi 0.1 δ1, δ2 0.2, 0.2
pj [4, 5]cent/kWh cj [0.2, 0.4]cent/kWh
pgrid 6.5 cent/kWh li,m {0.5, 1.2, 2.0}mile
within [0, 1]. The rating of each EV/PCP on a malicious or
normal PCP/EV is random in [0, 0.5] or (0.5, 1], respectively.
The ratios of malicious PCP and malicious EV are equal to
0.6. Other parameters are listed in Table I.
The following metrics are used to evaluate the performance
of the proposed scheme. Secure sharing efficiency (SSE): the
proportion of clean energy demanded by normal EVs to the
total clean energy supply of PCPs. Average utility of EVs: the
average of EVs’ utilities during energy trading in PCPSN.
B. Simulation Results
We compare the proposed scheme with the matching scheme
without reputation evaluation (MWR) [24] and the random
scheme. In the MWR scheme, the charging service is sched-
uled by the matching game while the reputation evaluation and
the PCP coalitions are absent. In the random scheme, each EV
selects the PCP and obtains the energy demand from PCPs at
random.
 ! �! "! #! $!
!
!%�
!%#
!%&
!%'
 
()*+��	�
	���
�
��
)
��
	�
�
��
��
�
	�
��
��
�
��
	��������	����*�
	,-.	����*�	
	.����*	����*�
Fig. 2. SSE versus number of EVs in different schemes.
! $  !  $ �! �$
!%#$
!%$
!%$$
!%&
!%&$
!%/
!%/$
!%'
!%'$
!%0
�������	�*��
�
��
)
��
	�
�
��
��
�
	�
��
��
�
��
�!	���
"!	���
#!	���
Fig. 3. SSE versus number of matching iterations.
 ! �! "! #! $!
!
!%$
 
 %$
�
�%$
"
()*+��	�
	����
1
�
��
��
�	
)
�
��
�
	�
	
�
�
�
	��������	����*�	 		
.����*	����*�
,-.	����*�
Fig. 4. Average utility of EVs versus number of PCPs in different schemes.
Fig. 2 shows the SSE in three schemes when the number
of EVs changes. It can be seen that the proposed scheme
outperforms other schemes by achieving a higher SSE. In the
MWR scheme, due to the absence of reputation evaluation, the
customers of PCPs’ charging services can be malicious EVs.
In the random scheme, the solar energy resources are randomly
allocated to EVs where a part of resources may not be used.
In the proposed scheme, EVs and PCP coalitions can form the
optimal matching pairs to improve energy efficiency through
Algorithm 1. In addition, trustworthy PCPs and EVs can be
selected through the proposed reputation model to provide and
receive secure charging services in PCPSNs, respectively.
653
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:20:36 UTC from IEEE Xplore.  Restrictions apply. 
Fig. 3 presents the convergence of the proposed many-to-
one matching algorithm when the number of EVs varies. From
Fig. 3, it can be seen that the SSE with 20, 30, 40 EVs is
converged to be stable by 4, 13, 15 iterations, respectively. The
fewer number of EVs in the simulation, the faster convergence
to the stable SSE. Moreover, since more clean energy resources
are allocated by more EVs, the simulation with a larger number
of EVs can obtain a higher SSE.
Fig. 4 demonstrates the average utility of EVs in three
schemes when the number of PCPs changes. Here, the number
of EVs is set as I = 40. It can be observed that our proposal
attains a higher average utility for EVs than other two schemes,
and the average utility of EVs increases with the increase
of the number of PCPs. The reason is that, in the MWR
scheme, each PCP has limited clean energy resource and the
cooperation among PCPs is absent. Thus, EVs with higher
energy demand may not attain satisfied energy resources in
the MWR scheme, resulting in a relative lower average utility.
In the random scheme, EVs randomly obtain clean energy
resources from PCPs without cooperation and competition,
causing the average utility of EVs is low. In the proposed
scheme, on one hand, PCPs can cooperatively form coalitions
to reallocate energy resources within each coalition. On the
other hand, EVs and PCP coalitions can compete with each
other to attain the optimal matching results via the proposed
matching algorithm. Thus, EVs can achieve optimal utilities
in the proposal.
VI. CONCLUSION
In this paper, we have proposed a blockchain-based se-
cure PCP sharing scheme with EVs in PCPSNs. Based on
BLS multi-signature, a secure PCP sharing protocol is de-
veloped to efficiently implement the blockchain into PCP-
SNs. A reputation model is designed to identify malicious
users while considering users’ social features. To optimally
schedule the charging process, we further present a matching
game to optimally schedule the energy strategies of EVs and
PCPs. In addition, simulation results show that our proposal
outperforms other conventional schemes with improved RE
efficiency, better user utility, and enhanced charging security.
In the future work, we will extend this work by considering
the existence of discharging EVs in PCPSNs.
ACKNOWLEDGE
This work is supported in part by NSFC (no. 61571286,
U1808207, 91746114), and Shanghai Key Laboratory of
Power Station Automation Technology.
REFERENCES
[1] Z. Moghaddam, I. Ahmad, D. Habibi and Q. V. Phung, “Smart Charging
Strategy for Electric Vehicle Charging Stations,” IEEE Transactions on
Transportation Electrification, vol. 4, no. 1, pp. 76–88, Mar. 2018.
[2] Global EV Outlook Understanding the Electric Vehicle Land-
scape to 2020. [Online]. Available: https://www.iea.org/publications/
freepublications/publication/Global EV Outlook 2016.pdf, 2016.
[3] H. Zhang, Z. Hu, Z. Xu and Y. Song, “An Integrated Planning Framework
for Different Types of PEV Charging Facilities in Urban Area,” IEEE
Transactions on Smart Grid, vol. 7, no. 5, pp. 2273–2284, Sep. 2016.
[4] Y. Hou, Y. Chen, Y. Jiao, J. Zhao, H. Ouyang, P. Zhu, D. Wang and
Y. Liu, “A resolution of sharing private charging piles based on smart
contract,” 2017 13th International Conference on Natural Computation,
Fuzzy Systems and Knowledge Discovery (ICNC-FSKD), Guilin, pp.
3004–3008, 2017.
[5] E. Thompson, R. Ordonez-Hurtado, W. Griggs, J. Y. Yu, B. Mulkeen
and R. Shorten, “On charge point anxiety and the sharing economy,”
2017 IEEE 20th International Conference on Intelligent Transportation
Systems (ITSC), Yokohama, pp. 1–6, 2017.
[6] Y. Cao, T. Wang, O. Kaiwartya, G. Min, N. Ahmad and A. H. Abdullah,
“An EV Charging Management System Concerning Drivers’ Trip Dura-
tion and Mobility Uncertainty,” IEEE Transactions on Systems, Man, and
Cybernetics: Systems, vol. 48, no. 4, pp. 596–607, Apr. 2018.
[7] C. Luo, Y. Huang and V. Gupta, “Stochastic Dynamic Pricing for EV
Charging Stations With Renewable Integration and Energy Storage,” IEEE
Transactions on Smart Grid, vol. 9, no. 2, pp. 1494–1505, Mar. 2018.
[8] J. Li, C. Li, Y. Xu, Z. Y. Dong, K. P. Wong and T. Huang, “Noncoop-
erative Game-Based Distributed Charging Control for Plug-In Electric
Vehicles in Distribution Networks,” IEEE Transactions on Industrial
Informatics, vol. 14, no. 1, pp. 301–310, Jan. 2018.
[9] S. Huckle, R. Bhattacharya, M. White and N. Beloff, “Internet of Things,
Blockchain and Shared Economy Applications,” Procedia Computer
Science, vol. 98, pp. 461–466, 2016.
[10] O. Novo, “Blockchain Meets IoT: An Architecture for Scalable Access
Management in IoT,” IEEE Internet of Things Journal, vol. 5, no. 2, pp.
1184–1195, Apr. 2018.
[11] D. Boneh, M. Drijvers and G. Neven, “Compact Multi-signatures for
Smaller Blockchains,” Advances in Cryptology – ASIACRYPT 2018,
Springer, vol. 11273, pp. 435–464, 2018.
[12] R. Zhang, X. Cheng and L. Yang, “Energy Management Framework
for Electric Vehicles in the Smart Grid: A Three-Party Game,” IEEE
Communications Magazine, vol. 54, no. 12, pp. 93–101, 2016.
[13] Y. Song, Y. Zheng and D. J. Hill, “Optimal Scheduling for EV Charging
Stations in Distribution Networks: A Convexified Model,” IEEE Trans-
actions on Power Systems, vol. 32, no. 2, pp. 1574–1575, Mar. 2017.
[14] M. L. Di Silvestre, P. Gallo, M. G. Ippolito, E. R. Sanseverino and G.
Zizzo, “A Technical Approach to the Energy Blockchain in Microgrids,”
IEEE Transactions on Industrial Informatics, vol. 14, no. 11, pp. 4792–
4803, Nov. 2018.
[15] N. Z. Aitzhan and D. Svetinovic, “Security and Privacy in Decentralized
Energy Trading Through Multi-Signatures, Blockchain and Anonymous
Messaging Streams,” IEEE Transactions on Dependable and Secure
Computing, vol. 15, no. 5, pp. 840–852, 1 Sep-Oct. 2018.
[16] J. Kang, R. Yu, X. Huang, S. Maharjan, Y. Zhang and E. Hossain, “En-
abling Localized Peer-to-Peer Electricity Trading Among Plug-in Hybrid
Electric Vehicles Using Consortium Blockchains,” IEEE Transactions on
Industrial Informatics, vol. 13, no. 6, pp. 3154–3164, Dec. 2017.
[17] X. Huang, C. Xu, P. Wang and H. Liu, “LNSC: A Security Model for
Electric Vehicle and Charging Pile Management Based on Blockchain
Ecosystem,” IEEE Access, vol. 6, pp. 13565–13574, 2018.
[18] T. Ma and O. A. Mohammed, “Optimal Charging of Plug-in Electric
Vehicles for a Car-Park Infrastructure,” IEEE Transactions on Industry
Applications, vol. 50, no. 4, pp. 2323–2330, 2014.
[19] Z. Li, J. Kang, R. Yu, D. Ye, Q. Deng and Y. Zhang, “Consortium
Blockchain for Secure Energy Trading in Industrial Internet of Things,”
IEEE Transactions on Industrial Informatics, vol. 14, no. 8, pp. 3690–
3700, Aug. 2018.
[20] Z. Su, Y. Wang, Q. Xu, M. Fei, Y. Tian and N. Zhang, “A Se-
cure Charging Scheme for Electric Vehicles with Smart Communi-
ties in Energy Blockchain,” IEEE Internet of Things Journal. doi:
10.1109/JIOT.2018.2869297, 2018.
[21] M. Conti, E. Sandeep Kumar, C. Lal and S. Ruj, “A Survey on
Security and Privacy Issues of Bitcoin,” IEEE Communications Surveys
& Tutorials, vol. 20, no. 4, pp. 3416–3452, 2018.
[22] Y. Wang, Z. Su and N. Zhang, “BSIS: Blockchain based Secure Incen-
tive Scheme for Energy Delivery in Vehicular Energy Network,” IEEE
Transactions on Industrial Informatics. doi: 10.1109/TII.2019.2908497.
[23] S. Maharjan, Q. Zhu, Y. Zhang, S. Gjessing and T. Basar, “Dependable
Demand Response Management in the Smart Grid: A Stackelberg Game
Approach,” IEEE Transactions on Smart Grid, vol. 4, no. 1, pp. 120–132,
Mar. 2013.
[24] M. Zeng, S. Leng, Y. Zhang and J. He, “QoE-Aware Power Management
in Vehicle-to-Grid Networks: A Matching-Theoretic Approach,” IEEE
Transactions on Smart Grid, vol. 9, no. 4, pp. 2468-2477, Jul. 2018.
654
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:20:36 UTC from IEEE Xplore.  Restrictions apply.