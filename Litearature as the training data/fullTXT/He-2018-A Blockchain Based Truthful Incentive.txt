A Blockchain Based Truthful Incentive Mechanism for Distributed P2P Applications
SPECIAL SECTION ON PRIVACY PRESERVATION FOR LARGE-SCALE USER DATA
IN SOCIAL NETWORKS
Received December 31, 2017, accepted March 5, 2018, date of publication April 2, 2018, date of current version June 5, 2018.
Digital Object Identifier 10.1109/ACCESS.2018.2821705
A Blockchain Based Truthful Incentive
Mechanism for Distributed P2P Applications
YUNHUA HE 1, (Member, IEEE), HONG LI2, (Member, IEEE), XIUZHEN CHENG3, (Fellow, IEEE),
YAN LIU4, (Member, IEEE), CHAO YANG5, (Member, IEEE), AND LIMIN SUN2, (Member, IEEE)
1Department of Computer Science, North China University of Technology, Beijing 100144, China
2Institute of Information Engineering, Chinese Academy of Science, Beijing 100093, China
3Department of Computer Science, The George Washington University, Washington, DC 20052, USA
4School of Software and Microelectronics, Peking University, Beijing 102600, China
5School of Syber Engineering, Xidian University, Xi’an 710071, China
Corresponding author: Hong Li (lihong@iie.ac.cn)
This work was supported in part by the Beijing Natural Science Foundation under Grant 4184085, in part by the National Natural Science
Foundation of China under Grant 61702503, Grant 61602053, and Grant 61672415, in part by the Youth Science and Technology
Innovation Foundation (North China University of Technology) under Grant 1473009, and in part by the Natural Science Foundation of
Shaanxi Province under Grant 2017JM6054.
ABSTRACT In distributed peer-to-peer (P2P) applications, peers self-organize and cooperate to effectively
complete certain tasks such as forwarding files, delivering messages, or uploading data. Nevertheless, users
are selfish in nature and they may refuse to cooperate due to their concerns on energy and bandwidth
consumption. Thus each user should receive a satisfying reward to compensate its resource consumption
for cooperation. However, suitable incentive mechanisms that can meet the diverse requirements of users in
dynamic and distributed P2P environments are still missing. On the other hand, we observe that Blockchain
is a decentralized secure digital ledger of economic transactions that can be programmed to record not
just financial transactions and Blockchain-based cryptocurrencies get more and more market capitalization.
Therefore in this paper, we propose a Blockchain based truthful incentive mechanism for distributed P2P
applications that applies a cryptocurrency such as Bitcoin to incentivize users for cooperation. In this
mechanism, users who help with a successful delivery get rewarded. As users and miners in the Blockchain
P2P system may exhibit selfish actions or collude with each other, we propose a secure validation method
and a pricing strategy, and integrate them into our incentive mechanism. Through a game theoretical analysis
and evaluation study, we demonstrate the effectiveness and security strength of our proposed incentive
mechanism.
INDEX TERMS Incentive mechanism, P2P applications, data transmissions, Bitcoin System, collusion
attacks, pricing strategy.
I. INTRODUCTION
Peer-to-Peer (P2P) applications are featured by distributed
architectures that partition tasks or work loads between
peers without a trusted authority. Peers self-organize and
collaborate in certain tasks such as forwarding files, deliv-
ering messages, or uploading data. Example P2P applica-
tions include mobile data offloading that allows mobile users
to cooperatively deliver cellular network data by exploiting
complementary network technologies (e.g., WiFi and femto-
cell) [1], Delay Tolerant Social Network (DTSN) [2] where
users opportunistically forwardmessages for others that share
common interests by following a store-carry-forward mecha-
nism, and mobile crowdsensing in which smartphone users
collaboratively upload data for the purpose of reducing
energy consumption and mobile data cost [3].
The effectiveness of data transfer, packet forward-
ing, or data collection in the P2P applications mentioned
above relies on the cooperation of mobile users. As data
transmissions in such P2P applications often happen in an
opportunistic manner, uncooperative behaviors would lead to
low delivery success ratio and long delivery latency. On the
other hand, autonomous mobile users may exhibit selfish
behaviors, refusing to cooperate in data transmissions for
the concerns on energy and bandwidth consumption. There-
fore the participating users should be provided with enough
rewards for cooperation. However, the properties of P2P
27324
2169-3536 
 2018 IEEE. Translations and content mining are permitted for academic research only.
Personal use is also permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.
VOLUME 6, 2018
https://orcid.org/0000-0001-8971-3936
Y. He et al.: Blockchain Based Truthful Incentive Mechanism for Distributed P2P Applications
applications bring challenges into the design of an incen-
tive mechanism [4], [5]. First, most P2P applications exploit
opportunistic connections amongmobile users without know-
ing who will be the next hop and how many users will get
involved; thus it is hard to know who will get rewarded and
how many rewards shall be paid. Second, in a distributed
environment, users may not believe that they can get their
rewards as there is no pre-established trust between each
other. Moreover, the uncontrolled environment may lead to
some disorders in an incentive system. Finally, users may
have different valuations on consumed resources and differ-
ent requirements on the returns.
Many incentive mechanisms have been proposed and
implemented, including the reputation systems, the Tit-for-
Tat schemes, and the credit based approaches. A reputation
system [6], [7] can help a user identify uncooperative peers
by monitoring the behaviors of its neighbors during data
transmissions and propagating the uncooperative reputation
throughout the network. Such systems generally lack the
considerations on a formal specification and analysis of the
incentive types and on how to define the reputation of a new
user. Tit-for-Tat schemes [8], [9] stimulate mobile users to
cooperate by exchanging equal services among them based
on what contributions they have done for others. Each user
receives as much service as it has done for its neighbors
based on its history behavior. These schemes are restricted
to applications with long session durations that can provide
many opportunities for reciprocation between pairs of users.
Another challenge of Tit-for-Tat is its hardness of meet-
ing the different service requirements of the users. Credit
based approaches [10], [11] provide incentives by paying the
cooperative users certain amount of credit or virtual money.
Such approaches could be the most promising due to their
explicit and flexible incentive methods; nevertheless, most
credit based incentive schemes either rely on a central trusted
authority or do not give an explicit digital currency system
that is provably secure, leading to possible system collapses.
Blockchain is a decentralized digital ledger of economic
transactions that can be programmed to record not just finan-
cial transactions, and it has the advantages of transparency,
security and speed [12]–[14]. Blockchain-based cryptocur-
rencies have recently gained a noticeable popularity, and
their current market capitalization is over $566 billion. The
security of Blockchain depends on a majority of the com-
puting power instead of a central authority, thus eliminating
the risks of one taking control over the system, generating
inflation, or completely shutting down the system. In this
paper, we exploit Blockchain transactions to incentivize users
to cooperate in P2P applications.
The basic idea of our incentive scheme is to employ
Blockchain transactions to reward those intermediate nodes
that contribute to a successful delivery from the sender to
the receiver. If an intermediate node helps transmit the data,
the next-hop node sends it a signed acknowledgement which
is used as a proof of getting the rewards. The miners in the
Blockchain P2P system are in charge of verifying whether
there is a successful delivery from the sender to the receiver,
and examining the validity of the signed acknowledgements
provided by the cooperative intermediate nodes in a success-
ful delivery. The Blockchain P2P system is an independent
system from P2P applications, the transactions generated in
P2P applications will send to the miners in the Blockchain
P2P system for the verification. This brings another concern:
if a miner can see the content of a signed acknowledge-
ment, she can disguise as a cooperative intermediate node to
get the payment. To overcome this problem, we extend the
Blockchain transaction syntax to support a secure validation
of the acknowledgement by using commutative encryptions.
We also propose a pricing strategy to defend the possi-
ble attacks resulted from selfish users and to prevent their
collusion.
The major contributions of the paper are summarized as
follows:
• We design a Blockchain-based truthful incentive mech-
anism that can meet the diverse requirements of users in
dynamic and distributed P2P environments.
• We introduce a secure validation method to keep the
to-be-verified content secret from the miners in the
Blockchian P2P system.
• We propose a pricing strategy to prevent selfish users
from exhibiting selfish actions and to defend the collu-
sion attacks resulted from them.
• We further employ a game theoretical analysis and sim-
ulation study to demonstrate the security and efficiency
of our incentive mechanism.
The remainder of the paper is structured as follows.
Section II outlines the related work. In Section III, we intro-
duce the Blockchain P2P system and the basic cryptographic
primitives employed in this paper. Our incentive scheme is
detailed in Section IV, followed by a comprehensive security
analysis and evaluation in Section V. The paper is concluded
in Section VI.
II. RELATED WORK
The incentive schemes for P2P applications fall into three cat-
egories: Reputation, Barter (Tit-for-Tat), and Credit (virtual
money).
A. REPUTATION-BASED APPROACHES
In a reputation system [6], [7], [15], [16], each user is given
a score that can be interpreted as the probability of an entity
behaving honestly. Such a system provides us with informa-
tion regarding the honesty of the peers, therefore can be uti-
lized to identify misbehaving users. For example, a watchdog
is used by a user in [16] to monitor the behavior of each
neighbor to make sure that the neighbor forwards others’
data. If misbehaviors are detected, the user broadcasts the
uncooperative reputation of the neighbor to other users in the
network. Burak et al. [15] combined centralized reputation-
based evaluation with collaborative reputation values based
on votes. Reputation systems generally suffer from the
VOLUME 6, 2018 27325
Y. He et al.: Blockchain Based Truthful Incentive Mechanism for Distributed P2P Applications
following drawbacks: i) no formal specification and analy-
sis of the types of the incentives is provided [10]; ii) the
possibility of selfish users colluding with each other to
maximize their welfare is generally ignored; and iii) the
reputation-based approaches are known to be vulnerable to
Sybil attacks [17] and whitewashing attacks [18].
B. TIT-FOR-TAT SCHEMES
Barter (Tit-for-Tat) based schemes [8], [9], [19] stimulate
mobile users to cooperate by exchanging equal services based
on what contributions they have done for others. In [8],
Buttyan et al. proposed the use of pair-wise Tit-for-Tat (TFT)
as an incentive mechanism for DTNs, in which each user
estimates the contribution levels of its neighbors based on
their behaviors in history, and then forwards as much traffic
to its neighbors in accordance with their contribution lev-
els. Parisa et al. [9] used the T-Chain incentive mechanism
to discourage free-riding in video streaming applications.
Tit-for-Tat schemes are restricted to applications with long
session durations that can provide many opportunities for
reciprocation between pairs of users [20]. Another challenge
of Tit-for-Tat is its hardness to meet the different service
requirements of the users.
C. CREDIT-BASED SCHEMES
In Credit based systems [10], [11], [21]–[24], a central
authority assigns certain virtual money to each user. When
a user needs others’ help (for example, to forward a mes-
sage), it should pay the helper certain amount of virtual
money. As the amounts of payments rely on the reports of
the users, a selfish user may attempt to cheat the system to
maximize its expected welfare. For example, a selfish node
may withhold its acknowledgement, or collude with other
nodes to forge acknowledgements, if such actions can maxi-
mize its welfare. Some effort has been made to counter such
cheating behaviors. Zhong et al. [10] proposed a cheat-proof,
credit-based system for stimulating cooperation among self-
ish nodes in mobile ad hoc networks. Felegyhazi et al. [25]
and Zhang et al. [11] developed game theory frameworks
based on the use of pricing strategies. These schemes assume
that a routing path between the sender and the receiver is
determined before data transmission occurs. Without know-
ing who will be the next hop and how many users will get
involved, it is hard to know who will get rewarded and how
many rewards shall be paid.
Other related credit-based schemes include [22] and [21].
Zhu et al. [22] proposed a layered incentive scheme for
dynamic routing in DTNs. In this scheme, the sender first
generates a base-layer message containing the payment pol-
icy. Then each of the intermediate nodes who agrees with
the payment policy generates a new layer based on the previ-
ous layer by appending a non-forged digital signature. After
receiving all the collected layered messages, the last inter-
mediate node sends them to a trusted center, i.e., a bank, for
validation and payment assignment according to the payment
policy. Obviously, this mechanism emphasizes the generation
and verification of the secure layered messages but does
not involve a detailed pricing strategy. Chen and Chan [21]
presented a pricing strategy running on top of a given DTN
routing module, which works by setting the sender’s payment
and the intermediate nodes’ rewards to ensure that selfish
actions do not result in larger rewards. Bogliolo et al. [26]
investigated the combined use of credit and reputation-based
schemes to establish ad-hoc connections. We notice that all
the credit based incentive schemes rely on central trusted
authorities that do not exist in P2P applications. Furthermore,
no explicit virtual digital currency system that is provably
secure was proposed by any credit based system. Never-
theless, lacking a secure currency system could result in a
collapsed incentive mechanism, just like the economy could
break down if the banking system is not secure or is out of
control.
Our incentive scheme is inspired by the existing research,
but is very different. It is based on the Bitcoin system whose
security is directly dependent on the majority of the comput-
ing power. We propose a secure validation approach carried
out by the miners in the Bitcoin system instead of a trusted
third authority, and a pricing strategy for the secure Bitcoin
system to defend against selfish actions and prevent collu-
sion attacks resulted from selfish users. Compared with the
existing ones, our scheme does not rely on a trusted third
authority but it can incentivize each node in P2P applications
to honestly follow the designed protocol.
III. PRELIMINARIES AND THE THREAT MODEL
A. BLOCKCHAIN P2P SYSTEM
Since Bitcoin [27] came out in 2008, its underlying technique,
blockchain has attracted lots of attentions from academia
and industry. Many versions of Blockchain were released as
open-source softwares [12], [27], [28]. Compared with other
payment systems, Blockchain is peer-to-peer, i.e. users can
transact directly without a trusted authority. Each transaction
in Blockchain involves a sender A and a recipient B who are
respectively identified by their public keys PKA and PKB, and
miners who verify the correctness of the transaction.
A typical transaction works for the money transfer
as follows: (1) A first creates a transaction Tx =
(Ty,PKB, v, SigSKA (Ty,PKB, v)) and broadcasts it to other
nodes in the network, where Ty is a previous transac-
tion, v is the amount of coins, SKA is A’s private key,
and SigSKA (Ty,PKB, v) is a signature on Tx signed by A;
(2) miners who maintain a chain of blocks verify if the money
from transaction Tx has not been spent by A and solve a hard
mining problem; (3) a miner that completes the validation
and the mining problem adds the transaction to a block and
broadcasts it to other nodes. Blockchain also supports a more
generalized transaction [29], [30], which considers the func-
tionality money transfer, i.e., a sender conditionally transfers
its money to a receiver. The workflow of the generalized
transaction is similar to the typical one, but the context of
the transaction is different. The context of a generalized
27326 VOLUME 6, 2018
Y. He et al.: Blockchain Based Truthful Incentive Mechanism for Distributed P2P Applications
FIGURE 1. A Bitcoin transaction.
transaction Tx = (Ty, πx , v, σ ) is shown in Fig. 1, where the
in-script σ refers to some information for validation provided
by the sender of the transaction, and the output-script πx with
a Boolean output refers to the recipient of the transaction.
A receiver redeeming Tx is valid only if πx evaluates to true.
Deposit protocols [31]–[33] have been implemented by
exploiting the Blockchain P2P system, in which each user
is required to initially put aside a certain amount of money,
which will be paid back to the user once he/she honestly
follows the protocol; otherwise the deposit is given to the
other parties and compensates them for the fact that the
protocol terminates prematurely. The design philosophy and
features of Blockchain make it an attractive way to address
the incentive challenges in peer-to-peer networks that lack
trusted third parties.
B. COMMUTATIVE ENCRYPTION
In this work, we employ commutative encryption as one of the
basic cryptographic primitives. A commutative encryption
function [34] is a family of bijections f : M × K → M such
that for a given m ∈ M we have
fa(fb(m)) = fb(fa(m))
for any a, b ∈ K . A commutative encryption enables
a plaintext to be encrypted more than once using differ-
ent users’ public keys (say a and b). One cannot decrypt
the ciphertext fb(fa(m)) without the help of the other user.
The order of the keys used in encryption and decryption
do not affect the computational result. Example commu-
tative cryptosystems include Pohligand Hellman [35] and
Massey and Omura [36].
C. THREAT MODEL AND ASSUMPTIONS
Fig. 2 illustrates a typical architecture of P2P applications.
The system consists of senders, intermediate nodes, and
receivers. Senders transmit certain files, messages, or the
sensed data to the receivers with the help of the intermediate
nodes. The numbers of senders and receivers are different in
different P2P applications. For example, there are 1 sender
and n receivers in mobile data offloading, while in the context
of DTN there are only 1 sender and 1 receiver. In this paper,
we consider a simple case with 1 sender and 1 receiver. Our
incentive scheme can be easily extended to the cases with
FIGURE 2. P2P application system.
1 sender and multiple receivers, and then the more complex
cases with multiple senders and receivers.
Data transmissions in P2P applications rely on the coop-
eration between intermediate nodes. To incentivize the coop-
erations, senders give certain rewards to the nodes that help
transmit the data. In this work, we assume that nodes are
selfish but would take a rational decision to maximize their
profit. Specially, each node may launch the following attacks:
• Refusing to Pay: A sender can refuse to pay back the
intermediate nodes when the data are successfully deliv-
ered to the receiver.
• Denying Attack: The intermediate nodes or the receiver
can deny that they have received the data from
other nodes, which could prevent others from getting
rewarded.
• Extending/Shortenning the Path: The intermediate node
can extend or shorten the path to get more reward from
the sender.
• Collusion Attack: Nodes can collude with each other
to maximize their profit. In this work, we only consider
the collusion among intermediate nodes or between an
intermediate node and the receiver. We shall address the
case where the sender colludes with the receiver in our
future work by considering reputation based inventive
systems.
IV. BLOCKCHAIN BASED TRUTHFUL
INCENTIVE MECHANISM
In our model, we employ the idea of credit based incentives
to motivate intermediate nodes to cooperate. In a credit based
scheme, incentive can be considered as a transaction. When
discussing a transaction, we should figure out the following
questions: (1) who pays who; (2) how to pay the bill; (2) how
much the payer should pay; and (4) how to guarantee that the
transaction is secure.
A. WHO PAYS WHO?
When a sender wants to transmit a certain message to a
receiver, there exist three different options to pay back the
intermediate nodes. The first option is to let the receiver
VOLUME 6, 2018 27327
Y. He et al.: Blockchain Based Truthful Incentive Mechanism for Distributed P2P Applications
give rewards to all the intermediate nodes; but this approach
allows malicious nodes to get high rewards by sending many
fake messages. The second option is to give the rewards by
both the sender and the receiver, which could suffer the same
problem as the first option since the sender can collude with
the intermediate nodes. The third option is for the sender to
pay back the intermediate nodes when it figures out that the
message is successfully delivered to the receiver, which is
adopted by this work.
Another relevant question we need to answer is who should
get the rewards. In this study, we choose to award only those
nodes that contribute to a successful delivery, which means
that an intermediate node cannot get a reward if the receiver
does not receive the message correctly. To identify the inter-
mediate nodes who help forward the message, the node in the
next hop is required to send a signed acknowledgement back.
Because a node is considered cooperative if and only if the
node has a signed acknowledgement from its successor, it is
important for an intermediate node to stimulate its successor
by paying certain money to its successor for sending the
signed acknowledgement.
B. HOW TO PAY THE BILL?
As mentioned before, intermediate nodes should be moti-
vated to cooperate in a dynamic and distributed environment.
In particular, a sender knows the receiver, but it does not
know the route to the receiver. The sender should give rewards
to the intermediate nodes who help transmit the message.
Cooperative nodes can be divided into two types: negative
cooperative nodeswho help transmit the data but the receiver
fails to receive the data, and positive cooperative nodes who
help transmit the data and the receiver does successfully
receive the data. In our consideration, the sender only pays
back the positive cooperative nodes.
In our model, the sender employs the Blockchain P2P
system to pay back the positive cooperative nodes. The work-
flow of the payment consists of three steps. In the first step,
the sender publicizes a transmission task and makes a cer-
tain deposit that is used to pay back the positive coopera-
tive nodes. In the second step, the sender transmits data to
the receiver by opportunistic connections. In the last step,
the positive cooperative nodes get their payments. For sim-
plicity, we first discuss the case with only one positive coop-
erative node; then extend our scheme to the multiple positive
cooperative node case.
1) ONE POSITIVE COOPERATIVE NODE
Suppose that a sender A sends a message m to a receiver
E . There is only one relay node B between the sender A
and the receiver E . Let (PKi, SKi) be the public/private key
pair of node i, H () be a hash function, E() be an encryption
function, and Sig() be a signature function. The workflow of
the payment is elaborated as follows.
• Publishing a Transmission Task:When Awants to trans-
mit data to E , it first generates two random numbers
FIGURE 3. A makes a deposit.
FIGURE 4. A transmits data to E .
R1 and R2, where R1 is used to prove that the node
in the next hop receives the data correctly, and R2 is
used to prove that the receiver gets the data successfully.
A keeps R1 and R2 secret, and publishes h1 = EPKA (R1),
h2 = H (R2). Then A makes a deposit to commit that it
will give rewards toB ifB successfully transmits the data
to the receiver E . A constructs a transaction DepositA as
shown in Fig. 3.
• Data Transmission: As illustrated in Fig. 4, A first
sends the message m||EPKE (R2)||σ ||SigSKA (R1) to node
B, where σ is a signature on H (m)||EPKE (R2). At the
same time, A constructs a transaction PaymentA→B and
broadcasts it to other nodes in the Blockchain P2P
network for validation. Then, B sends the message
m||EPKE (R2)||σ to the receiver E , constructs a transac-
tion PaymentB→E and broadcasts it to the Blockchain
P2P network. Finally, E receives the message, verifies
the signature σ , and sends B a signed acknowledgement
EPKE (SigSKE (ACKE )), which is encrypted by B’s public
key PKB. Note that the transactions PaymentA→B and
PaymentB→E represent a commitment that coins will
be transferred only after the miners have verified them.
The transactions in the data transmission are illustrated
in Fig. 5.
• Obtaining the Payments: To redeem the rewards, B
and E provide miners with {EPKB (ACKE ),EPKB (R1)}
and {R2,EPKE (ACKE )}, respectively. Then, the miners
validate the transactions. B and E can get the rewards if
and only if the following conditions are satisfied: (a)
1) E can provide the random number R2, which is
verified by
H (R2) = h2;
27328 VOLUME 6, 2018
Y. He et al.: Blockchain Based Truthful Incentive Mechanism for Distributed P2P Applications
FIGURE 5. Transactions in message transmission.
FIGURE 6. A publishes a task and makes a deposit.
2) B can provide the random number R1, which is
verified by
EPKB (h1) = EPKA (EPKB (R1));
3) B can provide the correct signed acknowledge-
ment, which is verified by
EPKB (EPKE (ACKE )) = EPKE (EPKB (ACKE )).
2) MULTIPLE POSITIVE COOPERATIVE NODES
In this section, we extend our scheme to a more complex case
where there are multiple positive cooperative nodes. Suppose
that a sender A sends a messagem to a receiver E , and B,C,D
are the positive cooperative nodes who help A transmit the
data to E . The workflow of the payment is elaborated as
follows.
• Publishing a Transmission Task: A announces a task
A → E : m and generates two random numbers R1
and R2 that should be kept secret. Then A makes a
deposit to commit that it will give the rewards to the
positive cooperative nodes if the message is successfully
delivered to the receiver E ; otherwise A would get the
deposit back. The transcript of the transaction is shown
in Fig. 6.
• Data Transmission:The process of the data transmission
from A to E is illustrated in Fig. 7. A first sends the mes-
sage m||EPKE (R2)||σ ||SigSKA (R1) to B, and constructs
a transaction PaymentA→B. Then, B, C , and D help A
transmit the message m||EPKE (R2)||σ to the receiver E ,
and construct transactions PaymentB→C , PaymentC→D,
and PaymentD→E , respectively. C , D, and E send the
signed encrypted acknowledgement back to B,C , andD,
respectively. Note that the transactions PaymentA→B,
PaymentB→C , PaymentC→D, and PaymentD→E repre-
sent a commitment that coins will be transferred only
after the miners have verified them. The Blockchain
transactions in the data transmission are illustrated
in Fig. 8.
• Obtaining the Payments: After the data is successfully
delivered to the receiver, all the positive coop-
erative nodes should get the rewards by provid-
ing the miners with the proofs that they did help
transmit the data. To be more specific, B pro-
vides {EPKB (R1),EPKB (ACKC ),PKA,PKC }; C pro-
vides {EPKC (ACKC ),EPKC (ACKD),PKD}; D provides
{EPKD (ACKD),EPKD (ACKE ),PKE }; and E provides
{R2,EPKE (ACKE )}. The transactions are considered to
be valid if and only if the following conditions are
satisfied: (a)
1) E can provide the random number R2, which is
verified by
H (R2) = h2;
2) There is a route from A to E , and the route can be
determined by the transaction chain from A to E ,
as shown in Fig. 9.
3) B can provide the random number R1, which can
be verified by
EPKB (h1) = EPKA (EPKB (R1));
4) B,C,D can provide the correct signed acknowl-
edgements, which are verified by
EPKB (EPKC (ACKC )) = EPKC (EPKB (ACKC )),
EPKC (EPKD (ACKD)) = EPKD (EPKC (ACKD)),
EPKD (EPKE (ACKE )) = EPKE (EPKD (ACKE )).
C. HOW MUCH SHOULD THE PAYERS PAY?
A sender should determine the payment to the positive coop-
erative nodes for their help to transmit its data, and each pos-
itive cooperative node needs to determine the payment to its
successor for sending the signed acknowledgement. Instead
of considering the two components separately, we consider
the final payment to the positive cooperative nodes and the
receiver.Without loss of generality, we assume that A sendsm
to E via P = (P1,P2, . . . ,Pn), the list of positive cooperative
nodes who help the transmission. Then, the final payment to
node i is computed by
pi =
α/2
n−1, if i ∈ P,
β, if i = E,
0, otherwise.
Note that in our implementation, A first makes a deposit;
after determining the number of positive cooperative nodes,
A determines the actual amount of coins given to them, and
the residual deposit will return to A. For example, in the
VOLUME 6, 2018 27329
Y. He et al.: Blockchain Based Truthful Incentive Mechanism for Distributed P2P Applications
FIGURE 7. A transmits the data to E .
FIGURE 8. Transactions in a multihop message transmission.
FIGURE 9. The transaction chain from A to E .
case of multiple positive cooperative nodes shown in Fig. 6,
A first makes a deposit of α+β coins. After all the posi-
tive cooperative nodes have been identified (Fig. 8), A sets
α′=α/23−1 = α/4.
D. IS IT SECURE?
1) CHEATING BEHAVIORS OF THE PARTICIPANTS
Since selfish mobile nodes always try to maximize their
utilities, they may cheat. For example, they can act as a miner
to get more information from the Blockchain transactions
and then launch sophisticated attacks. In particular, a receiver
may have one of the three selfish actions: i) it does not send
back a signed acknowledgement to its previous node or just
simply sends the acknowledge to others; ii) it does not provide
the validation information or provides a bogus validation
information; and iii.a) it does not receive the data but falsely
claims that it has received the data.An intermediate node can
have another cheating behavior except the first two selfish
FIGURE 10. An intermediate node colludes with its neighbors.
actions mentioned above: iii.b) it does not help with trans-
mitting the data but falsely claims that it has transmitted the
data.
Note that any of the selfish actions mentioned above can be
further complicated by the collusion of two or more nodes.
We assume that collusion only occurs between neighbors.
This is a reasonable assumption in opportunistic transmis-
sions because a node hardly gets in contact with a non-
neighbor node. Moreover, we can add a lock-time into each
payment transaction, which makes it more difficult for a
node to contact its non-neighbors. We consider two kinds of
collusion attacks:
• A receiver colludes with its neighbors. The receiver and
its neighbors can forge a bogus path from the sender to
the receiver. For example, suppose that the true path is
A → B → C → D → E . After receiving the data
from D, E does not send the signed acknowledgement
to D, or it does not provide the validation information.
Instead, E chooses some nodes from its neighbors to
create a bogus path, i.e., A→ E1→ E2→ E3→ E .
• An intermediate node colludes with its neighbors.
The intermediate node collude with its neighbors to
extend or shorten the path. As shown in Fig. 10, B can
choose some nodes from its neighbors to create a bogus
path A→ B→ B1→ B2→ B3→ C → D→ E , or B
colludes with C to shorten the path to obtain a new path
A→ B→ D→ E .
27330 VOLUME 6, 2018
Y. He et al.: Blockchain Based Truthful Incentive Mechanism for Distributed P2P Applications
2) DATA-TRANSMISSION GAME.
To study the security of our incentive mechanism, we employ
a static game to analyze the cooperative behaviors of the
intermediate nodes. Through the Nash equilibrium results of
the game, we can obtain the best strategies of the players
under different pricing strategies. By setting a suitable pric-
ing strategy, we can guarantee the security of our incentive
mechanism against the selfish behaviors of the users and the
collusion attacks. The model of the data-transmission game
is described as follows.
a: Players
This game has n + 1 players, the positive cooperative nodes
P = (P1,P2, . . . ,Pn) and the receiver E .
b: Strategies
Each player i has two possible actions: play honestly or play
selfishly. If player i plays honestly, it follows the proto-
col; otherwise, it plays selfishly, either behaves selfishly
itself or colludes with its neighbors. We denote the strategy
of node i by si. Then si is either Honest or Selfish.
c: Utilities
Player i can get its utility by deducting its cost from its
received payment. Without colluding with its neighbors,
the utility of ui is computed by
ui =

α/2n−1 − ci, i ∈ P and si = Honest,
β − cE , i = E and si = Honest,
0, i ∈ P and si = Selfish,
0, i = E and si = Selfish.
where ci is the cost of i for transmitting the data, sending a
signed acknowledgement, and providing the validation infor-
mation, cE is the cost of the receiver E for sending a signed
acknowledgement and providing the validation information.
When player i colludes with others, it is more complicated
because the utility should consider the success probability of
the collusion attack. We discuss the details in Section V. Here
we present some definitions for the security analysis of our
incentive scheme.
Definition 1: The best response strategy for a player is a
strategy that brings the maximum expected utility to itself,
regardless of the strategies of all other players.
To meet the security requirement, we need to design an
incentive mechanism to discourage playing selfishly. In other
words, we should make sure that si = Honest is the best
response strategy for each player in the game. We detail
the following two cases: without and with collusion. More
definitions about collusion resistance are given as follows.
Definition 2: An incentivemechanism is receiver-collusion-
resistant if the receiver and any group of its colluding
neighbors cannot increase the expected sum of their utilities
by using any strategy profile other than the one in which
everybody plays honestly.
Definition 3: An incentive mechanism is intermediate-
node-collusion-resistant, if any group of colluding
intermediate nodes cannot increase the expected sum of their
utilities by using any strategy profile other than the one in
which everybody plays honestly.
Definition 4: An incentive mechanism is secure if si =
Honest is the best response strategy for each player and the
game is receiver-collusion-resistant and intermediate-node-
collusion-resistant.
V. SECURITY ANALYSIS AND UTILITY EVALUATION
A. SECURITY ANALYSIS WITHOUT COLLUSION ATTACKS
Theorem 1: In the data-transmission game, si = Honest
is the best response strategy for every player i if α > 2n−1ci
and β > cE .
Proof: When player i plays honestly, we have
ui =
{
α/2n−1 − ci, i ∈ P,
β − cE , i = E .
E does not respond honestly (or an intermediate node Pi
does not play honestly):
• E (or Pi) does not send the acknowledgement to its
previous node Pn (Pi−1) or simply sends it to another
node. If E (Pi) does not send EPKn (SigSKE (ACKE ))
(EPKi−1 (SigSKi (ACKi))) to Pn (Pi−1), Pn (Pi−1) will not
provide the validation information; thus E (Pi) can not
get the payment from the transaction PaymentPn→E
(PaymentPi−1→Pi ). If E (Pi) sends the acknowledge-
ment to another node, the node can not provide
the validation information of Pn (Pi−1) because Pn
(Pi−1) keeps its acknowledgement secret by encryption,
i.e., EPKn (ACKn) (EPKi−1 (ACKi−1)). Thus, E (Pi) can
not get the payment.
• E (or Pi) does not provide validation information or pro-
vides a bogus validation information. If E (Pi) does
not provide the validation information, E (Pi) can not
get the payment from PaymentPn→E (PaymentPi−1→Pi ).
If E (Pi) provides a bogus validation information,
the transactions PaymentA→P1 (PaymentPi−2→Pi−1 ) and
PaymentPn−1→Pn (PaymentPi−1→Pi ) can not be verified.
Thus, E (Pi) can not get the payment.
• E (or Pi) does not receive the data but falsely claims
that it has received the data. If E (Pi) does not receive
the data, E can not provide R1, then the transaction
PaymentA→P1 can not be verified. Thus E (Pi) can not
get the payment. In addition, if the data is important to
E , cheating will damage its benefit.
As α > 2n−1ci, we have u′E = 0 < β − cE = uE and
u′i = 0 < α/2n−1 − ci = ui. Therefore, E’s (Pi’s) utility is
reduced by playing selfishly. Therefore, if α > 2n−1ci and
β > cE , si = Honest is the best response strategy for the
payer i. �
B. SECURITY ANALYSIS WITH COLLUSION ATTACKS
Wefirst consider the case whenE colludes with its neighbors;
then we analyze the case when an intermediate node colludes
with its neighbors.
VOLUME 6, 2018 27331
Y. He et al.: Blockchain Based Truthful Incentive Mechanism for Distributed P2P Applications
Theorem 2: Our incentivemechanism is receiver-collusion-
resistant if α < β/q2, where q is the probability that two
arbitrary nodes encounter each other.
Proof: We first consider the case with one conspired
node; then we extend to the case of multiple conspired nodes.
Case 1: Suppose G = {E,E1} is a collusion group.
G forges a bogus path with one positive cooperative node,
i.e., A→ E1→ E . Let E(uG) denote the expected sum of the
utility of G. Our goal is to show that
E(uG) ≤ uE .
If E1 gets R1, E and E1 can get the payment from A,
which means that E1 has encountered both E and A (with a
probability of q2). The expected sum of the payment of G
is pG = q2(α + β) + (1 − q2)β = q2α + β. Considering
the cost of E1 to provide the validation information and to
communicate with E , we have the expected sum of the utility
of G to be uG = q2α + β − β − cE = q2α − cE . Thus we
obtain uG = q2α − cE < β − cE = uE .
Case 2: SupposeG = {E,E1, . . . ,En} is a collusion group.
G forges a bogus path with multiple positive cooperative
nodes, i.e., A → E1 → · · · → En → E . Let E(uG) denote
the expected sum of the utility of G. Our goal is to show that
E(uG) ≤ uE .
When (A,E1), (E1,E2), . . . , (En,E) encounter each other,
G gets the payment. The expected sum of the payment of G
is
pG = qn+1(nα/2n−1 + β)+ (1− qn+1)β
= qn+1nα/2n−1 + β.
Deducting the cost of G, we have the expected sum of the
utility of G:
uG = qn+1nα/2n−1 + β − nβ − cE .
As α < β/q2, we have
uG = qn+1nα/2n−1 + β − nβ − cE
<
qn+1nβ
2n−1q2
− nβ + β − cE
= (qn−1/2n−1 − 1)nβ + β − cE
< β − cE = uE .
Therefore, if α < β/q2, our incentive mechanism is
receiver-collusion-resistant. �
Theorem 3: Our incentive mechanism is intermediate-
node-collusion-resistant.
Proof: An intermediate node can collude with its neigh-
bors to extend or shorten the path.
Case 1: An intermediate node colludes with its neighbors
to extend the path. We first Consider the case with one posi-
tive cooperative node A→ B→ E . LetG = {B,B1, . . . ,Bn}
be the collusion group. G extends the path to A → B →
B1 → · · · → Bn → E . Let E(uG) denote the expected sum
of utility of G. Our goal is to show that
E(uG) ≤ uB,
where uB is the utility of B to play honestly. As B indeed
helpedA transmit data toE , it can get all the needed validation
information from A and E , which means that B can always
launch a successful collusion attack. According to our pricing
scheme, we have
E(uG) = (n+ 1)α/2n − cB;
uB = α − cB.
Let f (x) = (x+1)/2x , x ≥ 1. We have f ′(x) = 2−x(1− (1+
x)x) < 0. Thus, f (x) is a monotonically decreasing function.
Accordingly we have f (n) < f (n−1) < . . . < f (1). It is easy
to see that
E(uG) = (n+ 1)α/2n − cB < α − cB = uB.
Now we consider the case with multiple positive cooperative
nodes. Let uB = α′ − cB. We can deduce that
E(uG) = (n+ 1)α′/2n − cB < α′ − cB = uB.
Case 2 An intermediate node colludes with its neighbors
to shorten the path A→ P1 → · · · → Pi → Pi+1 → · · · →
Pn → E . Let G = {Pi,Pi+1} be a collusion group. Then G
shortens the path to A→ P1→ · · · → Pi→ Pi+2→ · · · →
Pn→ E . Let E(uG) denote the expected sum of the utility of
G. Our goal is to show that
E(uG) ≤ uPi + uPi+1 ,
where uPi and uPi+1 are respectively the utilities ofPi andPi+1
to play honestly. As Pi and Pi+1 indeed helped transmit the
data, they can get all the needed validation information. Thus
they can launch a successful collusion attack. According to
our pricing scheme, we have
E(uG) = α/2n−2 − cPi − cPi+1;
uPi = α/2
n−1
− cPi;
uPi+1 = α/2
n−1
− cPi+1 .
It is easy to see that
E(uG) = uPi + uPi+1 .
Therefore, our incentive mechanism is intermediate-node-
collusion-resistant. �
The three theorems together prove the following theorem.
Theorem 4: Our incentive mechanism is secure if α >
2n−1cmax, β > cE , and α < β/q2.
C. EVALUATION
1) OVERHEAD
We employ a laptop computer with an Intel Core i7-2640M
Processor (4MB Cache, up to 2.8GHz) to implement a pro-
totype of our system using the Crypto++5.62 library and
consider a path of 5 hops, to evaluate the overhead of our
incentive mechanism. The OS of the laptop is Windows
10 Pro 64. The length of a message payload is 1024 bytes,
and the message digest function is MD-5. We consider three
commutative encryption schemes: ElGamal with a modulus
27332 VOLUME 6, 2018
Y. He et al.: Blockchain Based Truthful Incentive Mechanism for Distributed P2P Applications
TABLE 1. The CPU processing time.
of 1024 bits, RSAwith a modulus of 1024 bits, and RSAwith
a modulus of 3072 bits.
We first evaluate the CPU processing time. In our incentive
system, the major processing overhead is the R2 encryption
operation, the message and R1 signing operations, and the
transaction generating operation by the sender, the ACK sign-
ing and encryption operation (or the R1 decryption operation)
and the transaction generating operation by each intermediate
node, the message verification operation, the R2 decryption
operation, and the ACK signing and encryption operation by
the receiver, and the verification operation by the miners. The
columns of Table 1 report the CPU processing time of the
sender, an intermediate node (average), the receiver, and a
miner. We observe that RSA has a much smaller overhead.
Therefore if reducing overhead is the major objective, RSA
is a better implementation choice. Compared with the scheme
proposed by Zhu et al. [22], the CPU processing time of the
sender in our approach is slightly larger, the average CPU
processing time of the intermediate node is slightly smaller,
and the CPU processing time of the receiver is smaller.
We next evaluate the bandwidth and storage requirements.
Compared with the opportunistic routing protocols intro-
duced in [37] and [38] but without any incentive mecha-
nism, the major increased message overhead includes the
encrypted R2, the signed R1, and the signed and encrypted
ACK. For ElGamal and RSA with a modulus of 1024 bits,
the encrypted R2 takes about 128 bytes, the signed R1 takes
about 128 bytes, the signed and encrypted ACK takes about
128 bytes; for RSA 3074 bits, the encrypted R2 takes about
384 bytes, the signed R1 takes about 384 bytes, and the
signed and encryptedACK takes about 384 bytes. The storage
requirement for the Blockchain transactions is analyzed as
follows. For RSA 1024 and ElGamal 1024, each transaction
requires at least 1 byte for the previous transaction reference,
128 bytes for the in-script, 1 byte for the Bitcoin value, and
128 bytes for out-script; adding up together we get 258 bytes
for aminimum-sizedBitcoin transaction. For RSA3074, each
transaction requires 384 bytes for the in-script and 384 byes
for the out-script, resulting in a 770-byte minimum-sized
Bicoin transaction. Note that the process of miners verify-
ing the transactions does not affect the cost of the routing
protocols, and the throughput of processing the transaction
is determined by Blockchain consensus algorithm [12].
2) UTILITY EVALUATION
In this section we evaluate the utilities of the players under
different strategies. We set α = 16× 10−3 coins, β = 0.5×
10−3 coins, cE = 0.1×10−3 coins, and cPi = 1×10−3 coins.
FIGURE 11. Utility of a positive cooperative node.
FIGURE 12. Utility of the receiver.
The number of positive cooperative nodes is varied from
1 to 10 with a step size of 1, and the encounter probability
is increased from 0 to 0.5 with a step size of 0.05.
a: Utility of a positive cooperative node
Fig. 12 shows the impact of the number of positive coop-
erative nodes and the playing strategies on the utility of a
positive cooperative node. We observe that the node’s utility
indeed demonstrates diminishing returns when the number of
positive cooperative nodes increases. Extending the length of
the path (k = 3, k = 5) leads to the drop of Pi’s utility. When
α > 2n−1cPi , i.e., n < 5, playing honestly is the best response
strategy for Pi because the utility by playing honestly is larger
than that by playing selfishly. When n >= 5, the Pi’s utility
is below zero, which is hard to happen as rational participants
want to gain benefits.
b: Utility of the receiver
Fig. 12 shows the impact of the encounter probability and
the playing strategies on the utility of E . We observe that
the success rate of collusions is higher when the encounter
probability is higher. The utility obtained when E colluding
with k = 1 intermediate node is larger than that with multiply
intermediate nodes, i.e., k = 3. When α < β/q2, i.e., q <
0.177, the utility by playing honestly is larger than that by
playing selfishly, which is in accordance with our theoretical
analysis results.
VI. CONCLUSION AND FUTURE RESEARCH
In this paper, we propose a Blockchain based incentive mech-
anism that can meet the diverse requirements in a dynamic
and distributed P2P environment. In our incentive mech-
anism, intermediate nodes who contribute to a successful
delivery can obtain rewards from Blockchain transactions.
The transactions are verified by the miners in a secure way
VOLUME 6, 2018 27333
Y. He et al.: Blockchain Based Truthful Incentive Mechanism for Distributed P2P Applications
by using commutative encryptions. A pricing strategy is pro-
posed to guarantee the security of our incentive mechanism.
We also employ a static game model to demonstrate the
security strength of our incentive mechanism.
In our future research, wewill consider the issue of a sender
colluding with its receiver. One possible solution is to intro-
duce reputation into our incentive scheme. In this reputation
based incentive scheme, the collusion group of the sender and
the receiver will be put into a blacklist by the accusation of the
intermediate nodes. We also will consider the contradiction
of incentive and privacy in our scheme. We will bring certain
cryptographic extensions such as zero-knowledge proof and
blind signature to Blockchain for achieving fully anonymous
currency transactions.
REFERENCES
[1] K. Lee, J. Lee, Y. Yi, I. Rhee, and S. Chong, ‘‘Mobile data offloading:
How much can WiFi deliver?’’ IEEE/ACM Trans. Netw., vol. 21, no. 2,
pp. 536–550, Apr. 2013.
[2] C. E. Baker, A. Starke, T. G. Hill-Jarrett, and J. McNair, ‘‘In vivo eval-
uation of the secure opportunistic schemes middleware using a delay
tolerant social network,’’ in Proc. IEEE 37th Int. Conf. Distrib. Comput.
Syst. (ICDCS), Jun. 2017, pp. 2537–2542.
[3] W. Sherchan, P. P. Jayaraman, S. Krishnaswamy, A. Zaslavsky, S. Loke,
and A. Sinha, ‘‘Using on-the-move mining for mobile crowdsensing,’’
in Proc. IEEE 13th Int. Conf. Mobile Data Manage. (MDM), Jul. 2012,
pp. 115–124.
[4] F. L. Haddi and M. Benchaa, ‘‘A survey of incentive mechanisms in static
and mobile P2P systems,’’ J. Netw. Comput. Appl., vol. 58, pp. 108–118,
Dec. 2015.
[5] Y. He, M. Chen, B. Ge, and M. Guizani, ‘‘On WiFi offloading in het-
erogeneous networks: Various incentives and trade-off strategies,’’ IEEE
Commun. Surveys Tuts., vol. 18, no. 4, pp. 2345–2385, 4th Quart., 2016.
[6] H. Mousa, S. B. Mokhtar, O. Hasan, O. Younes, M. Hadhoud, and
L. Brunie, ‘‘Trust management and reputation systems in mobile partici-
patory sensing applications: A survey,’’ Comput. Netw., vol. 90, pp. 49–73,
Oct. 2015.
[7] M. Pouryazdan, B. Kantarci, T. Soyata, L. Foschini, and H. Song, ‘‘Quan-
tifying user reputation scores, data trustworthiness, and user incentives in
mobile crowd-sensing,’’ IEEE Access, vol. 5, pp. 1382–1397, 2017.
[8] L. Buttyán, L. Dóra, and M. Félegyházi, and I. Vajda, ‘‘Barter-based coop-
eration in delay-tolerant personal wireless networks,’’ in Proc. IEEE Int.
Symp. World Wireless, Mobile Multimedia Netw. (WoWMoM), Jan. 2007,
pp. 1–6.
[9] P. Rahimzadeh, C. Joe-Wong, K. Shin, Y. Im, J. Lee and S. Ha,
‘‘SVC-TChain: Incentivizing good behavior in layered P2P video stream-
ing,’’ in Proc. IEEE Conf. Comput. Commun. (INFOCOM), May 2017,
pp. 1–9.
[10] S. Zhong, J. Chen, and Y. R. Yang, ‘‘Sprite: A simple, cheat-proof, credit-
based system for mobile ad-hoc networks,’’ in Proc. IEEE INFOCOM,
Mar. 2003, pp. 1987–1997.
[11] H. Zhang, B. Liu, H. Susanto, G. Xue, and T. Sun, ‘‘Incentive mechanism
for proximity-based mobile crowd service systems,’’ in Proc. IEEE INFO-
COM, Apr. 2016, pp. 1–9.
[12] X. Li, P. Jiang, T. Chen, X. Luo, and Q. Wen, ‘‘A survey on the security
of blockchain systems,’’ Future Generat. Comput. Syst., Aug. 2017.
[Online]. Available: http://www.sciencedirect.com/science/article/pii/
S0167739X17318332, doi: https://doi.org/10.1016/j.future.2017.08.020.
[13] R. Khalil and A. Gervais, ‘‘Revive: Rebalancing off-blockchain payment
networks,’’ in Proc. CCS, 2017, pp. 439–453.
[14] S. Matsumoto and R. M. Reischuk, ‘‘IKP: Turning a PKI around with
decentralized automated incentives,’’ in Proc. IEEE Symp. Secur. Pri-
vacy (SP), May 2017, pp. 410–426.
[15] B. Kantarci, P. M. Glasser, and L. Foschini, ‘‘Crowdsensing with social
network-aided collaborative trust scores,’’ in Proc. IEEE Global Commun.
Conf. (GLOBECOM), Dec. 2015, pp. 1–6.
[16] Q. He, D. Wu, and P. Khosla, ‘‘SORI: A secure and objective reputation-
based incentive scheme for ad-hoc networks,’’ in Proc. IEEE WCNC,
Mar. 2004, pp. 825–830.
[17] B. N. Levine, C. Shields, and N. B. Margolin, ‘‘A survey of solutions
to the sybil attack,’’ Univ. Massachusetts Amherst, Amherst, MA, USA,
Tech. Rep. 224, 2006.
[18] M. Feldman, C. Papadimitriou, J. Chuang, and I. Stoica, ‘‘Free-riding
and whitewashing in peer-to-peer systems,’’ IEEE J. Sel. Areas Commun.,
vol. 24, no. 5, pp. 1010–1019, May 2006.
[19] Y. Lee, S. Kang, C. Min, Y. Ju, I. Hwang, and J. Song, ‘‘CoMon+:
A cooperative context monitoring system for multi-device personal
sensing environments,’’ IEEE Trans. Mobile Comput., vol. 15, no. 8,
pp. 1908–1924, Aug. 2016.
[20] T. Ning, Z. Yang, X. Xie, and H. Wu, ‘‘Incentive-aware data dissemination
in delay-tolerant mobile networks,’’ in Proc. 8th Annu. IEEE Commun.
Soc. Conf. Sensor, Mesh Ad Hoc Commun. Netw. (SECON), Jun. 2011,
pp. 539–547.
[21] B. B. Chen and M. C. Chan, ‘‘MobiCent: A credit-based incentive system
for disruption tolerant network,’’ in Proc. IEEE INFOCOM, Mar. 2010,
pp. 1–9.
[22] H. Zhu, X. Lin, R. Lu, and X. S. Shen, ‘‘A secure incentive scheme for
delay tolerant networks,’’ in Proc. 3rd Int. Conf. Commun. Netw. China
(ChinaCom), Jul. 2008, pp. 23–28.
[23] W. Li, X. Cheng, R. Bie, and F. Zhao, ‘‘An extensible and flexible truthful
auction framework for heterogeneous spectrum markets,’’ IEEE Trans.
Cogn. Commun. Netw., vol. 2, no. 4, pp. 427–441, Dec. 2016.
[24] Y. Wang, Z. Cai, G. Yin, and Y. Gao, ‘‘An incentive mechanism with
privacy protection in mobile crowdsourcing systems,’’ Comput. Netw.,
vol. 102, pp. 157–171, Jun. 2016.
[25] M. Felegyhazi, J.-P. Hubaux, and L. Buttyan, ‘‘Nash equilibria of packet
forwarding strategies in wireless ad hoc networks,’’ IEEE Trans. Mobile
Comput., vol. 5, no. 5, pp. 463–476, May 2006.
[26] A. Bogliolo et al., ‘‘Virtual currency and reputation-based cooperation
incentives in user-centric networks,’’ in Proc. 8th Int. Wireless Commun.
Mobile Comput. Conf. (IWCMC), Aug. 2012, pp. 895–900.
[27] S. Nakamoto, ‘‘Bitcoin: A peer-to-peer electronic cash system,’’ Con-
sulted, vol. 1, no. 2012, pp. 1–28, 2008.
[28] T. Ruffing, p. Moreno-Sanchez, and A. Kate, ‘‘P2P mixing and unlinkable
bitcoin transactions,’’ in Proc. NDSS, 2017, pp. 1–15.
[29] L. Luu, J. Teutsch, R. Kulkarni, and P. Saxena, ‘‘Demystifying incentives
in the consensus computer,’’ in Proc. CCS, 2015, pp. 706–719.
[30] R. Kumaresan, T. Moran, and I. Bentov, ‘‘How to use bitcoin to play
decentralized poker,’’ in Proc. CCS, 2015, pp. 195–206.
[31] M. Andrychowicz, S. Dziembowski, D. Malinowski, and L. Mazurek,
‘‘Secure multiparty computations on bitcoin,’’ in Proc. IEEE Symp. Secur.
Privacy (SP), Mat 2014, pp. 443–458.
[32] M. Andrychowicz, S. Dziembowski, D. Malinowski, and Ł. Mazurek,
‘‘Fair two-party computations via bitcoin deposits,’’ in Financial Cryptog-
raphy and Data Security. Berlin, Germany: Springer, 2014, pp. 105–121.
[33] I. Bentov and R. Kumaresan, ‘‘How to use bitcoin to design fair protocols,’’
in Advances in Cryptology Ű CRYPTO 2014. Berlin, Germany: Springer,
2014, pp. 421–439.
[34] S. Lian, Z. Liu, Z. Ren, and H. Wang, ‘‘Commutative encryption and
watermarking in video compression,’’ IEEE Trans. Circuits Syst. Video
Technol., vol. 17, no. 6, pp. 774–778, Jun. 2007.
[35] S. Pohlig and M. Hellman, ‘‘An improved algorithm for computing log-
arithms overGF(p) and its cryptographic significance (corresp.),’’ IEEE
Trans. Inf. Theory, vol. 24, no. 1, pp. 106–110, Jan. 1978.
[36] J. Massey and J. Omura, ‘‘A new multiplicative algorithm over finite fields
and its applicability in public key cryptography,’’ in Proc. EUROCRYPT,
1983. [Online]. Available: https://doi.org/10.1007/3-540-49677-7_4
[37] A. Boukerche and A. Darehshoorzadeh, ‘‘Opportunistic routing in wireless
networks: Models, algorithms, and classifications,’’ ACM Comput. Surv.,
vol. 47, no. 2, 2015, Art. no. 22.
[38] S. Batabyal and P. Bhaumik, ‘‘Mobility models, traces and impact of
mobility on opportunistic routing algorithms: A survey,’’ IEEE Commun.
Surveys Tuts., vol. 17, no. 3, pp. 1679–1707, 3rd Quart., 2015.
YUNHUA HE (M’16) received the Ph.D. degree in
computer science from Xidian University, Xi’an,
China, in 2016. He has authored eight research
articles in refereed international conferences and
premier journals. His research interests include
security and privacy in cyber-physical systems,
Bitcoin based incentive mechanism, and security
and privacy in vehicle ad hoc networks. He was a
recipient of the Best Paper Award from the confer-
ence CWSN 2013.
27334 VOLUME 6, 2018
Y. He et al.: Blockchain Based Truthful Incentive Mechanism for Distributed P2P Applications
HONG LI (S’16) received the B.A. degree from
Xi’an Jiaotong University and the Ph.D. degree
from the University of the Chinese Academy of
Sciences. He has published 10 papers in refereed
international conferences and premier journals.
His primary research interests include security and
privacy in Internet of Things, and security and
privacy in mobile social networks.
XIUZHEN CHENG received the M.S. and
Ph.D. degrees in computer science from the Uni-
versity of Minnesota–Twin Cities, in 2000 and
2002, respectively. She is currently a Professor
with the Department of Computer Science, The
George Washington University, Washington, DC,
USA. Her current research interests include cyber
physical systems, wireless and mobile computing,
sensor networking, wireless and mobile security,
and algorithm design and analysis. She was a
Program Director for the U.S. National Science Foundation for six months
in 2006 and joined the NSF again as a part-time program director in 2008.
She was a recipient of the NSF CAREER Award in 2004.
YAN LIU (M’10) received the B.S., M.S., and
Ph.D. degrees from the College of Comput-
ers, National University of Defense Technology,
in 1992, 1995, and 1998, respectively. She is cur-
rently an Associate Professor with the School of
Software and Microelectronics, Peking Univer-
sity. She has authored 50 papers in refereed inter-
national conferences and premier journals. Her
research interests include network security and pri-
vacy, social networks, and cyber physical systems.
CHAO YANG born in 1979. He is currently
the Ph.D. Supervisor with the School of Cyber
Engineering, Xidian University, and also with the
Shaanxi Key Laboratory of Network and System
Security. He is the key member of the innovation
team of the Ministry of Information Security. He
is currently engaged in: wireless network security,
mobile intelligent computing security, big data,
and cloud computing security research.
LIMIN SUN born in 1966. He received the B.S.,
M.S., and Ph.D. degrees from the College of Com-
puters, National University of Defense Technol-
ogy, in 1988, 1995, and 1998, respectively. He is
currently a Professor with the Institute of Informa-
tion Engineering, Chinese Academy of Sciences.
His research interests include security and privacy
in wireless networks, wireless sensor networks,
and the Internet of Things. He is a Senior Member
of the CCF.
VOLUME 6, 2018 27335
	INTRODUCTION
	RELATED WORK
	REPUTATION-BASED APPROACHES
	TIT-FOR-TAT SCHEMES
	CREDIT-BASED SCHEMES
	PRELIMINARIES AND THE THREAT MODEL
	BLOCKCHAIN P2P SYSTEM
	COMMUTATIVE ENCRYPTION
	THREAT MODEL AND ASSUMPTIONS
	BLOCKCHAIN BASED TRUTHFUL INCENTIVE MECHANISM
	WHO PAYS WHO?
	HOW TO PAY THE BILL?
	ONE POSITIVE COOPERATIVE NODE
	MULTIPLE POSITIVE COOPERATIVE NODES
	HOW MUCH SHOULD THE PAYERS PAY?
	IS IT SECURE?
	CHEATING BEHAVIORS OF THE PARTICIPANTS
	DATA-TRANSMISSION GAME.
	SECURITY ANALYSIS AND UTILITY EVALUATION
	SECURITY ANALYSIS WITHOUT COLLUSION ATTACKS
	SECURITY ANALYSIS WITH COLLUSION ATTACKS
	EVALUATION
	OVERHEAD
	UTILITY EVALUATION
	CONCLUSION AND FUTURE RESEARCH
	REFERENCES
	Biographies
	YUNHUA HE
	HONG LI
	XIUZHEN CHENG
	YAN LIU
	CHAO YANG
	LIMIN SUN