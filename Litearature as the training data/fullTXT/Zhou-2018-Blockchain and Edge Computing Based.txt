Blockchain and Edge Computing Based Vehicle-to-Grid Energy Trading in Energy Internet
Blockchain and Edge Computing Based
Vehicle-to-Grid Energy Trading in Energy Internet
Zhenyu Zhou, Lu Tan, and Gang Xu
State Key Laboratory of Alternate Electrical Power System with Renewable Energy Sources
School of Electrical and Electronic Engineering, North China Electric Power University, Beijing, China, 102206
Email: zhenyu zhou@ncepu.edu.cn, and xugang@ncepu.edu.cn
Abstract—Energy deficiency and carbon emission are two
increasingly grave issues recently. Energy Internet (EI), as a
promising solution, has received extensive attentions globally.
Among numerous key technologies and practice of EI, vehicle
to grid (V2G) provides a feasible solution to reduce the level of
demand-supply mismatch by leveraging the bidirectional energy-
trading capabilities of electric vehicles (EVs). In this paper, we
propose a secure and efficient V2G energy trading framework
by exploring blockchain and edge computing. First, we develop a
consortium blockchain-based secure energy trading mechanism
for V2G. Then, edge computing has been incorporated to improve
the successful probability of block creation. The computational
resource allocation problem is modeled as a two-stage Stackelberg
leader-follower game, and the optimal strategies are obtained by
using the backward induction approach. Finally, the performance
of the proposed framework is validated via numerical results and
theoretical analysis.
I. INTRODUCTION
A. Background and Motivation
In order to address the ever increasing concern over energy
deficiency and carbon emission, Energy Internet (EI) has been
proposed to provide a feasible solution which has received
extensive attentions from both industry and academia [1]. EI
is a highly integrated network which interconnects various
energy nodes including new power networks such as large-
scale distributed energy resources network and distributed
energy storage network, oil networks, natural gas networks and
etc., which aims to achieve bidirectional energy exchange and
sharing by exploring advanced energy distribution technology,
real-time online monitoring technology and novel information
and communication technology [2].
However, the large-scale penetration of intermittent dis-
tributed renewable energy sources and uncoordinated electric
vehicles (EVs) leads to significant power fluctuation [3], [4].
The exploitation of EVs’ energy storage capabilities provides
a promising solution [5], [6]. For example, the excessive
energy generated during the off-peak time can be stored in
the batteries of EVs and EVs fed electricity back to the grid
during the peak time to reduce the load-supply imbalance [7].
This new energy trading paradigm is known as vehicle to grid
(V2G), which is essential to build a secure and efficient energy
trading in EI [8], [9].
The studies on V2G energy trading have received consider-
able attentions recently. In [7], Zhou et al. proposed a holistic
solution on utilizing robust optimization to cope with the
uncertain energy scheduling challenges and over-conservatism
issues in emerging V2G networks. A novel network archi-
tecture of V2G mobile energy system was designed in [10]
to flatten out power demands across different districts with
the exploitation of EVs’ mobility features. Despite the above-
mentioned advantages, the wide area deployment of V2G still
confronts a critical challenge that there lacks a distributed
security mechanism for V2G energy trading. Conventional
centralized mechanisms rely on a trusted intermediary to
manage, audit, and verify every energy transaction, which is
vulnerable to a series of security threats such as single point
of failure, denial of service attacks, and privacy leakage [11].
Therefore, a distributed security mechanism is indispensable
to guarantee the reliable operation of large-scale V2G energy
trading in an untrusted and nontransparent energy market.
To address the security and privacy issues, we develop a
new V2G framework for EI, which leverages blockchain and
edge computing to enable secure and efficient energy trad-
ing. First, we develop a consortium blockchain-based secure
energy trading mechanism for V2G. All the transactions are
created, propagated, and verified by authorized local energy
aggregators (LEAGs) with moderate cost. Recent works have
explored blockchain to address the transaction security issues
of peer-to-peer energy trading among EVs. Liu et al. proposed
a decentralized blockchain-enabled EV charging scheme to
simultaneously minimize the fluctuation level of the power
grid and the EV charging cost [12]. In [13], a privacy pre-
serving payment scheme based on blockchain in V2G energy
trading system was designed to guarantee the demands of
privacy protection. However, these works have neglected the
high computational cost associated with solving proof-of-work
puzzles in blockchain creation, which will cause severe delay
in the process of energy trading. Therefore, edge computing
has been incorporated to improve the successful probability
of block creation. Specifically, LEAGs can purchase services
from an edge computing service provider (ESP), and offload
the computation-intensive proof-of-work puzzles to proximate
edge computing nodes. The computational resource allocation
problem is modeled as a two-stage Stackelberg leader-follower
game, and the optimal strategies are obtained by using the
backward induction approach [14].
The remainder of this paper is organized as follows. Section
II introduces the consortium blockchain for secure energy
trading. Section III elaborates the edge computing-based task
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:06:24 UTC from IEEE Xplore.  Restrictions apply. 
ly
图章
offloading. Section IV shows the simulation results. Finally,
Section V concludes this paper.
II. CONSORTIUM BLOCKCHAIN-BASED SECURE ENERGY
TRADING
The consortium blockchain-based secure energy trading for
V2G is shown in Fig. 1, which consists of three major entities:
EV, LEAG, and ESP. The operation details of the consor-
tium blockchain-based secure energy trading are explained
as follows. In the beginning, each EV has to register with
a legitimate authority to obtain its public key, privacy key,
and certificate. The public/privacy keys can be generated and
distributed by the authority. The certificate represents a unique
identity for the EV via binding its registration information.
Each EV has a set of wallet addresses issued by the authority.
During initialization, an EV finds the wallet address that is
used by its nearest LEAG and verifies the wallet integrity.
Afterwards, it downloads the corresponding data from the
memory server.
After energy trading, a discharging EV will receive the
specified reward if the trade has been successfully executed.
The energy coins are transferred from the LEAG to the wallet
address of the EV. Here, energy coin which is one kind
of digital cryptocurrency is used to serve as the dedicated
payment for the discharging EV and represent the digital assets
of each EV. The authenticity of the payment can be verified
by checking the last block of the consortium blockchain. The
LEAG sets up a new transaction record which has to be firstly
verified and digitally signed by the EV, and then uploaded for
public audit.
All of the transaction records collected by a LEAG within
a certain period will be encrypted, digitally signed, and then
structured into blocks. Each new block is linked to the prior
block in the consortium blockchain by a cryptographic hash.
Then, similar to the proof-of-work process in Bitcoin [15],
each authorized LEAG in the consortium blockchain competes
to create a block by finding a valid proof-of-work, i.e., a hash
value which satisfies certain difficulty requirement.
If the computational capability of a LEAG is limited, it
can purchase edge computing services from the ESP. Then,
the computation-intensive proof-of-work process is handled
by nearby edge computing nodes with powerful computation
capabilities, and the successful probability of block creation
will be significantly improved. The LEAG which is the first to
find a valid proof-of-work broadcasts the created block to all of
the authorized LEAGs in the network. Next, each LEAG audits
and verifies the transaction records in the received block, and
chooses whether to accept this new block or not. If a new
block is accepted by all the LEAGs, i.e., a consensus has
been reached, then it will be appended at the end of the
current consortium blockchain, and the LEAG which created
this block will be rewarded by a certain amount of energy
coins.
III. EDGE COMPUTING-BASED COMPUTATIONAL TASK
OFFLOADING
A. Hierarchical Game Formulation
In order to win the block mining competition, a LEAG can
purchase edge computing services from the ESP to enlarge
its computational capability. We assume that there are N
LEAGs, and the set of LEAGs is denoted as N . The service
demand of the n-th LEAG is denoted as sn. For the n-th
LEAG, the successful probability of block creation, i.e., Pn,
depends on two factors: its relative hash power Pn,h [16] and
its block orphaning probability Pn,o [15], which are explained
as follows.
The relative hash power of the n-th LEAG is defined as
the ratio of its computational power with respect to the total
computational power, i.e.,
Pn,h(sn) =
sn
sn +
∑
n′∈N ,n′ 6=n sn′
, n ∈ N , (1)
where Pn,h > 0 and
∑
j∈N Pj,h = 1.
Upon finding a valid proof-of-work, the n-th LEAG has
to broadcast the created block to the other LEAGs in order
to reach a consensus. If the n-th LEAG happens to choose
a large block which propagates slowly due to the data size,
then the block is more likely to be discarded due to the
high transmission latency. Accordingly, the chance of the n-
th LEAG to win the competition of block mining will be
diminished. This phenomenon is called orphaning [15]. By
assuming that the block propagation time follows a Poisson
distribution, the orphaning probability is given by
Pn,o = 1− e−
∆t(Dn)
T , (2)
where T denotes the expected block interval time, which is
10 mins in Bitcoin. ∆t(Dn) denotes the relative propagation
time of a block with size Dn, which is defined as
∆t(Dn) = t(Dn)− t(0). (3)
Here, t(Dn) is the propagation time to deliver a block with size
Dn, and t(0) presents the lag of the communication channel,
i.e., the time required for delivering the block header. t(0) is
bounded by the constraint t(0) ≥ dc/c, where dc denotes the
transmission distance, and c denotes the speed of light.
Based on the approach proposed in [15], t(Dn) can be
approximated by using its first-order Taylor series expansion
around Dn = 0 as
t(Dn) ≈ t(0) +∇t |Dn=0 Dn, (4)
where the second term of (4) is partially related to the
carrying capacity of the communication channel. Based on
the Shannon-Hartley theorem, it can be written as ∇t |Dn=0=
1/(G1G2), where G1 and G2 present the channel capacity
and coding gain, respectively. Hence, by taking ∇t |Dn=0=
1/(G1G2) and (4) into (3), ∆t(Dn) is written as
∆t(Dn) = t(Dn)− t(0) ≈ Dn
G1G2
. (5)
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:06:24 UTC from IEEE Xplore.  Restrictions apply. 
Fig. 1. The system model of V2G energy trading based on blockchain and edge computing
The successful probability of block creation, i.e., Pn, is
given by
Pn(sn) = Pn,h(sn)(1− Pn,o)
=
sn
sn +
∑
n′∈N ,n′ 6=n sn′
e−
Dn
G1G2T . (6)
Once the consensus process is successful, the n-th LEAG
will gain a revenue which consists of two parts: the reward
for its contribution to block creation Qn, and the transaction
fee Mn. The net revenue of the n-th LEAG can be calculated
as the expected profit minus the service cost, i.e.,
Un,b(sn) = (Qn +Mn)Pn(sn)− pcsn, (7)
where pc is the unit service price of edge computing.
The utility of the ESP is defined as the total revenue
obtained from service provisioning minus the operation cost,
i.e.,
UE(pc) =
∑
n∈N
pcsn − γc
∑
n∈N
sn, (8)
where γc is the unit cost of service provisioning.
Owing to the dominant market position of the ESP com-
pared to LEAGs, the competitive interaction between the ESP
and LEAGs can be modeled as a two-stage Stackelberg leader-
follower game. In the first stage, the ESP is the leader that
determines the unit service price pc, and obtains the revenue
from LEAGs for solving the offloaded proof-of-work puzzles.
In the second stage, the LEAGs act as the followers, and
determine the service demand to be purchased. The two-stage
Stackelberg leader-follower game is formulated as follows:
Stage 1. the service price optimization problem:
P1 : max
pc
UE(pc),
s.t. C1 : pc,min ≤ pc ≤ pc,max, (9)
where pc,min and pc,max denote the minimum and maximum
bounds of the unit service price.
Stage 2. the service demand optimization problem:
P2 : max
sn
Un,b(sn),
s.t. C2 : sn,min ≤ sn ≤ sn,max, (10)
where sn,min is the minimum computational resources (hash
power) required by the n-th LEAG, and sn,max represents the
maximum computational resources that can be provided by the
ESP.
B. Equilibrium Analysis
The optimal price and the optimal service demands can be
derived by using the backward induction approach [17].
1) The Solution of the Second-Stage Optimization Problem:
First, given a service price pc, the second-stage service demand
optimization problem P2 is solved for each LEAG. During
the service demand optimization, every LEAG competes with
each other to maximize its own relative hash power, and
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:06:24 UTC from IEEE Xplore.  Restrictions apply. 
thus, to maximize its successful probability of block creation.
From (1), we can observe that the relative hash power of
the n-th LEAG not only depends on its strategy sn, but
also depends on the strategies of the other LEGAs, e.g.,
sn′ , n′ ∈ N , n′ 6= n. Therefore, the competition among N
LEAGs can be modeled as a N -player noncooperative game.
Denote the optimal strategy of the n-th LEAG as s∗n, and let
s∗−n = {sn′ , n′ ∈ N , n′ 6= n} represent the set of optimal
strategies of the other LEAGs in the set N excluding the n-th
LEAG.
Given s∗−n, it can be easily validated that P2 is a stan-
dard convex programming problem. By setting the first-order
derivative of (7) to zero, i.e., ∂Un,b
∂sn
= 0, we have
ŝn =
√√√√ (Qn +Mn)
∑
n′∈N ,n′ 6=n sn′
pce
Dn
G1G2T
−
∑
n′∈N ,n′ 6=n
sn′ . (11)
then the best response function of the n-th LEAG, i.e.,
Bn(s∗−n) can be obtained as
s∗n = Bn(s∗−n) =
 sn,min, ŝn < sn,min
ŝn, sn,min ≤ ŝn ≤ sn,max
sn,max, ŝn > sn,max
(12)
2) The Solution of the First-Stage Optimization Problem:
Based on the optimal service demand strategies of all the
LEAGs obtained in the second stage, the first-stage service
price optimization problem can be solved. By substituting the
Nash equilibrium of the second-stage N -player noncooperative
game into (8), the utility of the ESP UE can be written as
UE(pc) = (pc − γc)
N − 1
pc
∑
n′∈N
e
D
n′
G1G2T
Qn′+Mn′
. (13)
We can prove that the second order derivative of (13) is
negative, which is given by
∂UE
∂pc
= −2
γc(N − 1)
p3c
∑
n∈N
e
Dn
G1G2T
Qn+Mn
< 0. (14)
Then we have the property that P1 is a standard convex
optimization problem, and the optimal solution p∗c can be
easily solved by using KKT conditions.
IV. SIMULATION RESULTS AND ANALYSIS
In this section, we validate the proposed scheme via simu-
lations.
A. Edge Computing-based Computational Task Offloading
To verify the benefits brought by edge computing, we
consider a case that there are 50 LEAGs, i.e. N = 50.
The simulation parameters are sn,min = 90, sn,max = 210,
pc,min = 0, pc,max = 15, Qn = 12000, γc = 3, G1 = 50,
and G2 = 4.
Fig. 2, Fig. 3 and Fig. 4 show the total service demand, the
profit of the ESP, and the average profit of the LEAG versus the
transaction fee Mn, respectively. Fig. 2 and Fig. 3 demonstrate
Transactions fee
6500 7000 7500 8000 8500
T
o
ta
l 
s
e
rv
ic
e
 d
e
m
a
n
d
80
100
120
140
160
180
200
220
Q
n
=13000
Q
n
=12000
Q
n
=11000
Fig. 2. Efficiency of task offloading: total service demand.
Transactions fee
6500 7000 7500 8000 8500
P
ro
fi
t 
o
f 
E
S
P
×10
4
1.3
1.35
1.4
1.45
1.5
1.55
1.6
1.65
1.7
1.75
Q
n
=13000
Q
n
=12000
Q
n
=11000
Fig. 3. Efficiency of task offloading: profit of ESP.
that both the total service demand and the profit of the ESP
increase monotonically with the transaction fee. The reason
behind is that the increased transaction fee provides a larger
incentive for LEAGs to purchase more services from the ESP.
This not only improves the successful probability of LEAGs,
but also increases the profit of the ESP. Furthermore, it is
observed that both the total service demand and the profit of
the ESP increase monotonically with the block creation reward
Qn, which is also due to the fact that a higher reward provides
a greater motivation for LEAGs to buy more services.
Fig. 4 shows the average profit of the n-th LEAG achieved
by four different schemes: the proposed scheme, the conven-
tional scheme without edge computing, the aggressive scheme
in which the n-th LEAG always purchases the maximum
amount of services sn,max, and the conservative scheme in
which the n-th LEAG always purchases the minimum amount
of services sn,min. It is clear that the proposed scheme outper-
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:06:24 UTC from IEEE Xplore.  Restrictions apply. 
Transactions fee
6500 7000 7500 8000 8500
P
ro
fi
t 
o
f 
L
E
A
G
100
150
200
250
300
350
400
450
500
550
The aggressive scheme
The conservative scheme
Without edge computing
The proposed scheme
Fig. 4. Efficiency of task offloading: profit of LEAG.
forms the other three heuristic schemes because the LEAG’s
strategy is optimized with regards to the transaction fee. When
the transaction fee is low, the conservative scheme performs
better than the aggressive scheme. It is not worthy to buy
more services because the expected profit cannot compensate
the cost of purchasing services. In comparison, when the
transaction fee is high enough, the LEAG should purchase
a larger amount of services to increase the chance of winning
because the expected profit is much higher than the service
cost.
B. Privacy and Security Analysis
In this subsection, we provide the privacy and the security
analysis.
Privacy: Each EV uses a unique public key to be identified
and to communicate with others rather than using its true
identity, which protects an EV’s identity from being tracking
and counterfeiting by malicious attackers. In addition, an EV
can modify its public key after each energy transaction to avert
the linking attack and satisfy anonymity and privacy.
Security: Once a block has been attached to the blockchain,
it contains the hash of the previous block, and the following
block will involve its own hash. Therefore, it is impossible to
alter the block unless the majority of the computational power
are controlled by a malicious attacker. Furthermore, all the
transaction data are encrypted utilizing asymmetric encryption
algorithms, e.g., elliptic curve digital signature, Boneh-Boyen
short signature, and SHA-256. It takes a tremendous cost to
decrypt the encrypted data without knowing the private key.
V. CONCLUSIONS
In this paper, we proposed a secure and efficient V2G energy
trading framework for EI by integrating blockchain and edge
computing. First, we proposed a consortium blockchain-based
energy trading mechanism for V2G. Then, we developed a
edge computing-based task offloading mechanism for LEAGs
to improve the successful probability of block creation. Finally,
the proposed framework is validated from the perspectives of
task offloading and security. In future works, we will focus
on how to design an efficient incentive mechanism for V2G
energy trading under the scenario of information asymmetry
by exploring contract theory.
ACKNOWLEDGMENT
This work was partially supported by the Beijing Nat-
ural Science Foundation under Grant Numbers 4174104;
Beijing Outstanding Young Talent under Grant Numbers
2016000020124G081; National Natural Science Foundation of
China (NSFC) under Grant Numbers 61601181.
REFERENCES
[1] K. Wang, J. Yu, Y. Yu, Y. Qian, D. Zeng, S. Guo, Y. Xiang, and J. Wu,
“A Survey on Energy Internet: Architecture, Approach, and Emerging
Technologies,” IEEE Syst. J., vol. PP, no. 99, pp. 1–14, Jan. 2017.
[2] H. Hou, G. Zhu, W. Chen,Y. Zhang, J. Zhao, and Z. Dong, “Energy
Internet risk assessment framework,” in IEEE PES Asia-Pacific Power
Energy Eng. Conf., pp. 1–5, Nov. 2015.
[3] Z. Zhou, J. Gong, Y. He, and Y. Zhang, “Software defined machine-to-
machine communication for smart energy management,” IEEE Commun.
Mag., vol. 55, no. 10, pp. 52–60, Oct. 2017.
[4] E. Zio and G. Sansavini, “Vulnerability of smart grids with variable
generation and consumption: A system of systems perspective,” IEEE
Trans. Syst. Man, Cybern. Syst., vol. 43, no. 3, pp. 477–487, May 2013.
[5] Y. Zhang, R. Yu, W. Yao, S. Xie, Y. Xiao and M. Guizani, “Home
M2M Networks: Architectures, Standards, and QoS Improvement”,
IEEE Commun. Mag., vol.49, no.4, pp.44-52, Apr. 2011.
[6] Y. Zhang, R. Yu, M. Nekovee, Y. Liu, S. Xie, and S. Gjessing, “Cognitive
Machine-to-Machine Communications: Visions and Potentials for the
Smart Grid”, IEEE Netw. Mag., vol.26, no.3, pp.6-13, May 2012.
[7] Z. Zhou, C. Sun, R. Shi, Z. Chang, S. Zhou, and Y. Li, “Robust energy
scheduling in vehicle-to-grid networks,” IEEE Netw., vol. 31, no. 2, pp.
30–37, Mar. 2017.
[8] Z. Zhou, H. Yu, C. Xu, Y. Zhang, S. Mumtaz and J. Rodriguez,
“Dependable Content Distribution in D2D-Based Cooperative Vehicular
Networks: A Big Data-Integrated Coalition Game Approach”, IEEE
Tans. Intelligent Transport. Syst., vol.19, no.3, pp.953-964, Mar. 2018.
[9] Z. Zhou, C. Gao, C. Xu, Y. Zhang, S. Mumtaz and J. Rodriguez, “Social
Big-Data-Based Content Dissemination in Internet of Vehicles”, IEEE
Tans. Ind. Informat., vol.14, no.2, pp.768-777, Feb. 2018.
[10] R. Yu, W. Zhong, S. Xie, C. Yuen, S. Gjessing, and Y. Zhang, “Balancing
Power Demand Through EV Mobility in Vehicle-to-Grid Mobile Energy
Networks,” IEEE Trans. Ind. Informat., vol. 12, no. 1, pp. 79–90, Feb.
2016.
[11] A. Dorri, M. Steger, S. S. Kanhere, and R. Jurdak, “Blockchain: A
distributed solution to automotive security and privacy,” IEEE Commun.
Mag., vol. 55, no. 12, pp. 119–125, Dec. 2017.
[12] C. Liu, K. K. Chai, X. Zhang, E. T. Lau, and Y. Chen, “Adaptive
blockchain-based electric vehicle participation scheme in smart grid
platform,” IEEE Access, pp. 1–1, May 2018.
[13] F. Gao, L. Zhu, M. Shen, K. Sharif, Z. Wan, and K. Ren, “A Blockchain-
Based Privacy-Preserving Payment Mechanism for Vehicle-to-Grid Net-
works,” IEEE Netw., vol. PP, no. 99, Apr. 2018.
[14] S. Maharjan, Q. Zhu, Y. Zhang, S. Gjessing, and T. Basar, “Dependable
Demand Response Management in the Smart Grid: A Stackelberg Game
Approach”, IEEE Trans. Smart Grid, vol.4, no.1, pp.120-132, 2013.
[15] R. Peter, “A transaction fee market exists without a block size limit,”
Block Size Limit Debate Working Paper.
[16] N. Houy, “The bitcoin mining game,” Working Paper, vol. PP, no. 99,
Mar. 2014.
[17] Z. Zhou, X. Fei, B. Huang, C. Xu, R. Jiao, and B. L. et al., “Game-
theoretical energy management for energy internet with big data-based
renewable power forecasting,” IEEE Access, vol. 5, pp. 5731–5746, Feb.
2017.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:06:24 UTC from IEEE Xplore.  Restrictions apply.