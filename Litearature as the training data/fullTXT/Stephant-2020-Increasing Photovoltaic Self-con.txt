Increasing Photovoltaic Self-consumption: An Approach with Game Theory and Blockchain
Increasing Photovoltaic Self-consumption:
An Approach with Game Theory
and Blockchain
Matthieu Stephant1(B), Dhaker Abbes1, Kahina Hassam-Ouari2,
Antoine Labrunie3, and Benôıt Robyns1
1 L2EP, Univ. Lille, Centrale Lille, Arts et Metiers Paris Tech, HEI, EA 2697, L2EP,
Laboratory of Electrical Engineering and Power Electronics, 59000 Lille, France
{matthieu.stephant,dhaker.abbes,benoit.robyns}@yncrea.fr
2 HEI, Yncrea-Hauts-De France, 13 Rue de Toul, 59000 Lille, France
kahina.hassam@yncrea.fr
3 Greenbirdie, 13 rue Raymond Losserand, 75014 Paris, France
antoine.labrunie@gb-solar.fr
Abstract. In this paper, we present a distributed approach to optimise
self-consumption on a university campus grid. The grid contains photo-
voltaic generators, electric vehicles, loads and a battery. We propose to
solve the optimisation problem with a distributed method using game
theory, where each element of the grid tries to reach its own objectives.
In addition to this optimisation framework, we develop a physical model
of the grid. This model uses real consumption and production data. We
use it to simulate the production and consumption profiles obtained from
the optimisation problem in order to check if these solutions respect the
grid constraints. Finally, we propose to implement concretely this dis-
tributed approach using a private blockchain, which stores production
and consumption data. In addition, a smart contract is deployed on the
blockchain to transcribe the game theory framework. The smart con-
tract collects the preferences of each element of the grid and launches
the optimisation process. Then the blockchain gathers the results and
replaces the role of a central optimisation supervisor. We present some
preliminary results to illustrate our method.
Keywords: Photovoltaic self-consumption · Game theory · Blockchain
1 Introduction
Due to environmental concerns, many countries have promoted the development
of photovoltaic (PV) generators through diverse financial incentives, leading to
an increase of the worldwide PV capacity from about more than 10 GWp in
2008 to more than 500 GWp at the end of 2018 [1]. PV generators differ from
Supported by the European city of Lille (MEL) and Greenbirdie under the Smart
Buildings as nodes of Smart Grid (SBnodesSG) Chair.
c© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2020
Published by Springer Nature Switzerland AG 2020. All Rights Reserved
J. L. Afonso et al. (Eds.): SESC 2019, LNICST 315, pp. 180–194, 2020.
https://doi.org/10.1007/978-3-030-45694-8_14
http://crossmark.crossref.org/dialog/?doi=10.1007/978-3-030-45694-8_14&domain=pdf
https://doi.org/10.1007/978-3-030-45694-8_14
Increasing Photovoltaic Self-consumption with Game Theory and Blockchain 181
traditional power plants like nuclear or coal power plants: their capacity is much
lower so they are spread on large geographical areas and often connected to low
or medium voltage grid. For example, small PV generators of less than 4 kWp
counted for 21% of the total PV capacity installed in the UK in 2016 [2]. As
a result, new uses of electricity networks appear with the development of PV
generators. The continuous decrease of PV installation costs encourages con-
sumers to produce their own electricity from rooftop solar panels. This situation
corresponds to self-consumption. The overall electrical grid can benefit from self-
consumption behaviour with a decrease of energy flows on the lines, leading to
a decrease of investments costs [3].
We define the self-consumption rate as the part of the electricity produced by
the PV generators that is locally consumed over the total local consumption [4].
Increasing this self-consumption rate requires adapting the consumption to the
PV production, which is highly intermittent. Generally, we consider two main
options to reach this aim. First, the use of a storage system, such as electrochem-
ical batteries, can store the PV generation during the day and deliver power to
the consumer at night. Second, demand-side management (DSM) system adapts
the consumption so that it fits the period of high PV production [4].
France, Sweden and the Netherlands now also allow collective self-
consumption, in which a group of consumers shares the local PV production
on the low voltage grid over a small area, creating a local energy community [5].
The idea is to benefit from the differences between the consumption profiles of
all the consumers in order to maximise the self-consumption rate. Consumers
and producers exchange the local energy production. However, collective self-
consumption projects are still at an early stage and we believe that a large-scale
development requires a new framework to optimise the self-consumption rate
and thus to make collective self-consumption attractive for all participants.
The question this article deals with is: how to optimise energy exchanges on a
local energy community in a distributed way? Indeed, to support decentralisation
of the grid, we believe that a distributed method is more relevant and enables
to get rid of a central agent.
In this perspective, we propose a new approach to improve the self-
consumption rate between several tertiary buildings. We base our study on the
grid of Lille Catholic University, France, which combines PV generators, a bat-
tery, charging stations for electric vehicles and tertiary buildings. We define a
global optimisation problem to increase the self-consumption rate. In order to
take into account the preferences of each participant, we decompose this global
problem in several smaller local problems. Thus, we build a decentralised frame-
work using game theory, in which each participant acts freely in order to reach
its individual objectives. Game theory is gaining popularity in the literature as
a distributed optimisation method for smart grid, as it reflects its distributed
and heterogeneous nature [6]. In [7], the authors introduce a bargaining game to
manage a micro-grid both in connected or islanded mode. Nguyen et al. use game
theory for demand side management in a system containing storage devices [8].
182 M. Stephant et al.
The results show a decrease of energy costs for energy consumers and a peak
power reduction of the overall system.
In our case, we define a specific non-cooperative game so that the self-
consumption rate increases when each player tends to meet its own objectives
by adjusting its consumption or production profile. We introduce parameters so
that each element is able to adjust its objective function (called utility function)
according to its own preferences. These preferences can represent the cost paid
(or earned) for electricity consumption (or production), the users’ comfort, or
the will to consume the local PV production. The benefit of such an approach
is that it only requires that the participants optimise locally their behaviour,
without any cooperation. Thus, it does not require a central agent to coordinate
all the participants.
To verify the relevance of our work, we aim to test the results of the pro-
posed optimisation framework on a physical model of the grid, including real
production and consumption data. We test the results with the model in order
to guarantee that the real grid can support the energy flows between the different
elements.
In addition, in order to implement concretely this framework, we propose
to use blockchain technology. Blockchain consists in a distributed and secured
database, supporting the execution of algorithms called smart contracts [9]. It
shows promising features for collective self-consumption and energy sharing and
interest for this topic is growing. One of the main applications observed in the
literature is the implementation of energy markets between consumers and pro-
ducers. Mengelkamp et al. propose to improve energy sharing by creating local
markets supported by blockchain [10]. In [11] and [12] authors use blockchain
to implement local markets with an auction scheme, where producers and con-
sumers publish demand offers and sell offers with smart contracts, and blockchain
automatically matches the offers. In [13], the authors present a method to solve
an optimal power flow in micro-grid networks. The global problem is first divided
in local problems and then blockchain aggregates all the local solutions to pro-
vide the overall optimum.
In our vision, we suggest using this technology to store in a secure way
the production and consumption data. Moreover, a specific smart contract will
collect each user’s preferences and launches the optimisation process. Thus,
blockchain is a promising tool to implement concretely the distributed opti-
misation framework that we introduced.
The novelty of our work consists in proposing a concrete and fully distributed
method to increase self-consumption rate in a local energy community by the
combination of different tools (game theory and blockchain). We exploit the
distributed nature of the grid and of the blockchain to get rid of a central opti-
misation agent. Moreover, the test of our approach on a physical model of a real
grid, provided with real production and consumption data, shows the feasibility
of such an approach.
This paper is divided as follows. In the second part, we introduce the opti-
misation problem and the game theory framework used to solve it. In the third
Increasing Photovoltaic Self-consumption with Game Theory and Blockchain 183
part, we detail how we combine the three tools (optimisation algorithm, physical
model of the grid, blockchain) to implement this framework. Then, we show and
analyse some preliminary results on simple scenarios.
2 Optimisation Framework Using Game Theory
In our problem, we consider a local university grid that contains loads (build-
ings), a storage system (an electrochemical battery), rooftop PV generators and
several charging station for electric vehicles. There is a connection point to the
distribution grid. We aim to increase the self-consumption rate of the local grid,
by adjusting the charge and discharge schedule of the battery and the electric
vehicles, and eventually by delaying the consumption of the buildings. Thus we
define an optimisation problem.
Two main approaches exist for solving optimisation problems: centralised
or distributed methods. In centralised methods, a supervisor agent knows the
entire characteristics of the system, computes the solution of the optimisation
problem with a specific algorithm and then sends the results to each element
of the grid. Thus, the central agent imposes the actions to take to the entire
system. However, in distributed methods, the global optimisation problem is
divided in local sub-problems so that finding the local solutions for all sub-
problems provides the overall solution. Distributed methods benefit from several
advantages. First, the local sub-problems are simpler and therefore easier to
solve than the global problem. Second, to solve a local problem, we do not need
to know the situation of the entire system. Thus, they are often more robust
because they are not impacted by the failure of one element [14].
Regarding electrical networks, a distributed approach is interesting because
it reflects the real structure of the grid. Indeed, a grid contains many different
elements (loads, generators...) connected between them, but each one has very
limited information about its neighbouring environment. Moreover, each element
tries to optimise individually its situation, for example the payoffs or the com-
fort, without considering the global situation of the grid. To reflect this reality,
we choose to apply a distributed method to our optimisation problem. More
specifically, we choose to use game theory, that defines a mathematical frame-
work for distributed optimisation in which each element of the system aims to
optimise its own individual situation.
Game theory is a relevant method in our case for several reasons. First,
it models a situation where players are in competition. This reflect the case
of a local energy community where players are in competition to reach their
consumption/production objectives. Second, game theory enables to take into
account not only cost objectives, but also other considerations like comfort [15].
Finally, game theory is interesting because each agent has to solve a simpler
problem, in comparison to the global optimisation problem.
184 M. Stephant et al.
2.1 Problem Formulation
We define a non-cooperative game in which each element tries to reach its per-
sonal objectives, without any coordination with the other elements. As we men-
tioned previously, this situation reflects the reality of a local grid where par-
ticipants have limited knowledge about the structure of the grid and do not
necessary communicate between them to meet their goals. Thus, we consider a
game with N players, which are the N elements of the grid (loads, PV genera-
tors, battery, electric vehicles charging stations). The game is defined by the set
G = {N, (Si)i∈N , (Ui)i∈N}, where Si is the strategy set of the player i and Ui
its utility function. Here, the strategy set is defined as Si = {xi}, where xi is
the energy consumption or production profile of the player.
The utility function, or objective function, mathematically translates the
goals of the player and measures user’s satisfaction. The players tend to maximise
their utility function by adjusting their strategy, here their energy consumption
or production profile. The next paragraph details the objectives and the utility
function of each player. In the following, we note c(t) the price function of the
electrical energy in the local grid over time.
Utility Functions
EV User. For an EV user connected to the charging station, we propose the
following function (we write xforecast
PV for the forecast local PV production):
UEV (xEV (t)) = α1 ln(1+xEV (t))−α2 c(t)xEV (t)−α3 ln(1+
xforecast
PV (t)
xEV (t)
) (1)
The term α1 ln(1 + xEV (t)) represents the objective to charge the vehicle.
With the term α2 c(t)xEV (t), the user aims to minimise the cost to pay. Then we
introduce the term α3 ln(1 + xforecast
PV (t)
xEV (t) ) to represent the objective to use pref-
erentially the local PV production. The natural logarithm function is classically
used for energy buyers as it models the satiety of the users [11]. We introduce
the weight coefficients α1, α2 and α3 so that each user can adjust its preferences.
These coefficients are commonly used in the literature for multi-objective opti-
misation to combine different objectives into a unique objective function. We
impose α1 + α2 + α3 = 1 [16].
For each EV, we have to consider some constraints. We authorize only charge
and the charging power is limited by the maximum power of the charging station:
0 ≤ PEV (t) ≤ PEV
max (2)
Moreover, the state of charge (SOC) has upper and lower bounds, which are
characteristics of the vehicle battery:
SOCmin
EV ≤ SOCEV (t) ≤ SOCmax
EV (3)
Increasing Photovoltaic Self-consumption with Game Theory and Blockchain 185
Battery. We consider that the battery has three objectives: first to maximise its
availability, which means to keep a median SOC in order to be able to charge or
discharge at any time, second to optimise its payoffs, and third to charge using
local PV production. Thus, we propose the following utility function:
Ub(xb(t)) = β1D(t) − β2 c(t) xb(t) − β3(x
forecast
PV (t) − xb(t))2 (4)
Here also we use the coefficients β1, β2 and β3 to detail the player’s preferences,
and we impose the sum to be equal to one. The term D(t) represents the avail-
ability of the battery, and models the fact that the battery aims to keep a median
SOC, written SOCmedian. This function is equal to 0 when the SOC is equal to
SOCmin
b and SOCmax
b , and 1 for SOCmedian
b .
The charging power and discharging power of the battery are limited:
0 ≤ Pb(t) ≤ P charge,max
b (5)
0 ≥ Pb(t) ≥ P discharge,max
b (6)
Moreover, similarly to the EV, the SOC has boundaries:
SOCmin
b ≤ SOCb(t) ≤ SOCmax
b (7)
PV Generators. PV generators simply tend to maximise their production,
because their marginal production cost is equal to zero [13]. So their goals are
to optimise their payoff, and to limit the production curtailment. Therefore, we
write the following utility function with the two respective terms:
UPV (xPV (t)) = γ1 c(t) xPV (t) − γ2(x
forecast
PV (t) − xPV (t))2 (8)
The coefficients γ1 and γ2 model the user’s choice, and we impose γ1 + γ2 = 1.
Loads. We consider that the loads have some flexibility, which means that
they can decrease their consumption compared to their expected consumption
xexpected
load . However, we impose that the total energy consumed at the end of the
day is equal to the expected consumption for the entire day. In other words,
loads can delay their consumption but do not globally decrease it. Then the
objectives are to minimise the cost paid for electricity, to minimise the decrease
of consumption, that represents a loss of comfort for the user, and to consume
the local PV production. Therefore, following [7], we write the following utility
equation:
Ul(xl(t)) = −δ1 c(t) xl(t) − δ2(x
expected
l (t) − xl(t))2 − δ3 ln(1 +
xforecast
PV (t)
xl(t)
) (9)
Each user can specify its preferences by adjusting δ1, δ2 and δ3 (with δ1 + δ2 +
δ3 = 1). The constraint on the flexibility f imposes:
xexpected
l (t)(1 − f) ≤ xl(t) ≤ xexpected
l (t)(1 + f) (10)
186 M. Stephant et al.
Nash Equilibrium. One important concept in game theory is the Nash equilib-
rium, a situation in which no player can increase its utility by being the only to
change its strategy [6]. Mathematically, if we write X∗ = {x∗
1, ..., x
∗
N} the strat-
egy of the players at the Nash equilibrium and x−i the strategy of all players
except player i, the Nash equilibrium corresponds to:
Ui(x∗
i , x
∗
−i) ≥ Ui(xi, x
∗
−i),∀xi ∈ Si (11)
This Nash equilibrium is important as it guarantees that when all players max-
imise individually their utility function, the global system reaches an equilibrium
point.
All the utility functions Ui specified in this article are concave and contin-
uous in xi. Moreover, all the constraints (on the power limits and the SOC)
impose that for each player, the strategy set is a segment: ∀i ∈ N,Si = {xi|xi ∈
[xmin
i , xmax
i ]}, so it is a convex set. This guarantees the existence of at least one
Nash equilibrium for our problem [17].
If we consider in a first approach a cost function that does not depend on
the consumption and production profiles of the players but that it imposed by
the distribution grid, for example a peak and off-peak hours price function, then
[18] ensures the unicity of the Nash equilibrium.
3 Optimisation Implementation
In this section we present how we concretely tend to deploy the proposed opti-
misation process, and more specifically how we connect the physical model of
the grid and the blockchain to the theoretical game theory framework. The com-
bination of these three parts form a new tool which gives a concrete distributed
framework for optimising self-consumption on real local grids, as illustrated on
Fig. 1.
3.1 Role of Blockchain
Blockchain is a distributed and secured database divided in blocks. A block
contains data and some additional information related to the previous block.
Thus, all blocks form a chain [9]. Each user holds a copy of the database. Adding
a new block to the existing chain requires a consensus between all users, so the
blockchain works without any central supervisor nor trusted third-party.
In addition, blockchain supports the execution of specific algorithms, called
smart contracts, that enable to automatically proceed to previously defined
tasks, such as triggering a transaction between two users [19]. Practically, a
smart contract is a piece of code defining some functions that is deployed over
the blockchain and interacts with every node of the network. Thanks to its dis-
tributed architecture, blockchain and smart contracts are interesting tools to
support smart grids decentralisation and we intend to use them in order to
deploy the distributed optimisation process.
Increasing Photovoltaic Self-consumption with Game Theory and Blockchain 187
User‘s preferences 
Desired consump on / 
forecasted produc on
Physical model of the local energy community 
Electrical data of the grid 
(currents, voltage, …)
Consump on and 
produc on forecast
Op misa on algorithm: 
game theory 
Consump on or 
produc on profile 
for each player
Consump on and 
produc on profiles for all 
players
Constraints for grid support
Blockchain : smart contract
Blockchain : database
Blockchain stores data for each mestep
User (node of the network)
Fig. 1. Overview of the overall optimisation process
In our system, blockchain serves as the communication layer between the
players and aggregates the results. It replaces the role of a central optimisation
agent. More precisely, we deploy a private blockchain between all the elements of
the grid. Thus, each player of the game represents one node of a peer-to-peer com-
munication network. A smart contract deployed on the blockchain implements
the game theory framework presented in the previous section. More precisely,
the smart contract contains different functions to perform the following tasks:
(1) collect the preferences coefficients of all users (coefficients αi for EV, βi for
the battery, γi for the PV generators and δi for the loads); (2) trigger the opti-
misation process (optimising locally each user’s utility); (3) gather the results;
(4) send the results to the physical modal of the grid. Thus, we see blockchain
as a tool to concretely implement our game theory framework in a real grid.
The main interest of this implementation is that, through the smart contract,
blockchain gets rid of the need for a central optimisation supervisor that would
know the production and consumption details and the preferences of all the grid
elements. Moreover, blockchain has the benefit to have a distributed structure,
so it guarantees security and trust between the elements of the grid. Blockchain
is also more resilient to changes than a unique central agent: new element can
simply be added to or deleted from the blockchain without any consequence on
the overall framework.
3.2 Game Theory Algorithm
As we mentioned in the previous paragraph, each player of the game constitutes
one node of the blockchain. This node locally optimises the user’s utility for
a defined time period. We make the assumption that the local PV forecast is
available through the smart contract for all elements and that each load knows
its desired consumption. Moreover, the smart contract provides the preferences
188 M. Stephant et al.
coefficients in input for each player. The algorithm returns the consumption or
production profile of each player that maximises its utility function.
3.3 Physical Model of the Real Grid
In the theoretical framework defined in Sect. 2, we have not taken into account
the constraints related to the grid. More precisely, the proposed game theory
framework implicitly assumes that the grid is able to transfer all the power flows
according to the optimisation results. However, the grid elements are connected
through lines that have a limited capacity. Therefore, it may be possible that the
consumption and production profiles processed by the optimisation algorithms
lead to some over-currents or over-voltages on the lines.
For this reason, we build a physical model of the grid at stake in which we
model the physical properties of the lines (see Fig. 2). We use PowerFactory, a
software used by grid operators for grid modelling and analysis [20]. The local
network contains 4 buildings considered to be loads, 2 PV generators, one battery
and 6 EV charging stations (Fig. 2).
~~~~
~~
~~~
AGBT_HEI
TGBT_TDN001
TGBT_HA
Terminal_HTA
AGBT_Ext
Battery
Distribution grid
Transformer
Load_A Load_B Load_C
Load_D
PV_A PV_B EV_A EV_B EV_C EV_D
EV_E EV_F
Fig. 2. Physical model of the grid
We aim to test the consumption and production profiles of all the players
provided by the optimisation process on the grid model in order to check if they
create line congestion or over-voltages. In this case, we can identify precisely
the problems that occur on the physical model. Then we can impose additional
constraints to the optimisation process (for example curtail the PV production)
in order to obtain profiles that will respect the grid constraints.
The combination of the theoretical optimisation framework with the simula-
tions on the physical model ensures that our solutions are realistic and will not
damage the grid.
Increasing Photovoltaic Self-consumption with Game Theory and Blockchain 189
4 Results
To illustrate our approach, we present in this section some preliminary results.
We consider the grid of Lille Catholic University (represented on Fig. 2), with
only one electric vehicle connected between 13:40 and 20:10. We use consumption
and production data for one day. We present two cases: in the first one, the
elements want to consume the local PV production (scenario (a)); in the second
one, they do not have a preference to consume local PV production (scenario
(b)). Tables 1 and 2 show the preferences coefficients and the parameters of the
different grid elements used for the simulations, respectively for scenario (a) and
scenario (b). These first results were obtained with MATLAB.
Table 1. Parameters of grid elements for scenario (a)
Element Coefficients Parameters
EV α1 = 0.2 α2 = 0.1 α3 = 0.7 Initial SOC = 40%
Battery β1 = 0.1 β2 = 0.1 β3 = 0.8 Initial SOC = 25%
PV generatora γ1 = 0.8 γ2 = 0.2 – –
PV generatorb γ1 = 0.6 γ2 = 0.4 – –
Loada δ1 = 0.1 δ2 = 0.1 δ3 = 0.8 Flexibility = 10%
Loadb δ1 = 0.2 δ2 = 0.2 δ3 = 0.6 Flexibility = 20%
Loadc δ1 = 0.2 δ2 = 0.2 δ3 = 0.5 Flexibility = 10%
Loadd δ1 = 0.3 δ2 = 0.1 δ3 = 0.6 Flexibility = 15%
Table 2. Parameters of grid elements for scenario (b)
Element Coefficients Parameters
EV α1 = 0.8 α2 = 0.2 α3 = 0 Initial SOC = 40%
Battery β1 = 0.3 β2 = 0.7 β3 = 0 Initial SOC = 25%
PV generatora γ1 = 0.8 γ2 = 0.2 – –
PV generatorb γ1 = 0.6 γ2 = 0.4 – –
Loada δ1 = 0.3 δ2 = 0.7 δ3 = 0 Flexibility = 10%
Loadb δ1 = 0.5 δ2 = 0.5 δ3 = 0 Flexibility = 20%
Loadc δ1 = 0.1 δ2 = 0.9 δ3 = 0 Flexibility = 10%
Loadd δ1 = 0.4 δ2 = 0.6 δ3 = 0 Flexibility = 15%
Figures 3 and 4 illustrate the results obtained respectively for scenarios (a)
and (b).
190 M. Stephant et al.
Mar 15, 06:00 Mar 15, 12:00 Mar 15, 18:00 Mar 16, 00:00 Mar 16, 06:00
2017
0.05
0.06
0.07
0.08
0
0.5
1
SO
C
SOC battery
Mar 15, 06:00 Mar 15, 12:00 Mar 15, 18:00 Mar 16, 00:00 Mar 16, 06:00
2017
0
100
200
300
400
PV
 p
ro
du
ct
io
n 
(k
W
)
Total PV production 2017
Mar 15, 06:00 Mar 15, 12:00 Mar 15, 18:00 Mar 16, 00:00 Mar 16, 06:00
0.05
0.06
0.07
0.08
100
200
300
400
co
ns
um
pt
io
n 
(k
W
)
Total cons umption of loads
2017
Mar 15, 06:00 Mar 15, 12:00 Mar 15, 18:00 Mar 16, 00:00 Mar 16, 06:00
0.05
0.06
0.07
0.08
0
2
4
6
co
ns
um
pt
io
n 
(k
W
)
Consumption EV
1.
2.
3.
4.
Fig. 3. Results for scenario (a), for: (1) the EV, (2) the battery, (3) the aggregated
load (the green line shows the desired consumption, and the red line the actual con-
sumption), and (4) the total PV production. (Color figure online)
From the comparison of the figures, we can notice that when the players
are taking care to consume the local PV production, they really adapt their
consumption to this production. Even if the effect is very slight for the EV, we
can see when we compare Figs. 3 and 4 that the EV decreases its consumption
when PV generators stop producing. We can particularly notice this effect at the
end of the day after 18:00, when PV generators stop producing. In scenario (b),
the EV does not change at all its consumption to fit to the PV production. For
the battery, the effect is more visible. In scenario (b), it prefers to charge when
the electricity price is low and to discharge when the electricity price is high, and
to keep a median SOC (here 50%). In scenario (a), it is charging during all the
period of PV production, no matter if the price is higher. For the loads, when
they do not pay attention to consume local production (scenario (b)), they adjust
their consumption profile in order to decrease the price they pay for electricity.
However, when they prefer to consume the local PV production (scenario (a)),
then they adjust their consumption to the PV production, leading to an increase
Increasing Photovoltaic Self-consumption with Game Theory and Blockchain 191
Mar 15, 06:00 Mar 15, 12:00 Mar 15, 18:00 Mar 16, 00:00 Mar 16, 06:00
2017
0
100
200
300
400
PV
 p
ro
du
ct
io
n 
(k
W
)
Total PV production
4.
Mar 15, 06:00 Mar 15, 12:00 Mar 15, 18:00 Mar 16, 00:00 Mar 16, 06:00
2017
0.05
0.06
0.07
0.08
0
0.5
1
SO
C
SOC battery
2.
Mar 15, 06:00 Mar 15, 12:00 Mar 15, 18:00 Mar 16, 00:00 Mar 16, 06:00
2017
0.05
0.06
0.07
0.08
100
200
300
400
co
ns
um
pt
io
n 
(k
W
)
Total consumption
3.
Mar 15, 06:00 Mar 15, 12:00 Mar 15, 18:00 Mar 16, 00:00 Mar 16, 06:00
2017
0.05
0.06
0.07
0.08
0
2
4
6
co
ns
um
pt
io
n 
(k
W
)
Consumption EV
1.
Fig. 4. Results for scenario (b), for: (1) the EV, (2) the battery, (3) the aggregated
load (the green line shows the desired consumption, and the red line the actual con-
sumption), and (4) the total PV production. (Color figure online)
of the self-consumption rate. In our case, the cost paid for electricity is then
higher, due to the profile of the chosen cost function.
Figure 5 compares the self-consumption rate obtained for both scenarios. It
confirms that when the players are more sensible to consumer the local PV
production (scenario (a)), then the self-consumption rate increases (scenario
(b)). Moreover, we calculate the peak to average ratio (PAR) in both scenarios
(Table 3). Scenario (a) leads to a decrease of the PAR of about 13% compared to
scenario (b). Indeed, when they favour the local PV production (scenario (a)),
the players adapt their consumption so that it fits to the PV production. Thus,
they require less energy from the distribution grid when PV generators are not
producing anymore. Moreover, in this scenario, the battery stores energy when
PV production is high and releases it at night. As a consequence, even if the
global consumed energy is the same in both scenarios, in scenario (a), players
manage to decrease the peak power seen from the distribution grid, resulting in
a reduction of the PAR.
192 M. Stephant et al.
06:00 08:00 10:00 12:00 14:00 16:00 18:00 20:00 22:00
Mar 15, 2017
85
90
95
100
105
Se
lf-
co
ns
um
pt
io
n 
ra
te
 (%
)
Self-consumption
self-consumption rate for scenario (b)
self-consumption rate for scenario (a)
Fig. 5. Self-consumption rate for scenarios (a) and (b).
Table 3. Peak to average ratio (PAR) in both scenarios
Scenario (a) Scenario (b)
PAR 1.75 1.98
These preliminary results show that our proposed algorithm leads to an
increase of the self-consumption rate and a decrease of PAR. The physical model
ensures that in the studied scenarios, the university grid can support the con-
sumption and production profiles. Simulations on the physical grid are neces-
sary to guarantee that the algorithm provides feasible solutions. This is a very
important point as the idea behind our work is to provide a concrete solution to
improve energy sharing among a local energy community.
Moreover, another interesting perspective is to include a price function that
reflects in real time the production and consumption on the local grid: when
consumption is higher than local production, the price will increase. This would
encourage the grid elements to preferentially consume the local production, even
in case that they are only sensible to the electricity cost.
5 Perspectives and Conclusion
In this paper, we propose a concrete framework to improve energy sharing
between producers and consumers among a local community energy, for example
the grid of Lille Catholic University. In this way, we maximise the use of local
photovoltaic production and thus the self-consumption rate.
Our approach combines three tools: game theory for distributed optimisa-
tion, a physical model of the grid to guarantee the stability of the grid, and
a communication layer with blockchain. The combination of these tools is an
innovative approach and constitutes a distributed method for better use of dis-
tributed renewable energy sources on local energy community. The approach
with game theory enables each actor to specify its particular preferences and
Increasing Photovoltaic Self-consumption with Game Theory and Blockchain 193
to act freely to reach these goals. Thus, our framework reflects the distributed
nature of electric grids, where various actors are following very diverse goals.
The first results are promising and show an increase of self-consumption rate.
However, we plan to continue this work, and specifically to focus on the following
tasks. First, the development of the smart contract with the blockchain is a key
point for a real distributed implementation. It will enable to concretely deploy
the optimisation method on a peer-to-peer communication network. As we men-
tioned in Sect. 3, the smart contract will automatically trigger the optimisation
algorithm and collect the results.
Second, the price function needs to reflect in real time the consumption
and production inside the local grid. The creation of a small electricity market
between the players is an interesting option to encourage loads to consume when
the PV production is high. In this perspective, we expect interesting further
results.
Moreover, some additional questions regarding the overall stability of the
system should be answered, especially when we add a new player, for exam-
ple when a new electric vehicle arrives at a charging station. The issue of the
global efficiency of the system, in particular regarding the performances and the
consumption of the blockchain.
References
1. Snapshot of Global PV Markets. Technical report, IEA PVPS (2019)
2. McKenna, E., Pless, J., Darby, S.: Solar photovoltaic self-consumption in the UK
residential sector: new estimates from a smart grid demonstration project. Energy
Policy 118, 482–491 (2018). https://doi.org/10.1016/j.enpol.2018.04.006
3. Villar, C., Neves, D., Silva, C.: Solar PV self-consumption: an analysis of influenc-
ing indicators in the Portuguese context. Energy Strat. Rev. 18, 224–234 (2017).
https://doi.org/10.1016/j.esr.2017.10.001
4. Luthander, R., Widén, J., Nilsson, D., Palm, J.: Photovoltaic self-consumption in
buildings: a review. Appl. Energy 142, 80–94 (2015). https://doi.org/10.1016/j.
apenergy.2014.12.028
5. Stephant, M., Hassam-Ouari, K., Abbes, D., Labrunie, A., Robyns, B.: A survey
on energy management and blockchain for collective self-consumption. In: 2018
7th International Conference on Systems and Control (ICSC), pp. 237–243. IEEE
(2018). https://doi.org/10.1109/ICoSC.2018.8587812
6. Saad, W., Han, Z., Poor, H.V., Basar, T.: Game-theoretic methods for the smart
grid: an overview of microgrid systems, demand-side management, and smart grid
communications. IEEE Signal Process. Mag. 29(5), 86–105 (2012). https://doi.
org/10.1109/MSP.2012.2186410
7. Dehghanpour, K., Nehrir, H.: Real-time multiobjective microgrid power manage-
ment using distributed optimization in an agent-based bargaining framework. IEEE
Trans. Smart Grid 9(6), 6318–6327 (2018). https://doi.org/10.1109/TSG.2017.
2708686
8. Nguyen, H.K., Song, J.B., Han, Z.: Distributed demand side management with
energy storage in smart grid. IEEE Trans. Parallel Distrib. Syst. 26(12), 3346–
3357 (2015). https://doi.org/10.1109/TPDS.2014.2372781
https://doi.org/10.1016/j.enpol.2018.04.006
https://doi.org/10.1016/j.esr.2017.10.001
https://doi.org/10.1016/j.apenergy.2014.12.028
https://doi.org/10.1016/j.apenergy.2014.12.028
https://doi.org/10.1109/ICoSC.2018.8587812
https://doi.org/10.1109/MSP.2012.2186410
https://doi.org/10.1109/MSP.2012.2186410
https://doi.org/10.1109/TSG.2017.2708686
https://doi.org/10.1109/TSG.2017.2708686
https://doi.org/10.1109/TPDS.2014.2372781
194 M. Stephant et al.
9. Sikorski, J., Haughton, J., Kraft, M.: Blockchain technology in the chemical indus-
try: machine-to-machine electricity market. Appl. Energy 195, 234–246 (2017).
https://doi.org/10.1016/j.apenergy.2017.03.039
10. Mengelkamp, E., Gärttner, J., Rock, K., Kessler, S., Orsini, L., Weinhardt, C.:
Designing microgrid energy markets: a case study: the Brooklyn Microgrid. Appl.
Energy 210, 870–880 (2018). https://doi.org/10.1016/j.apenergy.2017.06.054
11. Kang, J., Yu, R., Huang, X., Maharjan, S., Zhang, Y., Hossain, E.: Enabling
localized peer-to-peer electricity trading among plug-in hybrid electric vehicles
using consortium blockchains. IEEE Trans. Ind. Inform. 13(6), 3154–3164 (2017).
https://doi.org/10.1109/TII.2017.2709784
12. Foti, M., Greasidis, D., Vavalis, M.: Viability analysis of a decentralized energy
market based on blockchain. In: 2018 15th International Conference on the Euro-
pean Energy Market (EEM), pp. 1–5. IEEE (2018). https://doi.org/10.1109/EEM.
2018.8469906
13. Münsing, E., Mather, J., Moura, S.: Blockchains for decentralized optimization
of energy resources in microgrid networks. In: 2017 IEEE Conference on Control
Technology and Applications (CCTA), pp. 2164–2171, August 2017. https://doi.
org/10.1109/CCTA.2017.8062773
14. Molzahn, D.K., et al.: A survey of distributed optimization and control algo-
rithms for electric power systems. IEEE Trans. Smart Grid 8(6), 2941–2962 (2017).
https://doi.org/10.1109/TSG.2017.2720471
15. Pilz, M., Al-Fagih, L.: Recent advances in local energy trading in the smart grid
based on game-theoretic approaches. IEEE Trans. Smart Grid (2017). https://doi.
org/10.1109/TSG.2017.2764275
16. Marler, R., Arora, J.: The weighted sum method for multi-objective optimization:
new insights. Struct. Multidiscip. Optim. 41(6), 853–862 (2010). https://doi.org/
10.1007/s00158-009-0460-7
17. Yang, B., Johansson, M.: Distributed optimization and games: a tutorial overview.
In: Bemporad, A., Heemels, M., Johansson, M. (eds.) Networked Control Sys-
tems. LNCIS, pp. 109–148. Springer, London (2010). https://doi.org/10.1007/978-
0-85729-033-5 4
18. Rosen, J.: Existence and uniqueness of equilibrium points for concave N-person
games. Econometrica 33(3), 520–534 (1965). https://doi.org/10.2307/1911749
19. Macdonald, M., Liu-Thorrold, L., Julien, R.: The blockchain: a comparison of
platforms and their uses beyond bitcoin. Working Paper, pp. 1–18 (2017)
20. Gonzalez-Longatt, F.M., Rueda, J.L. (eds.): PowerFactory Applications for Power
System Analysis. Springer, Cham (2014). https://doi.org/10.1007/978-3-319-
12958-7
https://doi.org/10.1016/j.apenergy.2017.03.039
https://doi.org/10.1016/j.apenergy.2017.06.054
https://doi.org/10.1109/TII.2017.2709784
https://doi.org/10.1109/EEM.2018.8469906
https://doi.org/10.1109/EEM.2018.8469906
https://doi.org/10.1109/CCTA.2017.8062773
https://doi.org/10.1109/CCTA.2017.8062773
https://doi.org/10.1109/TSG.2017.2720471
https://doi.org/10.1109/TSG.2017.2764275
https://doi.org/10.1109/TSG.2017.2764275
https://doi.org/10.1007/s00158-009-0460-7
https://doi.org/10.1007/s00158-009-0460-7
https://doi.org/10.1007/978-0-85729-033-5_4
https://doi.org/10.1007/978-0-85729-033-5_4
https://doi.org/10.2307/1911749
https://doi.org/10.1007/978-3-319-12958-7
https://doi.org/10.1007/978-3-319-12958-7
	Increasing Photovoltaic Self-consumption: An Approach with Game Theory and Blockchain
	1 Introduction
	2 Optimisation Framework Using Game Theory
	2.1 Problem Formulation
	3 Optimisation Implementation
	3.1 Role of Blockchain
	3.2 Game Theory Algorithm
	3.3 Physical Model of the Real Grid
	4 Results
	5 Perspectives and Conclusion
	References