Designing Decentralized Markets for Distribution System Flexibility
2128 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 34, NO. 3, MAY 2019
Designing Decentralized Markets for Distribution
System Flexibility
Thomas Morstyn , Member, IEEE, Alexander Teytelboym , and Malcolm D. McCulloch , Senior Member, IEEE
Abstract—This paper introduces a decentralized market de-
sign, which allows a distribution system operator to manage local
demand constraints by obtaining flexibility from competing ag-
gregators, which must in-turn incentivize prosumers to provide
this flexibility. The novel networked market structure accounts
for distribution system operator-to-aggregator and aggregator-
to-prosumer ICT infrastructure and contractual arrangements,
which may limit which participants can negotiate transactions
with one another. The proposed flexibility market is opt-in for
prosumers, which continue to obtain energy within the existing
retail electricity market. At the same time, it is underpinned by
bilateral energy transactions, and could be integrated into future
peer-to-peer electricity markets. Through the market, the distribu-
tion system operator, aggregators, and prosumers reach agreement
on a stable outcome–a set of individually beneficial transactions no
group wishes to mutually deviate from. Market outcomes also sat-
isfy Pareto efficiency, meaning that it is not possible to make a
participant better off, without making another worse off.
Index Terms—Blockchain, demand-side response, distribution
network, distribution system operator, electricity markets, game
theory, market design, matching markets, peer-to-peer, prosumer,
smart grid, transactive energy.
NOMENCLATURE
| · | Number of elements of a set
[ · ] + max{ · , 0}
αt Difference between pbit and psit
β Element of {0, 1}
γi Agent i’s utility coefficient for early charging
Δp Price adjustment increment
κ(·) Selected contracts of an arrangement
τ(·) Underlying trades for a set of contracts
Φ Set of over-demanded trades
Ψ Subset of trades maximizing an agent’s utility
Ω Set of trades
ω A trade
A Set of agents
Manuscript received April 27, 2018; revised August 16, 2018 and Novem-
ber 2, 2018; accepted December 1, 2018. Date of publication December 11,
2018; date of current version April 17, 2019. This work was supported in
part by the Engineering and Physical Sciences Research Council (award ref-
erences EP/S000887/1 and EP/N03466X/1), and in part by the Oxford Martin
Programme on Integrating Renewable Energy. Paper no. TPWRS-00633-2018.
(Corresponding author: Thomas Morstyn.)
T. Morstyn and M. D. McCulloch are with the Department of Engineer-
ing Science, University of Oxford, Oxford OX1 2JD, U.K. (e-mail:, thomas.
morstyn@eng.ox.ac.uk; malcolm.mcculloch@eng.ox.ac.uk).
A. Teytelboym is with the Department of Economics, University of Oxford,
Oxford OX1 3UQ, U.K. (e-mail:,alexander.teytelboym@economics.ox.ac.uk).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TPWRS.2018.2886244
B Blocking set of contracts
a(·) Set of agents associated with a set of contracts
b(·) Buyer of a trade or contract
Ci(·) Agent i’s choice correspondence
c1j Aggregator j’s transaction cost coefficient
c2i Prosumer i’s battery cost coefficient
d The index of the DSO agent
Ei0 Agent i’s initial stored energy
[Eit , Ēit ] Agent i’s energy storage limits for time t
P Set of prosumer agents
Pd
it Agent i’s net inflexible demand for time t
P f
it Agent i’s planned retail flexible demand for t
[Pf
it , P̄
f
it ] Agent i’s flexible power limits for time t
PD
t Pre-flexibility market retail demand for time t
[PD
t , P̄
D
t ] Distribution network demand limits for time t
p Vector of contract prices
pbit Agent i’s retail energy price for time t
psit Agent i’s retail feed-in rate for time t
pω Price (or prices) of a trade (or set of trades)
pbω Buyer price of trade ω
psω Seller price of trade ω
RB
i (·) Agent i’s rejected upstream contracts
RS
i (·) Agent i’s rejected downstream contracts
S Set of aggregator agents
s(·) Seller of a trade or contract
T Number of time intervals
T Set of time intervals
tω Time interval of trade ω
Ui(·) Agent i’s utility function
uiE Agent i’s utility coefficient for stored energy
Vi(·) Agent i’s indirect utility function
X Set of available contracts
Xi Agent i’s contracts
x A contract
Y Set of available upstream contracts
Yi Agent i’s available upstream contracts
Y ∗
i Agent i’s selected upstream contracts
Yit Agent i’s upstream contracts for time t
y An upstream contract
Z Set of integers
Z Set of available downstream contracts
Zi Agent i’s available downstream contracts
Z∗
i Agent i’s selected downstream contracts
Zit Agent i’s downstream contracts for time t
z A downstream contract
z̄it Agent i’s net flexible demand for time t
0885-8950 © 2018 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:05:51 UTC from IEEE Xplore.  Restrictions apply. 
https://orcid.org/0000-0003-2781-9588
https://orcid.org/0000-0002-6570-1903
https://orcid.org/0000-0001-5378-1128
mailto:thomas.morstyn@eng.ox.ac.uk
mailto:thomas.morstyn@eng.ox.ac.uk
mailto:malcolm.mcculloch@eng.ox.ac.uk
mailto:alexander.teytelboym@economics.ox.ac.uk
MORSTYN et al.: DESIGNING DECENTRALIZED MARKETS FOR DISTRIBUTION SYSTEM FLEXIBILITY 2129
I. INTRODUCTION
THIS paper investigates how decentralized flexibility mar-
kets could be used to incentivize consumers with small-
scale energy resources, such as electric vehicles and home
batteries, to help manage distribution network demand consid-
ering existing retail electricity market arrangements.
Consumer-level flexible energy technologies are increasingly
being incorporated into distribution networks [1]. When com-
bined with consumer-level communications and processing,
these resources allow previously passive consumers to be-
come ‘prosumers’–consumers who proactively manage their
consumption, production and storage of energy [2].
Even in countries with liberalized electricity markets, pro-
sumers cannot directly participate in wholesale energy trading
due to their small size [3]. Instead, they are served in the re-
tail electricity market by a supplier that meters their individual
energy demand. This incentivizes prosumers to optimize their
demand ‘behind-the-meter’, but does not integrate their flexi-
bility into the overall operation of the power system [4].
Previously, distribution system operators (DSOs) have
managed local demand through long-term physical network
reinforcement [5]. However, without active coordination, the
introduction of distributed renewables and the electrification of
transport and heat are expected to lead to increasingly costly
distribution networks, with more severe demand variability re-
quiring investment in rarely used infrastructure [6].
Optimization approaches have been studied for coordinating
flexible energy resources in distribution networks and micro-
grids [7]–[10]. However, these strategies require a single DSO
or aggregator that can control all of the flexible energy resources.
These strategies do not address how prosumers can be incen-
tivized to provide flexibility, and do not consider prosumers who
may be willing to provide some flexibility, but may be unwilling
to cede full control [11].
Transactive energy mechanisms that instead incentivize co-
ordination are a promising approach for integrating the individ-
ual preferences and resource characteristics of prosumers [12].
Time-of-use energy prices, as well as unidirectional price sig-
nals rewarding demand response, have been proposed to shift
flexible loads to periods with low expected demand [13], [14].
A limitation is that new demand peaks can be created if all pro-
sumers follow the same signals [15]. Flexible resources need to
be coordinated in time, but also need to be coordinated relative
to one another.
Distributed optimization based on dual price variable ad-
justments can be considered analogous to an auction mecha-
nism [16]. Local energy market designs based on distributed
price-based optimization strategies are presented in [17]–[20].
However, these strategies require cooperation to achieve con-
vergence, since participants must implement correctly chosen
penalty terms when solving local sub-problems, rather than
making utility maximizing decisions. Local energy market de-
signs have also been proposed based on double-sided auctions
[21]–[24], mean-field game theory [25]–[27] and Stackelberg
leader-follower games [28]–[31]. Field trials of local energy
market designs have also been carried out in several countries
[32], [33]. However, barriers remain for designs which would
replace existing retail electricity markets, particularly if they ex-
pose small-scale consumers without flexible resources to whole-
sale energy price fluctuations [34].
An alternative approach is to retain existing retail market
arrangements, but to allow DSOs to organize additional local
flexibility markets to help manage constraints. Market designs
focused on incentivizing distribution system flexibility within
existing market arrangements are presented in [35]–[38]. The
designs in [35]–[37] focus on the negotiations between a DSO
and aggregators, but do not consider negotiations between ag-
gregators and the prosumers who will ultimately provide the
flexibility. In [38], a bi-level optimization approach is presented,
where a DSO sets flexibility prices and volumes based on full
information about the preferences and resource characteristics
of its supply chain of aggregators and prosumers. However, if
a DSO has limited information, it will not be able to use this
approach to obtain the flexibility it requires.
Recently, new designs for peer-to-peer (P2P) energy trad-
ing have been proposed for integrating prosumer flexibility into
power system operations [39]–[41]. Market designs allowing
prosumers to engage directly in bilateral energy transactions
have advantages for prosumers with preferences related to au-
tonomy, trust and privacy. If P2P energy trading platforms be-
come widespread, new mechanisms will be needed allowing
DSOs to engage and negotiate with aggregators and prosumers
to obtain flexibility [42].
In [43], it is recognized that within existing electricity mar-
ket arrangements a limiting factor for establishing new markets
for distribution system flexibility is a lack of liquidity, compro-
mising competition. This motivates the need for new market
designs that can integrate flexibility from multiple competing
aggregators and prosumers with diverse energy resources and
preferences.
This paper introduces a decentralized market design, which
allows a DSO to manage local demand constraints by obtain-
ing flexibility from competing aggregators, which must in-turn
incentivize prosumers to provide this flexibility. The novel net-
worked market structure accounts for DSO-to-aggregator and
aggregator-to-prosumer ICT infrastructure and contractual ar-
rangements, which may limit which participants can negotiate
transactions with one another. In addition, the market fulfills the
following design requirements:
� The flexibility market should be opt-in for prosumers, and
should account for their incentives within the retail elec-
tricity market.
� Even when acting autonomously and making individually
rational decisions, the DSO, aggregators and prosumers
should reach agreement on a stable outcome—a set of in-
dividually beneficial transactions no group wishes to mu-
tually deviate from.
� Market outcomes should satisfy Pareto efficiency, meaning
that it should not be possible to make one participant better
off without making another worse off.
This paper extends the authors’ previous work in [39], which
introduced networked matching market theory for P2P en-
ergy market design. Here, this framework is extended from
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:05:51 UTC from IEEE Xplore.  Restrictions apply. 
2130 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 34, NO. 3, MAY 2019
prosumer-to-prosumer energy trading, to flexibility trading be-
tween prosumers, aggregators and a DSO. In addition, the frame-
work is extended from single time interval trading, to multi time
interval trading. This allows time-dependent prosumer prefer-
ences to be incorporated; for example electric vehicle owners
that prefer charging sooner rather than later, and prosumers that
face retail energy prices that are time-of-use based.
The rest of this paper is organized as follows. Section II
presents the principle of operation for the proposed market de-
sign. Section III describes the DSO, aggregator and prosumer
preferences. Section IV sets out conditions establishing the exis-
tence of a stable market outcome. Section V describes the price-
negotiation mechanism. In Section VI, simulation case studies
are presented demonstrating the operation of the proposed mar-
ket design. Section VII concludes the paper. In the Appendix, it
is shown that the agent preferences satisfy the conditions for a
stable market outcome to exist.
II. DECENTRALIZED FLEXIBILITY MARKET DESIGN
The proposed flexibility market works alongside existing
retail electricity market arrangements in a distribution net-
work. It is assumed that the distribution network has a number
of prosumers–consumers with flexible energy resources, and
equipment for automated resource scheduling based on user
settings, such as a building or home energy management system
[44]. Each prosumer has a retail supplier, which meters their
individual net energy use (e.g. during each 30 minute interval of
the day). For each interval, each prosumer is charged for their
net energy use, at prices which may be time-of-use dependent,
and paid for their net exported energy [45].
It is assumed that the DSO is responsible for ensuring the
total demand in the distribution network does not exceed a max-
imum limit. The proposed flexibility market design allows the
DSO to incentivize demand flexibility from local prosumers to
achieve this. ICT infrastructure and contractual agreements may
be needed to facilitate the procurement of flexibility. Therefore,
rather than requiring the DSO to negotiate directly with each
prosumer, the proposed flexibility market is designed based on
a networked structure, with the DSO able to negotiate with inter-
mediary aggregators, and each aggregator in-turn able to negoti-
ate with certain prosumers. Direct prosumer-to-DSO trading can
also be incorporated if aggregators are not required. Throughout
the paper, the DSO, prosumers and aggregators participating in
the market are generically referred to as agents.
The DSO organizes a flexibility market if it predicts the dis-
tribution network demand limits could be violated. Prior to en-
tering the flexibility market, each prosumer first plans a demand
profile for their flexible energy resources, considering their costs
and preferences in the retail market, using their local energy
management systems.
The flexibility market is made up of a network of potential
flexibility contracts, with multiple contracts connecting each
pair of agents that are able to trade with one another. Fig. 1
shows a high-level diagram of a trading network for distribution
system flexibility. Each flexibility contract specifies a price the
seller will receive from the buyer for reducing demand during a
Fig. 1. A trading network for distribution system flexibility between a DSO,
aggregators, and local prosumers. Aggregators act as intermediaries between
a DSO and subscribed prosumers. The agents negotiate a set of flexibility
contracts, each representing an agreed reduction in demand during a particular
time interval.
particular retail market metering interval. Each contract speci-
fies the same energy quantity of demand reduction, but an agent
may accept multiple contracts for each time interval. The con-
tracts discretize the prosumers’ energy flexibility (in terms of
energy and time), and allow each discrete unit to be individually
priced. Multi-interval trading is important, since prosumers may
have storage systems with finite energy capacity. In this case,
their willingness to accept a contract specifying a price for a unit
of demand reduction during a particular interval will depend on
the price and availability of contracts at other time intervals.
The agents reach mutual agreement on a set of agreed con-
tracts and contract prices through an iterative price-negotiation
mechanism. At each step of the market, agents select their
favorite bundle of available upstream and downstream con-
tracts, and over-demanded contracts have their prices increased.
The process continues until no price changes occur during an
iteration.
This paper focuses on how a DSO can negotiate to obtain
particular amounts of demand shifting at particular times, once
other methods have been used to predict the amount of shifting
that is required. Forecasting methods for distribution network
demand are presented in [46], [47]. Only day-ahead trading
is considered, but additional trading closer to real-time could
be added, allowing agents to renegotiate based on updated de-
mand predictions. In this case, prosumer-to-prosumer transac-
tions could be included, allowing prosumers to negotiate with
peers to fulfil their previously negotiated flexibility obligations.
A 24-hour trading period is considered, given that home bat-
teries are generally scheduled with a single charge-discharge
cycle per day to flatten local PV generation, and electric ve-
hicles are generally scheduled to recharge overnight. Longer
trading periods may be desirable for flexible resources that have
multi-day cycles, for example electric vehicles with different
usage patterns between weekdays and weekends.
An advantage of the proposed flexibility market design is
that it is integrated within existing retail electricity market ar-
rangements. This maintains the important service which retail
suppliers provide by aggregating demand variability across a
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:05:51 UTC from IEEE Xplore.  Restrictions apply. 
MORSTYN et al.: DESIGNING DECENTRALIZED MARKETS FOR DISTRIBUTION SYSTEM FLEXIBILITY 2131
large number of consumers and providing stable energy prices
so that consumers are not directly exposed to wholesale energy
price fluctuations.
III. AGENT PREFERENCES
Let A be the set of agents in the trading network. In the flex-
ibility market, the agents trade flexibility contracts for a set of
time intervals T = {1, . . . , T}. Each flexibility contract speci-
fies a price for a flexibility trade, specifing an agreed reduction
in demand during a particular time interval. Note that all trades
specify the same energy quantity of demand reduction.
Let X be the set of contracts between the agents. A contract
x ∈ X can be described by a tuple (ω, tω , pω ), where ω ∈ Ω
is a unique trade ID, tω is the time interval of the underlying
trade and pω is the price specified by the contract for the trade.
The trades underlying a set of contractsX are given by τ(X) =
{ω ∈ Ω|(ω, tω , pω ) ∈ X}.
Each contractx, and its underlying tradeω, has a buyer b(x) =
b(ω) ∈ A and a seller s(x) = s(ω) ∈ A. The set of contracts
available to agent i is given byXi = {x ∈ Xi |i ∈ b(x) ∪ s(x)}.
These can be divided into a set of upstream contracts Yi , and a
set of downstream contracts Zi ,
Yi = {y ∈ Xi |b(y) = i}, Zi = {z ∈ Xi |s(z) = i}. (1)
These can be further divided into upstream and downstream
contracts associated with each time interval t ∈ T , given by,
Yit = {(φ, tφ , pφ) ∈ Xi |b(φ) = i, tφ = t},
Zit = {(ω, tω , pω ) ∈ Xi |s(ω) = i, tω = t}. (2)
The agents associated with a set of contracts X are given by
a(X) = {∪x∈X b(x), s(x)}
Each agent i ∈ A has a utility function Ui which describes
its preferences over sets of contracts. The subset of contracts
selected by the agent are given by its choice correspondence,
Ci(X) = argmax
X ′
i⊆Xi
Ui(X ′
i). (3)
A. Prosumer Preferences
LetP ⊆ A be the set of prosumers in the trading network. The
prosumers have renewable sources, inflexible loads and flexible
energy resources. The prosumers sell contracts for time intervals
when they are willing to reduce their planned retail market
demand. If prosumers own local flexible generation sources,
they can directly sell flexibility contracts. Prosumers with energy
storage systems may only be willing to sell contracts if they are
able to buy contracts for other time intervals allowing them to
increase their retail demand.
Prosumer i ∈ P has a net inflexible demand given by Pd
it , t ∈
T . The prosumer pays time-of-use dependent retail energy
prices pbit for its net demand, and sells excess energy at a feed-in
rate of psit . Unsubsidized feed-in rates are generally lower than
retail energy prices, since prosumer generation is not treated
as dispatchable, and is therefore considered to be less valuable
than energy obtained in the wholesale market [45]. Therefore,
it is assumed that pbit ≥ psit ≥ 0,∀t ∈ T .
Prosumer i’s flexible energy resource is modeled as a flexible
load with energy storage capacity. Let Ei0 be the initial stored
energy and for each time interval t ∈ T , let [Pf
it , P̄
f
it ] be the
output power limits and let [Eit , Ēit ] be the energy storage
limits. A range of flexible loads can be modeled using these
time varying constraints, for example electric vehicles which
must be recharged during certain hours.
Additional costs terms can be used to model prosumer pref-
erences associated with different types of flexible resources. In
this study, two types of flexible resources are considered, bat-
tery systems and electric vehicles. For the battery systems, a
quadratic cost term ci2 ≥ 0 is included to model a degradation
rate that increases with higher output power [48]. For the elec-
tric vehicles, it is assumed that in addition to only being able
to charge while parked, charging sooner may be preferable to
charging later. A utility coefficient γi ≥ 0 is included to model
the additional utility associated with having extra energy avail-
able earlier.
Before engaging with the flexibility market, the prosumer
calculates the optimal schedule for its flexible energy resource
in the retail market, Pf
it , t ∈ T , considering its constraints and
preferences. This is envisaged as being automated and com-
pleted by an energy management system based on user con-
trolled settings (see e.g. [44]). Note that a key component of an
energy management system is a tool for local demand forecast-
ing [49].
In the flexibility market, for upstream contracts Yi and down-
stream contracts Zi , prosumer i’s utility function is,
Ui(Yi ∪ Zi) =
∑
(ω,tω ,pω )∈Zi
(pω + γitω ) −
∑
(φ,tφ ,pφ )∈Yi
(pφ + γitφ)
+
∑
t∈T
[
psit [P
f
it − Pd
it − |Yit | + |Zit |] +
− pbit [P
d
it − Pf
it+|Yit | − |Zit |] + −c2i(Pf
it − |Yit | + |Zit |)2
]
,
if Pf
it ≤ Pf
it − |Yit | + |Zit | ≤ P̄ f
it ,∀t ∈ T ,
Eiτ ≤ Ei0 −
τ∑
t=1
(Pf
it − |Yit | + |Zit |) ≤ Ēiτ ,∀τ ∈ T ,
Ui(Yi ∪ Zi) = −∞, otherwise. (4)
Quantities have per-contract units. For example, if each contract
is associated with 0.5 kWh of energy, then Pf
it , P
d
it , Ei0 have
units of 0.5 kWh, psit , p
b
it have units of £/0.5 kWh and γi has
units of £/0.5 kWh/h.
Within the proposed framework, alternative utility functions
can be considered for prosumers with different energy resources
or preferences. For example, prosumers may value having en-
ergy stored in their battery at the end of the trading period. This
could be represented by an additional utility function term of
form uiE (
∑T
t=1(|Yit | − |Zit | − Pf
it ) in (4), where uiE is the
value placed on stored energy.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:05:51 UTC from IEEE Xplore.  Restrictions apply. 
2132 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 34, NO. 3, MAY 2019
The proposed market design assumes that prior to the flexi-
bility market, each prosumer calculates a retail market schedule
for their flexible energy resources Pf
it , t ∈ T which they would
prefer in the absence of external rewards. For this paper, each
prosumer’s retail market schedule was calculated by reformu-
lating (4) as a maximization problem, with decision variables
Pf
it , t ∈ T , while Yit = ∅, Zit = ∅,∀t ∈ T and with an addi-
tional utility term γi
∑
t∈T tP
f
it .
B. DSO Preferences
The trading network has a single DSO, d ∈ A, which must
manage minimum and maximum limits on the total distribution
network demand during each time interval, [PD
t , P̄
D
t ]. The DSO
buys flexibility contracts for time intervals when the predicted
pre-flexibility market retail demand PD
t , t ∈ T , violates the
maximum demand limits, and can sell contracts during uncon-
strained intervals. For upstream contracts Yd and downstream
contracts Zd , the DSO’s utility function is given by,
Ud(Yd ∪ Zd) =
∑
(ω,tω ,pω )∈Zd
pω −
∑
(φ,tφ ,pφ )∈Yd
pφ ,
if PD
t ≤ PD
t − |Ydt | + |Zdt | ≤ P̄ D
t ,∀t ∈ T ,
Ud(Yd ∪ Zd) = −∞, otherwise. (5)
C. Aggregator Preferences
Let S ⊆ A be the set of aggregators in the trading network.
The aggregators act as intermediaries, buying and selling flex-
ibility contracts from the DSO and prosumers. It is assumed
that the aggregators do not consume, store or generate energy.
Therefore, their total upstream and downstream contracts for
each time interval must be balanced. It is assumed that aggrega-
tor j ∈ S incurs a transaction cost for each accepted upstream
contract, c1j ≥ 0.
In the flexibility market, for upstream contracts Yj and down-
stream contracts Zj , aggregator j’s utility function is given by,
Uj (Yj ∪ Zj ) =
∑
(ω,tω ,pω )∈Zj
pω −
∑
(φ,tφ ,pφ )∈Yj
pφ − c1j |Yj |,
if |Yjt | = |Zjt |,∀t ∈ T ,
Uj (Yj ∪ Zj ) = −∞, otherwise (6)
The aggregator preferences can be extended to handle sit-
uations where the aggregators have their own flexibile energy
resources (e.g. community-scale energy storage systems [50]).
In this case, the upstream-downstream contract balance con-
straint |Yjt | = |Zjt |,∀t ∈ T would be replaced by the power
and energy constraints from the prosumer preferences (4).
IV. MARKET STABILITY AND EFFICIENCY
For a trading network with contracts X , an outcome is a
feasible set of contracts X ′ ⊆ X , where X ′ is feasible if each
trade ω ∈ τ(X ′) is associated with at most one contract, and
therefore has a unique price.
A key aim for market design is to ensure stable outcomes exist,
which agents are able to find through negotiation. If agents are
not able to agree on a stable outcome within the market, they
will have an incentive to leave and renegotiate outside of it [51].
This paper uses the definition for stable outcomes in matching
markets from [52]:
Definition 1: An outcome X ′ is stable if it is:
1) Individually Rational: X ′
i ∈ Ci(X ′) for all i ∈ A.
2) Unblocked: There is no feasible non-empty set B ⊆ X ,
such thatB ∩X ′ = ∅ andBi ⊆ Ci(B ∪X ′),∀i ∈ a(B).
In other words, an outcome is stable as long as no agent would
prefer to drop a contract they are associated with, and no group
of agents would prefer to mutually deviate to a different set of
contracts.
For upstream contracts Y and downstream contracts Z, let
agent i’s rejected sets of upstream and downstream contracts be
defined respectively as,
RB
i (Y |Z) = {y ∈ Y |b(y) = i, y /∈ Ci(Y ∪ Z)}, (7)
RS
i (Z|Y ) = {z ∈ Z|s(z) = i, z /∈ Ci(Y ∪ Z)}. (8)
In [52], it is shown that stable outcomes are guaranteed to exist
when the preferences of the agents satisfy full substitutability.
Definition 2: The preferences of agent i are fully substi-
tutable if, for any upstream contracts Y ′ ⊆ Y and downstream
contracts Z ′ ⊆ Z, the agent’s choice correspondence is:
1) Same-Side Substitutable: RB
i (Y ′|Z) ⊆ RB
i (Y |Z) and
RS
i (Z ′|Y ) ⊆ RS
i (Z|Y ).
2) Cross-Side Complementary:RB
i (Y |Z) ⊆ RB
i (Y |Z ′) and
RS
i (Z|Y ) ⊆ RS
i (Z|Y ′).
In other words, an agent’s preferences are fully substitutable
if, when offered additional contracts, they continue to reject
previously rejected same-side contracts, and continue to accept
previously accepted cross-side contracts.
Theorem 1: The prosumer, generator and aggregator prefer-
ences described by (4), (5), (6) satisfy full substitutability.
Proof of Theorem 1: See the Appendix. �
Note that stable outcomes coincide with competitive
equilibria–sets of prices for transactions that balance supply
and demand [52]. Also, since the agents can transfer utility
through payments, stable outcomes are Pareto efficient, mean-
ing no agent can be made better off without making another
agent worse off [53].
V. PRICE NEGOTIATION AND CONTRACT SELECTION
The fact that the agent preferences are fully substitutable has
two further consequences. First, the trading network can reach
agreement on a stable outcome using the deferred-acceptance
agent-to-agent price-negotiation mechanism from [54]. Second,
agents can use a computationally scalable process to select sets
of contracts that will maximize their utility, since their prefer-
ences satisfy the single improvement property [55].
A. Price-Negotiation Mechanism
The proposed flexibility market design requires only indi-
vidual decision making and agent-to-agent negotiation between
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:05:51 UTC from IEEE Xplore.  Restrictions apply. 
MORSTYN et al.: DESIGNING DECENTRALIZED MARKETS FOR DISTRIBUTION SYSTEM FLEXIBILITY 2133
Fig. 2. A flowchart showing the agent-to-agent price-negotiation mechanism.
the DSO, aggregators and prosumers. Agents wishing to obtain
flexibility make progressively higher offers to potential sellers,
and sellers choose to accept or reject these offers. Each itera-
tion, the prices of over-demanded flexibility trades increase by a
minimum price-increment Δp, until each trade has been either
selected by both its buyer and seller, or rejected by both its buyer
and seller.
A flow chart of the price-negotiation process is shown in
Fig. 2. Each agent i ∈ A starts by specifying the flexibility
trades they may be willing to make. Let Ω be the full set of
trades in the market. Each trade ω ∈ Ω is assigned a buyer price
pbω and a seller price psω . Initially, pbω = 0 and psω = 0 for all
ω ∈ Ω. The agents then engage in iterative negotiation with
their neighbors. Each iteration:
� Each agent i ∈ A constructs a set of upstream contracts
to choose from, Yi = {(ω, tω , pbω )|ω ∈ Ω, b(ω) = i} and
a set of downstream contracts to choose from, Zi =
{(ω, tω , psω )|ω ∈ Ω, s(ω) = i}.
� Each agent i ∈ A selects its favorite set of upstream con-
tracts Y ∗
i = Ci(Yi ∪ Zi) ∩ Yi and downstream contracts
Z∗
i = Ci(Yi ∪ Zi) ∩ Zi .
� The prices of over-demanded trades are increased. The
set of over-demanded trades is given by Φ = {ω ∈
Ω|(ω, tω , pω ) ∈ Y ∗
b(ω ) , ω /∈ Z∗
s(ω )}. For each ω ∈ Φ, if
pbω > psω , then psω is increased by Δp; otherwise, pbω is
increased by Δp.
The negotiation is complete when no price changes occur
during an iteration. ∪i∈AY ∗
i is a stable outcome for the trading
network.
Note that if the prosumer resources have sufficient flexibility
to satisfy the DSO’s demand constraints, then the constraints
will be satisfied at the end of the price-negotiation. The DSO
will continue to offer higher prices for unrealized contracts re-
quired to meet its demand constraints, as long as the constraints
are not satisfied. Eventually, these contracts will become suffi-
ciently valuable, so that they are also selected by the associated
prosumers and aggregators.
B. Contract Selection
During each iteration of the price-negotiation mechanism,
agents need to select a subset of contracts from those they are
offered that will maximize their utility. Since the agent pref-
erences satisfy full substitutability they also satisfy the single
improvement property [55].
Definition 3: Agent i’s preferences satisfy the single im-
provement property if, for any suboptimal subset of contracts
X ′, such that Ui(X ′) �= −∞, the agent can increase their utility
by making one of the following local adjustments:
1) Adding or removing a single upstream or downstream
contract.
2) Adding or removing both an upstream and downstream
contract.
Given the single improvement property, the agents can use the
following process to select utility-maximizing contract subsets.
A flow chart of the contract selection process for the prosumers
is shown in Fig. 3.
First, the agents need to ensure their constraints are not vi-
olated. The prosumers and DSO have maximum power limits.
For each time interval when their maximum power limit is vi-
olated, they should select upstream contracts starting with the
lowest priced contracts, until the violation is cleared. Similarly,
high priced downstream contracts should be selected for each
time interval until their minimum power limits are not violated.
The prosumers also need to ensure their energy storage con-
straints are not violated. The prosumers should identify the
time intervals when their energy storage limits are violated,
and should clear each violation in order from earliest to latest.
To clear maximum energy violations, prosumers should select
downstream contracts for preceding intervals, ensuring they do
not introduce new power or energy constraint violations. The
downstream contracts with the highest prices available at each
suitable time interval should be compared, to see which gives the
greatest increase in marginal utility for the unconstrained util-
ity function. Similarly, the prosumers should select low priced
upstream constraints to clear minimum energy level violations.
Once the agents have selected the minimum number of con-
tracts necessary to meet their constraints, they should select
additional contracts which increase their utility. Iteratively, the
agents need to assess the marginal utility provided by each of the
lowest priced upstream contracts still available at each time in-
terval, the highest priced downstream contracts still available at
each interval and upstream-downstream pairs of these contracts.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:05:51 UTC from IEEE Xplore.  Restrictions apply. 
2134 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 34, NO. 3, MAY 2019
Fig. 3. A flowchart showing the contract selection process for the prosumers.
Contract selection is similar for the DSO and aggregators, but without step 2,
which addresses the prosumers’ energy constraints.
The option or options providing the greatest increase in utility
should be selected. When none of these options provides further
utility, a utility maximizing subset of contracts has been selected.
VI. RESULTS
Simulation case studies were completed to verify the opera-
tion of the proposed market design, using the IEEE European
Low Voltage Test Feeder [56]. As shown in Fig. 4, the distri-
bution network has 55 prosumers. Prosumers 1–30 have 4 kW
PV sources and 4 kWh, 2 kW rated home battery systems,
prosumers 31–45 have electric vehicles which they charge at
home using 3 kW unidirectional chargers and prosumers 46–55
do not have flexible energy resources. Two case studies are pre-
Fig. 4. IEEE European low voltage test feeder with 55 prosumers.
sented, Case Study A which considers batteries with a relatively
low cost of degradation, and Case Study B which considers
batteries with a higher cost of degradation.
The IEEE European Low Voltage Test Feeder is 415 V
50 Hz 3-phase UK distribution feeder, with 55 single-phase
consumers. For the case studies, the flexibility market is im-
plemented to allow the DSO to manage the combined demand
across the three phases. The flexibility market is designed based
on a simplified model of distribution network demand. For real-
istic verification, the power flows, losses and voltages resulting
from the market outcome have been calculated using a 3-phase
unbalanced power flow model [57].
The DSO organizes a flexibility market to limit the distri-
bution network demand to 75 kW. There are two aggregators
acting as intermediaries between the DSO and the prosumers.
Aggregator 1 trades with prosumers 1–30 (the prosumers with
home batteries) and aggregator 2 trades with prosumers 31–45
(the prosumers with electric vehicles). Note that prosumers 46–
55 do not participate in the flexibility market since they do not
have flexible energy resources.
Smart meter data from the UK Customer-Led Network Revo-
lution project was used for the prosumer load and PV generation
profiles [58]. Data made available by NREL was used for the
energy required by the electric vehicles [59]. Vehicle arrival and
departure times were generated randomly, assuming normal dis-
tributions with mean times of 6 pm and 7 am respectively, and
one hour standard deviations.
The prosumers face time-of-use dependent retail energy
prices of £0.15/kWh from 7 am to 11 pm and £0.07/kWh from 11
pm to 7 am. The prosumers are paid a feed-in rate of £0.04/kWh
for excess energy they export.
The flexibility market occurs over a 24 hour period (from 8 am
to 8 am), with contracts specifying an agreed decrease in load
by 1 kW during a particular 30 minute interval. A market price
increment of Δp =£0.005/kWh is used. For prosumers 1–30,
the increased battery degradation that occurs at higher output
powers is modeled with a quadratic cost coefficient c2i . For Case
Study A, c2i = £0.01/(kWh)2 , whereas in Case Study B the rate
of degradation is higher, c2i = £0.06/(kWh)2 . It is assumed the
batteries start at their minimum energy level at 8 am and must be
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:05:51 UTC from IEEE Xplore.  Restrictions apply. 
MORSTYN et al.: DESIGNING DECENTRALIZED MARKETS FOR DISTRIBUTION SYSTEM FLEXIBILITY 2135
Fig. 5. Case Study A (low battery degradation): The total prosumer demand
planned in the retail market, and the demand following the flexibility market.
For each case, the additional power imported from the main grid due to losses
is also shown.
Fig. 6. Case Study A (low battery degradation): The total home battery out-
put power for prosumers 1–30 planned in the retail market and following the
flexibility market.
returned to this energy level by 8 am the next day. For prosumers
31–45, it is assumed they need to fully re-charge their electric
vehicles between their arrival and departure times, and also
have a preference for early charging, with γi = £0.01/kWh/h.
The aggregators incur a transaction cost of c1i = £0.01 for each
accepted upstream contract.
Each prosumer has a different load profile, and the electric
vehicle owners each have a different arrival time, departure time
and energy requirement for their vehicle. Common cost coeffi-
cients have been used for the prosumers of each type, so that
the impact of changing the degradation cost coefficient values is
clear between the two case studies. However, the market design
does not restrict agents from having different utility functions
and different cost coefficients. In particular, there are significant
differences between the utility functions of prosumers 1–30
(the prosumers with home batteries) compared with prosumers
31–45 (the prosumers with electric vehicles).
For Case Study A, Fig. 5 shows the total prosumer demand
planned in the retail market, and the demand following the
flexibility market. For each case, the additional power imported
from the main grid due to losses is also shown. In the retail
market, demand peaks occur at 6 pm and 11 pm. The 11 pm
peak is caused by electric vehicle owners waiting for the lower
retail price period before charging. In the flexibility market, the
DSO incentivizes the prosumers to shift their flexible loads so
that the 75 kW maximum demand limit is not violated.
Fig. 6 shows the total home battery output power for pro-
sumers 1–30 planned in the retail market and following the
flexibility market. Fig. 7 shows the total electric vehicle out-
put power for prosumers 31–45. Through the flexibility market,
the battery owners are incentivized to discharge their batter-
ies earlier to flatten the 6 pm demand peak. Also, the battery
owners have a second charging cycle which is shifted later (but
Fig. 7. Case Study A (low battery degradation): The total electric vehicle
output power for prosumers 31–45 planned in the retail market and following
the flexibility market.
Fig. 8. Case Study A (low battery degradation): The range of voltage magni-
tudes across the distribution network load buses due to the planned retail market
demand and the demand following the flexibility market.
Fig. 9. Case Study B (high battery degradation): The total prosumer demand
planned in the retail market, and the demand following the flexibility market.
For each case, the additional power imported from the main grid due to losses
is also shown.
still within the period with low retail prices) so that it does
not coincide with the electric vehicles’ 11 pm charging cycle.
Only a small amount of electric vehicle demand is shifted, since
the electric vehicle owners prefer early charging and therefore
would require more compensation to provide the same level of
flexibility as the prosumers with home batteries.
Fig. 8 shows the range of voltage magnitudes across the dis-
tribution network load buses due to the planned retail market
demand and the demand following the flexibility market. The
peak-shaving facilitated by the flexibility market increases the
minimum voltage magnitude from 0.930 pu to 0.945 pu.
For Case Study B, when the battery energy storage systems
have a higher degradation cost, Fig. 9 shows the total prosumer
demand. As shown in Fig. 10, the higher battery degradation
cost results in reduced battery utilisation being planned in the
retail market, relative to Case Study A. In the flexibility market,
the batteries are charged when PV generation is available, and
discharged to maintain the 75 kW demand limit. Fig. 11 shows
that the electric vehicle charging profiles are similar between
the two case studies. As shown in Fig. 12, the flexibility market
results in lower voltage rise due to a reduction in exported PV
generation.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:05:51 UTC from IEEE Xplore.  Restrictions apply. 
2136 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 34, NO. 3, MAY 2019
Fig. 10. Case Study B (high battery degradation): The total home battery
output power for prosumers 1–30 planned in the retail market and following the
flexibility market.
Fig. 11. Case Study B (high battery degradation): The total electric vehicle
output power for prosumers 31–45 planned in the retail market and following
the flexibility market.
Fig. 12. Case Study B (high battery degradation): The range of voltage magni-
tudes across the distribution network load buses due to the planned retail market
demand and the demand following the flexibility market.
Fig. 13. The total revenue accumulated by different groups of agents in the
flexibility market during case studies A and B.
Fig. 13 shows the total revenue accumulated by different
groups of agents in the flexibility market. Most of the flexibility
is provided by the prosumers with battery systems (prosumers
1–30), and thus they accumulate more revenue than the pro-
sumers with electric vehicles (prosumers 31–45). Aggregator
1, which trades with prosumers 1–30, receives more revenue
than aggregator 2, since it is responsible for coordinating more
transactions. The revenue accumulated by the prosumers and
aggregators is matched by the payments made by the DSO. Pro-
sumers 46–55 receive no revenue since they do not participate
in the flexibility market. Prosumers 1–30 recieve significantly
more revenue during Case Study B since they must be compen-
sated for their higher battery degradation costs.
VII. CONCLUSION
A decentralized market design has been presented, allowing a
DSO to manage local demand constraints by obtaining flexibility
from a supply chain of aggregators and prosumers with small-
scale flexible energy resources. A key advantage of the proposed
market design is that it can be implemented alongside existing
retail electricity market arrangements. The market design could
help integrate flexibility from prosumers with preferences for
autonomy and privacy, since it requires only individual decision
making and aggregator-to-prosumer negotiation. Prosumers can
individually decide whether to participate or not, and the con-
ditions under which they are willing to provide flexibility.
A limitation of the design is that it only allows the DSO
to manage the overall distribution network demand. Reducing
peak demand still approximately addresses voltage limits and
power flow limits at the transformer. Also, it has the potential
advantages of not requiring a detailed network model and treat-
ing flexibility provided by prosumers equally. However, there is
a trade-off when considering the proposed market design, com-
pared with centralized designs with more detailed distribution
network models that directly account for losses, reactive power
flows and voltage limits.
An interesting area for future work is whether the price-
negotiation mechanism can be sped up by allowing for asyn-
chronous price adjustments, while mitigating the trade-off with
economic efficiency. Detailed assessments of the required ICT
infrastructure and associated costs will be required prior to im-
plementation. Since the market design is underpinned by bi-
lateral transactions, it could also be integrated into future P2P
electricity markets.
APPENDIX
In this appendix, it is shown that the prosumer, DSO and ag-
gregator preferences from Section III satisfy full substitutability.
The following definition for an agent’s indirect utility function,
from [55], is needed.
Definition 4: The indirect utility function of agent i is given
by Vi(p) = maxΨ⊆Ω i
{Ui(κ([Ψ|p]))}, where Ωi is the set of
trades that are available for agent i to buy or sell, p is a vector of
prices for all trades in the market, Ψ ⊆ Ωi is a subset of available
trades which maximize agent i’s utility and κ([Ψ|p]) gives the
set of contracts associated with Ψ ⊆ Ωi , given the price vector p.
The preferences of an agent are fully substitutable, if and
only if they induce a submodular indirect utility function Vi .
To show Vi is submodular, it is enough to show that for any
two trades φ, ψ ∈ Ωi and prices pΩ ′
i
∈ R|Ω i \{ψ ,φ}|, phφ ≥ pφ ,
phψ ≥ pψ [55],
Vi(pΩ ′
i
, pφ , p
h
ψ ) − Vi(pΩ ′
i
, phφ , p
h
ψ ) ≥
Vi(pΩ ′
i
, pφ , pψ ) − Vi(pΩ ′
i
, phφ , pψ ). (9)
The following contracts are introduced, yφ = (φ, tφ , pφ), yψ =
(ψ, tψ , pψ ), zφ = (φ, tφ , phφ), zψ = (ψ, tψ , phψ ).
Proof of Theorem 1: First, a generic agent utility functionU ′
i
is formulated, based on the prosumer utility function (4), with
the cost term −c1i |Yi | from the aggregator utility function (6)
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:05:51 UTC from IEEE Xplore.  Restrictions apply. 
MORSTYN et al.: DESIGNING DECENTRALIZED MARKETS FOR DISTRIBUTION SYSTEM FLEXIBILITY 2137
added in. The prosumer, DSO and aggregator utility functions
(4), (5), (6) are special cases of U ′
i .
Given agent utility functions with formU ′
i , the marginal utility
provided by a contract only depends on: (i) its price; (ii) the
difference between the number of previously accepted upstream
and downstream contracts with the same time interval; and (iii)
the difference between the total number of previously accepted
upstream and downstream contracts with the same time interval
or a preceding one. Therefore, when an additional upstream
(or downstream) contract becomes available, the net number of
upstream (or downstream) contracts will either increase by one
or stay the same (depending on whether the contract is accepted,
accepted instead of a previously accepted contract of the same
type, accepted along with a previously rejected contract of the
opposite type, or rejected). Therefore, to show that preferences
described byU ′
i satisfy (9), it is sufficient to show that (10)–(13)
are satisfied.
U ′
i(Y
′
φi ∪ Zi ∪ yφ) − U ′
i(Yi ∪ Zi)
≥ U ′
i(Y
′′
i ∪ Zi ∪ yφ ∪ yψ ) − U ′
i(Y
′
ψi ∪ Zi ∪ yψ ), (10)
U ′
i(Y
′
φi ∪ Z ′
ψi ∪ yφ ∪ zψ ) − U ′
i(Yi ∪ Z ′′
i ∪ zψ )
≥ U ′
i(Y
′′
i ∪ Zi ∪ yφ) − U ′
i(Yi ∪ Zi), (11)
U ′
i(Yi ∪ Zi) − U ′
i(Yi ∪ Z ′′
i ∪ zφ)
≥ U ′
i(Y
′′
i ∪ Zi ∪ yψ ) − U ′
i(Y
′
ψi ∪ Z ′
φi ∪ zφ ∪ yψ ), (12)
U ′
i(Yi ∪ Z ′
ψi ∪ zψ ) − U ′
i(Yi ∪ Z ′′
i ∪ zφ ∪ zψ )
≥ U ′
i(Yi ∪ Zi) − U ′
i(Yi ∪ Z ′
φi ∪ zφ), (13)
where upstream contracts yφ , yψ /∈ Yi , Y ′′
i ⊆ Y ′
φi ⊆ Yi , Y ′′
i ⊆
Y ′
ψi ⊆ Yi , |Yi | ≤ |Y ′
φi | + 1 ≤ |Y ′′
i | + 2, and |Yi | ≤ |Y ′
ψi | + 1 ≤
|Y ′′
i | + 2. Also, downstream contracts zφ , zψ /∈ Zi ,Z ′′
i ⊆ Z ′
φi ⊆
Zi , Z ′′
i ⊆ Z ′
ψi ⊆ Zi , |Zi | ≤ |Z ′
φi | + 1 ≤ |Z ′′
i | + 2 and |Zi | ≤
|Z ′
ψi | + 1 ≤ |Z ′′
i | + 2.
Conditions (10)–(13) reflect (9) when φ, ψ are upstream
trades and are selected at pφ , pψ , but not phφ , p
h
ψ , and when φ, ψ
are downstream trades and selected at phφ , p
h
ψ , but not pφ , pψ .
Note that for cases when φ is selected or rejected at both pφ , phφ
and/or ψ is selected at both pψ , phψ , (9) results in an equality.
Let z̄it = Pf
it − |Yit | + |Zit | and let pbit = psit + αt ≥ 0,
where αt ≥ 0.
First, to show (10) is true, 5 cases need to be considered:
Case 1: |Y ′′
i | = |Y ′
φi | = |Y ′
ψi | = |Yi |. When tφ �= tψ , (10) re-
sults in an equality. When tφ = tψ , (10) requires,
−αtφ [Pd
itφ
− z̄itφ + 1] + − c2i(z̄itφ − 1)2 + αtφ [Pd
itφ
− z̄itφ ] +
+ c2i(z̄itφ )2 ≥ −αtφ [Pd
itφ
− z̄itφ + 2] + − c2i(z̄itφ − 2)2
+ αtφ [Pd
itφ
− z̄itφ + 1] + + c2i(z̄itφ − 1)2 ,
which is true for all αtφ ≥ 0, c2i ≥ 0 and Pd
itφ
, z̄itφ ∈ Z.
Case 2: |Y ′
ψi | = |Yi | and |Y ′′
i | = |Y ′
φi | = |Yi | − 1. In this
case, tφ �= tψ since |Y ′
ψi | �= |Y ′
φi |. Condition (10) results in an
equality.
Case 3: |Y ′
φi | = |Yi | and |Y ′′
i | = |Y ′
ψi | = |Yi | − 1. In this
case, tφ �= tψ since |Y ′
ψi | �= |Y ′
φi |. Condition (10) results in an
equality.
Case 4: |Y ′
φi | = |Y ′
ψi | = |Yi | − 1 and |Y ′′
i | = |Yi | − 2. For
both tφ = tψ and tφ �= tψ , condition (10) results in an equality.
Case 5: |Y ′
φi | = |Y ′
ψi | = |Yi | and |Y ′′
i | = |Yi | − 1. Let Yi =
Y ′′
i ∪ (h, th , ph). Condition (10) requires,
− psith − αth [Pd
ith
− z̄ith + β] + − c2i(z̄ith − β)2 − c1i − ph
− γith ≥ −αth [Pd
ith
− z̄ith − 1 + β] + − c2i(z̄ith + 1 − β)2
where β = 0 if th �= tφ and th �= tψ , and β = 1 otherwise.
This is true, since U ′
i(Yi ∪ Zi ∪ yφ) ≥ U ′
i(Y
′′
i ∪ Zi ∪ yφ) and
U ′
i(Yi ∪ Zi ∪ yψ ) ≥ U ′
i(Y
′′
i ∪ Zi ∪ yψ ), and therefore contract
(h, th , ph) provides non-negative marginal utility when selected
alongside either {Zi ∪ Y ′′
i ∪ yφ} or {Zi ∪ Y ′′
i ∪ yψ}.
To show (11) is true, 4 cases need to be considered:
Case 1: |Y ′′
i | = |Y ′
φi | = |Yi |, |Z ′′
i | = |Z ′
ψi | = |Zi |. When
tφ �= tψ , (11) results in an equality. When tφ = tψ , (11) re-
quires,
−αtφ [Pd
itφ
− z̄itφ ] + − c2i(z̄itφ )2 + αtφ [Pd
itφ
− z̄itφ − 1] +
+ c2i(z̄itφ + 1)2 ≥ −αtφ [Pd
itφ
−z̄itφ + 1] + − c2i(z̄itφ − 1)2
+ αtφ [Pd
itφ
− z̄itφ ] + + c2i(z̄itφ )2 ,
which is true for all αtφ ≥ 0, c2i ≥ 0 and Pd
itφ
, z̄itφ ∈ Z.
Case 2: |Y ′′
i | = |Y ′
φi | = |Yi |, |Z ′′
i | + 1 = |Zψi | = |Zi |. Let
Zi = Z ′′
i ∪ (l, tl , pl). Condition (11) requires,
psitl − αtl [P
d
itl
− z̄itl − β] + − c2i(z̄itl + β)2 + pl
+ γitl ≥ −αtl [Pd
itl
− z̄itl + 1 − β] + − c2i(z̄itl − 1 + β)2
where β = 1 if tl = tψ �= tφ , and β = 0 otherwise. This is
true, since U ′
i(Yi ∪ Zi ∪ yφ ∪ zψ ) ≥ U ′
i(Yi ∪ Z ′′
i ∪ yφ ∪ zψ ),
and therefore contract (l, tl , pl) provides non-negative marginal
utility when selected alongside {Yi ∪ Z ′′
i ∪ yφ ∪ zψ}.
Case 3: |Y ′′
i | + 1 = |Y ′
φi | = |Yi |, |Z ′′
i | = |Zψi | = |Zi |. Let
Yi = Y ′′
i ∪ (h, th , ph). Condition (11) requires,
− psith − αth [Pd
ith
− z̄ith + β] + − c2i(z̄ith − β)2 − c1i − ph
− γith ≥ −αth [Pd
ith
− z̄ith − 1 + β] + − c2i(z̄ith + 1 − β)2
where β = 1 if th = tφ �= tψ , and β = 0 otherwise. This is true,
since U ′
i(Yi ∪ Zi ∪ yφ ∪ zψ ) ≥ U ′
i(Y
′′
i ∪ Zi ∪ yφ ∪ zψ ), and
therefore contract (h, th , ph) provides non-negative marginal
utility when selected alongside {Y ′′
i ∪ Zi ∪ yφ ∪ zψ}.
Case 4: |Y ′′
i | = |Y ′
φi | = |Yi | − 1, |Z ′′
i | = |Zψi | = |Zi | − 1.
For both tφ = tψ and tφ �= tψ , condition (11) results in an equal-
ity.
To show (12) is true, 4 cases need to be considered:
Case 1: |Y ′′
i | = |Y ′
ψi | = |Yi |, |Z ′′
i | = |Z ′
φi | = |Zi |. When
tφ �= tψ , (12) results in an equality. When tφ = tψ , (12) re-
quires,
−αtφ [Pd
itφ
− z̄itφ ] + − c2i(z̄itφ )2 + αtφ [Pd
itφ
− z̄itφ − 1] +
+ c2i(z̄itφ + 1)2 ≥ −αtφ [Pd
itφ
−z̄itφ + 1] + − c2i(z̄itφ − 1)2
+ αtφ [Pd
itφ
− z̄itφ ] + + c2i(z̄itφ )2 ,
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:05:51 UTC from IEEE Xplore.  Restrictions apply. 
2138 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 34, NO. 3, MAY 2019
which is true for all αtφ ≥ 0, c2i ≥ 0 and Pd
itφ
, z̄itφ ∈ Z.
Case 2: |Y ′′
i | = |Y ′
ψi | = |Yi |, |Z ′′
i | + 1 = |Zφi | = |Zi |. Let
Zi = Z ′′
i ∪ (l, tl , pl). Condition (12) requires,
psitl − αtl [P
d
itl
− z̄itl − β] + − c2i(z̄itl + β)2 + pl
+ γitl ≥ −αtl [Pd
itl
− z̄itl + 1 − β] + − c2i(z̄itl − 1 + β)2
where β = 1 if tl = tφ �= tψ , and β = 0 otherwise. This is
true, since U ′
i(Yi ∪ Zi ∪ yφ ∪ zψ ) ≥ U ′
i(Yi ∪ Z ′′
i ∪ yψ ∪ zφ),
and therefore contract (l, tl , pl) provides non-negative marginal
utility when selected alongside {Yi ∪ Z ′′
i ∪ yψ ∪ zφ}.
Case 3: |Y ′′
i | + 1 = |Y ′
ψi | = |Yi |, |Z ′′
i | = |Zφi | = |Zi |. Let
Yi = Y ′′
i ∪ (h, th , ph). Condition (12) requires,
−psith − αth [Pd
ith
− z̄ith + β] + − c2i(z̄ith − β)2 − c1i − ph
− γith ≥ −αth [Pd
ith
− z̄ith − 1 + β] + − c2i(z̄ith + 1 − β)2
where β = 1 if th = tψ �= tφ , and β = 0 otherwise. This is true,
since U ′
i(Yi ∪ Zi ∪ yψ ∪ zφ) ≥ U ′
i(Y
′′
i ∪ Zi ∪ yψ ∪ zφ), and
therefore contract (h, th , ph) provides non-negative marginal
utility when selected alongside {Y ′′
i ∪ Zi ∪ yψ ∪ zφ}.
Case 4: |Y ′′
i | = |Y ′
ψi | = |Yi | − 1, |Z ′′
i | = |Zφi | = |Zi | − 1.
For both tφ = tψ and tφ �= tψ , condition (12) results in an equal-
ity.
To show (13) is true, 5 cases need to be considered:
Case 1: |Z ′′
i | = |Z ′
φi | = |Z ′
ψi | = |Zi |. When tφ �= tψ , (13)
results in an equality. When tφ = tψ , (13) requires,
− αtφ [Pd
itφ
− z̄itφ − 1] + − c2i(z̄itφ + 1)2
+ αtφ [Pd
itφ
− z̄itφ − 2] + + c2i(z̄itφ + 2)2
≥ −αtφ [Pd
itφ
− z̄itφ ] +
− c2i(z̄itφ )2 + αtφ [Pd
itφ
− z̄itφ − 1] + + c2i(z̄itφ + 1)2 ,
which is true for all αtφ ≥ 0, c2i ≥ 0 and Pd
itφ
, z̄itφ ∈ Z.
Case 2: |Z ′
ψi | = |Zi | and |Z ′′
i | = |Z ′
φi | = |Zi | − 1. In this
case, tφ �= tψ since |Z ′
ψi | �= |Z ′
φi |. Condition (13) results in an
equality.
Case 3: |Z ′′
i | = |Z ′
ψi | = |Zi | − 1 and |Z ′
φi | = |Zi |. In this
case, tφ �= tψ since |Z ′
ψi | �= |Z ′
φi |. Condition (13) results in an
equality.
Case 4: |Z ′
φi | = |Z ′
ψi | = |Zi | − 1 and |Z ′′
i | = |Zi | − 2. For
both tφ = tψ and tφ �= tψ , condition (13) results in an equality.
Case 5: |Z ′
φi | = |Z ′
ψi | = |Zi | and |Z ′′
i | = |Zi | − 1. Let Zi =
Z ′′
i ∪ (l, tl , pl). Condition (13) requires,
psitl − αtl [P
d
itl
− z̄itl − β] + − c2i(z̄itl + β)2 + pl
+ γitl ≥ −αtl [Pd
itl
− z̄itl + 1 − β] + − c2i(z̄itl − 1 + β)2
whereβ = 0 if tl �= tφ and tl �= tψ , andβ = 1 otherwise. This is
true, since U ′
i(Yi ∪ Zi ∪ zφ) ≥ U ′
i(Yi ∪ Z ′′
i ∪ zφ) and U ′
i(Yi ∪
Zi ∪ zψ ) ≥ U ′
i(Yi ∪ Z ′′
i ∪ zψ ), and therefore contract (l, tl , pl)
provides non-negative marginal utility when selected alongside
either {Yi ∪ Z ′′
i ∪ zφ} or {Yi ∪ Z ′′
i ∪ zψ}.
REFERENCES
[1] J. Guerrero et al., “Distributed generation: Toward a new energy
paradigm,” IEEE Ind. Electron. Mag., vol. 4, no. 1, pp. 52–64, Mar. 2010.
[2] Y. Parag and B. K. Sovacool, “Electricity market design for the prosumer
era,” Nature Energy, vol. 1, no. 4, pp. 1–6, 2016.
[3] R. Wilson, “Architecture of power markets,” Econometrica, vol. 70, no. 4,
pp. 1299–1340, 2002.
[4] D. Wu, M. Kintner-Meyer, T. Yang, and P. Balducci, “Economic analysis
and optimal sizing for behind-the-meter battery storage,” in Proc. IEEE
Power Energy Soc. Gen. Meeting, 2016, pp. 1–5.
[5] L. N. Ochoa, F. Pilo, A. Keane, P. Cuffe, and G. Pisano, “Embracing
an adaptable, flexible posture: Ensuring that future European distribution
networks are ready for more active roles,” IEEE Power Energy Mag.,
vol. 14, no. 5, pp. 16–28, Sep./Oct. 2016.
[6] D. Pudjianto, C. K. Gan, V. Stanojevic, M. Aunedi, P. Djapic, and
G. Strbac, “Value of integrating distributed energy resources in the UK
electricity system,” IEEE Power Energy Soc. General Meeting, 2010,
pp. 1–6.
[7] R. Li, Q. Wu, and S. S. Oren, “Distribution locational marginal pricing for
optimal electric vehicle charging management,” IEEE Trans. Power Syst.,
vol. 29, no. 1, pp. 203–211, Jan. 2014.
[8] S. S. Guggilam, E. Dall’Anese, Y. C. Chen, S. V. Dhople, and G. B.
Giannakis, “Scalable optimization methods for distribution networks with
high PV integration,” IEEE Trans. Smart Grid, vol. 7, no. 4, pp. 2061–
2070, Jul. 2016.
[9] T. Morstyn, A. V. Savkin, B. Hredzak, and H. D. Tuan, “Scalable energy
management for low voltage microgrids using multi-agent storage system
aggregation,” IEEE Trans. Power Syst., vol. 33, no. 2, pp. 1614–1623,
Mar. 2018.
[10] T. Morstyn, B. Hredzak, R. P. Aguilera, and V. G. Agelidis, “Model
predictive control for distributed microgrid battery energy storage sys-
tems,” IEEE Trans. Control Syst. Technol., vol. 26, no. 3, pp. 1107–1114,
May 2018.
[11] N. Good, K. A. Ellis, and P. Mancarella, “Review and classification of
barriers and enablers of demand response in the smart grid,” Renewable
Sustain. Energy Rev., vol. 72, pp. 57–72, 2017.
[12] GridWise Architecture Council, “GridWise Transactive Energy Frame-
work Version 1.0,” pp. 1–43, 2013.
[13] P. Grünewald, E. McKenna, and M. Thomson, “Keep it simple: Time-of-
use tariffs in high-wind scenarios,” IET Renewable Power Gener., vol. 9,
no. 2, pp. 176–183, 2015.
[14] K. Heussen, S. You, B. Biegel, L. H. Hansen, and K. B. Andersen, “Indirect
control for demand side management - A conceptual introduction,” in
Proc. IEEE Innov. Smart Grid Technol. Conf. Eur., 2012, pp. 1–7.
[15] D. Papadaskalopoulos and G. Strbac, “Decentralized participation of flex-
ible demand in electricity markets - Part I: Market mechanism,” IEEE
Trans. Power Syst., vol. 28, no. 4, pp. 3658–3666, Nov. 2013.
[16] M. Karlsson, F. Ygge, and A. Andersson, “Market-based approaches to
optimization,” Comput. Intell., vol. 23, no. 1, pp. 92–109, 2007.
[17] M. Kraning, E. Chu, J. Lavaei, and S. Boyd, “Dynamic network energy
management via proximal message passing,” Found. Trends Optim., vol. 1,
no. 2, pp. 70–122, 2014.
[18] F. Moret and P. Pinson, “Energy collectives: A community and fairness
based approach to future electricity markets,” IEEE Trans. Power Syst., to
be published, doi: 10.1109/TPWRS.2018.2808961.
[19] T. Morstyn and M. McCulloch, “Multi-class energy management for peer-
to-peer energy trading driven by prosumer preferences,” IEEE Trans.
Power Syst., vol. 10, no. 1, pp. 293–304, Jan. 2019.
[20] E. Munsing, J. Mather, and S. Moura, “Blockchains for decentralized
optimization of energy resources in microgrid networks,” in Proc. IEEE
Conf. Control Technol. Appl., 2017, pp. 2164–2171.
[21] J. Lee, J. Guo, J. K. Choi, and M. Zukerman, “Distributed energy trading
in microgrids: A game theoretic model and its equilibrium analysis,” IEEE
Trans. Ind. Electron., vol. 62, no. 6, pp. 3524–3533, Jun. 2015.
[22] M. Khorasany, Y. Mishra, and G. Ledwich, “Auction based energy trading
in transactive energy market with active participation of prosumers and
consumers,” in Proc. Australas. Univ. Power Eng. Conf., 2017, pp. 1–6.
[23] M. N. Faqiry and S. Das, “Double-sided energy auction in microgrid:
Equilibrium under price anticipation,” IEEE Access, vol. 4, pp. 3794–
3805, 2016.
[24] J. Guerrero, A. Chapman, and G. Verbic, “A study of energy trading in
a low-voltage network: Centralised and distributed approaches,” in Proc.
Australas. Univ. Power Eng. Conf., 2017, pp. 1–6.
[25] Z. Ma, D. S. Callaway, and I. A. Hiskens, “Decentralized charging control
of large populations of plug-in electric vehicles,” IEEE Trans. Control
Syst. Technol., vol. 21, no. 1, pp. 67–78, Jan. 2013.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:05:51 UTC from IEEE Xplore.  Restrictions apply. 
https://dx.doi.org/10.1109/TPWRS.2018.2808961
MORSTYN et al.: DESIGNING DECENTRALIZED MARKETS FOR DISTRIBUTION SYSTEM FLEXIBILITY 2139
[26] L. Deori, K. Margellos, and M. Prandini, “On the connection between
Nash equilibria and social optima in electric vehicle charging control
games,” in Proc. 20th World Congr. Int. Federation Autom. Control, 2016,
pp. 1–6.
[27] A. De Paola, D. Angeli, and G. Strbac, “Price-based schemes for dis-
tributed coordination of flexible demand in the electricity market,” IEEE
Trans. Smart Grid, vol. 8, no. 6, pp. 3104–3116, Nov. 2017.
[28] W. Wei, F. Liu, and S. Mei, “Energy pricing and dispatch for smart grid
retailers under demand response and market price uncertainty,” IEEE
Trans. Smart Grid, vol. 6, no. 3, pp. 1364–1374, May 2015.
[29] S. D. Manshadi and M. E. Khodayar, “A hierarchical electricity market
structure for the smart grid paradigm,” IEEE Trans. Smart Grid, vol. 7,
no. 4, pp. 1866–1875, Jul. 2016.
[30] L. Jia and L. Tong, “Renewables and storage in distribution systems:
Centralized vs. decentralized integration,” IEEE J. Sel. Areas Commun.,
vol. 34, no. 3, pp. 665–674, Mar. 2016.
[31] N. Liu, X. Yu, C. Wang, C. Li, L. Ma, and J. Lei, “An energy sharing
model with price-based demand response for microgrids of peer-to-peer
prosumers,” IEEE Trans. Power Syst., vol. 32, no. 5, pp. 3569–3583,
Sep. 2017.
[32] A. R. Soares et al., “Distributed optimization algorithm for residential
flexibility activation - Results from a field test,” IEEE Trans. Power Syst.,
to be published, doi: 10.1109/TPWRS.2018.2809440.
[33] K. Kok, B. Roossien, P. Macdougall, and O. V. Pruissen, “Dynamic pricing
by scalable energy management systems - Field experiences and simula-
tion results using powermatcher,” in Proc. IEEE Power Energy Soc. Gen.
Meeting, 2012, pp. 1–8.
[34] P. L. Joskow, “Why do we need electricity retailers?; or, can you get it
cheaper wholesale?” Centre Energy Environ. Policy Res., 2000, pp. 1–57.
[35] D. T. Nguyen, M. Negnevitsky, and M. de Groot, “Pool-based demand
response exchange–concept and modeling,” IEEE Trans. Power Syst.,
vol. 26, no. 3, pp. 1677–1685, Aug. 2011.
[36] K. Heussen, D. E. M. Bondy, J. Hu, O. Gehrke, and L. H. Hansen, “A
clearinghouse concept for distribution-level flexibility services,” in Proc.
IEEE Innov. Smart Grid Technol. Eur., 2013, pp. 1–5.
[37] C. Zhang, Y. Ding, N. C. Nordentoft, P. Pinson, and J. Østergaard,
“FLECH: A danish market solution for DSO congestion management
through DER flexibility services,” J. Modern Power Syst. Clean Energy,
vol. 2, no. 2, pp. 126–133, 2014.
[38] S. S. Torbaghan, N. Blaauwbroek, P. Nguyen, and M. Gibescu, “Local
market framework for exploiting flexibility from the end users,” in Proc.
Int. Conf. Eur. Energy Market, 2016, pp. 1–6.
[39] T. Morstyn, A. Teytelboym, and M. D. McCulloch, “Bilateral contract net-
works for peer-to-peer energy trading,” IEEE Trans. Smart Grid, vol. 10,
no. 2, pp. 2026–2035, Mar. 2019.
[40] E. Sorin, L. Bobo, and P. Pinson, “Consensus-based approach to peer-to-
peer electricity markets with product differentiation,” IEEE Trans. Power
Syst., vol. 34, no. 2, pp. 994–1004, Mar. 2019.
[41] E. Mengelkamp, J. Gärttner, K. Rock, S. Kessler, L. Orsini, and C. Wein-
hardt, “Designing microgrid energy markets a case study: The brooklyn
microgrid,” Appl. Energy, vol. 210, pp. 870–880, 2017.
[42] T. Morstyn, N. Farrell, S. J. Darby, and M. D. McCulloch, “Using peer-to-
peer energy-trading platforms to incentivize prosumers to form federated
power plants,” Nature Energy, vol. 3, no. 2, pp. 94–101, 2018.
[43] J. Villar, R. Bessa, and M. Matos, “Flexibility products and markets:
Literature review,” Elect. Power Syst. Res., vol. 154, pp. 329–340, 2018.
[44] H. Shareef, M. S. Ahmed, A. Mohamed, and E. Al Hassan, “Review on
home energy management system considering demand responses, smart
technologies, and intelligent controllers,” IEEE Access, vol. 6, pp. 24 498–
24 509, 2018.
[45] J. Ossenbrink, “How feed-in remuneration design shapes residential PV
prosumer paradigms,” Energy Policy, vol. 108, pp. 239–255, 2017.
[46] W. Charytoniuk, M. Chen, P. Kotas, and P. Van Olinda, “Demand forecast-
ing in power distribution systems using nonparametric probability density
estimation,” IEEE Trans. Power Syst., vol. 14, no. 4, pp. 1200–1206, Nov.
1999.
[47] S. Villalba and C. Bel, “Hybrid demand model for load estimation and
short term load forecasting in distribution electric systems,” IEEE Trans.
Power Del., vol. 15, no. 2, pp. 764–769, Apr. 2000.
[48] O. Mégel, J. L. Mathieu, and G. Andersson, “Scheduling distributed energy
storage units to provide multiple services,” in Proc. Power Syst. Comput.
Conf., 2014, pp. 1–7.
[49] W. El-Baz and P. Tzscheutschler, “Short-term smart learning electrical
load prediction algorithm for home energy management systems,” Appl.
Energy, vol. 147, pp. 10–19, 2015.
[50] N. Liu, M. Cheng, X. Yu, J. Zhong, and J. Lei, “Energy sharing provider
for PV prosumer clusters: A hybrid approach using stochastic program-
ming and Stackelberg game,” IEEE Trans. Ind. Electron., vol. 65, no. 8,
pp. 6740–6750, Aug. 2018.
[51] A. E. Roth, “What have we learned from market design? (Update),” Econ.
J., vol. 118, no. 2006, pp. 285–310, 2008.
[52] J. W. Hatfield, S. D. Kominers, A. Nichifor, M. Ostrovsky, and A. West-
kamp, “Stability and competitive equilibrium in trading networks,” J.
Political Econ., vol. 121, no. 5, pp. 966–1005, 2013.
[53] T. Fleiner, R. Jagadeesan, Z. Jankó, and A. Teytelboym, “Trading networks
with frictions,” in Proc. ACM Conf. Econ. Comput., 2018, pp. 615–615.
[54] T. Fleiner, Z. Jankó, A. Tamura, and A. Teytelboym, “Trading networks
with bilateral contracts,” in Proc. 3rd Conf. Auctions, Market Mechanisms
Appl., 2015, pp. 1–39.
[55] J. W. Hatfield, S. D. Kominers, A. Nichifor, M. Ostrovsky, and A. West-
kamp, “Full substitutability in trading networks,” in Proc. 16th ACM Conf.
Econ. Comput., 2015, pp. 39–40.
[56] European Low Voltage Test Feeder, “IEEE PES distribution sys-
tems analysis subcommittee test feeders,” 2000. [Online]. Available:
http://ieee.org/pes-testfeeders/resources. Accessed: Mar. 2017.
[57] R. Cespedes, “New method for the analysis of distribution networks,”
IEEE Trans. Power Del., vol. 5, no. 1, pp. 391–396, Jan. 1990.
[58] Customer-Led Network Revolution, “Enhanced profiling of domestic cus-
tomers with solar photovoltaics,” 2014. [Online]. Available: networkrev-
olution.co.uk. Accessed: Mar. 2017.
[59] M. Muratori, “Impact of uncoordinated plug-in electric vehicle charg-
ing on residential power demand - Supplementary data,” Nat. Renewable
Energy Lab., 2017. [Online]. Available: data.nrel.gov/submissions/69
Thomas Morstyn (S’14–M’16) received the B.E.
(Hon.) degree from the University of Melbourne,
Melbourne, Australia, and the Ph.D. degree from the
University of New South Wales, Sydney, NSW, Aus-
tralia, in 2011 and 2016, respectively, both in electri-
cal engineering.
He worked as an Electrical Engineer with the
Rio Tinto Technology and Innovation group between
2012 and 2014. He is currently an EPSRC Research
Fellow with the Department of Engineering Science,
University of Oxford, Oxford, U.K. His research in-
terests include multi-agent control and market design for integrating distributed
energy resources in power systems.
Alexander Teytelboym received the B.Sc. degree
from the London School of Economics, London,
U.K., and M.Phil. and D.Phil. degrees from the Uni-
versity of Oxford, Oxford, U.K, in 2008, 2010, and
2013, respectively, all in economics.
He is an economist interested in market design as
well as social and economic networks. Before joining
the Department of Economics, he was the Otto Poon
Research Fellow with the Institute for New Economic
Thinking, Oxford Martin School, Oxford, U.K. and
prior to that a Postdoctoral Fellow with the Labora-
tory for Information and Decision Systems, Massachusetts Institute of Technol-
ogy, Cambridge, MA, USA.
Malcolm D. McCulloch (SM’89) received the B.Sc.
(Eng.) and Ph.D. degrees in electrical engineering
from the University of the Witwatersrand, Johan-
nesburg, South Africa, in 1986 and 1990, respec-
tively.
In 1993, he joined the University of Oxford, Ox-
ford, U.K. to head up the Energy and Power Group,
where he is currently an Associate Professor in the
Department of Engineering Science. He is active in
the areas of electrical machines, transport, and smart
grids. His research interest includes transforming ex-
isting power networks, designing new power networks for the developing world,
developing new technology for electric vehicles, and developing approaches to
integrated mobility.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:05:51 UTC from IEEE Xplore.  Restrictions apply. 
https://dx.doi.org/10.1109/TPWRS.2018.2809440
http://ieee.org/pes-testfeeders/resources
http://networkrevolution.co.uk
http://networkrevolution.co.uk
http://data.nrel.gov/submissions/69
<<
  /ASCII85EncodePages false
  /AllowTransparency false
  /AutoPositionEPSFiles true
  /AutoRotatePages /None
  /Binding /Left
  /CalGrayProfile (Gray Gamma 2.2)
  /CalRGBProfile (sRGB IEC61966-2.1)
  /CalCMYKProfile (U.S. Web Coated \050SWOP\051 v2)
  /sRGBProfile (sRGB IEC61966-2.1)
  /CannotEmbedFontPolicy /Warning
  /CompatibilityLevel 1.4
  /CompressObjects /Off
  /CompressPages true
  /ConvertImagesToIndexed true
  /PassThroughJPEGImages true
  /CreateJobTicket false
  /DefaultRenderingIntent /Default
  /DetectBlends true
  /DetectCurves 0.0000
  /ColorConversionStrategy /sRGB
  /DoThumbnails true
  /EmbedAllFonts true
  /EmbedOpenType false
  /ParseICCProfilesInComments true
  /EmbedJobOptions true
  /DSCReportingLevel 0
  /EmitDSCWarnings false
  /EndPage -1
  /ImageMemory 1048576
  /LockDistillerParams true
  /MaxSubsetPct 100
  /Optimize true
  /OPM 0
  /ParseDSCComments false
  /ParseDSCCommentsForDocInfo true
  /PreserveCopyPage true
  /PreserveDICMYKValues true
  /PreserveEPSInfo false
  /PreserveFlatness true
  /PreserveHalftoneInfo true
  /PreserveOPIComments false
  /PreserveOverprintSettings true
  /StartPage 1
  /SubsetFonts false
  /TransferFunctionInfo /Remove
  /UCRandBGInfo /Preserve
  /UsePrologue false
  /ColorSettingsFile ()
  /AlwaysEmbed [ true
    /Algerian
    /Arial-Black
    /Arial-BlackItalic
    /Arial-BoldItalicMT
    /Arial-BoldMT
    /Arial-ItalicMT
    /ArialMT
    /ArialNarrow
    /ArialNarrow-Bold
    /ArialNarrow-BoldItalic
    /ArialNarrow-Italic
    /ArialUnicodeMS
    /BaskOldFace
    /Batang
    /Bauhaus93
    /BellMT
    /BellMTBold
    /BellMTItalic
    /BerlinSansFB-Bold
    /BerlinSansFBDemi-Bold
    /BerlinSansFB-Reg
    /BernardMT-Condensed
    /BodoniMTPosterCompressed
    /BookAntiqua
    /BookAntiqua-Bold
    /BookAntiqua-BoldItalic
    /BookAntiqua-Italic
    /BookmanOldStyle
    /BookmanOldStyle-Bold
    /BookmanOldStyle-BoldItalic
    /BookmanOldStyle-Italic
    /BookshelfSymbolSeven
    /BritannicBold
    /Broadway
    /BrushScriptMT
    /CalifornianFB-Bold
    /CalifornianFB-Italic
    /CalifornianFB-Reg
    /Centaur
    /Century
    /CenturyGothic
    /CenturyGothic-Bold
    /CenturyGothic-BoldItalic
    /CenturyGothic-Italic
    /CenturySchoolbook
    /CenturySchoolbook-Bold
    /CenturySchoolbook-BoldItalic
    /CenturySchoolbook-Italic
    /Chiller-Regular
    /ColonnaMT
    /ComicSansMS
    /ComicSansMS-Bold
    /CooperBlack
    /CourierNewPS-BoldItalicMT
    /CourierNewPS-BoldMT
    /CourierNewPS-ItalicMT
    /CourierNewPSMT
    /EstrangeloEdessa
    /FootlightMTLight
    /FreestyleScript-Regular
    /Garamond
    /Garamond-Bold
    /Garamond-Italic
    /Georgia
    /Georgia-Bold
    /Georgia-BoldItalic
    /Georgia-Italic
    /Haettenschweiler
    /HarlowSolid
    /Harrington
    /HighTowerText-Italic
    /HighTowerText-Reg
    /Impact
    /InformalRoman-Regular
    /Jokerman-Regular
    /JuiceITC-Regular
    /KristenITC-Regular
    /KuenstlerScript-Black
    /KuenstlerScript-Medium
    /KuenstlerScript-TwoBold
    /KunstlerScript
    /LatinWide
    /LetterGothicMT
    /LetterGothicMT-Bold
    /LetterGothicMT-BoldOblique
    /LetterGothicMT-Oblique
    /LucidaBright
    /LucidaBright-Demi
    /LucidaBright-DemiItalic
    /LucidaBright-Italic
    /LucidaCalligraphy-Italic
    /LucidaConsole
    /LucidaFax
    /LucidaFax-Demi
    /LucidaFax-DemiItalic
    /LucidaFax-Italic
    /LucidaHandwriting-Italic
    /LucidaSansUnicode
    /Magneto-Bold
    /MaturaMTScriptCapitals
    /MediciScriptLTStd
    /MicrosoftSansSerif
    /Mistral
    /Modern-Regular
    /MonotypeCorsiva
    /MS-Mincho
    /MSReferenceSansSerif
    /MSReferenceSpecialty
    /NiagaraEngraved-Reg
    /NiagaraSolid-Reg
    /NuptialScript
    /OldEnglishTextMT
    /Onyx
    /PalatinoLinotype-Bold
    /PalatinoLinotype-BoldItalic
    /PalatinoLinotype-Italic
    /PalatinoLinotype-Roman
    /Parchment-Regular
    /Playbill
    /PMingLiU
    /PoorRichard-Regular
    /Ravie
    /ShowcardGothic-Reg
    /SimSun
    /SnapITC-Regular
    /Stencil
    /SymbolMT
    /Tahoma
    /Tahoma-Bold
    /TempusSansITC
    /TimesNewRomanMT-ExtraBold
    /TimesNewRomanMTStd
    /TimesNewRomanMTStd-Bold
    /TimesNewRomanMTStd-BoldCond
    /TimesNewRomanMTStd-BoldIt
    /TimesNewRomanMTStd-Cond
    /TimesNewRomanMTStd-CondIt
    /TimesNewRomanMTStd-Italic
    /TimesNewRomanPS-BoldItalicMT
    /TimesNewRomanPS-BoldMT
    /TimesNewRomanPS-ItalicMT
    /TimesNewRomanPSMT
    /Times-Roman
    /Trebuchet-BoldItalic
    /TrebuchetMS
    /TrebuchetMS-Bold
    /TrebuchetMS-Italic
    /Verdana
    /Verdana-Bold
    /Verdana-BoldItalic
    /Verdana-Italic
    /VinerHandITC
    /Vivaldii
    /VladimirScript
    /Webdings
    /Wingdings2
    /Wingdings3
    /Wingdings-Regular
    /ZapfChanceryStd-Demi
    /ZWAdobeF
  ]
  /NeverEmbed [ true
  ]
  /AntiAliasColorImages false
  /CropColorImages true
  /ColorImageMinResolution 150
  /ColorImageMinResolutionPolicy /OK
  /DownsampleColorImages false
  /ColorImageDownsampleType /Bicubic
  /ColorImageResolution 900
  /ColorImageDepth -1
  /ColorImageMinDownsampleDepth 1
  /ColorImageDownsampleThreshold 1.00111
  /EncodeColorImages true
  /ColorImageFilter /DCTEncode
  /AutoFilterColorImages false
  /ColorImageAutoFilterStrategy /JPEG
  /ColorACSImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /ColorImageDict <<
    /QFactor 0.40
    /HSamples [1 1 1 1] /VSamples [1 1 1 1]
  >>
  /JPEG2000ColorACSImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /JPEG2000ColorImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /AntiAliasGrayImages false
  /CropGrayImages true
  /GrayImageMinResolution 150
  /GrayImageMinResolutionPolicy /OK
  /DownsampleGrayImages false
  /GrayImageDownsampleType /Bicubic
  /GrayImageResolution 1200
  /GrayImageDepth -1
  /GrayImageMinDownsampleDepth 2
  /GrayImageDownsampleThreshold 1.00083
  /EncodeGrayImages true
  /GrayImageFilter /DCTEncode
  /AutoFilterGrayImages false
  /GrayImageAutoFilterStrategy /JPEG
  /GrayACSImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /GrayImageDict <<
    /QFactor 0.40
    /HSamples [1 1 1 1] /VSamples [1 1 1 1]
  >>
  /JPEG2000GrayACSImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /JPEG2000GrayImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /AntiAliasMonoImages false
  /CropMonoImages true
  /MonoImageMinResolution 1200
  /MonoImageMinResolutionPolicy /OK
  /DownsampleMonoImages false
  /MonoImageDownsampleType /Bicubic
  /MonoImageResolution 1600
  /MonoImageDepth -1
  /MonoImageDownsampleThreshold 1.00063
  /EncodeMonoImages true
  /MonoImageFilter /CCITTFaxEncode
  /MonoImageDict <<
    /K -1
  >>
  /AllowPSXObjects false
  /CheckCompliance [
    /None
  ]
  /PDFX1aCheck false
  /PDFX3Check false
  /PDFXCompliantPDFOnly false
  /PDFXNoTrimBoxError true
  /PDFXTrimBoxToMediaBoxOffset [
    0.00000
    0.00000
    0.00000
    0.00000
  ]
  /PDFXSetBleedBoxToMediaBox true
  /PDFXBleedBoxToTrimBoxOffset [
    0.00000
    0.00000
    0.00000
    0.00000
  ]
  /PDFXOutputIntentProfile (None)
  /PDFXOutputConditionIdentifier ()
  /PDFXOutputCondition ()
  /PDFXRegistryName ()
  /PDFXTrapped /False
  /CreateJDFFile false
  /Description <<
    /CHS <FEFF4f7f75288fd94e9b8bbe5b9a521b5efa7684002000410064006f006200650020005000440046002065876863900275284e8e55464e1a65876863768467e5770b548c62535370300260a853ef4ee54f7f75280020004100630072006f0062006100740020548c002000410064006f00620065002000520065006100640065007200200035002e003000204ee553ca66f49ad87248672c676562535f00521b5efa768400200050004400460020658768633002>
    /CHT <FEFF4f7f752890194e9b8a2d7f6e5efa7acb7684002000410064006f006200650020005000440046002065874ef69069752865bc666e901a554652d965874ef6768467e5770b548c52175370300260a853ef4ee54f7f75280020004100630072006f0062006100740020548c002000410064006f00620065002000520065006100640065007200200035002e003000204ee553ca66f49ad87248672c4f86958b555f5df25efa7acb76840020005000440046002065874ef63002>
    /DAN <FEFF004200720075006700200069006e0064007300740069006c006c0069006e006700650072006e0065002000740069006c0020006100740020006f007000720065007400740065002000410064006f006200650020005000440046002d0064006f006b0075006d0065006e007400650072002c0020006400650072002000650067006e006500720020007300690067002000740069006c00200064006500740061006c006a006500720065007400200073006b00e60072006d007600690073006e0069006e00670020006f00670020007500640073006b007200690076006e0069006e006700200061006600200066006f0072007200650074006e0069006e006700730064006f006b0075006d0065006e007400650072002e0020004400650020006f007000720065007400740065006400650020005000440046002d0064006f006b0075006d0065006e0074006500720020006b0061006e002000e50062006e00650073002000690020004100630072006f00620061007400200065006c006c006500720020004100630072006f006200610074002000520065006100640065007200200035002e00300020006f00670020006e0079006500720065002e>
    /DEU <FEFF00560065007200770065006e00640065006e0020005300690065002000640069006500730065002000450069006e007300740065006c006c0075006e00670065006e0020007a0075006d002000450072007300740065006c006c0065006e00200076006f006e002000410064006f006200650020005000440046002d0044006f006b0075006d0065006e00740065006e002c00200075006d002000650069006e00650020007a0075007600650072006c00e40073007300690067006500200041006e007a006500690067006500200075006e00640020004100750073006700610062006500200076006f006e00200047006500730063006800e40066007400730064006f006b0075006d0065006e00740065006e0020007a0075002000650072007a00690065006c0065006e002e00200044006900650020005000440046002d0044006f006b0075006d0065006e007400650020006b00f6006e006e0065006e0020006d006900740020004100630072006f00620061007400200075006e0064002000520065006100640065007200200035002e003000200075006e00640020006800f600680065007200200067006500f600660066006e00650074002000770065007200640065006e002e>
    /ESP <FEFF005500740069006c0069006300650020006500730074006100200063006f006e0066006900670075007200610063006900f3006e0020007000610072006100200063007200650061007200200064006f00630075006d0065006e0074006f0073002000640065002000410064006f00620065002000500044004600200061006400650063007500610064006f007300200070006100720061002000760069007300750061006c0069007a00610063006900f3006e0020006500200069006d0070007200650073006900f3006e00200064006500200063006f006e006600690061006e007a006100200064006500200064006f00630075006d0065006e0074006f007300200063006f006d00650072006300690061006c00650073002e002000530065002000700075006500640065006e00200061006200720069007200200064006f00630075006d0065006e0074006f00730020005000440046002000630072006500610064006f007300200063006f006e0020004100630072006f006200610074002c002000410064006f00620065002000520065006100640065007200200035002e003000200079002000760065007200730069006f006e0065007300200070006f00730074006500720069006f007200650073002e>
    /FRA <FEFF005500740069006c006900730065007a00200063006500730020006f007000740069006f006e00730020006100660069006e00200064006500200063007200e900650072002000640065007300200064006f00630075006d0065006e00740073002000410064006f006200650020005000440046002000700072006f00660065007300730069006f006e006e0065006c007300200066006900610062006c0065007300200070006f007500720020006c0061002000760069007300750061006c00690073006100740069006f006e0020006500740020006c00270069006d007000720065007300730069006f006e002e0020004c0065007300200064006f00630075006d0065006e00740073002000500044004600200063007200e900e90073002000700065007500760065006e0074002000ea0074007200650020006f007500760065007200740073002000640061006e00730020004100630072006f006200610074002c002000610069006e00730069002000710075002700410064006f00620065002000520065006100640065007200200035002e0030002000650074002000760065007200730069006f006e007300200075006c007400e90072006900650075007200650073002e>
    /ITA (Utilizzare queste impostazioni per creare documenti Adobe PDF adatti per visualizzare e stampare documenti aziendali in modo affidabile. I documenti PDF creati possono essere aperti con Acrobat e Adobe Reader 5.0 e versioni successive.)
    /JPN <FEFF30d330b830cd30b9658766f8306e8868793a304a3088307353705237306b90693057305f002000410064006f0062006500200050004400460020658766f8306e4f5c6210306b4f7f75283057307e305930023053306e8a2d5b9a30674f5c62103055308c305f0020005000440046002030d530a130a430eb306f3001004100630072006f0062006100740020304a30883073002000410064006f00620065002000520065006100640065007200200035002e003000204ee5964d3067958b304f30533068304c3067304d307e305930023053306e8a2d5b9a3067306f30d530a930f330c8306e57cb30818fbc307f3092884c3044307e30593002>
    /KOR <FEFFc7740020c124c815c7440020c0acc6a9d558c5ec0020be44c988b2c8c2a40020bb38c11cb97c0020c548c815c801c73cb85c0020bcf4ace00020c778c1c4d558b2940020b3700020ac00c7a50020c801d569d55c002000410064006f0062006500200050004400460020bb38c11cb97c0020c791c131d569b2c8b2e4002e0020c774b807ac8c0020c791c131b41c00200050004400460020bb38c11cb2940020004100630072006f0062006100740020bc0f002000410064006f00620065002000520065006100640065007200200035002e00300020c774c0c1c5d0c11c0020c5f40020c2180020c788c2b5b2c8b2e4002e>
    /NLD (Gebruik deze instellingen om Adobe PDF-documenten te maken waarmee zakelijke documenten betrouwbaar kunnen worden weergegeven en afgedrukt. De gemaakte PDF-documenten kunnen worden geopend met Acrobat en Adobe Reader 5.0 en hoger.)
    /NOR <FEFF004200720075006b00200064006900730073006500200069006e006e007300740069006c006c0069006e00670065006e0065002000740069006c002000e50020006f0070007000720065007400740065002000410064006f006200650020005000440046002d0064006f006b0075006d0065006e00740065007200200073006f006d002000650072002000650067006e0065007400200066006f00720020007000e5006c006900740065006c006900670020007600690073006e0069006e00670020006f00670020007500740073006b007200690066007400200061007600200066006f0072007200650074006e0069006e006700730064006f006b0075006d0065006e007400650072002e0020005000440046002d0064006f006b0075006d0065006e00740065006e00650020006b0061006e002000e50070006e00650073002000690020004100630072006f00620061007400200065006c006c00650072002000410064006f00620065002000520065006100640065007200200035002e003000200065006c006c00650072002e>
    /PTB <FEFF005500740069006c0069007a006500200065007300730061007300200063006f006e00660069006700750072006100e700f50065007300200064006500200066006f0072006d00610020006100200063007200690061007200200064006f00630075006d0065006e0074006f0073002000410064006f00620065002000500044004600200061006400650071007500610064006f00730020007000610072006100200061002000760069007300750061006c0069007a006100e700e3006f002000650020006100200069006d0070007200650073007300e3006f00200063006f006e0066006900e1007600650069007300200064006500200064006f00630075006d0065006e0074006f007300200063006f006d0065007200630069006100690073002e0020004f007300200064006f00630075006d0065006e0074006f00730020005000440046002000630072006900610064006f007300200070006f00640065006d0020007300650072002000610062006500720074006f007300200063006f006d0020006f0020004100630072006f006200610074002000650020006f002000410064006f00620065002000520065006100640065007200200035002e0030002000650020007600650072007300f50065007300200070006f00730074006500720069006f007200650073002e>
    /SUO <FEFF004b00e40079007400e40020006e00e40069007400e4002000610073006500740075006b007300690061002c0020006b0075006e0020006c0075006f0074002000410064006f0062006500200050004400460020002d0064006f006b0075006d0065006e007400740065006a0061002c0020006a006f0074006b006100200073006f0070006900760061007400200079007200690074007900730061007300690061006b00690072006a006f006a0065006e0020006c0075006f00740065007400740061007600610061006e0020006e00e400790074007400e4006d0069007300650065006e0020006a0061002000740075006c006f007300740061006d0069007300650065006e002e0020004c0075006f0064007500740020005000440046002d0064006f006b0075006d0065006e00740069007400200076006f0069006400610061006e0020006100760061007400610020004100630072006f0062006100740069006c006c00610020006a0061002000410064006f00620065002000520065006100640065007200200035002e0030003a006c006c00610020006a006100200075007500640065006d006d0069006c006c0061002e>
    /SVE <FEFF0041006e007600e4006e00640020006400650020006800e4007200200069006e0073007400e4006c006c006e0069006e006700610072006e00610020006f006d002000640075002000760069006c006c00200073006b006100700061002000410064006f006200650020005000440046002d0064006f006b0075006d0065006e007400200073006f006d00200070006100730073006100720020006600f60072002000740069006c006c006600f60072006c00690074006c006900670020007600690073006e0069006e00670020006f006300680020007500740073006b007200690066007400650072002000610076002000610066006600e4007200730064006f006b0075006d0065006e0074002e002000200053006b006100700061006400650020005000440046002d0064006f006b0075006d0065006e00740020006b0061006e002000f600700070006e00610073002000690020004100630072006f0062006100740020006f00630068002000410064006f00620065002000520065006100640065007200200035002e00300020006f00630068002000730065006e006100720065002e>
    /ENU (Use these settings to create PDFs that match the "Suggested"  settings for PDF Specification 4.0)
  >>
>> setdistillerparams
<<
  /HWResolution [600 600]
  /PageSize [612.000 792.000]
>> setpagedevice