7df8c653-6e0e-4399-8ec3-8762bc60d178
第 44卷 第 7期 2020年 4月 10日 Vol. 44 No. 7 Apr. 10，2020
http：//www.aeps-info.com
基于区块链的微电网市场势博弈模型
周步祥 1，杨明通 1，史述青 2，魏金萧 3，李祖钢 1，董 申 1
（1.四川大学电气工程学院，四川省成都市 610065；2.电子科技大学格拉斯哥学院，四川省成都市 611731；
3.四川电力设计咨询有限责任公司，四川省成都市 610094）
摘要：微电网是实现新能源优势互补、高效消纳和并网远送的有效形式。基于区块链与微电网市
场相似的分布式拓扑结构，设计了微电网市场总体框架。综合考虑微电网市场经济性和能源利用
情况，引入博弈理论和势博弈概念，将约束条件转化为状态空间，构造基于双向时变信息交互下状
态量序数势博弈的微电网运行优化模型，并证明了该模型状态均衡的存在。在微电网市场不同信
息交互的条件下，通过博弈中策略学习算法求解势博弈模型，实现微电网市场的运行优化。仿真结
果表明，在微电网市场参与个体保持理性的情况下应用势博弈模型，能够使得微电网中各设备运行
在最优水平，增加了微电网的经济收益，提高了新能源利用率。
关键词：微电网市场；势博弈；状态均衡；新能源；区块链
0 引言
随着全球变暖、空气污染、全球能源急剧消耗等
环境问题日益严重，传统能源已经不能满足并适应
社会的需求和发展，以可再生能源为主的混合能源
将代替传统能源成为满足社会发展需要的主要能
源［1］。微电网作为新能源就地消纳和并网远送的主
要模式，因其供电可靠、运行方式灵活及对环境友好
等优点得到了普遍关注和研究［2-4］。
如何实现微电网内多目标协调优化运行，相关
领域的专家学者做了诸多研究。文献［5］建立了微
电网和用户的非合作博弈模型，对冷热电联供微电
网运行进行优化，提高了微电网对可再生能源的消
纳能力。基于多代理控制模型，文献［6］对孤岛运行
方式下的含多储能单元微电网内各分布式能源及负
荷的动态博弈模型进行研究，验证了模型的有效
性。文献［7］按照微电网内各主体不同的利益追求，
将其划分为不同的智能体，建立了多主体博弈调度
模型，验证了该模型的有效性和实用性。文献［8］考
虑经济性和用户满意度，引入非合作完全信息动态
博弈理论，对用户侧和能源供给侧进行博弈互动，引
导用户用电策略，优化微电网运行。
上述文献对微电网优化运行进行研究，大多引
入了博弈论提高微电网的自主性和智能性，但均需
要证明纳什均衡的存在，在很大程度上限制了博弈
论在微电网中的应用。势博弈作为非合作博弈的一
种特殊形式，具备有限递增的属性，保证了纯策略均
衡解的存在，状态量序数势博弈至少存在一个状态
均衡，从而避免了验证纳什均衡的存在。文献［9］引
入势博弈对微电网分布式运行进行优化求解，验证
了势博弈模型的可行性和正确性。但是，在上述博
弈模型的设计过程中，个体决策大多假设获取了微
电网的全局信息，忽略了信息的非同步性和间歇性，
并且博弈模型中的理智“经济人”为实现自身利益最
大化，不去考虑自身决策对系统整体的影响，从而导
致博弈结果与优化问题最优解不一致。
区块链因其安全性、去中心化、可追溯等特
点［10-14］，在能源互联网及电力市场等领域都得到了
广泛应用［15-17］。文献［18］构建了基于区块链技术的
多微电网系统竞争博弈模型，得到的各时段最优电
价策略可有效地平衡市场各主体的效益，从而实现
多方共赢和协调发展。文献［19］构建了个人对个人
(P2P）光伏（photovoltaic，PV）交易平台，采用信誉值
交易机制，使用户获得满意的交易结果。
区块链与微电网市场具有相似的分布式拓扑结
构，并且势博弈优化算法非常契合区块链的分布式
特性。基于以上，综合考虑微电网市场经济性和能
源利用情况，提出一种基于双向时变信息交互下状
态量序数势博弈的运行优化模型，并证明该模型状
态均衡的存在。在构建的区块链智能管理平台的支
持下，个体决策可获取微电网实时信息，弥补势博弈
模型在获取全局信息方面的不足，并在微电网市场
架构设计中加入奖惩机制，抑制个体私欲过分膨胀，
DOI：10. 7500/AEPS20190308006
收稿日期：2019-03-08；修回日期：2019-09-23。
上网日期：2020-02-21。
15
2020，44（7） ·区块链技术在电力系统中的应用·
保证了博弈结果趋向优化问题最优解，实现微电网
新能源的高效利用。
1 区块链支持的微电网市场博弈框架设计
1. 1 区块链支持的微电网市场架构
微电网市场主体主要包括：为获取较低电价的
普通用户，将过剩分布式电能进行储存或出售的分
布式电能生产者，负责区块链智能云平台运营和监
管的微电网运营商，提供辅助服务、基础设施建设的
地方电网公司等。如果政府也参与分布式能源的投
资 ，则 可 以 形 成 PPP（public-private partnership）
模式［20］。
微电网系统由风力发电机组、光伏阵列、储能装
置等实体单元以及区块链智能管理平台构成，区块
链智能管理平台详见附录A。在满足电力系统安全
约束条件下，参与微电网市场的各主体根据自身需
求，可进行中长期、日前、日内、小时内的能源交易，
其交易的合规性由微电网运营商和电力公司裁定，
并将其违规交易操作记录在征信区块链中。所有参
与微电网市场的主体作为系统节点具有相等的地
位，均由区块链智能管理平台授权进行统一管理，交
易过程中的交易信息、所进行的操作以及产生的结
果，都会反馈至平台进行加密储存和分析，从而保证
交易正常进行及交易数据的安全性。
选定 Balance作为微电网市场参与主体的账户
模型，Balance的变化取决于市场参与者交易数据和
智能合约的内容变化。考虑微电网市场和能源交易
的特殊性质，选取联盟链作为微电网的区块链模
型［21］，联盟链网络为授权节点构成的网络，适用于
电网等权限要求较高的场景，且各节点之间能建立
独立的信息通道，能较好地保护供应商和用户的隐
私，其联盟节点成员为符合准入条件的普通用户、分
布式电能生产者和微电网运营商。采用实用拜占庭
容错（practical Byzantine fault tolerance，PBFT）算法
作为共识机制［14］，该共识机制采用数学计算，不需
要进行挖矿，实现区块链智能管理平台在最短的时
间内达成共识，以此提高区块链的交易速度以满足
微电网市场效率需求。为了激励市场中理性的“经
济人”参与记账过程，以达成共识，搭配设计了 2种
激励机制：①直接收取交易各方的手续费，作为记账
节点的收益，将该收益补偿给为促使达到优化作出
贡献的主体，例如中断负荷；②在记账中发行一定量
的区块链代币作为奖励，当交易节点进行安全校核
或阻塞管理等操作时，可选择支付代币换取交易优
先权。
1. 2 微电网动态博弈框架
将微电网中的产消者视作具有自主和协调能力
的“个体”，微电网系统通过交流母线向负荷供电，微
电网中的“个体”都安装了智能电表，利用智能电表
和各类控制器对用户负荷以及微电网能源装置的状
态（电压、功率、储能装置的充放电控制等）进行采集
和控制。微电网区块链智能管理平台主要负责对智
能电表采集的数据和信息进行监控、存储和分析，根
据智能管理平台的分析处理结果对各类控制器进行
控制，实现能量的优化调度，如图 1所示。
在区块链智能平台中注册，对符合准入市场条
件的“个体”ID进行加密并存储在相应的区块链中。
微电网通过公共耦合点与主网连接，当微电网生产
电能不能满足本地用户的需求时，由主网进行电力
供应；当微电网生产电能过剩时，则向主网进行能源
外送。微电网从主网购得电量的价格应低于本地电
价，消费者上报的购买价格应高于本地电价，通过这
种激励机制刺激买卖双方进行交易。为防止买卖双
方联盟定价干扰市场秩序，设定了闭区间申报价格
机制。在微电网每一轮博弈开始，管理平台将电量
和电价实时信息广播到各系统节点，微电网市场博
弈流程详见附录 B图 B1。
1. 3 智能合约设计
智能合约是一段预先编译协定并存储在区块链
中的程序代码，用于促进、验证和实现整体联系的协
议，其使用的是正常合同的推理和结构，根据最低限
度的人为干预条款，使合同裁决得以执行。其主要
内容包括：能源类型、需求量、交易时间、金额等。此
6F�D3� �	�D���3
M*�3 ��K� � �� �6=4
�4
�4��J�60)�	
���(
���
E	�
�6*=�
���
�6*=�
���
�6*=�
���
�6*=�
���
��*
���
*�!D�
"=�
LF>
&��/A
F>&��
/A
�6*=�
���
�6*=�
���
DC/DC
��*��
��
5	%
	��B8	�/B8 �	��B8
�
*
4
6
#
�
*
4
B
8
��
���
*F
*�
��
���
*F
*�
��
���
*F
*�
��
���
*F
*�
图 1 基于区块链的微电网市场动态博弈模型
Fig. 1 Dynamic game model of microgrid market
based on block chain
16
周步祥，等 基于区块链的微电网市场势博弈模型
http：//www.aeps-info.com
外，将智能合约中用户用电量和运营数据与大数据
平台衔接，可以有效地提高负荷预测的准确性，使得
发用电计划更加匹配。
智能合约有 5种基本的功能：①广播宣布每一
个竞价交易的开始；②买方接收当前卖方待售资源；
③等待一段时间，直到收到所有买家的出价；④比较
所有买家的出价，产生并宣布该轮电量的获得者；
⑤将结算款从买家账户转入相应卖家账户。电力交
易过程中，买家和卖家通过智能合同建立联系，买卖
双方完全自治，并对交易信息进行存储，以便在发生
纠纷时进行追溯，保证了交易安全。智能合约算法
流程图如附录 B图 B2所示。
2 基于双向时变信息交互的状态量序数势
博弈理论
2. 1 微电网市场双向时变信息交互下的拓扑网络
模型
从微电网市场拓扑结构来看，管理平台、负荷侧
和能源侧所构成的网络可以表示成一个无向图
H =( N，L，A )，其中，N ={ 1，2，…，n }为系统各参
与个体节点集合，n为参与个体节点总数；L为系统
节点间的通信线路集合；矩阵 A=（aij），aij：L→ R+，
aij= 1表示通信线路联通，aij= 0表示通信线路中
断，R+为正实数集合。
2. 2 状态量序数势博弈相关理论
势博弈分为完全势博弈、加权势博弈、序数势博
弈［9］，将状态量引入到序数势博弈中，为微电网市场
信息在博弈个体之间交互和传播提供机制，促进达
成合作共识。
对博弈模型 G={ N，{ Bi } i∈N，{ Ei } i∈N，X，g，θ }，
其中，X为状态空间；B={ Bi } i∈N 为任意个体 i∈N
与状态无关的行为集合；状态和行为相关的收益函
数为 E={ Ei } i∈N，E：X × B→ R；状态转移函数 g：
X × B× I→ R，表明状态更新与当前状态、行为以
及系统干扰 I有关。对于任意个体 i有 2个不同的行
为 bi ∈ Bi和bi '∈ Bi，其他所有参与者 b- i ∈ ∏
j≠ i
B j 保
持不变，如果存在一个光滑凸函数 θ：X × A→ R使
得式（1）成立，且对于当前状态行为 ( x，b )，有新状
态 x'= g ( x，b，I )，存 在 θ ( x，b )= θ ( x'，0 )，则 G=
{ N，{ Bi } i∈N，{ Ei } i∈N，X，I，g，θ }为状态量序数势博
弈［22-23］，函数 θ：X × A→ R为该博弈的势函数。
sgn ( Ei ( x，bi，b- i )- Ei（x，bi ，b- i ) )=
sgn ( θ ( x，bi，b- i )- θ（x，bi ，b- i ) ) （1）
充分考虑微电网区块链管理平台与能源侧、负
荷侧间通信可能存在的延迟和间歇性问题的影响，
利用状态空间中参与个体，依据管理平台提供的数
据信息对于真实值的估计值来解决上述影响。基于
最近邻决策思想确定收益函数［24］为：
Ei，t ( x，a )= Ei，t ( ej |aij ( t )= 1 )+ βE e
i，t ( ej |aij ( t )= 1 )=
∑
j∈N
δij ( t ) aij ( t ) γ ( ej，1，ej，2，⋯，ej，K )
∑
j∈N
δij ( t ) aij ( t )
+
β
∑
k=1
K
∑
j∈N
δij ( t ) aij ( t ) e2j，k
∑
j∈N
δij ( t ) aij ( t )
（2）
式中：ej 为个体 j对某一决策的估计值；β为权重系
数；E e
i，t（·）为引进减小误差函数；ej，k为个体 j对于决
策 k 真 实 值 的 估 计 值 ；K 为 决 策 总 数 ；
γ ( ej，1，ej，2，…，ej，K )为信息交互下的最小化全局目标
函数；等式右边第 2项引入减小估计误差；δij ( t )为
个体 i与个体 j之间信息重要程度的权重参数。
2. 3 状态均衡及存在性证明
如果对于一组状态和行为（x*，b*）满足以下 2个
条 件 ：① 对 于 任 意 博 弈 参 与 个 体 i∈N，都 有
b* ∈ arg min
bi ∈ Bi
Ci ( x*，bi，b*- i )成立，Ci（x*，bi，b*- i）为个
体 i的状态集合；②对于原状态 x* 和新状态 x=
g ( x*，b，I )，有 x*= x，那么（x*，b*）为状态量序数势
博弈的状态均衡［24-25］，该证明过程详见附录 C。
3 微电网市场状态量序数势博弈模型的建
立及求解
3. 1 微电网市场势博弈模型的建立
微电网电力市场调度优化模型主要考虑经济收
益，微电网收益目标函数为：
max Z= CBS - CAP - CO - CES - CDE - CDG （3）
式中：函数 Z为微电网运行日效益函数；CBS为微电
网向主网或本地用户购售电费用；CAP为奖惩费用；
CO为微电网运营商收取区块链运营费用；CES为储
能设备运维成本；CDE 为柴油机机组发电成本；CDG
为分布式发电设备运维成本。各变量表达式如式
（4）所示。
ì
í
î
ï
ï
ï
ï
ïï
ï
ï
ï
ï
ï
ï
ïï
ï
ï
CBS = ∑
t=1
T
∑
w=1
2
ctM，w P t
GS，wΔt
CAP =K 1 ( min ( 0，h1 ) )2+K 2h22-(ω e-ω e0 )R b ( t )+
cex ( t ) ( H ( t )-H ( t0 ) )
CES = θES || PES Δt
CDE =( θDEPDE- fc ) Δt+C on -off
CDG = θDGP t
DG，gΔt
（4）
17
2020，44（7） ·区块链技术在电力系统中的应用·
式中：T为 1 d交易时段数，因交易时间为 15 min，取
T=96；∆t为交易时间间隔；w=1表示微电网与主
网交易，w=2微电网与用户交易；ctM，w为第 t个时段
内微电网与主网或用户的交易电价；P t
GS，w 为第 t个
时间段内微电网与主网或用户交易电量，取负值表
示微电网向主网或本地用户购买电量，取正值表示
微电网向主网或本地用户出售电量；K 1和K 2为惩罚
因子，为更好地保证满足约束条件，取较大值；h1为
不等式约束条件；h2为等式约束条件；ω e和 ω e0分别
为当前阶段和基本标准的可再生能源利用率；R b ( t )
为提高 1%的可再生能源利用率获得的奖励收益；
cex ( t )为每增加单位标准污染气体排放受到的惩罚
费用；H ( t )和H ( t0 )分别为当前阶段和允许标准的
污染气体排放量；PES和 PDE分别为储能设备充放电
功率和柴油机发出功率；θES和 θDE分别为储能设备
和柴油机的运行维护成本；P t
DG，g为第 g个分布式电
源 t时段内输出功率；fc 为单位时间碳交易成本；
C on - off为启停成本；θDG为分布式电源运行维护成本；
微电网的年收益可由式（3）减去设备初始投资获得。
设备初始投资 C in表示为：
C in = ncDGPDG0 + mcESPES0 ∑
kES = 1
KES
( 1+ rc )-LES kES + C f
（5）
式中：cDG和PDG0分别为分布式电源单位投资成本和
单位容量；cES和 PES0分别为储能设备单位投资成本
和单位容量；KES为储能设备替换次数；rc为资金贴
现率；LES为储能设备的寿命周期；C f为微电网其他
固定成本（包括后备柴油机投资、控制设备、线路、建
设费用等）。
储 能 设 备 的 替 换 成 本 折 算 成 净 现 值（net
present value，NPV）考虑到初始投资中［20］，微电网
投资主体的净现值NNPV表达式为：
NNPV = (CM- C a ) ∑
l= 1
L
( 1+ rc )- l- C in （6）
式中：CM为年均收益；C a为年均运营成本；L为项目
年限。
根据负荷侧的能源需求，来实现能源供给侧各
设备间的能量输出优化控制，微电网市场运行需满
足实时功率平衡，即
∑
g= 1
nDG
P t
DG，g+ ∑
m= 1
nES
P t
ES，m- ∑
w= 1
2
P t
GS，w= 0 （7）
式中：P t
ES，m为 t时刻第 m个储能设备充放电功率（正
值为设备充电量，负值为设备放电量）；nDG和 nES分
别为分布式电源和储能设备的总数。
在式（7）约束下，分布式电源出力、储能装置充
放电功率及柴油机组出力与负荷侧相匹配。
为了降低自然环境和自身运行特点对能源侧出
力及微电网整体功率的影响，提出不对各分布式装
置实时输出进行控制，而是关注实际输出功率与其
最大输出功率比值，根据管理平台期望的输出功率
水平预测值，即
-α= p1 ( t )
pmax1 ( t )
= p2 ( t )
pmax2 ( t )
…=
pfDG ( t )
pmaxfDG ( t )
（8）
式中：pf ( t )和 pmaxf ( t )为分布式装置 f的输出功率和
其最大值，f = 1，2，⋯，fDG，其中，fDG 为分布式装置
总数；用 γ ' ( α1，α2，⋯，αfDG )= ∑
f = 1
fDG
( αf-
-α )2对能源侧
控制进行描述，当 γ '= 0时，所有分布式装置输出值
与预测值相等，使得装置运行在优化可行的功率水
平。将分布式装置出力优化问题转化为式（9）。
{min γ'（α1，α2…，αfDG）
s.t. αf ∈ ( 0，1 )，f =1，2，⋯，fDG
（9）
综上所述，可建立如式（2）所示的收益函数对
能源侧进行优化控制，在此不再赘述。相应地，对应
收益函数的势函数为：
θ ( x，b )=
∑
j∈N
aij ( t ) γ ( ej，1，ej，2，⋯，ej，K )
K
+
β
∑
k= 1
K
∑
j∈N
aij ( t ) e2j，k
K
（10）
为保证微电网能源侧各装置稳定协调运行，对
其控制还应满足以下等式约束和不等式约束条件：
ì
í
î
ï
ï
ï
ïï
ï
ï
ï
ï
ïï
ï
P min
DG，g ≤ P t
DG，g ≤ P max
DG，g
P min
ES，m ≤ P t
ES，m ≤ P max
ES，m
SminES，m ≤ StES，m ≤ SmaxES，m
ΔP min
DG ≤ ΔPDG ≤ ΔP max
DG
ΔP min
ES ≤ ΔPES ≤ ΔP max
ES
S0ES，m= SAES，m
（11）
式中：P min
DG，g和 P max
DG，g分别为分布式电源 g最小功率和
最大功率；P min
ES，m和 P max
ES，m分别为储能设备m最小和最
大充放电功率；SminES，m，StES，m 和 SmaxES，m 分别为储能装置
m在控制周期中荷电状态的最小值、t时刻荷电值和
最大值；ΔP min
DG 和 ΔP max
DG 分别为分布式电源增量 ΔPDG
的最小值和最大值；ΔP min
ES 和 ΔP max
ES 分别为储能装置
充 放 电 功 率 增 量 ΔPES 的 最 小 值 和 最 大 值 ；
S0ES，m和SAES，m 分别为储能装置 m在控制周期初始时
刻和结束时刻的荷电状态，两者相等保证了调度周
期之间的独立性。
18
周步祥，等 基于区块链的微电网市场势博弈模型
http：//www.aeps-info.com
微电网包含光伏、风机机组及储能元件等分布
式电源，采用电压源型电流控制逆变器实现能量输
出。分布式电源有功输出和注入电网电流恒定时，
相应的无功功率计算为：
{Qc+ 1 = |I|2 ( a2c+ b2c )- P 2
Uc= ac+ jbc
（12）
式中：Qc+ 1 为分布式电源第 c+1次迭代的无功功
率；|I|为恒定的电流相量幅值；ac和bc 为第 c次迭代
后电压 Uc 的实部和虚部；P为恒定的有功功率值。
对于辐射型微电网采用 DistFlow 等式表示潮流
约束［26］。
3. 2 状态量序数势博弈模型的求解
利用策略学习算法，对建立的微电网市场能源
供给侧状态量序数势博弈模型进行求解。将天气环
境参数和微电网市场负荷预测数据输入管理平台进
行分析处理，能源需求侧通过智能合约向智能管理
平台发送需求信息，由管理平台进行汇总分析处理
并广播至各节点。能源供给侧根据管理平台获得的
需求信息，通过各设备之间的信息双向交互，实现个
体的策略更新，使得决策收敛到博弈模型的均衡处。
在博弈开始时刻，个体 i在行为空间中任意选
择一个行为作为初始行为，并将该行为下的收益作
为初始收益，如果该收益不是状态均衡收益，以概率
p随机选取一个行为作为新行为，其中 p∈（0，1）。若
当前收益比初始收益小，则用新行为代替初始行为，
否则将保持初始收益进行下一次博弈，直到符合终
止条件完成势博弈求解过程，如附录 B图 B3所示。
4 算例分析
4. 1 仿真设计及基础数据
选取 4台风机、4组光伏阵列、1组蓄电池和 2台
柴油机进行仿真，不同新能源设备维护成本见表 1。
风机和光伏阵列的参数分别见表 2和表 3。光照、温
度、温度在未来 24 h内预测数据见附录 D图 D1，风
机、光伏功率及负荷预测数据见图 2。柴油机参数
数据见附录 D表 D1。蓄电池设定容量为 96 kW∙h，
具体参数数据见附录D表D2。
4. 2 博弈结果分析
选取 8组新能源设备进行仿真，验证该模型的
有效性。对机组之间的信息交互拓扑进行刻画，仿
真设计的拓扑结构为：在任意时刻 t，假定获取期望
比 值 的 某 机 组 i 与 机 组 j 进 行 信 息 交 互 ，则 有
aij ( t )= aji ( t )= 1，新能源设备的输出功率比值设为
α= 0.15，参数 β= 0.01。通过附录 D 图 D2 和图
D3可以看出，在开始时刻，各设备的输出比值与期
望最优比值的差距较大，但经过设备间双向的信息
交互后，设备通过优化自身收益函数，使得输出比值
趋近于期望最优比值，γ'的值趋向于 0。
如图 3所示，最后 8组新能源设备在博弈时间为
21.4 s时收敛至最优比值 α*= 0.95，博弈时间完全
满足日前或小时内的微电网市场调度优化速度的要
求。验证了双向时变信息交互下状态量序数势博弈
模型能有效保证新能源设备运行在最优的功率水
平上。
由图 2的负荷预测曲线可以看出，新能源设备
出力时间段在一定程度上与负荷的峰谷相契合，但
表 1 各类设备维护成本
Table 1 Maintenance cost of various equipments
设备类型
光伏
风机
柴油发电机
蓄电池组
维护成本/(元·kW -1)
0.009 4
0.029 6
0.093 7
0.082 7
表 2 风机参数
Table 2 Parameters of wind turbines
风机
1号
2号
3号
4号
切入风速
vi/(m·s-1)
3
3
3
3
额定风速
vr/(m·s-1)
11
11
10
10
切出风速
vo/(m·s-1)
20
20
25
25
额定功率/
kW
20
15
10
10
表 3 光伏阵列参数
Table 3 Parameters of photovoltaic arrays
光伏阵列
1号
2号
3号
4号
总计
额定功率/kW
20
20
30
15
85
00:00 05:00 10:00 15:00 20:00 23:00
0
50
100
150
200
250
��
�
(
/k
W
M�M"�(
��M"�(
M�M"�(�	
B8M"
图 2 未来 24 h内风机、光伏功率及负荷预测曲线
Fig. 2 Forecasting curves of wind turbine, photovoltaic
and load power in the future 24 hours
19
2020，44（7） ·区块链技术在电力系统中的应用·
仍不能满足负荷的需求，需要柴油机和蓄电池组的
功率支撑。进一步分析光伏和风机设备功率输出情
况，由图 4可以看出，光伏设备在 07：00—18：00时段
内，经过各设备间的双向信息交互，博弈输出功率接
近于预测最大输出功率。由图 5可以看出，风机除
弃风点外，博弈输出功率也接近于预测最大输出
功率。
究其原因，虽然光伏设备运维成本较低，但安装
固定，不易输出功率调整，因此在必要时由风机出力
调整。例如，在 08：00—09：00时段内，出现明显弃
风现象，并且加上风光能源的可再生性，经过各新能
源设备之间信息的双向交互，将 2种设备输出功率
保持在高利用率的水平上，符合微电网经济运行和
实际需求。
表 4对比分析了微电网在博弈优化前后指标值
的情况，由表 4可以看出，经过博弈优化后微电网收
益和能源利用率均有较大程度的提高，附录 D表 D4
给出了设备全寿命周期成本收益。
基于以上分析结果，文章提出的基于双向时变
信息交互下状态量序数势博弈模型在微电网优化运
行中的有效性和可行性得到验证。
5 结语
1）提出了一种基于双向时变信息交互下状态量
序数势博弈的微电网运行优化模型，并证明该模型
状态均衡的存在。
2）在区块链支持的微电网供需生态关系的基
础上设计了微电网市场总体框架，将电力交易区块
链化与智能合约相结合，个体决策可获取微电网实
时信息，弥补以往博弈模型在全局信息方面的不足，
并在微电网市场架构设计中加入奖惩机制，抑制个
体私欲过分膨胀，保证了模型博弈结果趋向优化问
题最优解。
3）在微电网中没有对各分布式装置实时输出进
行控制，而是控制实际输出功率与其预测最大输出
功率比值，使得该模型更具实际应用性。
4）仿真分析表明微电网中各个体之间双向信息
交互后，在保证新能源优先使用的前提下，微电网能
够运行在最优水平，验证了文章提出模型的有效性
和可行性，并提高了微电网能源利用率，增加了微电
网的经济收益。
5）就目前研究水平而言，区块链技术、微电网技
术都属于前沿技术，存在一定的局限性，例如：如何
00:00 05:00 10:00 15:00 20:00 23:00
0
20
40
60
80
100
�
(
/k
W
��
��M"�(
�����(
图 4 24 h内光伏预测与博弈预测功率对比图
Fig. 4 Comparison diagram of photovoltaic prediction
power and game prediction power within 24 hours
00:00 05:00 10:00 15:00 20:00 23:00
0
10
20
30
40
50
60
�
(
/k
W
��
M�M"�(
M����(
图 5 24 h内风机预测功率与博弈功率对比图
Fig. 5 Comparison diagram of wind turbine prediction
power and game prediction power within 24 hours
0.1
0 5 10 15 20 21.4 25
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
83
�
6
#
@
�
D
�
�
(
!
�
�K/s
013
023
033
043
053
063
073
083
图 3 8组新能源设备输出功率比值变化曲线图
Fig. 3 Variation curves of output power ratio of 8 groups
of renewable energy equipments
表 4 微电网经济指标值对比
Table 4 Comparison of microgrid
economic indicators
时段
07:00—10:00
10:00—13:00
13:00—16:00
16:00—18:00
原微电网统一调度
经济效
益/元
2 712.7
4 357.4
4 134.9
2 617.4
能源利
用率/%
85.6
88.4
89.2
87.7
微电网博弈优化调度
经济效
益/元
2 972.4
4 614.1
4 407.6
2 815.5
能源利
用率/%
93.2
95.3
96.7
94.5
20
周步祥，等 基于区块链的微电网市场势博弈模型
http：//www.aeps-info.com
实现区块链与智能合约的真正落地，可靠的区块链
实体用例较少等问题还需要相关领域的专家学者努
力攻克难关。微电网市场能否进一步突破桎梏，最
大程度地实现能源的优化配置，还需要有关部门出
台相应的政策予以规范和鼓励。
6）后续将在现有研究的基础上，结合电力物联
网技术，进一步研究区块链在微电网电力市场中多
链协同、跨链流通的形式，将微电网中多能交易、多
能互补及碳排放等能源项目资产化，应用区块链多
链互联的方式解决接口扩展适配问题，加速分布式
能源流通。
附录见本刊网络版（http：//www.aeps-info.com/
aeps/ch/index.aspx），扫英文摘要后二维码可以阅读
网络全文。
参 考 文 献
［1］艾芊，郝然 .多能互补、集成优化能源系统关键技术及挑战［J］.
电 力系统自动化，2018，42（4）：2-10.
AI Qian，HAO Ran. Key technologies and challenges for multi-
energy complementarity and optimization of integrated energy
system［ J］. Automation of Electric Power Systems，2018，
42（4）：2-10.
［2］周烨，汪可友，李国杰，等 .基于多智能一致性算法的微电网分
布式分层控制策略［J］.电力系统自动化，2017，41（11）：142-149.
ZHOU Ye，WANG Keyou， LI Guojie， et al. Distributed
hierarchical control for microgrid based on multi-agent consensus
algorithm［J］. Automation of Electric Power Systems，2017，
41（11）：142-149.
［3］陈刚，杨毅，杨晓梅，等 .基于分布式牛顿法的微电网群分布式
优化调度方法［J］.电力系统自动化，2017，41（21）：156-162.
CHEN Gang，YANG Yi，YANG Xiaomei，et al. Distributed
optimization scheduling method for microgrid cluster based on
distributed Newton method［J］. Automation of Electric Power
Systems，2017，41（21）：156-162.
［4］王晗，严正，徐潇源，等 .计及可再生能源不确定性的孤岛微电
网概率潮流计算［J］.电力系统自动化，2018，42（15）：110-117.
WANG Han，YAN Zheng，XU Xiaoyuan，et al. Probabilistic
power flow calculation of island microgrid considering uncertainty
of renewable energy［J］. Automation of Electric Power Systems，
2018，42（15）：110-117.
［5］林凯骏，吴俊勇，郝亮亮，等 .基于非合作博弈的冷热电联供微
能源网运行策略优化［J］.电力系统自动化，2018，42（6）：25-32.
LIN Kaijun，WU Junyong，HAO Liangliang，et al. Optimization
of operation strategy for micro-energy grid with CCHP systems
based on non-cooperative game［J］. Automation of Electric
Power Systems，2018，42（6）：25-32.
［6］刘延博，邱晓燕，邱高，等 .孤岛运行下含储能系统的微电网多
代理博弈模型［J］.高压电器，2016，52（7）：75-81.
LIU Yanbo，QIU Xiaoyan，QIU Gao，et al. Multi-agent game
model of micro-grid containing energy storage system in islanding
operation［J］. High Voltage Apparatus，2016，52（7）：75-81.
［7］刘洪，李吉峰，葛少云，等 .基于多主体博弈与强化学习的并网
型综合能源微网协调调度［J］.电力系统自动化，2019，43（1）：
40-48.
LIU Hong， LI Jifeng， GE Shaoyun， et al. Coordinated
scheduling of grid-connected integrated energy microgrid based
on multi-agent game and reinforcement learning［J］. Automation
of Electric Power Systems，2019，43（1）：40-48.
［8］赵敏，沈沉，刘锋，等 .基于博弈论的多微电网系统交易模式研
究［J］.中国电机工程学报，2015，35（4）：848-857.
ZHAO Min，SHEN Chen，LIU Feng，et al. A game-theoretic
approach to analyzing power trading possibilities in multi-
microgrids［J］. Proceedings of the CSEE，2015，35（4）：848-857.
［9］曾君，王侨侨，刘俊峰，等 .一种基于势博弈的微电网分布式运
行优化算法［J］.中国电机工程学报，2017，37（24）：7195-7204.
ZENG Jun，WANG Qiaoqiao，LIU Junfeng，et al. An operation
optimization algorithm of microgrid based on potential game［J］.
Proceedings of the CSEE，2017，37（24）：7195-7204.
［10］王蓓蓓，李雅超，赵盛楠，等 .基于区块链的分布式能源交易关
键技术［J］.电力系统自动化，2019，43（14）：53-64.
WANG Beibei，LI Yachao， ZHAO Shengnan， et al. Key
technologies on blockchain based distributed energy transaction
［J］. Automation of Electric Power Systems，2019，43（14）：
53-64.
［11］张宁，王毅，康重庆，等 .能源互联网中的区块链技术：研究框
架与典型应用初探［J］.中国电机工程学报，2016，36（15）：
4011-4022.
ZHANG Ning， WANG Yi， KANG Chongqing， et al.
Blockchain technique in the energy internet： preliminary
research framework and typical applications［J］. Proceedings of
the CSEE，2016，36（15）：4011-4022.
［12］张俊，高文忠，张应晨，等 .运行于区块链上的智能分布式电力
能源系统：需求、概念、方法以及展望［J］.自动化学报，2017，
43（9）：1544-1554.
ZHANG Jun，GAO Wenzhong，ZHANG Yingchen， et al.
Blockchain based intelligent distributed electrical energy
systems： needs， concepts， approaches and vision［J］. Acta
Automatica Sinica，2017，43（9）：1544-1554.
［13］袁勇，王飞跃 .区块链技术发展现状与展望［J］.自动化学报
2016，42（4）：481-494.
YUAN Yong，WANG Feiyue. Blockchain：the state of the art
and future trends［J］. Acta Automatica Sinica，2016，42（4）：
481-494.
［14］崔金栋，王胜文，辛业春 .区块联盟链视角下智能电网数据管
理 技 术 框 架 研 究［J］. 中 国 电 机 工 程 学 报 , 2020，40（3）：
836-848.
CUI Jindong，WANG Shengwen，XIN Yechun. Research on
technical framework of smart grid data management from
consortium blockchain perspective［J］. Proceedings of the
CSEE, 2020，40（3）：836-848.
［15］欧阳旭，朱向前，叶伦，等 .区块链技术在大用户直购电中的应
用初探［J］.中国电机工程学报，2017，37（13）：3737-3745.
OUYANG Xu，ZHU Xiangqian，YE Lun，et al. Preliminary
applications of blockchain technique in large consumers direct
power trading［J］. Proceedings of the CSEE，2017，37（13）：
3737-3745.
21
2020，44（7） ·区块链技术在电力系统中的应用·
［16］邰雪，孙宏斌，郭庆来 .能源互联网中基于区块链的电力交易
和阻塞管理方法［J］.电网技术，2016，42（12）：3630-3638.
TAI Xue， SUN Hongbin， GUO Qinglai. Electricity
transactions and congestion management based on blockchain in
energy internet［J］. Power System Technology，2016，42（12）：
3630-3638.
［17］李彬，曹望璋，祁兵，等 .区块链技术在电力辅助服务领域的应
用综述［J］.电网技术，2017，41（3）：736-744.
LI Bin， CAO Wangzhang， QI Bing， et al. Overview of
application of block chain technology in ancillary service market
［J］. Power System Technology，2017，41（3）：736-744.
［18］马天男，彭丽霖，杜英，等 .区块链技术下局域多微电网市场竞
争博弈模型及求解算法［J］.电力自动化设备，2018，38（5）：
191-203.
MA Tiannan，PENG Lilin，DU Ying，et al. Competition game
model for local multi-microgrid market based on block chain
technology and its solution algorithm［J］. Electric Power
Automation Equipment，2018，38（5）：191-203.
［19］祁兵，夏琰，李彬，等 .基于区块链激励机制的光伏交易机制设
计［J］.电力系统自动化，2019，43（9）：132-139.
QI Bing， XIA Yan， LI Bin， et al. Photovoltaic trading
mechanism design based on blockchain-based incentive
mechanism［J］. Automation of Electric Power Systems，
2019，43（9）：132-139.
［20］陈青恒，袁晓杰，何宇俊，等 .投资开放模式下基于全寿命周期
分析的离网型微网投资与优化［J］.电网技术，2018，42（8）：
2248-2455.
CHEN Qingheng， YUAN Xiaojie， HE Yujun， et al.
Investment and optimization of off-grid microgrid projects based
on life-cycle cost/benefit analysis with open investment mode
［J］. Power System Technology，2018，42（8）：2448-2455.
［21］王惠洲，于艾清 .基于联盟区块链技术的 V2V电力交易研究
［J］.现代电力，2019，36（3）：34-41.
WANG Huizhou，YU Aiqing. Study on V2V electricity trading
based on consortium blockchain technology［J］. Modern Electric
Power，2019，36（3）：34-41.
［22］MARDEN J R. State based potential games［J］. Automatica，
2012，48（12）：3075-3088.
［23］YOUNG H P. Strategic learning and its limits［M］. UK：
Oxford University Press，2004.
［24］张建良 .基于非合作博弈的分布式优化模型及算法研究［D］.
杭州：浙江大学，2014.
ZHANG Jianliang. Research on models and algorithms for
distributed optimization based on the non-cooperative games
［D］. Hangzhou：Zhejiang University，2014.
［25］YOUNG H P. Learning by trial and error［J］. Games and
Economic Behavior，2009，65（2）：626-643.
［26］任佳依，顾伟，王勇，等 .基于模型预测控制的主动配电网多时
间尺度有功无功协调调度［J］.中国电机工程学报，2018，
38（5）：1397-1407.
REN Jiayi，GU Wei，WANG Yong，et al. Multi-time scale
active and reactive power coordinated optimal dispatch in active
distribution network based on model predictive control［J］.
Proceedings of the CSEE，2018，38（5）：1397-1407.
周步祥（1965—），男，博士，教授，硕士生导师，主要研究
方向：调度自动化和电网规划。E-mail：hiway_scu@126.com
杨明通（1992—），男，通信作者，硕士研究生，主要研究
方向：能源互联网及电力市场。E-mail：1228970075@qq.com
史述青（1998—），男，本科，主要研究方向：电子技术及
计算机应用技术。E-mail：2016200103033@std.uestc.edu.cn
（编辑 施冬敏）
Blockchain Based Potential Game Model of Microgrid Market
ZHOU Buxiang1，YANG Mingtong1，SHI Shuqing2，WEI Jinxiao3，LI Zugang1，DONG Sheng1
(1. College of Electrical Engineering,Sichuan University,Chengdu 610065, China；
2. Glasgow College, University of Electronic Science and Technology of China, Chengdu 611731, China；
3. Sichuan Electric Power Design Consulting Co., Ltd., Chengdu 610094, China)
Abstract: Microgrid is effective to realize the complementary advantages, efficient accommodation, and grid-connected long-
distance transmission of renewable energies. Based on the distributed topological structure of blockchain similar to that of microgrid
market, the overall framework of microgrid market is designed. Taking a full consideration of economy and energy utilization of
microgrid market, this paper introduces the conceptions of game theory and potential game to convert constraints to state space,
and build a microgrid operation optimization model based on the ordinal potential game of state variables with two-way time-
varying information interaction. The state balance of this model is proved. In different information interaction conditions of
microgrid market, the strategic learning algorithm of games is used to solve this potential game model, and the operation of
microgrid market is optimized. Simulation results show that the application of this potential game model with rational microgrid
participants enables all devices of the microgrid to operate at the optimal level, increases the revenue of the microgrid, and
improves the utilization rate of renewable energy.
Key words: microgrid market; potential game; state equilibrium; renewable energy; blockchain
22