Local power consumption method of distributed photovoltaic generation in rural distribution network based on blockchain
Received: 24 June 2022 Revised: 8 November 2022 Accepted: 20 December 2022 IET Generation, Transmission & Distribution
DOI: 10.1049/gtd2.12748
ORIGINAL RESEARCH
Local power consumption method of distributed photovoltaic
generation in rural distribution network based on blockchain
Tao Zhang Jianhua Yang Kaiyuan Jin Tianjun Jing
College of Information and Electrical Engineering,
China Agricultural University, Beijing, China
Correspondence
Jianhua Yang, College of Information and Electrical
Engineering, China Agricultural University, Beijing
100083, China.
Email: yang.haag@163.com
Funding information
Science and Technology Project of State Grid
Corporation of China, Grant/Award Number:
5400-202133157A-0-0-00
Abstract
With the increasing penetration of distributed photovoltaic generation (DPVG) in the rural
distribution network, some problems such as abandoning solar energy and increasing volt-
age fluctuation have become more and more prominent. In order to promote local or
nearby power consumption of the photovoltaic (PV) generation in the distribution net-
work, the profit strategy is given with an optimal electricity price based on blockchain
technology (BCT) by considering the topology, the load fluctuation of the distribution
network and the reputation value of agricultural park consumers. The electricity price in
the blockchain (BC) transaction is used as an intermediate variable to establish the rev-
enue model for the PV generation, the agricultural park consumers and the distribution
network. The power trading mechanism of the PV generation is constructed in the decen-
tralized management agency of the BC. The maximum overall comprehensive income of
the PV generation and the park consumers is used as the objective function, and the Stack-
elberg game theory is applied to prove the existence of the optimal game strategy in the
transaction. The local power consumption method of the PV generation is simulated with
the optimal electricity price in the IEEE 33-node distribution network. The problem of
abandoning solar energy is effectively relieved within an appropriate voltage limitation,
and the comprehensive benefit of the PV generation and the park consumers is raised in
the distribution network.
1 INTRODUCTION
Now the installation capacity of distributed photovoltaic gener-
ation (DPVG) is continuously increasing in rural distribution
networks. In turn, some problems such as abandoning solar
energy and increasing voltage fluctuation have become more
and more prominent. Therefore, it is necessary to improve the
local or nearby ability of photovoltaic (PV) power consumption
in the distribution networks. Moreover, blockchain technology
(BCT) can be applied in DPVG energy transaction for the
consumption. BCT is considered to be a combination of dis-
tributed storage, point-to-point transmission and consensus [1,
2]. The decentralization, transaction information immutability
and open consensus of the blockchain (BC) are the keys to par-
ticipating in the energy transaction [3–5]. BC is also applied to
the multi-energy transaction scenario [6].
This is an open access article under the terms of the Creative Commons Attribution-NonCommercial-NoDerivs License, which permits use and distribution in any medium, provided the
original work is properly cited, the use is non-commercial and no modifications or adaptations are made.
© 2023 The Authors. IET Generation, Transmission & Distribution published by John Wiley & Sons Ltd on behalf of The Institution of Engineering and Technology.
Aiming at the local PV power consumption problem, Chen
[7] used BC to control the time-shifted load in agricultural
parks. In addition, Reza [8] provided an economic demand
response model for residential consumers to change their con-
sumption pattern from the times of high-energy prices to other
times for maximising their utility functions. Ali [9] established
a bi-level programming framework using the concept of multi-
leader-follower game theory to determine the optimal contract
prices of virtual power plant in distribution networks. Lee [10]
explored the mechanism of distributed energy trading between
microgrids and studied economic benefits through the multi-
level Stackelberg game model. In [11], distributed generation
owners and agricultural park consumers got greater benefits
by the peer-to-peer (P2P) trading mode. In [12], a new micro-
grid power trading strategy was proposed to solve the problem
of power consumption by using the simplex method and the
IET Gener. Transm. Distrib. 2023;17:1409–1418. wileyonlinelibrary.com/iet-gtd 1409
https://orcid.org/0000-0002-1097-5501
mailto:yang.haag@163.com
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://wileyonlinelibrary.com/iet-gtd
http://crossmark.crossref.org/dialog/?doi=10.1049%2Fgtd2.12748&domain=pdf&date_stamp=2023-01-14
1410 ZHANG ET AL.
Nash equilibrium solution of the game theory to determine the
optimal power sale scheme. Furthermore, the signing of an elec-
tricity transaction agreement usually occurs before the users
actually consume power energy, while the actual power gen-
eration and consumption may not match the contract, which
may increase information security risk [13]. Liu [14] assessed
the effect of uncertainties in both PV power and loads on the
day-ahead schedule of microgrids.
In the electricity trading mode with BCT, Stackelberg game
was widely used to get the optimal electricity price [15]. Under
the expectation income of electricity sale companies from pur-
chasing and selling electricity with the goal of maximizing the
comprehensive utility of residential users, an incomplete infor-
mation model of Stackelberg game was established among
electricity sale companies and residential users [16]. The opti-
mal adjustment ability of electricity price and power energy
storage was used for flexible resources and local power energy
consumption [17]. The time-of-use electricity price can play
an important role in improving the overall economic bene-
fits of power systems [18]. The electricity price bidding model
might be established for new energy in a real-time market,
which could make the bidding strategy more reasonable [19].
In order to increase the local electricity consumption of PV
generation, the incentive mechanism using an optimal internal
electricity price was proposed with BCT [20]. Bokkisam [21]
proposed a transactive energy framework to minimize the elec-
tricity bills through the demand response management with
P2P energy trading among the residential buildings in commu-
nity microgrids, where the virtual agent might be implemented
by using the BC environment without third-party. In [22],
some innovative approaches were proposed for efficient inte-
gration and management of these cryptocurrencies in order to
face the challenging aspects of smart grids in the presence of
BC-based cryptocurrencies. Gokcek [23] proposed a bi-level
optimal bidding strategy in which community energy storage
systems and community PV generation were considered for the
P2P energy trading market with excess power being sold to
neighbours.
The BC energy transaction mechanism has been analysed in
the existing literature. In rural distribution networks, however,
some in-depth research needs to be done for the BC trans-
action electricity price and the coordinated consumption of
time-shifted loads with DPVG stations.
The above literature did not explore the relationship between
the optimal electricity price and the multi-party income in
the local DPVG power consumption process. It is also nec-
essary to solve the optimal time-shifted power strategy in
rural distribution networks through the Stackelberg game
model.
The following contributions are stated in this paper:
1. In view of the problem that the extensive power of
DPVG stations cannot be locally or nearby consumed in
the rural distribution network, the optimal BC transac-
tion electricity price can be used as a variable to construct
multi-party comprehensive income functions including agri-
cultural park consumers, DPVG stations and the grid
company.
2. The coupling between BC and distributed trading is ana-
lyzed. Also, a decentralized BC transaction mechanism is
established with distributed transaction characteristics.
3. The relationship between the optimal transaction electric-
ity price and the time-shifted consumption power is derived.
Furthermore, the existence of the optimal price is proved.
4. The maximum overall comprehensive income of the sta-
tions and the consumers is taken as the objective function.
The optimal transaction electricity price and the reason-
able time-shifted consumption power of each consumer are
determined through the Stackelberg game model.
The remainder of the paper is organized as follows. The
applicability of BCT in electric energy transaction is validated
and the BC profit-making mechanism is identified in Section 2.
The local PV power consumption method is proposed in Sec-
tion 3. The existence of optimal BC electricity price is proved
through the Stackelberg model with the decentralized BC man-
agement agency in Section 4. Simulation results are presented
to verify the correctness of the proposed method in Section 5.
Finally, conclusions are evaluated in Section 6.
2 APPLICABILITY OF BCT IN
ELECTRIC ENERGY TRANSACTION
2.1 Coupling analysis of BC and distributed
transaction
The power of DPVG needs to be consumed locally as much
as possible in the distribution network. This problem may be
solved by applying the distributed transaction which includes
some new features such as decentralized P2P transactions, open
and transparent transactions, and data security sharing. BCT
can be used to ensure the normal and orderly progress of the
distributed transaction because of its adaptability to the new
characteristics of the distributed transaction. The coupling anal-
ysis of the BC and the distributed transaction are shown in
Figure 1.
2.2 BC profit-making mechanism
According to the specific topology of the rural distribution net-
work, the electrical distance between one DPVG station and an
agricultural park consumer can be determined. In the decentral-
ized BC management agency, the scoring function, Dij, of the
electrical distance is expressed as [20]
Di j =
⎧⎪⎪⎨⎪⎪⎩
100 − 5di j , 0 ≤ di j ≤ 2
110 − 10di j , 2 < di j ≤ 5
60 else
(1)
 17518695, 2023, 6, D
ow
nloaded from
 https://ietresearch.onlinelibrary.w
iley.com
/doi/10.1049/gtd2.12748 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
ZHANG ET AL. 1411
FIGURE 1 Coupling analysis of BC and distributed transaction. BC,
blockchain.
where dij is the minimum electrical distance between consumer
i and station j, and the impedance modulus value of the power
line is taken in the distribution network.
The transaction information of one agricultural park con-
sumer, as a factor affecting the discount coefficient, can
be uploaded to the management agency for storage and
calculation to obtain the impact score with both con-
tracted and actual electricity consumption values of the
previous day in the consumer. The default rate of the
consumer is defined as expressed in Equation (2), and
the scoring function of the management agency on the
default rate of the agricultural park consumer is shown in
Equation (3) [20].
bi =
1
nPV
nPV∑
𝛾=1
||||||
ET
act.i.𝛾 − ET
deal.i.𝛾
ET
deal.i.𝛾
|||||| × 100% (2)
Bi =
⎧⎪⎪⎨⎪⎪⎩
50
(
−lg
(
15 bi + 1
10
)
+ 1
)
, 0 ≤ bi ≤ 20%
−174.75 bi + 104.85, 20% < bi ≤ 60%
0, 60% < bi ≤ 100%
(3)
where bi is the default rate of consumer i in TPV, the control and
consumption period of the stations, on the previous day. Bi is
the score of bi, that is, a mutual reputation value. T is one meter-
ing period, for example, 15 min. nPV is the number of metering
periods in TPV. ET
act.i.𝛾 and ET
deal.i.𝛾 are the actual and the agreed
consumption of DPVG power energy at consumer i in the γth
metering period, respectively.
Different production characters of the agricultural park con-
sumers lead to different load variation characteristics. In order
to reduce the burden of the distribution network regulation
caused by excessive load fluctuations of the consumers, the load
information of each consumer is uploaded to the management
agency as part of the block. The scoring function of the man-
agement agency on the load fluctuation of the consumer can be
expressed as [20]
Fi = 100 −
𝜎i
𝜆i
× 100 (4)
where Fi is the load fluctuation score, σi and λi are the stan-
dard deviation and arithmetic mean of the load fluctuation of
consumer i, respectively.
Assume that there are m stations and n park consumers. Based
on the network topology information, the initial consumption
area and distance weight coefficient are divided in the manage-
ment agency. Besides, the comprehensive score, Gcon.i, of the
station to consumer i can be expressed as [20]
Gcon.i = a
m∑
j=1
fi j Di j + bBi+cFi (5)
where a, b, and c are the weight coefficients of the electrical
distance, the mutual reputation value, and the load fluctua-
tion information, respectively. The consumption area is divided
according to the geographical location of the DPVG stations
and the park consumers. fij is the scoring weight of station j
to consumer i, and the station only scores for the consumer
in the same consumption area. If there are multiple stations in
the same consumption area, the weights will be equally divided,
for example fij= fik = 0.5 when stations j and k are in the
consumption area with consumer i.
The electrical distance and the load fluctuation are deter-
mined by the network topology and the load characteristics,
respectively. They are regarded as fixed influencing factors.
In consideration of the changes in the transaction reputation
value, the weights of variable and fixed influencing factors are
equally divided. Assuming constant values a = 0.25, b = 0.5 and
c = 0.25, the profit discount coefficient αi can be represented as
[20]
𝛼i =
⎧⎪⎪⎪⎪⎨⎪⎪⎪⎪⎩
0.90, 90 < Gcon.i ≤ 100
0.92, 80 < Gcon.i ≤ 90
0.95, 70 < Gcon.i ≤ 80
0.98 60 < Gcon.i ≤ 70
1.00 0 < Gcon.i ≤ 60
(6)
3 LOCAL PV POWER CONSUMPTION
METHOD
3.1 Comprehensive income of DPVG
The revenue of the DPVG station is divided into two parts,
namely the local power consumption revenue promoted by the
optimal BC electricity price and the grid acquisition revenue.
After the local PV power consumption method based on BCT
is adopted, the sum revenue,
∑m
j=1 AT
PV. j .𝛾 , of the station can
be determined during the γth T when all the stations as a whole
 17518695, 2023, 6, D
ow
nloaded from
 https://ietresearch.onlinelibrary.w
iley.com
/doi/10.1049/gtd2.12748 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
1412 ZHANG ET AL.
TABLE 1 Time-of-use electricity prices for consumers
Time period
Electricity price
/(Yuan/kWh)
On peak 8:00–11:30,18:30–23:00 0.6714
Mid peak 7:00–8:00,11:30–18:30 0.4489
Off peak 23:00–7:00 0.2265
perform different electricity price αips of the BC transaction on
consumer i, which is expressed as
m∑
j=1
AT
PV. j .𝛾 =
⎧⎪⎪⎨⎪⎪⎩
∑n
i=1 (𝛼i ps − p𝜇 )xT
pv.i.𝛾 + (pgs + ppol )
(∑m
j=1 E T
gen. j .𝛾 −
∑n
i=1 xT
pv.i.𝛾
)
,∑m
j=1 E T
gen. j .𝛾 ≥
∑n
i=1 xT
pv.i.𝛾∑n
i=1 (𝛼i ps − p𝜇 )xT
pv.i.𝛾 ,
∑m
j=1 E T
gen. j .𝛾 <
∑n
i=1 xT
pv.i.𝛾
(7)
where ps is the transaction price. xT
pv.i.𝛾 is the electric energy
production of PV generation consumed by consumer i in the
γth T. pgs is the guide price of PV generation energy purchased
by the grid company. ppol is the subsidy price of PV genera-
tion energy specified by the government. ET
gen. j .𝛾 is the electric
energy production of station j with the diminution amount of
abandoned power in the γth T. pμ is the network fee, here
set pμ = 0.2965 − 0.2865 = 0.010 Yuan/kWh, which is the
difference price between 10 and 35 kV [24, 25].
As a comparison, the electric energy generated by the station
is purchased by the grid company in the γth T before adopt-
ing the consumption method. Also, the electricity sale revenue,∑m
j=1 AT
all. j .𝛾 , is expressed as
m∑
j=1
AT
all. j .𝛾 = (pgs + ppol )
m∑
j=1
ET
gen. j .𝛾 (8)
From Equations (7) and (8), it can be seen that the income by
using the local PV power consumption method is greater when
pgs + ppol < 𝛼i ps is satisfied.
3.2 Comprehensive income of agricultural
parks
Based on the division of peak and valley electricity prices in
some Chinese western provinces, the time-of-use electricity
prices are shown in Table 1 for the agricultural park consumers.
As the buyer and user of electricity, the agricultural park con-
sumer can choose to purchase electricity from the grid company
or directly trade with the DPVG station at the BC transaction
price. In the γth T, the comprehensive income of consumer i
directly purchasing electricity from the grid company is shown
in Equation (9), and the comprehensive income of the direct
transaction with the PV station at the BC transaction price is
expressed in Equation (10).
AT
i.𝛾 = kT
i.𝛾 ln
(
1 + xT
i.𝛾
)
− p′gxT
i.𝛾 (9)
AT
use.i.𝛾 = kT
i.𝛾 ln
(
1 + xT
pv.i.𝛾
)
− 𝛼i psx
T
pv.i.𝛾 (10)
where kT
i.𝛾 is the benefit coefficient of consumer i in the γth T
[26]. xT
i.𝛾 is the electricity consumption of consumer i in the γth
T. p′g is the comprehensive price for the consumer to purchase
electricity, and the average electricity price of one day is normally
taken as this price.
Comparing Equations (9) and (10), when the same amount
of electricity is used in one consumer and (p′g − 𝛼i ps )xT
pv.i.𝛾 > 0
is satisfied, it can be deduced that there will be the electricity
income in the consumer.
3.3 Comprehensive income of grid
After the grid company participates in the local PV power
consumption process based on BCT, as an intermediary ser-
vice provider, its comprehensive income can be divided into
three parts: the income from the power energy loss reduction
of the distribution network, the income from the increase of
PV generation power due to the reduction of abandoned solar
energy, and the income from postponing the modification of
the distribution network.
When the DPVG station is connected to the distribution
network, the active power loss of the distribution network is cer-
tainly changed. After the local PV power consumption method
is adopted in the distribution network, the income of the power
energy loss reduction in TPV,
∑nPV
𝛾=1 AT
net.loss.𝛾 , is expressed in
Equation (11).
nPV∑
𝛾=1
AT
net.loss.𝛾 =
nPV∑
𝛾=1
pgΔET
loss.𝛾 (11)
where ΔET
loss.𝛾 is the reduction of the power energy loss in the
γth T after the consumption method is adopted, pg is the grid
electricity price in T.
With the reduction of abandoned PV solar energy, the benefit
of the grid company in TPV,
∑nPV
𝛾=1 AT
net.pur.𝛾 , can be expressed
as
nPV∑
𝛾=1
AT
net.pur.𝛾 = (pg − pgs − ppol )
nPV∑
𝛾=1
m∑
j=1
ΔET
gen. j .𝛾 (12)
where ΔET
gen. j .𝛾 is the reduction amount of abandoned PV
power energy in the γth T after station j participates in the local
PV power consumption process.
The reduction of the PV solar energy is equivalent to an
increase in installed PV capacity, which corresponds to post-
poning the modification of the distribution network. Relevant
income can be calculated in units of years, which is converted to
 17518695, 2023, 6, D
ow
nloaded from
 https://ietresearch.onlinelibrary.w
iley.com
/doi/10.1049/gtd2.12748 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
ZHANG ET AL. 1413
TPV as
∑nPV
𝛾=1 AT
net.renew.𝛾
nPV∑
𝛾=1
AT
net.renew.𝛾 =
nPVCnew
∑nPV
𝛾=1
∑m
j=1 ΔPT
PV. j .𝛾
365 × 96
(13)
where Cnew is the annual equivalent deferred construction value
of installed capacity for the DPVG station, which can be 310
Yuan/kW⋅a [27]. ΔPT
PV. j .𝛾 is equivalent increased capacity of
station j in the γth T after the consumption method is adopted.
The comprehensive income of the distribution network in
TPV ,
∑nPV
𝛾=1 AT
net.𝛾 , is determined as
nPV∑
𝛾=1
AT
net.𝛾 =
nPV∑
𝛾=1
AT
net.loss.𝛾
+
nPV∑
𝛾=1
AT
net.pur.𝜆 +
nPV∑
𝛾=1
AT
net.renew.𝛾 (14)
4 OPTIMAL SOLUTION OF
STACKELBERG GAME
4.1 Objective function
The objective function F1 is the overall comprehensive income
of both the DPVG stations and the agricultural park consumers
in TPV, which can be represented in Equation (15). The objec-
tive function F2 is the comprehensive income constraint of the
distribution network in TPV, as shown in Equation (16).
max F1 =
nPV∑
𝛾=1
(
n∑
i=1
AT
use.i.𝛾 +
m∑
j=1
AT
PV. j .𝛾
)
(15)
F2 =
nPV∑
𝛾=1
AT
net.𝛾 > 0 (16)
4.2 Proof of optimal BC electricity price
Not all non-cooperative game models have theoretical optimal
solutions. Therefore, it is necessary to prove that there is an
optimal game strategy in the game model, that is, there are
the optimal BC electricity price and the corresponding opti-
mal time-shifted consumption power in each agricultural park
consumer.
Normally the consumer directly purchases electricity from
the grid company. The income of consumer i from the normal
electricity use in the γth T is shown in Equation (9). At this time,
the first-order partiality of the equation is determined as
𝜕AT
i.𝛾
𝜕xT
i.𝛾
=
kT
i.𝛾
1 + xT
i.𝛾
− p′g (17)
In the γth T, there is a benefit coefficient that maximizes the
income of the consumer from the normal electricity use. Make
Equation (17) zero to get the benefit coefficient, kT
i.𝛾 , as follows:
kT
i.𝛾 = p′g(1 + xT
i.𝛾 ) (18)
When the benefit coefficient remains this value, the first
and second derivatives of AT
use.i.𝛾 with respect to xT
pv.i.𝛾 are
calculated in Equations (19) and (20), respectively.
𝜕AT
use.i.𝛾
𝜕xT
pv.i.𝛾
=
kT
i.𝛾
1 + xT
pv.i.𝛾
− 𝛼i ps (19)
𝜕2AT
use.i.𝛾
𝜕xT
pv.i.𝛾
2
=
−kT
i.𝛾(
1+xT
pv.i.𝛾
)2
< 0 (20)
From Equations (19) and (20), it can be known that AT
use.i.𝛾
is a strictly convex function with respect to xT
pv.i.𝛾 . Therefore, in
the γth T, there is xT
pv.i.𝛾 such that AT
use.i.𝛾 is the largest. After
Equation (19) is made zero, its result is combined with Equa-
tion (18) to obtain the game relationship between αips and xT
pv.i.𝛾
as follows:
xT
pv.i.𝛾 =
p′g(1 + xT
i.𝛾 )
𝛼i ps
− 1 (21)
Substitute Equations (21) into (15), and calculate the second
derivative of F1 with respect to ps, which is expressed as
𝜕2F1
𝜕p2
s
=
nPV∑
𝜆=1
n∑
i=1
(
𝛼i ps − 2(p𝜇 + pgs + ppol )
)
kT
i.𝛾
𝛼i p3
s
(22)
When 𝛼i ps < 2(p𝜇 + pgs + ppol ) is satisfied, the second
derivative of F1 with respect to ps is always less than 0, then
F1 is a strictly convex function with respect to ps, which proves
that there is an optimal electricity price ps.best that maximizes F1,
that is, there is indeed an optimal BC electricity price αips.best.
In addition, the electric energy of DPVG consumed by con-
sumer i in the γth T satisfies some constraints which can
be expressed in Equations (23) and (24), respectively. If the
constraint is exceeded, the critical value can be taken.
xT
min.pv.i.𝛾 ≤ xT
pv.i.𝛾 ≤ xT
max.pv.i.𝛾 (23)
n∑
i=1
xT
pv.i.𝛾 ≤
m∑
j=1
ET
gen. j .𝛾 (24)
where xT
min .pv.i.𝛾 and xT
max .pv.i.𝛾 are the critical minimum and
maximum values of the electric energy of DPVG consumed by
consumer i in the γth T, respectively.
According to the relevant standards of voltage quality in
China, the voltage deviation of the PV grid-connected node
 17518695, 2023, 6, D
ow
nloaded from
 https://ietresearch.onlinelibrary.w
iley.com
/doi/10.1049/gtd2.12748 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
1414 ZHANG ET AL.
should not exceed ± 7% of the rated grid voltage UN:
0.93UN ≤ Upv. j ≤ 1.07UN (25)
where Upv .j is the PV grid-connected node voltage of DPVG
station j.
After determining the optimal game strategy ΩT
𝛾 (ps.best,
PT
pvbest.i ) of the consumer, the normal electric energy output of
each DPVG station can be calculated in TPV according to the
voltage fluctuation of each PV grid-connected node. The volt-
age critical value can be taken for the PV grid-connected node
when the voltage of the node does not meet the constraints
of Equation (25), and then the normal output of each station
can be recalculated in TPV. The amount of abandoned electric
energy of each station can finally be determined in TPV under
the constraints of Equation (25).
4.3 The decentralized BC management
agency
In the DPVG energy transaction involving multiple subjects,
the most concerned variables of each transaction subject are the
transaction prices and the mutual reputation value. The decen-
tralized BC management agency can be used to save data in
each node to prevent tampering, verify the validity of transac-
tion information, and solve the problem of the reputation value
in the electric energy transaction.
With the coupling analysis of the BC characteristics and
distributed transaction characteristics, the DPVG energy trans-
action process can be determined for the decentralized BC
management agency based on the Stackelberg game model, as
shown in Figure 2, which is mainly divided into seven parts: (1)
Transaction access, (2) Discount strategy, (3) Optimal game, (4)
Transaction agreement, (5) Transaction information record, (6)
Transaction execution, and (7) Transaction feedback.
The DPVG stations and the agricultural park consumers
obtain transaction accounts after review and participate in the
electric energy transaction. The discount coefficient and the
optimal game strategy of each consumer jointly participate in
the formation of the smart contract. After the transaction is
completed, the BC management agency records the transaction
default information.
5 SIMULATION EXAMPLE
5.1 Simulation parameters
The IEEE 33-node distribution network is taken as a simulation
example, as shown in Figure 3. The total load of the distribution
area is 3.830 + j1.570 MVA, and the reference value of the line
voltage is 12.66 kV.
Assume that there are six DPVG stations, which are installed
at nodes 7, 9, 15, 27, 28, and 32, with installed capacities of 1200,
1000, 600, 800, 800, and 600 kW, respectively. Suppose planting
park consumers 1 and 2 are at nodes 11 and 12 respectively,
FIGURE 2 Decentralized BC management agency
FIGURE 3 IEEE 33-node distribution network
and breeding park consumers 1 and 2 are at node 29 and node
30 respectively, and there are 28 residential users which are at
remaining nodes. The default rates are assumed to be 5%, 7%,
10%, and 7% for plantation consumers 1 and 2, and breeding
park consumers 1 and 2, respectively.
According to the geographical location of the DPVG sta-
tions and the park consumers, the consumption area and load
information of each node are determined as shown in Table 2.
In addition, there are not time-shifted loads in the residential
users. Here, it is considered that the power generation output
characteristics of all stations are similar, as in Figure 4 with-
out considering the node voltage exceeding the constraints. The
load curves of the breeding park consumers, the planting park
consumers, and the residential users are shown in Figure 4.
The guide price pgs of the centralized PV generation is set at
0.350 Yuan/kWh, and the subsidy standard ppol is adjusted to 0
 17518695, 2023, 6, D
ow
nloaded from
 https://ietresearch.onlinelibrary.w
iley.com
/doi/10.1049/gtd2.12748 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
ZHANG ET AL. 1415
TABLE 2 Load information of IEEE 33-node network
Local consumption area 1 Local consumption area 2
Node
Maximum
load / kVA Node
Maximum
load / kVA Node
Maximum
load / kVA
6 60 + j20 2 120 + j40 28 60 + j20
7 120 + j40 3 90 + j40 29 260 + j105
8 120 + j40 4 130 + j55 30 310 + j135
9 60 + j20 5 60 + j20 31 150 + j70
10 60 + j20 19 90 + j40 32 120 + j40
11 350 + j160 20 90 + j40 33 60 + j20
12 400 + j190 21 90 + j40
13 60 + j20 22 90 + j40
14 120 + j40 23 90 + j50
15 60 + j20 24 140 + j65
16 70 + j25 25 140 + j65
17 60 + j20 26 60 + j20
18 80 + j30 27 60 + j20
FIGURE 4 Relative curves of loads and PV output. PV, photovoltaic.
TABLE 3 Information on benefit factors of each consumer
Park consumer
Planting
park 1
Planting
park 2
Breeding
park 1
Breeding
park 2
Discount coefficient 0.92 0.95 0.92 0.92
[28]. The optimal BC electricity price and optimal time-shifted
consumption power for each park consumer are determined
through simulation calculation.
5.2 Simulation analysis
The discount coefficient of each consumer is determined by the
BC management agency, as shown in Table 3.
FIGURE 5 PV grid-connected node voltage fluctuation
Before adopting the consumption method based on BCT,
during the PV output period 8:00 to 18:00, the voltage fluctu-
ation of each PV grid-connected node is shown in Figure 5. It
can be seen from Figure 5 that the node voltage exceeds the
voltage limit between 12:00 and 15:00, and the voltage devia-
tion exceeds the specified value by 7%. To ensure voltage quality,
the power output of the stations has to be limited. In order to
ensure that the voltage fluctuation of each PV grid-connected
node is normal in all metering periods, the amount of aban-
doned power energy between 12:00 and 15:00 of stations 1 to 6
is 243.555, 353.154, 389.688, 221.63, 340.977, and 474.932 kWh,
respectively. It is clear that the phenomenon of abandoning
solar energy is serious in the stations. The installed capacity of
each station is equivalently reduced by 49.518, 71.800, 79.228,
45.061, 69.325, and 96.559 kW, respectively.
It is determined that TPV is 12:00 to 15:00, nPV is 12. Dur-
ing TPV, the local consumption control is performed. Figure 6
shows the power variation of the distribution network through
branches 1 to 2 on a typical day. The maximum reverse power
 17518695, 2023, 6, D
ow
nloaded from
 https://ietresearch.onlinelibrary.w
iley.com
/doi/10.1049/gtd2.12748 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
1416 ZHANG ET AL.
FIGURE 6 Power distribution of IEEE 33-node network
FIGURE 7 Comprehensive income F1 change curve
TABLE 4 Optimal BC electricity price for consumers
Park consumer
Planting
park 1
Planting
park 2
Breeding
park 1
Breeding
park 2
αips.best/Yuan/kWh 0.357 0.369 0.357 0.357
is 18896.243 kW in TPV. The simulation step size of ps is set
at 0.001Yuan/kWh, and when the station chooses ps to change
from 0.350 to 0.480 Yuan/kWh, the relationship between F1
and ps is shown in Figure 7.
From Figure 7, it is known that a maximum value, 3810.450
Yuan, is achieved for the overall comprehensive income F1,
when the optimal game strategy of the leader is ΩT
𝛾 (0.388),
that is, the optimal electricity price ps.best is chosen to be
0.388 Yuan/kWh.
As mentioned earlier, the metering period T is 15 min, and
it is considered that both the PV power and the power of
the consumers remain unchanged during T, then xT
pvbest.i.𝛾 =
0.25PT
pvbest.i.𝛾 .
According to the game relationship shown in formula
(21), when the optimal electricity price ps.best is set at 0.388
Yuan/kWh and the constraints of Equations (23) and (24)
are satisfied, the optimal game strategy ΩT
𝛾 (0.388𝛼i , x
T
pvbest.i.𝛾 )
can be determined for different metering periods, as shown in
Tables 4 and 5, respectively.
TABLE 5 Optimal time-shifted power of consumers
Time-shifted power /kW
Period
Planting
park 1
Planting
park 2
Breeding
park 1
Breeding
park 2
12:00 107.839 119.285 139.243 165.971
12:15 88.910 98.336 136.459 162.651
12:30 97.009 107.299 55.948 66.657
12:45 103.436 114.412 73.082 87.087
13:00 101.939 112.756 55.446 66.059
13:15 139.355 154.166 54.533 64.970
13:30 126.148 139.550 55.295 65.879
13:45 142.524 157.674 55.688 66.348
14:00 171.136 189.340 56.677 67.527
14:15 18.411 21.041 105.865 126.175
14:30 54.181 61.921 55.132 65.684
14:45 159.880 182.720 56.339 67.124
FIGURE 8 Voltage fluctuation of PV grid-connected node under optimal
game strategy
After the consumption method is adopted, the overall PV
power consumption in each park consumer can be calculated
to be 4741.108 kW from Table 5. At this time, the voltage viola-
tion of each PV grid-connected node is alleviated, the reduced
amount of the PV generation power energy can be determined.
The influence of the optimal game strategy on the voltage
fluctuation of the PV grid-connected nodes is analyzed, and the
voltage fluctuation of the nodes is shown in Figure 8. It is clear
that the voltage fluctuation of each PV grid-connected node is
within the allowable range. It means that the over-limit situa-
tion of the PV grid-connected node is alleviated, and the power
output of the DPVG stations is increased.
Nodes n5, n11, n29, and n18 are selected as representative
nodes of different load types in different consumption areas,
and the effects of the optimal game strategy are analyzed for
different types of the agricultural parks on the node voltage.
The voltage variations of these nodes are shown in Figure 9.
 17518695, 2023, 6, D
ow
nloaded from
 https://ietresearch.onlinelibrary.w
iley.com
/doi/10.1049/gtd2.12748 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
ZHANG ET AL. 1417
FIGURE 9 Node voltage of some users under the optimal game strategy
The results show that the game strategy can maintain the node
voltage deviation within the allowed range.
In order to ensure that the voltage fluctuation of each
PV grid-connected node is within the normal range in all
time periods, the abandoned power energy of stations 1 to 6
between 12:00 and 15:00 is 114.471, 124.213, 172.924, 99.857,
144.125, and 221.635 kWh, respectively. The phenomenon of
abandoning solar energy has been alleviated. At this time,
the installed capacity of each station is equivalently reduced
by 23.273, 25.254, 35.157, 20.302, 29.302, and 45.061 kW,
respectively.
Under the optimal game strategy, considering the electricity
cost of the consumer, it is usually chosen to use time-shifted
equipment from the on-peak electricity price period to TPV.
The electric energy for the stations to abandon solar energy is
reduced to be 4586.859 kWh in TPV, which brings an additional
income of 401.350 Yuan. The comprehensive income of the dis-
tribution network is added to be 137.928 Yuan, which satisfies
the constraint of Equation (16).
6 CONCLUSION
The characteristic coupling between the BC and the distributed
transaction is analyzed. The local PV power consumption
method based on BCT is studied. The DPVG energy transac-
tion mechanism of the decentralized BC management agency is
determined. The optimal concession strategy of the BC electric-
ity price is designed with the electrical distance, the reputation
value, and the load fluctuation as the influencing factors. The
revenue models of the DPVG station, the agricultural park
consumer, and the distribution network are established. Fur-
thermore, the optimal BC electricity price is proved and solved
through the Stackelberg game theory. The optimal time-shifted
consumption power of each consumer is determined. Finally,
the IEEE 33-node distribution network is taken as an example
to simulate. The results of the example show that the proposed
consumption method can effectively alleviate the voltage devi-
ation of the PV grid-connected node, reduce the abandoned
amount of DPVG power, and increase the comprehensive ben-
efits. The integrated application of BCT and the distributed
transaction is analysed. However, the green power traceability
mechanism and virtual token characteristics in BCT are not rea-
sonably considered. The proposed method needs to be verified
in practice.
AUTHOR CONTRIBUTIONS
Tao Zhang: Data curation; Formal analysis; Investigation;
Methodology; Software; Supervision; Validation; Visualiza-
tion; Writing—original draft. Jianhua Yang: Conceptualization;
Formal analysis; Funding acquisition; Methodology; Project
administration; Writing—review & editing. Kaiyuan Jin: Data
curation; Resources; Validation; Writing—original draft. Tian-
jun Jing: Data curation; Funding acquisition; Investigation.
ACKNOWLEDGEMENTS
In this work, the authors were partially supported by the State
Grid Gansu Electric Power Company, China. This work is
supported by Science and Technology Project of State Grid
Corporation of China (5400-202133157A-0-0-00).
CONFLICT OF INTEREST
The authors declare that they have no known competing finan-
cial interests or personal relationships that could have appeared
to influence the work reported in this paper.
DATA AVAILABILITY STATEMENT
The data that support the findings of this study are available
from the author, Zhang Tao, upon reasonable request. Zhang
Tao’s email: 1741797138@qq.com.
ORCID
Jianhua Yang https://orcid.org/0000-0002-1097-5501
REFERENCES
1. Merlinda, A., Valentin, R., David, F., et al.: Blockchain technology in the
energy sector: A systematic review of challenges and opportunities. Renew.
Sustain. Energy Rev. 100, 143–174 (2019)
2. Qi, B., Xia, Y., Li, B., et al.: Photovoltaic trading mechanism design based
on blockchain-based incentive mechanism. Autom. Electr. Power Syst.
43(09), 132–139 (2019)
3. Tai, X., Sun, H., Guo, Q.: Electricity transactions and congestion manage-
ment based on blockchain in energy internet. Power Syst. Technol. 40(12),
3630–3638 (2016)
4. Wangi, B., Li, Y., Zhao, S., et al.: Key technologies in blockchain based
distributed energy transaction. Autom. Electr. Power Syst. 43(14), 53–64
(2019)
5. Liu, H., Cao, Y., Ren, Y., et al.: Application of blockchain technology in
distributed energy trading system. Price: Theory Practice (08), 154–158
(2021)
6. Li, B., Cao, W., Zhang, J., et al.: Transaction system and key technologies of
multi-enengy system based on heterogeneous blockchain. Autom. Electr.
Power Syst. 42(04), 183–193 (2018).
7. Chen, Z., Yang, J., Jin, K., et al.: Control strategy of time-shift facil-
ity agriculture load and photovoltaic local consumption based on energy
blockchain. Electr. Power Autom. Equip. 41(02), 47–55 (2021)
8. Reza, S., Amjad, A., Seyed, H., et al.: Economic demand response model in
liberalised electricity markets with respect to flexibility of consumers. IET
Gener. Transm. Distrib. 11(17), 4291–4298 (2017)
 17518695, 2023, 6, D
ow
nloaded from
 https://ietresearch.onlinelibrary.w
iley.com
/doi/10.1049/gtd2.12748 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
mailto:1741797138@qq.com
https://orcid.org/0000-0002-1097-5501
https://orcid.org/0000-0002-1097-5501
1418 ZHANG ET AL.
9. Ali, Z., Ali, S., Farshid, N.: Multi-leader–follower game theory for mod-
elling interaction between virtual power plants and distribution company.
IET Gener. Transm. Distrib. 12(21), 5747–5752 (2018)
10. Lee, J., Guo, J., Choi, J.K., et al.: Distributed energy trading in microgrids:
A game-theoretic model and its equilibrium analysis. IEEE Trans. Ind.
Electron. 62(6), 3524–3533 (2015)
11. Lee, W., Lin, X., Schober, R., et al.: Direct electricity trading in smart grid:
A coalitional game analysis. IEEE J. Sel. Areas Commun. 32(7), 1398–1411
(2014)
12. Dou, C., Luo, W., Dong, Y., et al.: Multi-agent system based electricity mar-
ket trading strategy within microgrid groups. Power Syst. Technol. 23(5),
1735–1744 (2019)
13. Ping, J., Yan, Z., Chen, S., et al.: Credit risk management in distributed
energy resource transactions based on block-chain. Proc. CSEE 39(24),
7137–7145 (2019)
14. Liu, S., Liu, P., Wang, X., et al.: Effects of correlated photovoltaic power
and load uncertainties on grid-connected microgrid day-ahead scheduling.
IET Gener. Transm. Distrib. 11(14), 3620–3627 (2017)
15. Li, J., Wang, Y., He, J., et al.: Blockchain-based dynamic game of electricity
price and power for microgrid electricity market. Autom. Electr. Power
Syst. 45(17), 11–19 (2021)
16. Wang, G., Song, Y., Huang, B., et al.: Research on time-of-use pric-
ing strategy for residential customers based on uncompleted information
stackelberg game. Distrib. Utiliz. 38(02), 46–52 (2021)
17. Jiang, X., Tang, B., Yu, G., et al.: Coordination and optimization method of
park energy storage and electricity price for local consumption of renew-
able energy. Power Syst. Autom. 1–14 (2022) https://kns.cnki.net/kcms/
detail/32.1180.TP.20211130.1234.005.html
18. Yang, H., Shi, R., Ma, Y., et al.: Scheduling strategy of electric storage
system considering multiple time-of-use electricity prices and potential
benefit. Electr. Power Autom. Equip. 41(10), 130–137 (2021)
19. Li, K., Song, T., Hang, X., et al.: Bidding strategy of energy storage consid-
ering electricity price uncertainty and loss cost. Autom. Electr. Power Syst.
44(17), 52–59 (2020)
20. Zhang, T., Yang, J., Li, J., et al.: Research on local consumption method of
distributed photovoltaic generation for benefits of multi parties based on
blockchain. Energy Rep. 7, 185–190 (2021).
21. Bokkisam, H.R., Singh, S., Acharya, R.M., et al.: Blockchain-based peer-
to-peer transactive energy system for community microgrid with demand
response management. CSEE J. Power Energy Syst. 8(1), 198–211 (2022)
22. Ghorbanian, M., Dolatabadi, S.H., Siano, P., et al.: Methods for flex-
ible management of blockchain-based cryptocurrencies in electricity
markets and smart grids. IEEE Trans. Smart Grid 11(5), 4227–4235
(2020)
23. Gokcek, T., Sengor, I., Hayes, B.P., et al.: A hierarchical approach for
P2P energy trading considering community energy storage and PV-
enriched system operator. IET Gener. Transm. Distrib. 16(23), 4738–4749
(2022)
24. National Energy Administration. Notice on Launching the Pilot Program
of Distributed Generation Market-Based Trading. http://zfxxgk.nea.gov.
cn/auto87/201711/t20171113_3055.htm (2017)
25. Gansu Provincial Development and reform commission: Notice
on matters related to the implementation of transmission
and distribution electricity price of Gansu Power Grid from
2020 to 2022. http://fzgg.gansu.gov.cn/fzgg/c106108/201306/
2a1b8e967352a1b8e96735546e4b27e308290537bc8.shtml (2020)
26. Tushar, W., Chai, B., Yuen, C., et al.: Three-party energy management with
distributed energy resources in smart grid. IEEE Trans. Ind. Electron.
4(62), 2487–2498 (2015)
27. Wu, Y., MA, X., Sun, Y., et al.: Overall economic evaluation and analysis of
accession of microgrids with high penetration. Power Syst. Protec. Control
40(13), 49–54 (2012)
28. National Development and Reform Commission: Notice of the
national development and Reform Commission on matters related to
the on grid tariff policy for photovoltaic power generation in 2020.
https://www.ndrc.gov.cn/xxgk/zcfb/tz/202004/t20200402_1225031.
html?code=&state=123 (2020)
How to cite this article: Zhang, T., Yang, J., Jin, K.,
Jing, T.: Local power consumption method of
distributed photovoltaic generation in rural distribution
network based on blockchain. IET Gener. Transm.
Distrib. 17, 1409–1418 (2023).
https://doi.org/10.1049/gtd2.12748
 17518695, 2023, 6, D
ow
nloaded from
 https://ietresearch.onlinelibrary.w
iley.com
/doi/10.1049/gtd2.12748 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
https://kns.cnki.net/kcms/detail/32.1180.TP.20211130.1234.005.html
https://kns.cnki.net/kcms/detail/32.1180.TP.20211130.1234.005.html
http://zfxxgk.nea.gov.cn/auto87/201711/t20171113_3055.htm
http://zfxxgk.nea.gov.cn/auto87/201711/t20171113_3055.htm
http://fzgg.gansu.gov.cn/fzgg/c106108/201306/2a1b8e967352a1b8e96735546e4b27e308290537bc8.shtml
http://fzgg.gansu.gov.cn/fzgg/c106108/201306/2a1b8e967352a1b8e96735546e4b27e308290537bc8.shtml
https://www.ndrc.gov.cn/xxgk/zcfb/tz/202004/t20200402_1225031.html?code=&state=123
https://www.ndrc.gov.cn/xxgk/zcfb/tz/202004/t20200402_1225031.html?code=&state=123
https://doi.org/10.1049/gtd2.12748
	Local power consumption method of distributed photovoltaic generation in rural distribution network based on blockchain
	1 | INTRODUCTION
	2 | APPLICABILITY OF BCT IN ELECTRIC ENERGY TRANSACTION
	2.1 | Coupling analysis of BC and distributed transaction
	2.2 | BC profit-making mechanism
	3 | LOCAL PV POWER CONSUMPTION METHOD
	3.1 | Comprehensive income of DPVG
	3.2 | Comprehensive income of agricultural parks
	3.3 | Comprehensive income of grid
	4 | OPTIMAL SOLUTION OF STACKELBERG GAME
	4.1 | Objective function
	4.2 | Proof of optimal BC electricity price
	4.3 | The decentralized BC management agency
	5 | SIMULATION EXAMPLE
	5.1 | Simulation parameters
	5.2 | Simulation analysis
	6 | CONCLUSION
	AUTHOR CONTRIBUTIONS
	ACKNOWLEDGEMENTS
	CONFLICT OF INTEREST
	DATA AVAILABILITY STATEMENT
	ORCID
	REFERENCES