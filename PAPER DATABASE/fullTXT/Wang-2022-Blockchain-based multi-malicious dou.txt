Blockchain-based multi-malicious double-spending attack blacklist management model
Vol:.(1234567890)
The Journal of Supercomputing (2022) 78:14726–14755
https://doi.org/10.1007/s11227-022-04370-1
1 3
Blockchain‑based multi‑malicious double‑spending attack 
blacklist management model
JunLu Wang1 · Qiang Liu1 · Baoyan Song1
Accepted: 11 February 2022 / Published online: 8 April 2022 
© The Author(s), under exclusive licence to Springer Science+Business Media, LLC, part of Springer Nature 
2022
Abstract
In recent years, blockchain security issues have attracted widespread attention. 
Especially in terms of computing power security, when nodes have sufficient com-
puting power, they can arbitrarily tamper with blockchain ledger data. As a huge 
collection of computing power, the blockchain mining pool is a potential malicious 
node. Multiple malicious nodes jointly conduct a double-spending attack on the 
blockchain, which brings great security risks to the blockchain. This paper studies 
the different combinations of double-spending attack by potential malicious mining 
pools, constructs a blacklist judgment strategy based on the attack characteristics, 
and proposes a blockchain-based multi-malicious double-spending attack blacklist 
management model. Firstly, an inner loop malicious game is proposed to analyze the 
competition trend between a single malicious node and other malicious nodes. Sec-
ondly, according to the attack mode of multiple mining pools, a joint attack model 
and a decentralized attack model are proposed, and the operation rules of the two 
attack models are mathematically derived. Then a blacklist management model is 
proposed, and after the blacklist is constructed, a blacklist judgment strategy is for-
mulated. The blacklist uses decentralize mining pool judgments and joint mining 
pool judgments to extract malicious mining pool nodes, which stops further mali-
cious behavior. And finally, simulation experiments show that the blacklist manage-
ment model can significantly reduce the success of attacks and resist double-spend-
ing attacks effectively.
Keywords Blacklist management model · Inner loop malicious game · Joint attack 
model · Decentralized attack model · Blacklist judgment strategy
JunLu Wang and Qiang Liu contributed equally to this work.
 * Baoyan Song 
 bysong@lnu.edu.cn
Extended author information available on the last page of the article
http://crossmark.crossref.org/dialog/?doi=10.1007/s11227-022-04370-1&domain=pdf
14727
1 3
Blockchain‑based multi‑malicious double‑spending attack…
1 Introduction
In 2008, Satoshi Nakamoto published a paper “Bitcoin: A peer-to-peer Electronic 
Cash System”, [1] and then blockchain technology [2–4] was applied to the bitcoin 
blockchain. Development has entered a new stage [5–7]. Blockchain adopts efficient 
cryptography principles, establishes trust through consensus mechanisms such as 
proof of work (abbreviated as POW) and proof of stake (abbreviated as POS) [8, 9], 
and uses point-to-point interaction [10–12] for blockchain data storage, which is an 
excellent solution to the problem of how to establish trust on the decentralized net-
work [13, 14]. Among them, due to the decentralization, traceability, antitampering, 
and information transparency [15–18], blockchain technology has been widely used 
in agricultural product traceability, electronic invoices, user privacy, and other appli-
cation scenarios [19–22]. However, as the application of blockchain becomes more 
widespread, the security issues of blockchain [23–25] become more prominent.
The research of Matzu et al. [26] showed that 1.4% of transactions in the bitcoin 
blockchain contained nonfinancial information, even which included some illegal 
and pornographic information. Once this type of malicious information is stored in 
the blockchain, it cannot be deleted. In June 2016, criminals successfully attacked 
Ethereum’s decentralized autonomous organization (abbreviated as DAO) project 
[27], which used reentrancy vulnerabilities in smart contracts, and the DAO project 
lost $60 million as a result. On November 11, 2013, this Czech cryptocurrency Bit-
Cash exchange was hacked and the wallets of 4000 customers were stolen, resulting 
in the loss of millions of CZK(czech currency unit) worth of Bitcoin [28]. The Coin-
check cyberattack that occurred on January 26, 2018, had a huge impact on the cryp-
tocurrency industry [29]. The Japanese exchange lost $532 million in online trans-
actions. After the cyberattack, the exchange merged with another financial services 
company named Monex Group to maintain business [30]. The Bitstamp exchange 
was one of the largest cryptocurrency exchanges at that time. After a security breach 
on January 5, 2015, it lost approximately 19,000 Bitcoins [31]. The reason for the 
loss is believed to be the loss of a wallet that stores digital credentials for customers.
And double-spending attacks against transactions [32–34] have been focused 
on research. As long as a node in the blockchain has sufficient computing power 
(more than 50% of the total network computing power), it has the right to con-
trol data, and it can pass powerful computing power to carry out double-spending 
attacks and modify the data in the blockchain. Since the attack method is in line 
with the proof of work of the blockchain [35, 36], the modified data after the 
double-spending attack will be recognized to be valid by the entire network. At 
the same time, research on malicious attacks has achieved a lot of results. She 
et al. [37] propose a blockchain trust model (abbreviated as BTM) for the detec-
tion of malicious nodes in wireless sensor networks. The trust model is used to 
construct a blockchain data structure for detecting malicious nodes. Using block-
chain smart contracts and the quadrilateral measurement and positioning method 
of WSNs, the detection of malicious nodes in 3D space is realized. Huang et al. 
[38] propose a blockchain system with a credit-based IIoT consensus mecha-
nism, through the credit-based proof-of-work (PoW) mechanism to ensure system 
14728 J. Wang et al.
1 3
security and transaction efficiency. In order to protect the confidentiality of sensi-
tive data, designing a data rights management method to regulate access to sen-
sor data. Gong et  al. [39] propose a blockchain-based CTI framework, which 
improves confidence in the source and content of data, and can quickly detect 
and eliminate inaccurate data to resist sybil attacks. Tukur et al. [40] propose an 
edge-based blockchain to enable anomaly detection technology, it improves avail-
ability, avoids single points of failure, and prevents internal attacks in the Internet 
of things such as system administrators from maliciously destroying the integrity 
of data. Shafi Q et al. [41] develop a botnet prevention system for the Internet of 
Things (IoT), which takes advantage of software-defined networking (abbreviated 
as SDN) and distributed blockchain (DBC), detecting and mitigating botnets and 
preventing devices from falling into the hands of attackers through blockchain 
and SDN simulation and analysis.
Existing researches based on blockchain double-spending computing power 
attacks mainly focus on independent computing power objects. However, with the 
rapid increase in the scale of blockchain computing power in recent years, the com-
puting power risk of independent mining has increased obviously [42], and more 
scattered independent computing power objects have gathered to become blockchain 
mining pools [43, 44]. In 2014, Niko Punin [45] thought that the BitFury’s chips 
power around 40% of miners in the bitcoin mining pools, which means it has poten-
tial ability to obtain a 51% attack advantage [46]. Lylian Teng pointed out that in 
the first half of 2018, the hashrate of mining pools under Bitmain (with BTC.com, 
AntPool and ViaBTC included) was approaching the dreaded 51 percent thresh-
old needed to stage a 51 percent attack. The computing power of these top mining 
pools has caused widespread concern. As a large collection of computing power, 
blockchain mining pools have an important impact on blockchain security, which 
are potential malicious nodes to attack blocks, and the mining pools between the 
blockchain unite to commit evil, which will bring greater damage to the blockchain.
The blacklist strategy [47, 48] is often used in engineering security, by record-
ing malicious nodes into the blacklist to prevent further malicious behaviors. At the 
same time, the blacklist strategy also creates a security problem. The blacklisted 
investigative nodes themselves do evil and record the honest nodes in the blacklist, 
which destroy the safety and reliability of the system. This requires analysis from 
the direction of the investigative nodes, and then to construct a blacklist strategy 
with a higher degree of credibility.
With the development of blockchain technology, more and more decentralized 
nodes join forces to attack the blockchain. For example, as a large computing power 
aggregate, mining pools destroy the validity of data on the chain through double-
spending attacks on the blockchain, which brings severe computing power security 
risk to the blockchain. Therefore, studying the attack mechanism and prevention 
strategy of malicious nodes has become an important part in the current blockchain 
security system. Based on the existing research, multiple nodes with malicious 
behavior are analyzed. This paper studies different attack methods of double-spend-
ing attack between malicious nodes and combines the blacklist judgment strategy to 
propose a blockchain-based multi-malicious double-spending attack blacklist man-
agement model. The main contributions are as follows: 
14729
1 3
Blockchain‑based multi‑malicious double‑spending attack…
1. First of all, in view of the coexistence of multiple malicious nodes in the block-
chain, an inner-loop malicious game is proposed to analyze the success prob-
ability of a single malicious node attack.
2. Secondly, according to different malicious attack modes from mining pool, two 
malicious attack models are proposed: joint attack model and decentralized attack 
model, to simulate and derive the operating rules of two attack models.
3. On this basis, a blacklist management model is constructed. The internal loop 
computing power chain strategy is used to synchronize the accounts of all man-
agement nodes. When the execution node has malicious behavior or faults, the 
failure node switching transition method is used to make the blockchain transac-
tions run normally.
4. Finally, a blacklist strategy is proposed. By accurately determining the joint min-
ing pool and the decentralized mining pool, further evils can be prevented.
2  Related work
Malicious attacks are a hot topic in blockchain research, and it has made many 
research results.
Regarding blockchain double-spending attacks, Lee et  al. [49] present a new 
approach for avoiding double-spending attacks via the oriented recipient concepts in 
private blockchain networks; together with the concepts of stealth address and mas-
ter node at recipient sides, transactional privacy is assured and transaction recipi-
ents become active which receive transaction propagation unilaterally. C Pérez-Solà 
et al. [50] propose a double-spending prevention mechanism for bitcoin zero con-
firmation transactions, and basing on the use in the flexibility of the bitcoin script-
ing language and the vulnerabilities of the ECDSA (Elliptic Curve Digital Signature 
Algorithm) signature scheme, to prevent attackers from conducting such attacks. 
Zhang et al. [51] propose a mitigation measure for double-spending attacks, which 
further reduces the success rate of attacks by charging confirmation fees and set-
ting a period for defending against double-spending attacks. Ekparinya P et al. [52] 
deploy a virtual machine with restricted CPU quantum to simulate the top 10 mining 
pools of Ethereum, partition the network through BGP(Border Gateway Protocol) 
hijacking or ARP(Address Resolution Protocol), and deceiving before launching a 
balancing attack to steal coins. The results show that Ethereum is very destructive in 
a consortium or private environment. Kovalchuk L et al. [53] analyze the influence 
of the block generation rate in the delayed message passing network on the success 
probability of double-spending attacks and provide strict analytical expressions for 
the network security threshold and the upper limit of the block-generation rate to 
provide guidance for the blockchain to resist double-spending attacks.
A mining pool is a collection of computing power composed of multiple nodes, 
which has the potential to do evil. Reasoning that the block withholding (abbrevi-
ated as BWH) attack will have significant impacts on the pool selection, Fujita 
et al. [54] investigate the mining pool selection issue in the presence of a BWH 
attack and model the pool selection process of miners as an evolutionary game 
and find the evolutionarily stable states (abbreviated as ESSs) of the game as the 
14730 J. Wang et al.
1 3
solutions; Yang et al. [55] propose a game model for attack or cooperative choice 
of each miner in the blockchain system, analyze it from a macro perspective, and 
formulate strategies on this basis, which can fairly solve the dilemma of each 
mining pool choosing cooperation or offense; Wang et al. [56] analyze the details 
of the mining pool behavior (such as mining revenue and transaction collection 
strategy) and obtain that a small number of mining pools continue to control most 
of the computing resources of the Bitcoin network. In the case of a decline in the 
unit profit of computing resources in mining pools, bitcoin incentives are insuf-
ficient to meet the exponential growth of computing resources. Romiti et al. [57] 
conduct the in-depth analysis of mining reward distribution within three of the 
four largest bitcoin mining pools and examine their cross-pool economic rela-
tionships, and the results point out that centralization tendencies in large mining 
pools and cryptocurrencies in general.
In terms of security, Sagirlar et  al. [58] design a Hybrid-IoT (hybrid block-
chain architecture toward IoT) to create a distributed consensus-based Internet of 
things that applies blockchain technology to the Internet of things system, which 
dedicates to solving cloud server maintenance costs, security and trust issues of 
IoT applications; Shi et al. [59] develop a new consensus protocol called “Proof 
of Age” (abbreviated as POA). The protocol is based on the pow protocol, uses 
age of work (abbreviated as AOW) to measure the effective mining time of min-
ers committed to maintaining the security of the blockchain, and restrains the 
motivation of merged mining; Saad et al. [60] propose a new form to attack the 
memory pool of blockchain-based cryptocurrencies, including cost-based and 
age-based designs, to further optimize the size of the memory pool and help resist 
the impact of DDoS (Distributed Denial of Service) attacks. He et al. [61] pro-
pose a software status monitoring system based on blockchain (abbreviated as 
BoSMoS). The system is designed to monitor the software status of IIoT devices 
to detect and respond to identified malicious behaviors. BoSMoS uses the block-
chain as a distributed ledger to store a snapshot of the software state, ensuring 
software integrity information. Wang et  al. [62] propose a novel most trusted 
chain (abbreviated as MTC) confirmation mechanism to defend against bifur-
cation attacks. Through the arbitration mechanism, the confirmation of MTC is 
delayed until the end of the game, and the end threshold is set as the termination 
condition of the game process to help MTC become the winner.
To sum up, in terms of double-spending attack, current research is mainly 
focused on reducing the success rate of existing blockchain double-spending attack. 
In terms of mining pools, current research is mainly focused on the analysis of the 
reward mechanism of mining pools. In terms of security, current research is mainly 
focused on designing consensus mechanisms and strategies to improve blockchain 
security. However, the existing work ignores the case of joint attacks on the block-
chain between nodes. As a large computing power node, mining pools jointly launch 
attacks on the blockchain, which seriously endangers the security of the blockchain. 
This paper analyzes the different scenarios of double-spending attacks from multiple 
malicious nodes. In order to effectively reduce the successful probability of double-
spending attacks, a blockchain-based multi-malicious double-spending attack black-
list management model is proposed.
14731
1 3
Blockchain‑based multi‑malicious double‑spending attack…
3  Multi‑malicious double‑spending attack model
When multiple malicious nodes perform a double-spending attack on the block-
chain, the malicious nodes compete with honest nodes by computing power, and 
there is also competition between malicious nodes. In addition, the blockchain min-
ing pool, as a collection of computing power, also has the possibility of doing evil 
itself. According to the attack situation of the blockchain mining pool, two mali-
cious attack models are proposed: a joint attack model and a decentralized attack 
model. Then, to derive the two malicious attack models mathematically, and the 
operation rules are got .
3.1  Inner loop malicious game
In the blockchain with multiple malicious nodes, there is a game of computing 
power between malicious nodes and honest nodes, and also a competition among 
malicious nodes. As shown in Fig. 1, attacking node b double-spends a transaction, 
while attacking node a double-spends another transaction. And the two transactions 
occurred on the same block height, which means the attacking node a not only com-
petes with the honest node, but also needs to compete with the attacking node b.
Since the development of the blockchain, its complexity has further increased 
at this stage. It is possible that malicious nodes will not only compete with hon-
est nodes but also compete with other malicious nodes when performing double-
spending attacks, and it leads to the following state: when multiple malicious nodes 
conduct double-spending attacks, what is the probability of a single malicious node 
attacking successfully at the same time?
There is a malicious node M, whose computing power accounts for T(M). At this 
time, there are other n malicious nodes N1, N2,...; the corresponding computing 
power ratio T(N1), T(N2),...; honest node H; computing power proportion T(H); and 
malicious total computing power proportion SC.
Fig. 1  Multiple malicious nodes attack mode
14732 J. Wang et al.
1 3
Now that the malicious node M and other malicious nodes maliciously attack a cer-
tain block at the same time, and the honest node is z blocks ahead of the malicious 
node; the probability p(z) of the malicious node M chasing z blocks be calculated.
For example, there are a total of n malicious nodes in the blockchain which are simi-
lar to the malicious node M. Since each malicious node conducts a malicious attack 
separately, each malicious node has the different probability of succeeding in chas-
ing Z blocks. The final success probability of node M is equal to the accumulation 
of the initial success probability to node M and the failure probability of all other 
malicious nodes, so the block tracking success probability of malicious node M can 
be obtained.
Assuming that the percentage of malicious nodes M is 0.1, the other malicious node 
sets are {0.1}, {0.1,0.15}, {0.1,0.2}, {0.1,0.1,0.15}, and the number of confirmed 
blocks 1,2,3,4,5,6,7. Substitute these parameters into formula 3, and the probability 
of successful pursuit is shown in Table 1. Through comprehensive analysis, the fol-
lowing conclusions can be obtained further: 
1. The proportion of the computing power for honest and malicious nodes remains 
unchanged, and the success probability of malicious nodes p(z) decreases as the 
number of confirmed blocks z increases.
2. There will be competition between malicious computing power, which reduces 
the success rate of malicious node M attack.
3. When there is a competition between malicious computing power, under the same 
conditions, the higher the computing power in the malicious set T(Ni), the lower 
(1)SC = 1 − T(H) = T(M) +
n∑
i=1
T(Ni)
(2)p(z) =
{
1 T(M) > T(H)(
T(M)
T(H)
)z
T(M) ≤ T(H)
(3)
⎧⎪⎨⎪⎩
∑
1≤i≤n T(Ni) ≤ T(H)
p(z) =
∏
1≤i≤n
�
1 −
�
T(Ni)
T(H)
�z�
, T(M) > T(H)
p(z) =
�
T(M)
T(H)
�z
⋅
∏
1≤i≤n
�
1 −
�
T(Ni)
T(H)
�z�
, T(M) ≤ T(H)
Table 1  Success rate of multiple 
malicious node attacks
0.1{0.1} 0.1{0.1,0.15} 0.1{0.1,0.2} 0.1{0.1,0.1,0.15}
Z = 1 0.1094 0.1001 0.0926 0.0885
Z = 2 0.0154 0.0219 0.0240 0.0286
Z = 3 0.0019 0.0036 0.0044 0.0058
Z = 4 0.0002 0.0006 0.0007 0.0010
Z = 5 0 0 0 0.0002
14733
1 3
Blockchain‑based multi‑malicious double‑spending attack…
the success rate of the T(M) in double-spending attack. Under the same condi-
tions, the larger number of nodes in the malicious set T(Ni), the lower the success 
rate of the T(M) in double-spending attack.
Finally, there is the following situation. The honest node has confirmed z blocks 
but still does not know that the malicious node has maliciously attacked the kth 
block at this stage. In order to obtain the overall probability of successful malicious 
attacks at this time, using the poison distribution model.
Further to expand the functional relationship in (6) and get Fig.  2. In the figure, 
set the malicious proportion T(M) to 0.1; the other malicious node sets to {0.1}, 
{0.1,0.15}, {0.1,0.2}, and the number of confirmed blocks to 1,2,3,4,5,6,7. Through 
analysis, under the same conditions, the greater the number of malicious nodes 
T(Ni), the lower the success rate of the double-spending attack of node M. For exam-
ple, the function line 0.1{0.1,0.15}, 0.1{0.1,0.2} is always below the function line 
0.1{0.1}; under the same conditions, the larger the proportion of the malicious node 
T(Ni) in computing power, the greater the probability of success of node M. For 
(4)
⎧
⎪⎨⎪⎩
�i =
T(Ni)
1−T(M)−
∑
1≤i≤n T(Ni)
⋅ Z
p(Ni) = 1 −
∑k=z
k=0
�
−k
⋅e−�i
k!
⋅
�
1 −
�
T(Ni)
T(H)
�z−k
�
(5)
⎧
⎪⎨⎪⎩
� =
T(M)
1−T(M)−
∑
1≤i≤n T(Ni)
⋅ z
p(M) = 1 −
∑k=z
k=0
�
−k
⋅e−�
k!
⋅
�
1 −
�
T(M)
T(H)
�z−k
�
(6)P(z) = p(M) ⋅
∏
1≤i≤n
(1 − p(Ni))
Fig. 2  Multi-malicious node attack trend
14734 J. Wang et al.
1 3
example, the function line 0.1{0.1, 0.2} is always below the function line 0.1{0.1, 
0.15}.
3.2  Joint attack model
In the blockchain network, the mining pool, as a large collection of computing 
power, is a potentially malicious node. Multiple mining pools are used as multi-
ple malicious nodes, and the mining pools unite to carry out malicious computing 
power attacks on the blockchain. This article is based on this attack mode to pro-
poses a blockchain joint attack model. M1, M2,.... Mn represent the mining pools 
existing in the blockchain; P(M1), P(M2),...P(Mn) represent the ratio of the min-
ing pool’s computing power to the total network computing power; H represents 
honest nodes in the blockchain; P(H) represents the ratio of honest nodes to the 
entire network computing power; and Z represents the number of blocks that hon-
est nodes keep ahead malicious mining pools.
Mining pool M1 unites part of the mining pools to focus on double-spending 
attack on a transaction, and multiple malicious nodes computing power is concen-
trated to compete with honest nodes and other malicious nodes. M1, M2, ...Mm 
represent a joint multiple mining pool MC.
The proportion of honest total computing power in the blockchain is HA.
The malicious joint mining pool MC maliciously attacks the blockchain; the honest 
computing power HA keeps ahead the malicious computing power by Z blocks, and 
the probability of success for the malicious node to make up for the Z blocks is P(z).
In fact, the honest computing power has confirmed Z blocks. But at this stage, the 
malicious joint computing power MC has double spent attacking to the kth block, 
and the poison distribution model is used for calculating success probability of mali-
cious attacks p(z).
p(z) is the success probability of a malicious joint mining pool, which is double-
spending attack on the blockchain. The entire attack process is shown in Fig. 3.
(7)P(MC) =
∑
1≤i≤m
P(Mi)
(8)HA = 1 − P(MC) = P(H) +
∑
m+1≤i≤n
P(Mi)
(9)P(z) =
{
1 P(MC) > HA(
P(MC)
P(H)
)z
P(MC) ≤ HA
(10)
�
� =
P(MC)
HA
⋅ z
p(z) = 1 −
∑k=z
k=0
�
−k
⋅e−�
k!
⋅ (1 − (
P(MC)
HA
)z−k)
14735
1 3
Blockchain‑based multi‑malicious double‑spending attack…
3.3  Decentralized attack model
There is another malicious attack mode among mining pools. The computing power 
of each mining pool is not combined and independent. Double-spending attacks are 
carried out on the same blockchain, and the targets of double-spending attacks in 
each mining pools are different. This article proposes a blockchain decentralized 
attack model based on this attack mode. M1, M2,...Mn represent the mining pools 
existing in the blockchain; P(M1), P(M2),...P(Mn) represent the ratio of the min-
ing pool’s computing power to the total network computing power; H represents for 
honest nodes in the blockchain; P(H) represents the ratio of honest nodes comput-
ing power to the entire network computing power; and Z represents the number of 
blocks that honest nodes keep ahead malicious mining pools.
There are multiple mining pools in the blockchain to be malicious nodes, which 
carry out double-spending attacks on the same block. They attack different double-
spending targets, and the computing power is dispersed. Based on this, this article 
conducts research and analysis on the blockchain double-spending attack in this sit-
uation. M1, M2, ...Mm represent the MC of multiple blockchain mining pools mali-
ciously attacked, and HA is the honest computing power.
(11)MC = ∪1≤i≤m Mi
(12)HA =P(H) +
∑
m+1≤i≤n
P(Mi)
Fig. 3  Joint attack model
14736 J. Wang et al.
1 3
The decentralized attack mining pool MC maliciously attacks the blockchain. At this 
time, the honest computing power HA keeps ahead the malicious computing power 
by Z blocks. The malicious computing power continues to hash calculations to find 
out the eligible hash values, make up the gap in the number of Z blocks, and find 
the success probability P(zMi ) of the malicious node to make up for the Z blocks in 
mining pool Mi. Since the computing power of malicious nodes on the blockchain is 
scattered, and they independently attack the blockchain; the effective probability of 
malicious nodes MC making up for Z blocks is:
In fact, the honest computing power of blockchain has confirmed Z blocks, but at 
this stage, the malicious computing power MC has double spent attacking to the kth 
block. The poison distribution model is used for processing to obtain the overall suc-
cess probability of malicious attacks.
p(z) is the success probability of a malicious decentralized mining pool carrying out 
a double-spending attack on the blockchain.
p(z) is the success probability of a malicious decentralized mining pool carrying out 
a double-spending attack on the blockchain. The entire attack process is shown in 
Fig. 4.
3.4  Model comparison
In the joint attack model, malicious mining pools collectively conduct malicious 
attacks on the blockchain. This article analyzes its internal laws based on the 
(13)
⎧
⎪⎪⎨⎪⎪⎩
P(zM1) = (
P(M1)
P(H)+
∑
m+1≤i≤n P(Mi)
)z P(M1) ≤ HA
P(zM2) = (
P(M2)
P(H)+
∑
m+1≤i≤n P(Mi)
)z P(M2) ≤ HA
P(zMm) = (
P(Mm)
P(H)+
∑
m+1≤i≤n P(Mi)
)z P(M3) ≤ HA
(14)
⎧
⎪⎪⎨⎪⎪⎩
P(z) = 1,∃i ∈ {1, 2, 3,… ,m} P(zMi) > HA
P(z) = P(zM1) + (1 − P(zM1)) ⋅ P(zM2)+
(1 − P(zM1)) ⋅ (1 − P(zM2)) ⋅ P(zM3) +⋯+
(1 − P(zM1)) ⋅ ⋯ ⋅ (1 − P(zM(m−1))) ⋅ P(zMm)
∀i ∈ {1, 2, 3,… ,m} P(zMi) ≤ HA
(15)
⎧⎪⎨⎪⎩
�i =
P(Mi)
P(H)+
∑
m+1≤i≤n P(Mi)
⋅ z
p(zMi) = 1 −
∑k=z
k=0
�
−k
⋅e−�
k!
⋅
�
1 −
�
P(Mi)
HA
�z−k
�
(16)
p(z) = p(zM1) + (1 − p(zM1)) ⋅ p(zM2) + (1 − p(zM1)) ⋅ (1 − p(zM2))
⋅p(zM3) +⋯ + (1 − p(zM1)) ⋅ ⋯ ⋅ (1 − p(zM(m−1))) ⋅ p(zMm)
14737
1 3
Blockchain‑based multi‑malicious double‑spending attack…
mathematical derivation of the joint attack model above, sets up malicious mining 
pool groups composed of different computing powers for comparison. The comput-
ing power of each group of malicious mining pools is {0.2}, {0.1,0.1}, {0.1,0.2}, 
{0.1,0.1,0.1} and {0.1 ,0.2,0.1}. Setting the number of confirmed chase blocks to 
2, and each group conducts malicious double-spending attacks on the blockchain. 
After statistics on the blockchain result data, Fig. 5 is obtained.
Fig. 4  Decentralized attack model
Fig. 5  Joint attack model comparison
14738 J. Wang et al.
1 3
In Fig.  5, {0.2} and {0.1, 0.1}, {0.1, 0.2} and {0.1, 0., 0.1}, the two sets of 
attacks have the same probability of success. As the total computing power increases 
in each set, the probability of a successful attack also increases. To further analyze, 
there is no strong correlation between the success rate of the attack and the number 
of malicious mining pools. The success rate of the multi-mining pool joint attack 
model is mainly related to the total computing power in the mining pool set.
In the decentralized attack model, malicious mining pools are scattered to carry 
out malicious attacks on the blockchain. This article analyzes its internal laws based 
on the mathematical derivation of the attack model, sets up malicious mining pool 
groups composed of different computing powers for comparison. The computing 
power of each malicious mining pool is {0.2}, {0.1,0.1}, {0.1,0.2}, {0.1,0.1,0.1}, 
and {0.1 ,0.2,0.1}. Setting the number of confirmed chase blocks to 2, and each 
group conducts malicious double-spending attacks on the blockchain, and then 
obtains Fig. 6 after statistics on the blockchain result data.
In Fig. 6, the success rate of the {0.2} computing power group is significantly 
greater than {0.1, 0.1} group and {0.1, 0.1, 0.1} group. The total computing power 
of 0.1, 0.2 and 0.1, 0.1, 0.1 are the same, but the former is significantly larger than 
the latter. Further analysis shows that there is no strong correlation between the suc-
cess rate of the double-spending attack in the decentralized attack model and the 
total computing power of the malicious mining pool. The success rate of the multi-
mining pool decentralized attack model is mainly related to the malicious mining 
pools with a large percentage of computing power in the mining pool set. Figure 7 is 
obtained after statistics of the above two models.
Through the analysis of Fig. 7, when the number of malicious mining pools and 
the percentage of computing power in the blockchain are the same, the probability of 
success of the attack of the centralized attack model is higher than that of the decen-
tralized attack model. When the computing power gap is large, the decentralized 
attack model successes probability is mainly related to the malicious nodes with a 
large percentage of computing power. For example, the success probability of {0.1, 
0.2} computing power set is significantly greater than {0.1, 0.1, 0.1} computing 
Fig. 6  Decentralized attack model comparison
14739
1 3
Blockchain‑based multi‑malicious double‑spending attack…
power set. The success of the joint attack model is mainly related to the size of the 
joint computing power set from all mining pools. For example, the success probabil-
ity of {0.2} computing power set is equal to {0.1, 0.1} computing power set.
In the case of multiple malicious computing power attacks on the blockchain, two 
mining pool attack models are analyzed, and the following attack laws are obtained 
through analysis in the two attack models. 
1. In the multi-mining pool decentralized attack model, when the computing power 
gap between mining pools is large, the malicious attack is mainly related to the 
mining pool with a large percentage of computing power. The malicious mining 
pool with a large percentage of computing power is important to the blockchain 
security.
2. In the multi-mining pool centralized attack model, the combination of multiple 
mining pools in the blockchain is a serious threat to the blockchain. The more 
mining pools in the blockchain, the higher the harm.
3. The success rate of the multi-mining pool centralized attack model is significantly 
higher than the multi-mining pool decentralized attack model, and the multi-
mining pool centralized attack is highly harmful to the blockchain.
4  Blacklist management model
Based on the research and analysis of the blockchain multi-malicious attack model, 
the blacklist management model is constructed. The blockchain management node is 
elected through node elections, and the internal loop computing power chain strat-
egy is adopted to maintain the consistency of the local blacklist database. After the 
node has malicious behavior or failure, the execution node is switched in time to 
Fig. 7  Joint-decentralized difference graph
14740 J. Wang et al.
1 3
maintain the continuous operation of the blockchain transaction. Finally the mali-
cious attack node is determined through the blacklist judgment strategy, to prevent it 
from further damaging the normal operation of the blockchain.
4.1  Blacklist management model construction
In the blockchain network, each blockchain local area network elects execution 
nodes and alternate nodes. The execution nodes are responsible for recording mali-
cious attack nodes to the blacklist, and at the same time, the data chain computing 
power proof strategy is used to maintain the consistency of the blacklist database 
in all execution nodes. In response to unexpected failures or malicious behaviors 
of execution nodes, a two-way rotation strategy of execution candidate nodes was 
adopted to effectively respond.
4.1.1  Blacklist management node election
The blacklist management nodes are divided into two types: execution and alternate 
nodes.
Definition 1 Record the illegal nodes with malicious behaviors into the local black-
list database, and regularly send the blacklist database information to all nodes in 
this area and other execution nodes, which update regularly. This type of node is 
execution nodes.
Definition 2 Dynamically to update the local blacklist database of the execution 
nodes in this area, and to replace the execution nodes when the execution nodes fail 
or the malicious behavior is determined. Such nodes are alternate nodes.
Execution nodes and alternate nodes also are ordinary nodes in this area, they 
can perform proof of work for mining. The chain where the mining is located is the 
intranet data chain. At the same time, the execution nodes and alternate nodes can 
obtain a certain amount of blacklist database maintenance and update fees during 
their own election cycle. The execution and alternate node election must comply 
with the following rules: 
1. Each regional blockchain needs to elect one execution node and two candidate 
nodes.
2. The execution nodes and alternate nodes themselves are not bad nodes recorded 
in the blockchain blacklist database.
3. Any non-blacklist node in the local blockchain has the right to vote. After the 
vote, the number of votes ranked first is the execution node, and the second and 
third ranked nodes are alternate nodes.
4. The validity period of each management node will last to the beginning of the 
next election cycle, and the management node cannot be reelected.
14741
1 3
Blockchain‑based multi‑malicious double‑spending attack…
4.1.2  Inner loop computing power chain strategy
In the blockchain network, bad nodes hinder the normal operation of the blockchain 
network through malicious competition. Execution node uses a blacklist strategy 
to record the malicious nodes into the local blacklist data table and then sends the 
blacklist data table to all local nodes and other execution nodes; all local nodes do 
not recognize the blocks generated by malicious nodes and the blacklist. Other exe-
cution nodes further send the received information to all nodes in the local area and 
then realize the blacklist information broadcast on the blockchain network.
At the same time, due to the geographical limitations of the local area network, 
local malicious nodes are always recorded faster in the blacklist data table than the 
malicious nodes in other places, and part of the local area network cannot update the 
data table in time due to communication failures. It is difficult to maintain strong 
consistency and synchronization of blacklist data tables among execution nodes in 
different regions.
Based on this, this paper proposes the strategy of internal loop computing power 
chain.
Inner loop computing power chain strategy: all execution nodes in the blockchain 
network form an inner loop network. This network is responsible for the consistency 
maintenance of database information. Each execution node generates a new data-
base block through proof of work, and the database block is composed of a database 
block header and a database block body. The database block first generated will be 
broadcast to the inner loop network. After consistency verification by other execu-
tion nodes, the database block enter into the data chain and the local blacklist data-
base is updated.
The design structure of the database block is as follows: 
1. The main key fields of the database block header are the parent hash value, times-
tamp, Merkle tree, random number, and target value.
2. The database block stores SQL database statements, and the execution node 
updates the blacklist database table by executing SQL statements.
In the inner loop network, after the illegal operation is detected by the law enforce-
ment node, the execution node converts the operation performed on the illegal node 
into SQL statements, writes them into the local database buffer pool, and broadcasts 
the SQL statements to other law enforcement nodes. The law enforcement node 
takes out some SQL statements from the local database cache pool, stores them 
in the data block, generates a block header through the calculation power proof, 
and finally broadcasts the newly generated database block to the entire network to 
achieve the consistency of the blacklist database. The inner loop computing power 
chain network is shown in Fig. 8.
14742 J. Wang et al.
1 3
4.1.3  Failed node switching transition
In the local blockchain network, the execution node has two special situations: one 
is that the execution node has a sudden failure, which causes the node to fail to oper-
ate normally; the other is that the execution node produces malicious behavior and 
disrupts the normal operation of the blockchain. The alternate node needs to replace 
the execution node to operate normally in the local blockchain network.
In the first case, the execution node fails to operate normally, in order to prevent 
the situation from further deterioration, the alternate node needs to replace the exe-
cution node to execute normal operation.
Fig. 8  Inner loop computing power chain network
Table 2  Master management 
node data table
Local network Execution node Alternate 
node 1
Alter-
nate 
node 2
Local1 A1 A2 A3
Local2 B3 B2 B1
Local3 C1 C3 C2
Local4 D2 D1 D3
14743
1 3
Blockchain‑based multi‑malicious double‑spending attack…
The total management node data table is maintained between the blockchain 
execution nodes and the alternate nodes. As shown in Table 2, there is one execu-
tion node and two alternate nodes in each blockchain local area network. The execu-
tion node has the highest priority, and the priority of backup node 1 is higher than 
that of alternate node 2. When the execution node does not respond the update and 
other commands issued to other execution nodes within a period of time, it is in a 
fault state by default. At this time, the alternate node 1 becomes the execution node 
and replaces the original execution node for normal operation. The original alter-
nate node 2 becomes the standby node 1, and the corresponding original execution 
node becomes the standby node 2 with the lowest priority. After the adjustment is 
completed, the data table modification information is released to entire management 
nodes for the management node to update the data table in the new management 
node.
In the second case, if the execution node suddenly commits evil, the SQL state-
ment of a certain honest node in the blacklist is written into the database block. In 
order to quickly generate the data block, it generates a fake data block header with-
out performing calculations on the database block header, and other execution nodes 
will perform the following operations after receiving the malicious data block in the 
inner loop network: 
1. Performing hash value verification on the header of the data block. If it does not 
meet the requirements, the execution node that generates the block is determined 
to be a malicious operation; otherwise, it enters the second step.
2. Checking the SQL statement in the data block with the verified SQL statement 
in the local database cache pool. If any inconsistency is found, such as the honest 
node is forcibly written into the blacklist, the database block will be discarded.
At the same time, after being judged as a malicious execution node, the priority of 
the execution node in the master management node data table becomes NULL, indi-
cating that it will no longer be used as an execution node, and the execution node is 
also added to the blacklist database, which will no longer have the right to vote and 
be elected in the future. This process is shown in Fig. 9.
4.2  Blacklist judgment strategy
Multiple malicious computing powers carry out double-spending attacks on the 
blockchain, which seriously affects the normal operation of the blockchain, and a 
blacklist judgment strategy is proposed. According to the laws of malicious attacks 
above, a blacklist strategy is proposed to reduce the occurrence and success prob-
ability of malicious attacks in mining pool. Determining whether a single mining 
pool is a malicious behavior through the decentralized mining pool determination; 
determining the malicious behavior of multiple joint mining pools through joint 
mining pool determinations, and then adding the determined malicious mining pools 
to the local execution node blacklist database. After that, the blocks generated by the 
mining pool nodes in the blacklist are not recognized to be valid.
14744 J. Wang et al.
1 3
4.2.1  Blacklist decentralized mining pool judgment strategy
When a malicious mining pool performs a double-spending attack, it first accu-
mulates its own effective blocks. When the length of the malicious chain is 
greater than the length of the honest chain, it will be published immediately. So 
that other honest nodes will recognize the blocks on the malicious chain instead. 
The malicious attack chain has a distinctive feature, at least first two blocks of the 
fork chain are packaged from the same mining pool, and the nodes on the mining 
pool MP have their corresponding mining pool identifier sign.
Decentralized mining pool judgment idea: 
1. When there are more than two bifurcated sub-chains L in the blockchain at the 
same time, the node extracts the block information BL on each sub-chain. 
(17)
⎧⎪⎨⎪⎩
L1 = {BL1,BL2,…}
L2 = {BL
,
1
,BL
,
2
,…}
…
Fig. 9  Node malicious behavior detection
14745
1 3
Blockchain‑based multi‑malicious double‑spending attack…
2. The node extracts the sign of block information on the forked sub-chain L. If the 
sign of the node that created in the first two blocks is found in the same mining 
pool, then enter 3) for further judgment.
3. The blockchain prescribes a block quantity constant e in advance. If in the e 
blocks after the fork sub-chain, more than half of the node signs sign (BL) which 
are from the same mining pool MP. It is determined that the forked chain L is a 
malicious chain UL, where NUM(a, b) represents the times of the mining pool 
identified as a appears in chain b. 
4. The node abandons the forked child chain of the malicious node and records the 
malicious mining pool MP to the execution node blacklist database BLA, then 
no longer recognizes the validity of the block created by the node in the mining 
pool. 
4.2.2  Blacklist joint mining pool judgment strategy
There is another malicious behavior of mining pools, that is, multiple MPs cooperate 
to attack. At this time, the mining pools of the first two blocks of the malicious fork 
chain may not be the same. In addition, in the first e blocks of the malicious fork 
chain, it is difficult to have more than half of the node addresses from the same min-
ing pool, which may come from multiple joint mining pools. As shown in Fig. 10.
Joint mining pool judgment strategy: 
(18)L = UL when
{
sign(BL1) = sign(BL2)
NUM(addr(BL1),L) >
1
2
(19)M
write
⟶BL
Fig. 10  Joint mining pool operation mode
14746 J. Wang et al.
1 3
1. The node detects that the blockchain has produced multiple forked sub-chain L, 
and the number of blocks in each forked sub-chain is not less than e. After the 
decentralized mining pool judgment for each forked sub-chain, the number of 
forked sub-chain is still no less than two.
2. Each block of the forked sub-chain is compared with the first e blocks of the 
sub-chain in turn (except for itself). If it is found and generated under the same 
mining pool with its own node mark, add 1. 
3. Setting a variable t, t should be greater than 1/2. When the number of blocks N 
generated by all joint mining pool nodes of the forked sub-chain is greater than 
t*e, the forked sub-chain is deemed to be a malicious chain with the joint mining 
pool. 
4. The node abandons the chain forked by the malicious node and records the joint 
malicious mining pool MP to the execution node blacklist database BLA, which 
no longer recognizes the validity of the block created by the node under the min-
ing pool. 
5  Experiment and analysis
The experiment uses 40 hosts with 8GB of RAM, 3.5GHz CPU frequency, and 1TB 
hard disk capacity. NPM: 3.10.10; NodeJS: v6.10.2; Truffle: 2.0.8; and Te6stRPC: 
3.0.5. It was deployed through docker virtualization technology; Kubernetes is used 
to manage the docker cluster, and 40 nodes are divided into multiple areas. Each 
area is set with corresponding blacklist management nodes and ordinary nodes. The 
experimental design architecture diagram is shown below.
In the experiment, the blacklist management model (BMM for short) compari-
son mechanism is the traditional proof-of-work blockchain model (POW for short) 
(Fig. 11).
5.1  Probability of successful attack
Many malicious nodes carry out malicious attacks on the blockchain, and the 
comparison between the number of successful attacks and the total number 
(20)NUM(sign(BL1, L)) =
{
0,NUM(sign(BL1, L)) < 2
NUM(sign(BL1, L)), else
(21)
⎧
⎪⎨⎪⎩
1
2
< t < 1
N =
∑i=e
i=1
NUM(sign(BLi, L))
L = UL whenN > t ⋅ e
(22)M
write
⟶BL
14747
1 3
Blockchain‑based multi‑malicious double‑spending attack…
of attacks can reflect the successful efficiency of the malicious attacks. In the 
blacklist management model (BMM for short), after the malicious behavior of a 
node is detected by the blockchain, the corresponding malicious node is added 
to the local blacklist database by the execution node, indicating that any subse-
quent behavior of the malicious node is invalid. The traditional proof mechanism 
is based on computing power in the blockchain (POW for short). After a mali-
cious node conducts a malicious attack on the blockchain, the longer the attack 
time, the more disadvantaged the malicious node will be, and until the final 
impact on the blockchain is negligible. In the experiment, this article deployed 
experimental environments with 20 master nodes, respectively. Multiple rounds 
of experiments were conducted in each experimental environment. In each round 
of experiments, 50 simulated double-spending attacks were performed on the 
BMM and POW blockchains. In the BWW blockchain, BWW+ and BWW- rep-
resent the number of successful and failed double-spending attacks of malicious 
nodes; in the POW blockchain, POW+ and POW- represent the number of suc-
cessful and failed double-spending attacks of malicious nodes. After several sta-
tistics, Fig. 12 are obtained, respectively.
Fig. 11  Experimental design architecture diagram
14748 J. Wang et al.
1 3
Through the analysis of the figure, we can know the successful number of 
POW blockchain attacks is significantly higher than BWW blockchain, since the 
malicious behavior is detected by the BWW blockchain, the malicious nodes 
are recorded in the blacklist to prevent further mistakes, which significantly 
reduces the possibility of successful attack. As the scale of blockchain nodes 
increases, the number of successful BMM malicious attacks stabilizes at a very 
small range. Therefore, the successful efficiency of BMM malicious attacks is 
extremely low.
5.2  Stability assessment
A double-spending attack on the blockchain by multiple malicious nodes will gener-
ate multiple forked sub-chains at the same time, then the blockchain enters a chaotic 
competition stage. Only one sub-chain is left to return to a stable state. The multi-
chain state returns to the single chain normal state, which reflects the stability of 
the blockchain. In the BMM blockchain, when the malicious node is judged to be 
invalid by the blacklist strategy, the block created cannot be recognized by the whole 
network, which means that the forked sub-chain of the malicious node is invalid. In 
Fig. 12  20-node experimental 
environment
Fig. 13  Fork sub-chain competition trend
14749
1 3
Blockchain‑based multi‑malicious double‑spending attack…
the POW blockchain, the length of the malicious forked sub-chain is much smaller 
than the length of the main chain of the blockchain, and it means the sub-chain is 
invalid. This experiment simulates a double-spending attack. Five and 10 malicious 
nodes are set to perform malicious attacks on the two blockchains. As time goes by, 
the number of forks in the blockchain is counted and it was finally drew as Fig. 13.
In the figure it can be seen that the two blockchains with the same number of 
malicious nodes initially have the same number of forked sub-chains. Later, as time 
grows, the number of forked sub-chains of the BMM blockchain drops rapidly and 
finally becomes a stable single chain, while the POW block number of chain forks 
slowly decreases, which means the blockchain recovers more slowly. Thus, the 
BMM blockchain is significantly better than the traditional POW blockchain.
5.3  Competition delay comparison
During the blockchain double-spending attack, different fork chains compete with 
each other. The time delay from the start of the competition to the end of the com-
petition is the competition delay. The competition delay reflects the degree of chaos 
in the blockchain. In the BWW blockchain, the malicious nodes recorded in the 
blacklist will no longer participate in the competition. In the POW blockchain, the 
blockchain with too short sub-chain length will no longer participate in the compe-
tition. In the experiment, a blockchain experiment environment of 10, 20, 30, and 
40 nodes was set up, and two rounds of tests were performed under the BWW and 
POW blockchains in each experimental environment. Each round of testing counts 
the competition delays of different blockchains, where (POW, 1) represents the first 
round of testing from the POW blockchain. The competition delay comparison can 
be obtained from Fig. 14.
In the figure, the competition delay of the POW blockchain is significantly higher 
than that of the BWW blockchain; the POW blockchain competition delay range 
Fig. 14  Competition Delay Comparison
14750 J. Wang et al.
1 3
(110s, 222s), and the BWW competition delay is (30s, 84s). So BWW significantly 
shortens the competition delay.
5.4  Malicious conversion ratio
In the process of double-spending attacks on malicious nodes, since honest nodes 
admit the valid blocks that arrived first, it will cause some honest nodes to cre-
ate malicious blocks together with malicious nodes. The ratio that honest nodes 
change into malicious nodes reflects the degree of security in the blockchain. The 
BWW blockchain mainly adds malicious nodes to the local blacklist database. In 
the POW blockchain, honest nodes that are transformed into malicious nodes will 
be converted again in the subsequent continuous competition. In this experiment, 
the proportion of the computing power of malicious nodes was adjusted to 20%, 
50%, and 80%. At the same time, the conversion rate of honest nodes into mali-
cious nodes in different time periods of the BWW and POW blockchains were 
calculated, and finally Figs. 15 and 16 are obtained.
Through figures analysis, when the malicious computing power of the POW 
blockchain accounts for 50%, the conversion rate of honest nodes is stable at 
Fig. 15  POW Malicious conversion ratio
Fig. 16  BWW Malicious conversion ratio
14751
1 3
Blockchain‑based multi‑malicious double‑spending attack…
about 50%. If the computing power is less than 50%, the malicious computing 
power is ultimately changing into 0 due to competitive disadvantages, and hon-
est nodes are not transformed into malicious nodes. When the computing power 
is higher than 50%, eventually, the block sub-chain created by malicious nodes 
becomes the main chain, and all honest nodes are transformed into malicious 
nodes. In the BWW blockchain, the conversion rate of honest nodes increases 
first and then decreases to 0. Even if the computing power of malicious nodes 
is higher than 50%, due to the limitation of the blacklist database, honest nodes 
that are finally transformed into malicious nodes are transformed into honesty 
nodes again. Therefore, the BWW blockchain has great advantage in security 
performance.
6  Conclusion and future work
Due to the short development time of the blockchain, the technology is still 
imperfect, and the blockchain mining pool lacks effective constraints. In order to 
significantly reduce the probability of successful mining pool attacks and effec-
tively resist double-spend attacks, this paper studies the different combinations 
of attack method in blockchain mining pools and proposes a blockchain-based 
multi-malicious double-spending attack blacklist management model. This paper 
proposes an inner loop malicious game method to obtain the success rate of 
double-spending attacks through mathematical derivation. Two double-spending 
attack models are proposed, which are the joint attack model and the decentral-
ized attack model. Then, the attack processes of the two models are mathemati-
cally analyzed, and the internal attack mechanism is deduced through the com-
prehensive analysis of the attack results. Later a blacklist management model 
is proposed, and to formulate a blacklist judgment strategy after constructing a 
blacklist. Through the decentralize mining pool judgment and joint mining pool 
judgments to extract malicious mining pool nodes, which prevents nodes to do 
evil from the root cause.
The mathematical model of double-spending attack with multiple malicious 
nodes studied in this paper is mainly carried out under the POW consensus mech-
anism. Further work in the future is to analyze the combined attack forms under 
other mainstream consensus mechanisms such as POS and Dpos (Delegated Proof 
of Stake) and to formulate related defense strategies. And the work is still in the 
experimental stage. In order to apply the theoretical results to IoT applications 
with low power consumption and simple processing, the later stage of our another 
work is to study how to further integrate the research results with the existing 
relatively complete blockchain system (such as hyperledger fabric), to accelerate 
the transformation of achievements and the landing of IoT applications.
Acknowledgements The authors thank for prof. Linlin Ding and Dr Wanting Ji for helpful discussions.
14752 J. Wang et al.
1 3
Funding This work was supported by the National Natural Science Foundation of China (61502215, 
51704138), the Postdoctoral Science Foundation of China (2020M672134) and the Scientific Research 
Project of the Educational Department of Liaoning Province (LJC201913).
Data availability A significant amount of data is presented in this article. The remaining data that support 
the findings of this study are available on request from the corresponding author. The data are not pub-
licly available due to privacy or ethical restrictions.
Declarations 
Conflict of interest The authors declare no potential conflict of interests.
References
 1. Nakamoto S (2008) Bitcoin: a peer-to-peer electronic cash system. Decent Bus Rev:21260
 2. Yaga D, Mell P, Roby N, Scarfone K (2019) Blockchain technology overview. arXiv preprint 
arXiv: 1906. 11078
 3. Yli-Huumo J, Ko D, Choi S, ParkS Smolander K (2016) Where is current research on blockchain 
technology?-a systematic review. PloS One 11(10):e0163477
 4. Zheng Z, Xie S, Dai H, Chen X, Wang H (2017) An overview of blockchain technology: archi-
tecture, consensus, and future trends. In: 2017 IEEE International Congress on Big Data (Big-
Data Congress), pp 557–564, IEEE
 5. Belchior R, Vasconcelos A, Guerreiro S, Correia M (2020) A survey on blockchain interoper-
ability: past, present, and future trends. arXiv preprint arXiv: 2005. 14282
 6. Yang W, Garg S, Raza A, Herbert D, Kang B (2018, August) Blockchain: trends and future. In: 
Pacific Rim Knowledge Acquisition Workshop, Springer, Cham, pp 201–210
 7. Giungato P, Rana R, Tarabella A, Tricase C (2017) Current trends in sustainability of bitcoins 
and related blockchain technology. Sustainability 9(12):2214
 8. Nguyen GT, Kim K (2018) A survey about consensus algorithms used in blockchain. J Inf Pro-
cess Syst 14(1):101–128
 9. Mingxiao D, Xiaofeng M, Zhe Z, Xiangwei W, Qijun C (2017) A review on consensus algo-
rithm of blockchain. In: 2017 IEEE International Conference on Systems, Man, and Cybernetics 
(SMC), IEEE, pp 2567–2572
 10. He Y, Li H, Cheng X, Liu Y, Yang C, Sun L (2018) A blockchain based truthful incentive mech-
anism for distributed P2P applications. IEEE Access 6:27324–27335
 11. Donet J A D, Pérez-Sola C, Herrera-Joancomartí J (2014) The bitcoin P2P network. In: Interna-
tional Conference on Financial Cryptography and Data Security, Springer, Berlin, Heidelberg, pp 
87–102
 12. Ben Mariem S, Casas P, Donnet B (2018) Vivisecting blockchain P2P networks: unveiling the 
Bitcoin IP network. In: ACM CoNEXT student workshop
 13. Benisi NZ, Aminian M, Javadi B (2020) Blockchain-based decentralized storage networks: a sur-
vey. J Netw Comput Appl 162:102656
 14. Puthal D, Malik N, Mohanty SP, Kougianos E, Yang C (2018) The blockchain as a decentralized 
security framework [future directions]. IEEE Consum Electron Mag 7(2):18–21
 15. Gencer AE, Basu S, Eyal I, Van Renesse R, Sirer EG (2018) Decentralization in bitcoin and 
ethereum networks. In: International Conference on Financial Cryptography and Data Security, 
Springer, Berlin, Heidelberg, pp 439–457
 16. Nugent T, Upton D, Cimpoesu M (2016) Improving data transparency in clinical trials using 
blockchain smart contracts. F1000Research 5
 17. Bhowmik D, Feng T (2017) The multimedia blockchain: a distributed and tamper-proof media 
transaction framework. In: 2017 22nd International Conference on Digital Signal Processing 
(DSP), IEEE, pp 1–5
 18. Xinyi Y, Yi Z, He Y (2018) Technical characteristics and model of blockchain. In: 2018 10th 
International Conference on Communication Software and Networks (ICCSN), IEEE, pp 
562–566
http://arxiv.org/abs/1906.11078
http://arxiv.org/abs/2005.14282
14753
1 3
Blockchain‑based multi‑malicious double‑spending attack…
 19. Viriyasitavat W, Hoonsopon D (2019) Blockchain characteristics and consensus in modern busi-
ness processes. J Ind Inf Integr 13:32–39
 20. Leng K, Bi Y, Jing L, Fu HC, Van Nieuwenhuyse I (2018) Research on agricultural supply chain 
system with double chain architecture based on blockchain technology. Fut Gener Comput Syst 
86:641–649
 21. Liu X (2018) Research and application of electronic invoice based on blockchain. In: MATEC 
Web of Conferences , Vol. 232, EDP Sciences, p 04012
 22. Feng Q, He D, Zeadally S, Khan MK, Kumar N (2019) A survey on privacy protection in block-
chain system. J Netw Comput Appl 126:45–58
 23. Lin IC, Liao TC (2017) A survey of blockchain security issues and challenges. Int J Netw Secur 
19(5):653–659
 24. Kumar NM, Mallick PK (2018) Blockchain technology for security issues and challenges in IoT. 
Proced Comput Sci 132:1815–1823
 25. Dai F, Shi Y, Meng N, Wei L, Ye Z (2017) From bitcoin to cybersecurity: a comparative study of 
blockchain application and security issues. In: 2017 4th International Conference on Systems and 
Informatics (ICSAI), IEEE, pp 975–979
 26. Matzutt R, Hiller J, Henze M, Ziegeldorf J H, Müllmann D, Hohlfeld O, Wehrle K (2018) A quanti-
tative analysis of the impact of arbitrary blockchain content on bitcoin. In: International Conference 
on Financial Cryptography and Data Security, Springer, Berlin, Heidelberg, pp 420–438
 27. DuPont Q (2017) Experiments in algorithmic governance: a history and ethnography of “The 
DAO,” a failed decentralized autonomous organization. Bitcoin Beyond:157–177
 28. bradbury D (2013) Czech bitcoin exchange Bitcash.cz hacked and up to 4,000 user wallets emptied. 
Coindesk. https:// www. coind esk. com/ czech- bitco in- excha nge- bitca sh- cz- hacked- 4000- user- walle ts- 
empti ed
 29. Shane D (2018) $530 million cryptocurrency heist may be biggest ever. CNNMoney. https:// money. 
cnn. com/ 2018/ 01/ 29/ techn ology/ coinc heck- crypt ocurr ency- excha nge- hack- japan/ index. html
 30. Wood A (2018) Confirmed: monex group to acquire coincheck. Cointelegraph. https:// coint elegr 
aph. com/ news/ confi rmed- monex- group- to- acqui re- coinc heck
 31. Whittaker Z (2015) Bitstamp exchange hacked, $5M worth of bitcoin stolen. zdnet. https:// www. 
zdnet. com/ artic le/ bitst amp- bitco in- excha nge- suspe nded- amid- hack- conce rns- heres- what- we- know/
 32. Karame G, Androulaki E, Capkun S (2012) Two bitcoins at the price of one? Double-spending 
attacks on fast payments in bitcoin. IACR Cryptol ePrint Arch 248:1–17
 33. Karame GO, Androulaki E, Capkun S (2012) Double-spending fast payments in bitcoin. In: Pro-
ceedings of the 2012 ACM Conference on Computer and Communications Security, pp 906–917
 34. Chaudhary KC, Chand V, Fehnker A (2020) Double-spending analysis of bitcoin. In Pacific Asia 
Conference on Information Systems Proceedings. Association for Information Systems
 35. Gervais A, Karame G O, Wüst K, Glykantzis V, Ritzdorf H, Capkun S (2016) On the security and 
performance of proof of work blockchains. In: Proceedings of the 2016 ACM SIGSAC Conference 
on Computer and Communications Security, pp 3–16
 36. Meneghetti A, Sala M, Taufer D (2020) A survey on pow-based consensus. Ann Emerg Technol 
Comput (AETiC) Print ISSN, 2516-0281
 37. She W, Liu Q, Tian Z, Chen JS, Wang B, Liu W (2019) Blockchain trust model for malicious node 
detection in wireless sensor networks. IEEE Access 7:38947–38956
 38. Huang J, Kong L, Chen G, Wu MY, Liu X, Zeng P (2019) Towards secure industrial IoT: blockchain 
system with credit-based consensus mechanism. IEEE Trans Ind Inf 15(6):3680–3689
 39. Gong S, Lee C (2020) Blocis: blockchain-based cyber threat intelligence sharing framework for 
sybil-resistance. Electronics 9(3):521
 40. Tukur YM, Thakker D, Awan IU (2021) Edge-based blockchain enabled anomaly detection for 
insider attack prevention in Internet of Things. Trans Emerg Telecommun Technol 32(6):e4158
 41. Shafi Q, Basit A (2019) DDoS botnet prevention using blockchain in software defined internet 
of things. In: 2019 16th International Bhurban Conference on Applied Sciences and Technology 
(IBCAST), IEEE, pp 624–628
 42. Qiang Liu, Song Yan, Jie Wan (2021) Ruiqiang Ma. Multi-malicious nodes double-spending attack 
blacklist management model. DSIT, Jianhang Xu, pp 462–467
 43. Lewenberg Y, Bachrach Y, Sompolinsky Y, Zohar A, Rosenschein J S (2015) Bitcoin mining pools: 
a cooperative game theoretic analysis. In: Proceedings of the 2015 International Conference on 
Autonomous Agents and Multiagent Systems, pp 919–927
https://www.coindesk.com/czech-bitcoin-exchange-bitcash-cz-hacked-4000-user-wallets-emptied
https://www.coindesk.com/czech-bitcoin-exchange-bitcash-cz-hacked-4000-user-wallets-emptied
https://money.cnn.com/2018/01/29/technology/coincheck-cryptocurrency-exchange-hack-japan/index.html
https://money.cnn.com/2018/01/29/technology/coincheck-cryptocurrency-exchange-hack-japan/index.html
https://cointelegraph.com/news/confirmed-monex-group-to-acquire-coincheck
https://cointelegraph.com/news/confirmed-monex-group-to-acquire-coincheck
https://www.zdnet.com/article/bitstamp-bitcoin-exchange-suspended-amid-hack-concerns-heres-what-we-know/
https://www.zdnet.com/article/bitstamp-bitcoin-exchange-suspended-amid-hack-concerns-heres-what-we-know/
14754 J. Wang et al.
1 3
 44. Fisch B, Pass R, Shelat A (2017) Socially optimal mining pools. In: International Conference on 
Web and Internet Economics, Springer, Cham, pp 205–218
 45. Daniel C (2014) Are 51% Attacks a Real Threat to Bitcoin? CoinDesk. https:// www. coind esk. com/ 
51- attac ks- real- threat- bitco in
 46. Lylian T (2019) BTC.COM’S BITCOIN MINING POOL DOMINANCE THREATENED BY 
POOLIN. 8btc. https:// bitco inmag azine. com/ busin ess/ btc- coms- bitco in- mining- pool- domin ance- 
threa tened- by- poolin
 47. Ji S, Ma H, Liang Y, Leung H, Zhang C (2017) A whitelist and blacklist-based co-evolutionary 
strategy for defensing against multifarious trust attacks. Appl Intell 47(4):1115–1131
 48. Dony C, Raskinet M, Renaville F, Simon S, Thirion P (2020) How reliable and useful is Cabell’s 
Blacklist? A data-driven analysis. Liber Q. 30(1)
 49. Lee H, Shin M, Kim K S, Kang Y, Kim J (2018) Recipient-oriented transaction for preventing dou-
ble spending attacks in private blockchain. In: 2018 15th Annual IEEE International Conference on 
Sensing, Communication, and Networking (SECON), IEEE, pp 1–2
 50. Pérez-Solà C, Delgado-Segura S, Navarro-Arribas G, Herrera-Joancomartí J (2019) Double-spend-
ing prevention for bitcoin zero-confirmation transactions. Int J Inf Secur 18(4):451–463
 51. Zhang S, Lee JH (2020) Mitigations on sybil-based double-spend attacks in bitcoin. IEEE Consum 
Electron Mag 10(5):23–28
 52. Ekparinya P, Gramoli V, Jourjon G (2018) Double-spending risk quantification in private, consor-
tium and public ethereum blockchains. CoRR abs/1805.05004
 53. Kovalchuk L, Kaidalov D, Nastenko A, Rodinko M, Shevtsov O, Oliynykov R (2020) Decreas-
ing security threshold against double spend attack in networks with slow synchronization. Comput 
Commun 154:75–81
 54. Fujita K, Zhang Y, Sasabe M, Kasahara S (2021) Mining pool selection under block with holding 
attack. Appl Sci 11(4):1617
 55. Yang T, Xue Z (2019) Game theory among mining pools in blockchain system. Commun Technol 
52(05):1189–1195
 56. Wang C, Chu X, Qin Y (2020, July) Measurement and analysis of the bitcoin networks: a view from 
mining pools. In: 2020 6th International Conference on Big Data Computing and Communications 
(BIGCOM), pp 180–188, IEEE
 57. Romiti M, Judmayer A, Zamyatin A, Haslhofer B (2019) A deep dive into bitcoin mining pools: an 
empirical analysis of mining shares. arXiv preprint arXiv: 1905. 05999
 58. Sagirlar G, Carminati B, Ferrari E, Sheehan J D, Ragnoli E (2018) Hybrid-iot: hybrid blockchain 
architecture for internet of things-pow sub-blockchains. In: 2018 IEEE International Conference on 
Internet of Things (iThings) and IEEE Green Computing and Communications (GreenCom) and 
IEEE Cyber, Physical and Social Computing (CPSCom) and IEEE Smart Data (SmartData), IEEE, 
pp 1007–1016
 59. Shi L, Wang T, Li J, Zhang S (2021) Pooling is not favorable: decentralize mining power of PoW 
blockchain using age-of-work. arXiv preprint arXiv: 2104. 01918
 60. Saad M, Njilla L, Kamhoua C, Kim J, Nyang D, Mohaisen A (2019) Mempool optimization for 
defending against ddos attacks in pow-based blockchain systems. In: 2019 IEEE International Con-
ference on Blockchain and Cryptocurrency (ICBC), IEEE, pp 285–292
 61. He S, Ren W, Zhu T, Choo KKR (2019) BoSMoS: a blockchain-based status monitoring system for 
defending against unauthorized software updating in industrial Internet of Things. IEEE Internet of 
Things J 7(2):948–959
 62. Wang K, Wang Y, Ji Z (2020) Defending blockchain forking attack by delaying MTC confirmation. 
IEEE Access 8:113847–113859
Publisher’s Note Springer Nature remains neutral with regard to jurisdictional claims in published 
maps and institutional affiliations.
https://www.coindesk.com/51-attacks-real-threat-bitcoin
https://www.coindesk.com/51-attacks-real-threat-bitcoin
https://bitcoinmagazine.com/business/btc-coms-bitcoin-mining-pool-dominance-threatened-by-poolin
https://bitcoinmagazine.com/business/btc-coms-bitcoin-mining-pool-dominance-threatened-by-poolin
http://arxiv.org/abs/1905.05999
http://arxiv.org/abs/2104.01918
14755
1 3
Blockchain‑based multi‑malicious double‑spending attack…
Authors and Affiliations
JunLu Wang1 · Qiang Liu1 · Baoyan Song1
 JunLu Wang 
 wangjunlu@lnu.edu.cn
 Qiang Liu 
 18170097254@163.com
1 School of Information, Liaoning University, Shenyang 110036, China
	Blockchain-based multi-malicious double-spending attack blacklist management model
	Abstract
	1 Introduction
	2 Related work
	3 Multi-malicious double-spending attack model
	3.1 Inner loop malicious game
	3.2 Joint attack model
	3.3 Decentralized attack model
	3.4 Model comparison
	4 Blacklist management model
	4.1 Blacklist management model construction
	4.1.1 Blacklist management node election
	4.1.2 Inner loop computing power chain strategy
	4.1.3 Failed node switching transition
	4.2 Blacklist judgment strategy
	4.2.1 Blacklist decentralized mining pool judgment strategy
	4.2.2 Blacklist joint mining pool judgment strategy
	5 Experiment and analysis
	5.1 Probability of successful attack
	5.2 Stability assessment
	5.3 Competition delay comparison
	5.4 Malicious conversion ratio
	6 Conclusion and future work
	Acknowledgements 
	References