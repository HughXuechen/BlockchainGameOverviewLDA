Dynamic Evolutionary Game-based Modeling, Analysis and Performance Enhancement of Blockchain Channels
 
Dynamic Evolutionary Game-based Modeling,
Analysis and Performance Enhancement of
Blockchain Channels
PeiYun Zhang, Senior Member, IEEE, MengChu Zhou, Fellow, IEEE,
ChenXi Li, and Abdullah Abusorrah, Senior Member, IEEE
 
   Abstract—The  recent  development  of  channel  technology  has
promised to reduce the transaction verification time in blockchain
operations. When transactions are transmitted through the chan-
nels  created  by  nodes,  the  nodes  need  to  cooperate  with  each
other. If one party refuses to do so, the channel is unstable. A sta-
ble channel is thus required. Because nodes may show uncooper-
ative behavior, they may have a negative impact on the stability of
such channels. In order to address this issue, this work proposes a
dynamic evolutionary game model based on node behavior. This
model  considers  various  defense  strategies’ cost  and  attack  suc-
cess ratio under them. Nodes can dynamically adjust their strate-
gies according to the behavior of attackers to achieve their effec-
tive defense. The equilibrium stability of the proposed model can
be achieved. The proposed model can be applied to general chan-
nel networks. It is compared with two state-of-the-art blockchain
channels:  Lightning  network  and  Spirit  channels.  The  experi-
mental  results  show  that  the  proposed  model  can  be  used  to
improve  a  channel’s  stability  and  keep  it  in  a  good  cooperative
stable  state.  Thus  its  use  enables  a  blockchain  to  enjoy  higher
transaction success ratio and lower transaction transmission delay
than the use of its two peers.
    Index Terms—Blockchain,  channel  network,  evolutionary  game,
malicious behavior, secure computing, stability analysis.
  
I.  Introduction
  
A.  Background
B LOCKCHAINS  have  wide  applications  in  such  areas  as
smart  grids,  secure  computing,  smart  manufacturing,
Internet  of  Things,  and  finance  [1],  [2].  The  security  of
blockchain-based  cryptocurrencies,  such  as  Bitcoin  [2],  par-
tially comes from the wide replication of blocks at the expense
of  finite  scalability.  Malavolta et  al.  propose  the  virtual  con-
cept of a channel [3]. Both parties create a channel by adding
a  single  transaction  to  the  blockchain,  i.e.,  lock  up  a  certain
amount of funds (i.e.,  cryptocurrency such as bitcoin) as col-
lateral  balance  in  the  deposit,  i.e.,  a  multi-signature  address.
The  deposit  is  guaranteed  by  the  bitcoin  smart  contract  [4].
Then, the balance is allocated off-chain to reach an agreement
to make an off-chain payment.  Finally,  both parties write the
final  balance  into  the  blockchain  and  close  the  channel  after
transmitting  transactions  between  them.  Channel  technology
is a major method to increase cryptocurrency scale. It focuses
on moving transactions from a blockchain to an off-chain by
using point-to-point channels [5]. Using channels, we can han-
dle  many  transactions  off-chain.  They  can  be  transferred
through  channels,  and  ultimately  net  profit  is  settled  on  the
blockchain to reduce the delay of transaction confirmation [6].
A blockchain  can  be  taken as  an  arbitration  platform to  han-
dle abnormal conditions in a transaction process, e.g., disagree-
ment  between  two  nodes  on  state  channels.  The  use  of  such
channels can improve a blockchain’s transaction throughput.
To reduce the number of on-chain transactions, channels are
linked together to form a blockchain channel network, which
can enable a large number of transactions to be conducted off
blockchain  and  reduce  the  dependence  of  transactions  on-
chain. Based on a blockchain channel network, nodes use one
or more channels to transmit transactions by transferring fund
between  channels.  If  one  party  withdraws  transactions  or
closes the channel due to attacks or noncooperation behaviors
of  nodes,  the  transactions  have  to  be  dealt  with  on  the
blockchain  online  (called  on-chain  transactions).  Moreover,
on-chain  transactions  not  only  cost  transaction  fees,  but  also
require longer transaction confirmation time, sometimes up to
several hours [7]. Hence, a stable and secure channel network
is critical for successful transaction transmission. Building and
 
Manuscript  received  February  7,  2022;  revised  May  18,  2022;  accepted
June  7,  2022.  This  work  was  supported  by  the  National  Natural  Science
Foundation  of  China  (61872006),  Scientific  Research  Activities  Foundation
of  Academic  and  Technical  Leaders  and  Reserve  Candidates  in  Anhui
Province (2020H233), Top-notch Discipline (specialty) Talents Foundation in
Colleges  and  Universities  of  Anhui  Province  (gxbj2020057),  the  Startup
Foundation  for  Introducing  Talent  of  NUIST,  and  by  Institutional  Fund
Projects  from  Ministry  of  Education  and  Deanship  of  Scientific  Research
(DSR),  King  Abdulaziz  University  (KAU),  Jeddah,  Saudi  Arabia  (IFPDP-
216-22).  Recommended  by  Associate  Editor  Yang  Xiang. (Corresponding
author: MengChu Zhou.)
Citation: P. Y. Zhang, M. C. Zhou, C. X. Li, and A. Abusorrah, “Dynamic
evolutionary  game-based  modeling,  analysis  and  performance  enhancement
of  blockchain  channels,” IEEE/CAA  J.  Autom.  Sinica,  vol.  10,  no.  1,  pp.
188–202, Jan. 2023.
P. Y. Zhang is with the School of Computer Science, Nanjing University of
Information  Science  &  Technology,  Nanjing  210044,  China  (e-mail:  zpy@
nuist.edu.cn).
M.  C.  Zhou  is  with  the  Helen  and  John  C.  Hartmann  Department  of
Electrical  and  Computer  Engineering,  New  Jersey  Institute  of  Technology,
Newark, NJ 07102 USA (e-mail: zhou@njit.edu).
C.  X.  Li  is  with  the  School  of  Computer  and  Information,  Anhui  Normal
University, Wuhu 241003, China (e-mail: ichenxi1102@126.com).
A.  Abusorrah  is  with  the  Department  of  Electrical  and  Computer
Engineering,  Faculty  of  Engineering,  and  Center  of  Research  Excellence  in
Renewable  Energy  and  Power  Systems,  King  Abdulaziz  University,  Jeddah
21481, Saudi Arabia (e-mail: aabusorrah@kau.edu.sa).
Color  versions  of  one  or  more  of  the  figures  in  this  paper  are  available
online at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JAS.2022.105911
188 IEEE/CAA JOURNAL OF AUTOMATICA SINICA, VOL. 10, NO. 1, JANUARY 2023
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:00:11 UTC from IEEE Xplore.  Restrictions apply. 
maintaining a model for stability analysis in such a network is
one of the most important steps to achieve successful transac-
tion transmission.  
B.  Research Motivations and Contributions
This  work  is  motivated  by  the  strong  need  to  improve  the
stability and security of a blockchain channel network by:
1)  Decreasing  Internal  Attacks  From  Internal  Nodes: In
practice, a channel has the risk of being attacked [8], especia-
lly  when  attacks  are  initiated  from  nodes  inside  channels
(called  internal  attacks).  Internal  attacks  may  severely  affect
the performance of a channel and even paralyze it [9]−[13]. It
is more difficult to prevent them than external ones. To solve
the  problem,  this  work  proposes  a  defense  strategy  to  help
nodes  resist  internal  attacks  to  enhance  channel  network  sta-
bility.
2)  Promoting  Cooperation  Among  Nodes: If  nodes  in  a
blockchain  channel  network  do  not  cooperate,  some  related
channels cannot be reused. Hence, how to make full use of all
channels  is  an  important  issue  for  researchers  and  engineers.
Some  methods  simply  isolate  nodes  when  these  nodes  have
malicious  behavior  [10],  [14]−[17],  which  makes  their  cre-
ated channels unused and unstable. It also makes a blockchain
channel  network  sparse.  To  solve  the  problem,  evolutionary
game theory is adopted to study the cooperation among nodes
[18]. An effective strategy is derived to promote their cooper-
ation  so  as  to  make  full  use  of  all  the  existing  channels  to
increase channel network stability.
Hence, to maintain a blockchain channel network in a good
and stable state of cooperation under internal attacks and non-
cooperation  behaviors,  we  propose  a  dynamic  evolutionary
game model of a blockchain channel network with the follow-
ing contributions:
i) To decrease internal attacks in a blockchain channel net-
work, a novel dynamic evolutionary game model is proposed
based  on  its  nodes’ behaviors.  A  defense  strategy  is  devel-
oped,  which  considers  attack  cost  and  attack  success  ratio.
Among  them,  the  attack  cost  is  based  on  balances  between
any  two  nodes  in  a  blockchain  channel  network.  It  allows
nodes  to  resist  attack  behaviors  at  a  certain  ratio  and  at  the
same time decrease non-cooperation behaviors.
ii) To increase cooperation among nodes, the model consid-
ers the bounded rationality of nodes, which only know a part
of the game state of a blockchain channel network. Each node
adopts  its  strategy  with  the  goal  to  maximize  its  profits.
Driven  by  their  profits,  nodes  prefer  to  cooperate  instead  of
attacks or non-cooperation.
iii)  Based  on  the  model,  equilibrium  stability  analysis  of
involved  parities  is  conducted.  An  evolutionary  stable  strat-
egy (ESS) is derived. Nodes in a blockchain channel network
adopt their own strategies according to ESS. They can contin-
uously adjust their strategies based on their current profit situ-
ations to reach a stable state in a blockchain channel network.
The  stability  analysis  is  presented  under  different  behaviors
with attacks and non-cooperation.
Section II describes the related work. Section III proposes a
dynamic evolutionary game model. Section IV gives theoreti-
cal proofs to analyze game stability. Section V analyzes experi-
mental results. Section VI concludes this work.  
II.  Related Work
The  existing  channels  are  mainly  divided  into  two  cate-
gories: payment and state channels [19]. Each channel has its
respective transaction type.
1) Payment Channels: They are designed to establish direct
peer-to-peer payment. They allow both parties to maintain and
update their ledgers privately. Each transaction does not need
to  be  written  into  a  blockchain  ledger.  Legal  funds  can  be
withdrawn from its blockchain at any time. Among them, the
blockchain  ledger  is  a  public,  decentralized,  and  verifiable
ledger  managed  by  the  blockchain  [20].  Payment  channels
include  Spilman  payment  channels,  lightning  channels,  and
duplex micropayment channels.
i) Spilman payment channels: Spilman [21] first proposes a
channel payment protocol based on a bitcoin system. This pro-
tocol realizes instant confirmation of transactions and features.
Funds  of  a  transaction  receiver  always  increase  during  pay-
ment  processes  of  channels.  The  individual  receiver  only
announces the latest states in the channel network. Otherwise,
a  receiver’s  funds  are  lost.  This  channel  protocol  only  sup-
ports  one-way  payment,  i.e.,  a  user  pays  to  different  mer-
chants.
ii)  Lightning  network: This  is  the  earliest  popular  payment
channel  network.  It  is  formed  through  payment  channels  to
improve blockchain transaction throughput. It mainly includes
two  types  of  contracts  [10]:  Recoverable  sequence  maturity
contracts  (RSMC)  and  hashed  timelock  contracts  (HTLC).
The former mainly implements two-way payment channels. It
enables  both  parties  of  a  channel  to  immediately  confirm  a
transaction  when  the  transaction  is  not  submitted  on  the
blockchain.  The  latter  realizes  that  the  transfer  of  the  fund
(also  called  balance)  between any two nodes  in  a  blockchain
channel  network  can  be  completed  through  a  two-way  pay-
ment  channel.  There  are  shortcomings  of  low  efficiency  and
insufficient availability of a lightning network solution. Espe-
cially  in  its  two-way payment  channel  protocol,  the  channels
are  limited by the script  of  a  bitcoin system.  In  order  to  pre-
vent one party from doing evil, the other party needs to store
its  counterpart’s  previous  penalty  transactions  in  rounds  of
interactions. As high-frequency transactions continue to occur,
the  cost  of  storing  these  transactions  becomes  greater  and
greater [14]. This may bring a huge burden to users.
iii) Duplex micropayment channels: The channels solve the
problems  of  the  aforementioned  two  channels.  They  also
achieve high scalability for digital payment based on bitcoins
[11]. Because HTLC of a lightning channel is used, transmis-
sion on a duplex micropayment channel is secure.
2)  State  Channels: Different  from  payment  channels,  state
channels  not  only support  off-chain payments  among parties,
but also allow the execution of arbitrarily complex smart con-
tracts. They are further divided into Sprites and Revive chan-
nels. Miller et al. [12] propose them to improve the efficiency
of  blockchains.  They  can  be  used  to  solve  the  problem  of  a
lightning  channel  in  terms  of  excessive  time  overhead  when
cross-channel  payment  is  unsuccessful.  Revive  channels  are
ZHANG et al.: DYNAMIC EVOLUTIONARY GAME-BASED MODELING, ANALYSIS AND PERFORMANCE ENHANCEMENT 189 
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:00:11 UTC from IEEE Xplore.  Restrictions apply. 
proposed  in  [13]  to  implement  a  sustainable  mechanism  in
payment  channels.  They  enable  transaction  participants  to
safely transfer balances through payment channels.
With channel technologies such as payment and state chan-
nels, it is necessary to find a transaction transmission path in a
decentralized  channel  network  to  transmit  a  transaction.  The
path  from transaction  senders  to  receivers  enables  stable  and
fast transaction transmission. The existing channel path selec-
tion methods such as Flare [15] and Landmark Routing [16],
[17] need nodes to obtain all the information of a routing pro-
cess.  Regardless  of  nodes  in  the  case  of  dynamically  joining
or  quitting  a  channel,  if  all  nodes  are  willing  to  cooperate,  a
path  can  be  found  through  a  routing  algorithm.  However,
attackers  may  launch  attacks  on  a  channel  to  obtain  its  bal-
ance, such as a routing attack [22], [23].
In addition, nodes in a channel may also become the target
of  attacks  and  some  of  them  may  be  captured  by  attackers.
Internal nodes may launch attacks from the inside of channels
(we call them internal attacks). Traditional signature verifica-
tion [9] faces the problem of invalidation under such attacks.
To solve it, the prior work, e.g., [10], [11], assumes that hon-
est  participants  lose no funds during the process of  rebalanc-
ing  channel  funds.  However,  they  fail  to  consider  the  mali-
cious behaviors of dishonest participants. Reference [12] con-
siders  the  consequences  of  malicious  behavior  but  fails  to
effectively reduce a node’s malicious behavior. The method in
[13] guarantees security of transmission processes but fails to
handle participants of malicious behaviors. These attacks may
seriously affect the performance of a channel and even cause
it  to  be  paralyzed.  Effectively  resisting  attack  behaviors  of
internal nodes can improve the stability and security of chan-
nels,  which  can  help  complete  transaction  transmission
quickly and successfully via channels.
From  the  above  analysis,  all  the  prior  channels  face  two
challenging  issues:  a)  how  to  reduce  node  internal  attack
behaviors to avoid the instability of a blockchain channel net-
work; and b) how to increase cooperation among nodes so as
to increase channel stability.
In  blockchain  channels,  attackers  can  launch  attacks  on
blockchain  channels,  such  as  routing  attacks.  In  addition,
nodes  in  blockchain  channels  may  also  become  attacked
objects  and  be  captured  by  attackers.  These  internal  nodes
may  launch  attacks  from  the  channel  itself,  which  may  seri-
ously affect the performance of such channel and even lead to
the paralysis of the whole network. Therefore, effectively pre-
venting the attack behavior of internal nodes can improve the
stability and security of  blockchain channels,  which can help
transactions  in  channels  be  completed  quickly  and  smoothly.
Based  on  the  idea  of  nodes’ profits  and  evolutionary  game,
this work proposes a novel model to analyze the evolutionary
game of node behavior in blockchain channels, so as to effec-
tively improve its stability and security.  
III.  Proposed Evolutionary Game Model for
Blockchain Channels
  
A.  Related Concepts
Evolutionary  Game  Theory: This  theory  abandons  the
assumption of complete rationality in classical game theory. It
emphasizes  bounded  rationality  [24]  of  participants  and  a
dynamic evolutionary game process.
1)  Bounded  Rationality: The  assumption  of  bounded  ratio-
nality means that nodes in blockchain channels can only have
knowledge  of  part  of  the  information  of  the  whole  network
game  state.  It  is  impossible  to  know  the  overall  state  of  the
game, which is in line with the characteristics of the nodes in
blockchain  channels.  Because  in  a  blockchain  channel  net-
work, frequent joining and exiting of nodes make a blockchain
channel  topology  constantly  change.  Nodes  consume  a  good
amount of funds and some storage space to obtain and main-
tain the state of an entire blockchain channel network. Hence,
in  a  resource-constrained  blockchain  channel,  it  is  economi-
cally inefficient.
2) Dynamic Evolution: A node in a blockchain channel net-
work cannot find an optimal strategy through only one game.
To  solve  the  problem,  dynamic  evolution  [25]  can  allow  for
nodes  to  obtain  their  optimal  strategies  by  adjusting  their
strategies,  including  continuous  learning,  imitation,  and  trial-
and-error  during  games.  Nodes  may  dynamically  adjust  their
strategies  according  to  the  different  strategies  of  attackers
[26].  In  the  end,  this  finds  the  best  strategy  to  maximize  its
profits.  The  relevant  settings  of  a  blockchain  channel  are  as
follows:
i)  A  blockchain  channel  is  composed  of  multiple  nodes.
Each  node  has  a  transaction-transmission  function  that  sup-
ports transmitting a transaction.
ii) Node behaviors: There are cooperation, non-cooperation,
defense, and attack behaviors of a node.
a)  Cooperation: A  node  agrees  on  transmitting  a  transac-
tion.
b)  Non-cooperation: A  node  refuses  to  transmit  a  trans-
action.
c)  Attack: A  node  launches  attacks,  such  as  the  denial-of-
service attack in data trade [27] and pool-hopping attack [28].
More types of attacks in blockchains are given in [29].
d)  Defense: A  node  defends  against  attacks  from  other
nodes, such as analyzing node attacks, building a blacklist  of
malicious nodes, and dealing with no transaction from them.
iii)  Nodes  are  classified  into  two types:  Type-I  and  type-II
according to whether they have attack behaviors or not.
a) Type-I nodes have defensive behaviors in channels; and
b) Type-II nodes have attack behaviors in channels.
Note  that  all  nodes  have  cooperation  and  non-cooperation
behaviors.
iv) All nodes have bounded rationality [30]. In an evolution-
ary  game,  type-I  and  type-II  nodes  rely  on  the  information
about the strategies used by each other. Both parties make the
best  decisions  to  achieve  maximum  profits  in  a  game  only
with  their  knowledge and resources.  When a  channel  is  used
to  transmit  a  transaction,  nodes  that  create  the  channel  can
obtain  different  profits  (i.e.,  funds,  such  as  cryptocurrency)
due  to  their  different  behaviors,  such  as  cooperation,  non-
cooperation,  defense,  and  attack  behaviors.  Thus,  nodes
choose their own strategies to maximize their own profits dur-
ing  an  evolutionary  game  for  a  blockchain  channel  network.
Because nodes only know part of the game state of the whole
 190 IEEE/CAA JOURNAL OF AUTOMATICA SINICA, VOL. 10, NO. 1, JANUARY 2023
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:00:11 UTC from IEEE Xplore.  Restrictions apply. 
network, bounded rationality enables type-I and type-II nodes
to make decisions and constantly adjust strategies according to
their current profits.
v) Multiple channels can be established between two nodes
with the help of other nodes.
The following notation and acronyms are used:
ESS Evolutionary stable strategy
HTLC Hashed timelock contract
RSMC Recoverable sequence maturity contract
A Profit matrix of a type-I node
B Profit matrix of a type-II node
CA Cost of an attack
CD Cost of a defense
CR Cost of transaction transmission
J Jacobian matrix of an evolutionary game
Kj The number of type-II nodes adopting strategy j
L Loss under an attack
M The total number of nodes
M' The total number of type-I nodes
M'' The total number of type-II nodes
Ni The number of type-I nodes adopting strategy i
Nk The number of nodes adopting strategy k
P Attack success ratio of a type-II node if a type-I
node adopts a defense strategy
Pk Expected profit of nodes adopting strategy k
P̄k Average profit of nodes adopting strategy k
R Reward of a game
RA Reward of an attack
RM
The  number  of  transaction  messages  success-
fully sent to a target node (transaction executor)
S1
Strategy space of type-I nodes and S1={coopera-
tion, non-cooperation, defense}
S2
Strategy space of type-II nodes and S2={cooper-
ation, attack, non-cooperation}
TC Completion time of transaction transmission
TD Transaction transmission delay
TM The total number of transaction messages
TS Start time of transaction transmission
Ui
The  expected  profit  of  type-I  nodes  adopting
strategy i
Uj
The  expected  profit  of  type-II  nodes  adopting
strategy j
W The maximizing profit  of  both sides in a game
through ESSs
X The set of strategy ratios of type-I nodes
Y The set of strategy ratios of type-II nodes
aij
Element  of  the  profit  matrix  at  row i and  col-
umn j of a type-I node
bij
Element  of  the  profit  matrix  at  row i and  col-
umn j of a type-II node
i The i-th strategy adopted by a type-I node
j The j-th strategy adopted by a type-II node
xi ∈ X Strategy ratio of type-I nodes adopting strategy
i
y j ∈ Y Strategy  ratio  of  type-II  nodes  adopting  strat-
egy j
zk The k-th strategy ratio
ρ Transaction success ratio
Ʋ Average profit of type-I nodes
Ѵ Average profit of type-II nodes
Γ The set of strategies adopted by nodes and Γ =
{cooperation, non-cooperation, attack, defense}
  
B.  A Game Model
To  construct  an  evolutionary  game  model  of  a  blockchain
channel  network,  we  need  to  consider  three  basic  elements:
Participants, strategy space, and profit matrix.
1) Participants
Participants  of  a  game  are  composed  of  type-I  and  type-II
nodes.  The  former’s  profits  come  from  transmitting  transac-
tions, while the latter’s profits come from launching attacks or
transmitting transactions.
2) Strategy Space
Let Γ denote the set of strategies adopted by nodes:
Γ = {cooperation, non-cooperation, attack, defense}
where  a  cooperation  strategy  denotes  that  nodes  agree  on
transmitting  transactions;  a  non-cooperation  one  denotes  that
nodes  may  refuse  to  transmit  transactions;  an  attack  one
denotes that nodes may perform malicious non-cooperation or
attack to obtain profits; and a defense one denotes that nodes
may defend against malicious non-cooperation or attacks.
Based on Γ, the strategy space of type-I and type-II nodes is
obtained according to their definitions, respectively:
 
S 1 = {cooperation,non-cooperation,defense} (1)
 
S 2 = {cooperation,attack,non-cooperation} . (2)
3) Profit Matrix
i) Parameter definition
According to the characteristics of a blockchain channel net-
work, related parameters are defined as follows:
R (Reward):  It  represents  profits  obtained  by  each  node  of
both  parties  in  a  game  by  successfully  transmitting  a  transa-
ction.
CD (Cost of a defense): It is the cost required (consumption
of funds) if a type-I node adopts a defense strategy.
RA (Reward  of  an  attack):  It  represents  profits  (acquisition
of  funds)  obtained  by  a  type-II  node  that  successfully  per-
forms an attack.
CA (Cost  of  an  attack):  It  refers  to  the  cost  required  by  a
type-II node that carries out an attack. It can represent the con-
sumed funds during an attack or relevant legal sanction if the
attack is identified by other nodes.
CR (Cost of transaction transmission): It represents the cost
required if a node transmits a transaction. It can represent the
consumption of funds.
L (Loss):  It  represents  the  loss  of  a  type-I  node  under  an
attack.
P (Probability): The probability for a type-II node to attack
ZHANG et al.: DYNAMIC EVOLUTIONARY GAME-BASED MODELING, ANALYSIS AND PERFORMANCE ENHANCEMENT 191 
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:00:11 UTC from IEEE Xplore.  Restrictions apply. 
successfully  a  type-I  node  that  adopts  a  defense  strategy,
called attack success ratio for short.
From [31], the profit of a node is required to be greater than
its cost. Hence, the following conditions must be met:
 
R > RA (3)
 
R >CD >CA (4)
 
R >CR >CA. (5)
ii) Profit analysis
Both  parties  of  a  game  can  be  classified  into  three  cate-
gories according to a strategy adopted by a type-II node. Note
that:  They  do  not  need  to  know  each  other’s  strategies  and
how to get the profits of both parties. As long as both parties
input their own strategies, the game model can determine the
final game result.
a)  If  a  type-II  node  adopts  a  cooperation  strategy,  a  type-I
node  may  adopt  three  strategies:  Cooperation,  non-cooper-
ation, or defense strategy. Hence, there are three combination
strategies between them: (Cooperation, Cooperation), (Non-
cooperation,  Cooperation),  and (Defense,  Cooperation).
The  profits  of  both  parties  are  shown  in Table I  if  a  type-II
node adopts a cooperation strategy.
 
TABLE I 
Profits of Both Parties if a Type-II Node Adopts a
Cooperation Strategy
Strategy of a type-I node Profit of a type-I node Profit of a type-II node
Cooperation R−CR R−CR
Non-cooperation 0 −CR
Defense R−CD R−CR
 
 
Based  on Table I ,  a  chart  depicting  the  actors  (type-I  and
type-II nodes) and interactions in the game model is shown in
Fig. 1. The detailed description is given as follows.
 
Defense
Cooperation
Cooperation Cooperation
Cooperation
Non-cooperation
(R−CR, R−CR) (R−CD , R−CR)(0, −CR)
Type-I
Type-II Type-II Type-II
 
Fig. 1.     The actors and interactions in a game model.
 
(Cooperation,  Cooperation):  Both  parties  agree  to  trans-
mit a transaction. Cost CR is required to transmit a transaction.
Hence, either party gains the final profit of R − CR.
(Non-cooperation, Cooperation): A type-II node transmits
a transaction to a type-I node, but the latter adopts a non-coop-
eration strategy. Because a type-I node does not cooperate,  it
has neither loss nor gain. Hence, its final profit is 0. The type-
II  node cannot  successfully  complete  the  transmission opera-
tion  because  the  type-I  node  does  not  cooperate  with  it  to
transmit  the  transaction.  Therefore,  there  remains  only  the
consumed fund CR when transmitting a transaction. Thus, the
final profit of a type-II node is −CR.
(Defense,  Cooperation):  A  type-I  node  transmits  transac-
tions by adopting a defense strategy and both parties agree to
cooperate.  Both  parties  obtain  profit R .  The  type-I  node  has
cost CD  due  to  its  use  of  a  defense  strategy.  Hence,  its  final
profit is R  − CD .  A type-II node consumes fund CR  for trans-
mitting a transaction. Hence, the final profit is R − CR.
b) If a type-II node adopts an attack strategy, the profits of
both parties are shown in Table II.
 
TABLE II 
Profits of Both Parties if a Type-II Node
Adopts an Attack Strategy
Strategy of a type-I node Profit of a type-I node Profit of a type-II node
Cooperation −L RA−CR
Non-cooperation −L −CA
Defense R−CD−P×L −CA
 
 
(Cooperation,  Attack):  A  type-I  node  adopting  a  cooper-
ation  strategy  cannot  successfully  complete  a  transaction-
transmitting operation due to the successful attack by a type-II
node.  Hence,  it  only has  loss L  under  attack.  Hence,  its  final
profit is −L. A type-II node obtains profit RA because of a suc-
cessful  attack.  On  the  other  hand,  transmitting  a  transaction
requires cost CR. Hence, its final profit is RA − CR.
(Non-cooperation, Attack): A type-I node adopting a non-
cooperation  strategy  cannot  successfully  complete  a  transac-
tion-transmitting  operation  due  to  the  successful  attack  by  a
type-II  node.  Hence,  it  only  has  loss L  under  attack.  Its  final
profit  is  −L.  The  attack  from  a  type-II  node  is  unsuccessful
due to the uncooperative type-I node. The attack requires cost
CA. Thus, its final profit is −CA.
(Defense,  Attack):  Due to  a  defense strategy adopted by a
type-I node, a type-II node has some attack success ratios. In
the case of a successful attack, a type-I node obtains profit R
of  successful  transmission.  However,  the  deployment  of  a
defense strategy requires defense cost CD and the node has the
loss L  after  the  type-II  node’s  successful  attack.  If  the  attack
success ratio is P ,  the cost of the type-I node is P  × L .  So its
final profit is R − CD – P × L. Because the type-I node adopts
a  defense  strategy,  the  attack  on  it  may  be  unsuccessful.  An
attack  requires  cost CA .  Hence,  the  final  profit  of  a  type-II
node is −CA.
According  to  the  rule  of  maximizing  profits  for  nodes,  we
require that R − CD – P × L ≥ 0, i.e.,
 
R ≥CD+P×L. (6)
c) If a type-II node adopts a non-cooperation strategy, prof-
its of both parties are shown in Table III.
(Cooperation,  Non-cooperation):  Profits  of  both  parties
are the opposite of the case of (Non-cooperation, Cooperation)
in Table I.
(Non-cooperation,  Non-cooperation):  Both  parties  do  not
agree on transmitting a transaction and their profits are 0.
(Defense,  Non-cooperation):  Although  a  type-I  node
adopts  a  defense  strategy,  due  to  the  non-cooperation  of  a
type-II  node,  it  does  not  have  any  profit  when  successfully
transmitting  a  transaction.  However,  it  requires  cost CD  to
 192 IEEE/CAA JOURNAL OF AUTOMATICA SINICA, VOL. 10, NO. 1, JANUARY 2023
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:00:11 UTC from IEEE Xplore.  Restrictions apply. 
deploy  a  defense  strategy.  Hence,  its  final  profit  is  −CD.
Because a type-II node does not cooperate, it has neither loss
nor gain. Hence, its final profit is 0.
Based on Tables II and III, the actors and interactions in the
game model are similar to those in Fig. 1.
d) Profit matrix
From Tables I–III ,  we  know  that  strategy  spaces  of  both
type-I  and  type-II  nodes  consist  of  three  strategies.  Hence,  a
profit matrix with a size of 3 × 3 is constructed for each party.
The profit  matrix  of  a  type-I  node is  denoted by A  =  [aij]3×3,
and that  of  a  type-II  node is  denoted by B  =  [bij]3×3,  where i
and j  denote  the i -th  and j -th  strategy,  respectively.  For A,
strategies  1–3  correspond  to  cooperation,  non-cooperation,
and  defense.  For B ,  they  correspond  to  cooperation,  attack,
and non-cooperation. aij represents the profits of a type-I node
adopting strategy i  and a  type-II  node adopting strategy j.  bij
represents the profit of a type-II node adopting strategy j and a
type-I node adopting strategy i.
 
A =
 R−CR −L −CR
0 −L 0
R−CD R−CD−P×L −CD
 (7)
 
B =
 R−CR RA−CR 0
−CR −CA 0
R−CR −CA 0
 . (8)
iii) Maximizing profits
The  premise  of  an  evolutionary  game  is  that  each  partici-
pant in a game exhibits bounded rationality at a decision-mak-
ing stage,  i.e.,  participants  make strategic  choices  in  order  to
maximize  their  own  profits.  The  selfishness  or  altruism  of
game participants  with bounded rationality can maximize the
profits  of  both  parties  in  a  game  [32].  Through  equilibrium
stability  analysis  in  Section  IV,  we  can  obtain  the  maximal
profit of both sides in a game through ESSs.  
C.  Dynamic Evolutionary Game Model
An ESS and replication dynamics are two core concepts of
evolutionary  game  theory.  An  ESS  corresponds  to  a  stable
state  of  an evolutionary game.  Replication dynamics indicate
a convergence process to reach a stable state. An ESS is only
a  local  stability  strategy,  which  cannot  constitute  sufficient
conditions for judging evolution stability in a random environ-
ment. In order to better describe a dynamic evolution process,
we  use  the  concept  of  evolutionary  equilibrium [33],  [34]  to
unify  the  ESS  concept  and  dynamic  process  in  evolutionary
game theory.  A replication dynamic equation can ensure that
an ESS is an evolutionary equilibrium. The general form of a
replication dynamic equation [35] is as follows: 
dzk
dt
=
(
PkPk
)
× zk (9)
P̄k
where zk is a k-th strategy ratio, Pk is the expected profit, and
 the  average  profit  of  nodes  adopting  strategy k.  zk  is
denoted by
 
zk = Nk/M (10)
where Nk is the number of nodes adopting strategy k and M is
the total number of nodes. 0 ≤ Nk  ≤ M .  If Nk  = 0, there is no
node adopting strategy k. If Nk = M, all nodes adopt strategy k.
Type-I  and  type-II  nodes  in  a  blockchain  channel  network
have their strategy ratios.
1) Strategy Ratios of Both Parties
Ratios  of  type-I  nodes  adopting  different  strategies: Let  Ni
be  the  number  of  type-I  nodes  adopting  the i -th  strategy. M'
denotes the total  number of type-I nodes. M'  = N1  + N2  + N3
and 0 ≤ Ni  ≤  M' .  Let xi  be  the ratio  of  type-I  nodes adopting
the i-th strategy,
 
xi = Ni/M′ (11)∑3
i=1 xi = 1where 0 ≤ xi ≤ 1 and . x1, x2, and x3 denote the ratios
of  type-I  nodes  adopting  cooperation,  non-cooperation,  and
defense  strategies,  respectively.  Let X  be  the  set  of  strategy
ratios of type-I nodes,
 
X = {xi|1 ≤ i ≤ 3} (12)
Ratios of type-II nodes adopting different strategies: Let Kj
be the number of type-II nodes adopting strategy j. M'' denotes
the  total  number  of  type-II  nodes.  Then, M''  = K1  +  K2  +  K3
and 0 ≤ Kj ≤ M''. Let yj be the ratio of type-II nodes adopting
j-th strategy,
 
y j = K j/M′′ (13)∑3
j=1 y j = 1where  0  ≤ yj  ≤  1  and . y1,  y2 ,  and y3  denote  the
ratios of type-II nodes adopting cooperation, attack, and non-
cooperation  strategies,  respectively.  Let Y  be  the  set  of  strat-
egy ratios of type-II nodes,
 
Y = {y j|1 ≤ j ≤ 3}. (14)
2) Replicating Dynamic Equations of an Evolutionary Game
Based on Different Strategy Ratios
According  to  the  replication  dynamics  theory  of  an  evolu-
tionary  game  and  strategy  ratios,  replication  dynamic  equa-
tions of type-I and type-II nodes can be obtained.
Let Ui be the expected profit of type-I nodes adopting strat-
egy i,
 
Ui =
∑
j∈S 2
ai jy j (15)
where aij  is  an  element  of  matrix A  and  yj  ϵ  Y .  Let Ʋ  be  the
average profit of type-I nodes,
 
Ʋ =
∑
i∈S 1
xiUi (16)
∈where xi  X. According to (9), the replication dynamic equa-
tion of type-I nodes adopting strategy i is
 
dxi
dt
= (Ui−Ʋ) xi (17)
 
TABLE III 
Profits of Both Parties if a Type-II Node Adopts a
Non-cooperation Strategy
Strategy of a type-I node Profit of a type-I node Profit of a type-II node
Cooperation −CR 0
Non-cooperation 0 0
Defense −CD 0
 
ZHANG et al.: DYNAMIC EVOLUTIONARY GAME-BASED MODELING, ANALYSIS AND PERFORMANCE ENHANCEMENT 193 
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:00:11 UTC from IEEE Xplore.  Restrictions apply. 
dxi
dtwhere  denotes  the  change  rate  of  the  node  strategy  ratio
with  time  if  strategy i  is  adopted  by  type-I  nodes.  Based  on
(15)–(17), we have
 
dxi
dt
=
∑
j∈S 2
ai jy j−
∑
k∈S 1
∑
j∈S 2
xkak jy j
 xi. (18)
Based on (7) and (18), replication dynamic equations of x1,
x2, and x3 are
 
dx1
dt
= (y1 (1− x1)− x3 (y1+ y2)) x1R
− (1− x1) (y1+ y3) x1CR+ x1x3CD
+ (x1+ x2−1) x1y2L+ x1x3y2P×L (19)
 
dx2
dt
= − (x1y1+ x3 (y1+ y2)) x2R+ (y1+ y3) x1x2CR
+ x2x3CD+ (x1+ x2−1) x2y2L+ x2x3y2P×L (20)
 
dx3
dt
= ((1− x3) (y1+ y2)− x1y1) x3R+ (y1+ y3) x1x3CR
− (1− x3) x3CD+ (x1+ x2) x3y2L
− (1− x3) x3y2P×L. (21)
Let Uj be the expected profit of type-II nodes adopting strat-
egy j,
 
U j =
∑
i∈S 1
bi jxi (22)
where bij  is  an  element  of  matrix B  and  xi  ϵ  X .  The  average
profit of a type-II node is
 
Ѵ =
∑
j∈S 2
y jU j (23)
where yj  ϵ Y . According to (9), the replication dynamic equa-
tion of a type-II node is
 
dy j
dt
= (U j− Ѵ)y j (24)
dy j
dtwhere  denotes  the  change  rate  of  the  node  strategy  ratio
with  time if  strategy j  is  adopted  by  type-II  nodes.  Based on
(22)–(24), we have
 
dy j
dt
=
∑
i∈S 1
bi jxi−
∑
k∈S 2
∑
i∈S 1
ykbik xi
y j. (25)
Based on (8) and (25), replication dynamic equations of y1,
y2, and y3 are
 
dy1
dt
= (x1+ x3) (1− y1)y1R− (1− y1− x1y2)y1CR
− x1y1y2RA+ (x2+ x3)y1y2CA (26)
 
dy2
dt
= − (x1+ x3)y1y2R− (x1− x1y2− y1)y2CR
+ x1y2 (1− y2)RA
− (x2y2 (1− y2)+ x3y2 (1− y2))CA (27)
 
dy3
dt
= − (x1+ x3)y1y3R+ (y1+ x1y2)y3CR
− x1y2y3RA+ (x2+ x3)y2y3CA. (28)
A  replication  dynamic  system  of  both  types  of  nodes  is
composed of (19)–(21) and (26)–(28) in a blockchain channel
network  according  to  evolutionary  game theory.  Because  the
above  replication  dynamics  are  non-linear  [36],  it  is  difficult
to  find  a  unique  solution.  Hence,  their  equilibrium  stability
analysis is needed [37].  
IV.  Equilibrium Stability Analysis
If a combination strategy [(x1, x2, x3), (y1, y2, y3)] of an evo-
lutionary game makes (19)–(21) and (26)–(28) all equal to 0,
it is an equilibrium point [38]. Based on the proposed dynamic
evolutionary game model, the possible equilibrium points can
thus be calculated. Nine such points of the proposed dynamic
evolutionary  game  model  are  found  as  shown  in Table IV.
Each equilibrium point corresponds to a combination strategy.
Different strategies adopted lead to different states of a game
in  a  blockchain  channel  network.  Other  combination  strate-
gies can be adopted before reaching an equilibrium point.
 
TABLE IV 
Equilibrium Points of the Proposed Model
Combination strategy between nodes
(The strategy adopted by type-I nodes and the
strategy adopted by type-II nodes)
Equilibrium point
(Cooperation, Cooperation) [(1, 0, 0), (1, 0, 0)]
(Cooperation, Attack) [(1, 0, 0), (0, 1, 0)]
(Cooperation, Non-cooperation) [(1, 0, 0), (0, 0, 1)]
(Non-cooperation, Cooperation) [(0, 1, 0), (1, 0, 0)]
(Non-cooperation, Attack) [(0, 1, 0), (0, 1, 0)]
(Non-cooperation, Non-cooperation) [(0, 1, 0), (0, 0, 1)]
(Defense, Cooperation) [(0, 0, 1), (1, 0, 0)]
(Defense, Attack) [(0, 0, 1), (0, 1, 0)]
(Defense, Non-cooperation) [(0, 0, 1), (0, 0, 1)]
 
 
We next  prove that  the  two equilibrium points  in Table IV
are  ESSs under  conditions  of CD  >  CR  and CD  <  CR ,  respec-
tively.  It  means  that  a  blockchain  channel  network  may
achieve a stable state of cooperation or defense.
Let J  be the Jacobian matrix of an evolutionary game [39].
From [40],  we  know that  the  necessary  and  sufficient  condi-
tions  for  the  equilibrium  point  [(1,  0,  0),  (1,  0,  0)]  to  be  an
ESS in a channel system are Trace J < 0 and Det J > 0. Trace
J is defined as the sum of the elements on the main diagonal
of  matrix J .  Det J  is  defined  as  the  determinant  of  matrix J.
Note that not all the equilibrium points in Table IV are ESSs.
Hence,  we need to find ESSs from the equilibrium points,  in
which only two ones are proved to be ESSs.
Theorem 1: The equilibrium point [(1, 0, 0), (1, 0, 0)] is the
only  ESS  of  the  replication  dynamic  system  of  a  blockchain
channel network if CD > CR.
Its proof is given in [39]. This result means that the combi-
nation  strategy (Cooperation, Cooperation )  is  an  ESS,  with
which the channel network achieves a stable state of coopera-
tion.
Theorem 2: The equilibrium point [(0, 0, 1), (1, 0, 0)] is the
only  ESS  of  the  replication  dynamic  system  of  a  blockchain
 194 IEEE/CAA JOURNAL OF AUTOMATICA SINICA, VOL. 10, NO. 1, JANUARY 2023
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:00:11 UTC from IEEE Xplore.  Restrictions apply. 
channel network if CD < CR.
Its  proof  is  given  in  [39].  Similarly,  (Defense, Coopera-
tion)  is  an  ESS,  with  which  the  channel  network  achieves  a
stable state of defense. From Theorems 1 and 2, we know that
if CD = CR, the proposed model does not have an equilibrium
point.
Nodes in a blockchain channel network should adopt strate-
gies according to the above two ESS results. When an evolu-
tionary  game  is  played  in  a  blockchain  channel  network,
bounded rationality allows type-I and type-II nodes in a game
to  make  decisions  in  a  distributed  manner.  Nodes  continu-
ously adjust their strategies based on their current profit situa-
tions, so as to reach an ESS. Based on the proposed dynamic
evolutionary game model, both type-I and type-II nodes adopt
a  cooperation  strategy  to  transmit  transactions  in  the  end  if
CD > CR; and type-I nodes adopt a defense strategy and type-II
nodes adopt a cooperative strategy to transmit transactions in
the end if CD < CR. It is proven that an ESS can be reached if
CD ≠ CR.
Based on (7) and (8), through the above equilibrium stabil-
ity analysis, we can obtain the maximal profit (denoted as W)
of both sides in a game through ESSs
 
W =
{
R−CR+R−CR
R−CD+R−CR
if CD >CR
if CD <CR.
(29)
  
V.  Experimental Results
  
A.  Experimental Setup
1) Experimental Environments and Parameter Setting
Firstly, we use MATLAB2018b [41] to simulate game pro-
cesses and obtain solutions to the proposed model in Sections
V-B and V-C. In addition, due to the randomness of the non-
cooperative  behavior  of  nodes  in  real  scenarios  in  a
blockchain,  we need to  further  verify  the  performance  of  the
proposed  method  in  real  scenarios,  especially  in  the  case  of
the  non-cooperative  behavior  of  nodes.  The  process  of  node
behaviors can be visualized and inspected by using simulator
ONE [42] to build a network [43], [44]. Two hundred type-II
nodes are randomly selected from 1000 nodes. The entire sim-
ulation time is 40 000 seconds. Secondly, the proposed model
is  achieved.  Experimental  environments  include  CPU  (Intel
Core i5, 4.2 GHz), Memory (16 GB), and Win. 10.
The  parameter  settings  are  given  in Table V .  Node  transa-
ction  transmission  profits  and  cost  are  different.  All  parame-
ters are standardized and their values fall in [0, 1].
i)  Profits  of  nodes  are  required  to  be  greater  than  cost.
Besides, an attacker launches attacks because the reward of an
attack (RA) is greater than the cost of transaction transmission
(CR)  in  a  blockchain  channel  network.  Thus, R  >  RA  >  CR  >
CA. Let R = 1 as the standard, RA = 0.8, CR = 0.4, and CA = 0.2.
ii) To test convergence under different defense cost, we set
different values for CD .  According to (3)–(5), if CD  > CR,  CD
is set as 0.42, 0.44, and 0.46, respectively; and if CD < CR, it is
set as 0.1, 0.2, and 0.3, respectively. In other cases, CD  is set
as 0.46 and 0.3, respectively.
iii)  Because  nodes  in  an  evolutionary  game  have  bounded
rationality, the loss after being attacked is as same as the prof-
its  obtained  by  both  parties  in  a  game  by  successfully  trans-
mitting a transaction. Therefore L = R = 1.
iv) To test convergence under different attack success ratios
of type-II nodes, P is set as 0.1, 0.2, and 0.4 according to (6),
respectively. In other cases, P = 0.5.
2) Description of Combination Strategies
Based on (11) and (13), a combination strategy [(x1, x2, x3),
(y1, y2,  y3 )]  for  an  evolutionary  game  is  adopted  by  nodes.
Seven initial  combination strategies under different situations
in the blockchain channel network are given in Table VI.
 
TABLE VI 
Initial Combination Strategy Parameters
Initial strategy Value
Ω1 [(x0
1, x
0
2, x
0
3), (y0
1,y
0
2,y
0
3)] = [(1/2, 1/2, 0), (1/3, 1/3, 1/3)]
Ω2 [(x0
1, x
0
2, x
0
3), (y0
1,y
0
2,y
0
3)] = [(1/3, 1/3, 1/3), (1/3, 1/3, 1/3)]
Ω3 [(x0
1, x
0
2, x
0
3), (y0
1,y
0
2,y
0
3)] = [(1/3, 1/3, 1/3), (1/2, 1/4, 1/4)]
Ω4 [(x0
1, x
0
2, x
0
3), (y0
1,y
0
2,y
0
3)] = [(1/2, 1/4, 1/4), (1/2, 1/4, 1/4)]
Ω5 [(x0
1, x
0
2, x
0
3), (y0
1,y
0
2,y
0
3)] = [(1/2, 1/4, 1/4), (1/3, 1/3, 1/3)]
Ω6 [(x0
1, x
0
2, x
0
3), (y0
1,y
0
2,y
0
3)] = [(1/4, 1/4, 1/2), (1/2, 1/4, 1/4)]
Ω7 [(x0
1, x
0
2, x
0
3), (y0
1,y
0
2,y
0
3)] = [(1/4, 1/4, 1/2), (1/3, 1/3, 1/3)]
 
 
x0
1 x0
2 x0
3
y0
1
y0
2 y0
3
In Table VI ,  taking  Ω1 as  an  example:  ( , , )  =  (1/2,
1/2,  0).  It  means  that  1/2,  1/2,  and 0  of  type-I  nodes  adopt  a
cooperation  strategy,  a  non-cooperation  strategy,  and  a
defense strategy in the initial state of a game, respectively. ( ,
, )  =  (1/3,  1/3,  1/3)  means  that  nodes  adopt  three  strate-
gies equally.
3) Indicators
Equilibrium  stability: The  equilibrium  stability  between
type-I and type-II nodes depends on the comparison of profits
of  strategies  adopted  in  an  evolutionary  game  [45].  If  they
reach an ESS, the equilibrium stability is reached. We obtain
average values for ten trials.
Convergence: It  means  the  time  that  a  blockchain  channel
network  reaches  an  ESS.  It  is  expressed  as  Time  (s).  The
shorter the time is consumed, the faster the convergence speed
is [46].
Transaction success ratio (ρ): It denotes the ratio of transac-
tion  messages  that  are  successfully  sent  to  target  nodes  (i.e.,
 
TABLE V 
Experimental Parameters
Parameter Description Value
R Reward of a game by successfully
transmitting a transaction 1
CD
Cost of a defense if CD > CR
0.42, 0.44, and
0.46
Cost of a defense if CD < CR 0.1, 0.2, and 0.3
RA Reward of an attack 0.8
CA Cost of an attack 0.2
CR Cost of transaction transmission 0.4
L Loss under an attack 1
P Attack success ratio 0.1, 0.2, 0.4, and
0.5
 
ZHANG et al.: DYNAMIC EVOLUTIONARY GAME-BASED MODELING, ANALYSIS AND PERFORMANCE ENHANCEMENT 195 
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:00:11 UTC from IEEE Xplore.  Restrictions apply. 
transaction executor) among all messages, i.e.,
 
ρ = RM/TM (30)
where RM  is the number of transaction messages successfully
sent to a target node, and TM is the total number of transaction
messages.
Transaction transmission delay (TD)
 
TD = TC −TS (31)
where TC is the time that the transaction is transmitted and TS
is the time that transaction transmission starts.
According to Theorem 1, if CD  > CR ,  the equilibrium point
[(1, 0, 0), (1, 0, 0)] is an ESS of the replication dynamic sys-
tem of a blockchain channel network. According to Theorem
2, if CD < CR, the equilibrium point [(0, 0, 1), (1, 0, 0)] is an
ESS  of  the  replication  dynamic  system.  Based  on  the  two
kinds of ESSs under different conditions, we analyze the sta-
bility  and  convergence  of  a  blockchain  channel  network  as
follows.  
B.  Channel Stability and Convergence if CD > CR
1) Equilibrium Stability of Evolution if Type-I Nodes Adopt
a Defense Strategy
x0
3
x0
1
i) Let CD = 0.46 and CR = 0.4. All nodes use Ω1 for an evo-
lutionary game. In the initial  state of a game, we analyze the
effect  of  whether  nodes  adopt  a  defense  strategy  on  equilib-
rium  stability  or  not.  The  equilibrium  stability  is  shown  in
Fig. 2.  According  to  Ω1,  no  node  adopts  a  defense  strategy,
i.e.,  = 0. If no type-I node in the channel network adopts a
defense  strategy,  type-II  nodes  choose  an  attack  strategy  in
order  to  maximize  their  own  profits.  After  several  iterations,
the strategy ratio ( )  of  type-I  nodes adopting a cooperation
strategy  increases,  while  type-II  nodes  choose  a  cooperation
strategy to reduce their own loss by evolutionary learning. The
channel network eventually converges to a stable state where
both parties cooperate, i.e., they adopt a combination strategy
(Cooperation, Cooperation).
 
1.2
1.0
0.8
0.6
0.4
0.2
0
−0.2
0 20 3010 40 50
Time (s)
60 70 80 90 100
N
od
e 
ra
tio
x1
x2
x3
y1
y2
y3
 
Fig. 2.     Equilibrium stability when CD > CR and all nodes adopt Ω1.
 
x0
3
ii)  Let CD  =  0.46  and CR  =  0.4.  All  nodes  take  Ω2 for  an
evolutionary game. According to Ω2, they adopt ratio  = 1/3.
The  equilibrium  stability  is  shown  in Fig. 3 .  If  some  type-I
nodes in the channel network adopt a defense strategy, type-II
nodes will observe. After a period of evolutionary learning, in
order  to  maximize  their  own  profits,  type-II  nodes  choose  a
cooperation strategy. Type-I nodes observe that type-II nodes
have adopted the cooperation strategy after a period of evolu-
tionary learning. In order to maximize their own profits, type-I
nodes  abandon  the  defense  strategy  and  choose  the  coopera-
tion strategy.  The channel  network eventually converges to a
stable  state  where  both  parties  choose  to  cooperate,  i.e.,
(Cooperation, Cooperation )  is  adopted.  From Figs. 2  and  3
we  can  see  that  if CD  >  CR ,  whether  type-I  nodes  take  a
defense strategy or not, it does not affect the equilibrium sta-
bility  of  the  channel  network.  From  the  equilibrium  stability
analysis,  the time to reach the game equilibrium as shown in
Fig. 2.
 
x1
x2
x3
y1
y2
y3
1.2
1.0
0.8
0.6
0.4
0.2
0
−0.2
0 40 6020 80 100
Time (s)
120 140 160 180 200
N
od
e 
ra
tio
 
Fig. 3.     Equilibrium stability when CD > CR and all nodes adopt Ω2.
 
2) Convergence Under Different Strategies
x0
1
x0
1
y0
1
Both type-I and type-II nodes deploy cooperation strategies.
By Theorem 1, we know that the combination strategy of (Coo-
peration, Cooperation )  is  an  ESS.  On this  basis,  Ω3–Ω5 are
used  to  carry  out  an  evolutionary  game  to  reach  the  equilib-
rium point in Theorem 1. The convergence under different ini-
tial  strategies is  shown in Figs. 4–6.  Let CD  = 0.46 and CR  =
0.4. In Fig. 4, all nodes use Ω3 for an evolutionary game. The
convergence is shown given different initial cooperation strat-
egy ratios ( ). Initially, 1/3 of the nodes adopt a cooperation
strategy in Ω3. In Fig. 5, all nodes use Ω4 for an evolutionary
game. Initially,  1/2 of the nodes adopt a cooperation strategy
in Ω4. Comparing Fig. 4 with Fig. 5, we can see that since the
ratio  ( )  in Fig. 5  is  greater  than  that  in Fig. 4 ,  the  channel
network  reaches  the  ESS in Fig. 5  faster.  In Fig. 6 ,  all  nodes
use  Ω5 for  an  evolutionary  game.  Initially,  1/3  of  the  nodes
adopt  a  cooperation  strategy  in  Ω5.  Comparing Fig. 5  with
Fig. 6, we conclude that since the ratio ( ) in Fig. 5 is greater
than that in Fig. 6, the faster the channel network reaches the
ESS.
3) Convergence Under Different Cost
In  order  to  test  convergence  under  a  different  cost  of
deploying a defense strategy by type-I nodes, we change cost
CD. Let CR = 0.4. If CD > CR, the ESS is (Cooperation, Coop-
eration).  Both  type-I  and  type-II  nodes  adopt  a  cooperation
strategy.  For  1/3  of  the  type-I  nodes, CD  is  0.42,  0.44,  and
0.46,  respectively.  The  convergence  under  different  costs  is
shown  in Fig. 7 .  As  defense  cost CD  increases,  the  speed
increases at which type-I nodes reach a stable state of cooper-
 196 IEEE/CAA JOURNAL OF AUTOMATICA SINICA, VOL. 10, NO. 1, JANUARY 2023
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:00:11 UTC from IEEE Xplore.  Restrictions apply. 
ation.  The  speed  remains  unchanged  at  which  type-II  nodes
reach  a  stable  state  of  cooperation.  The  higher  the  cost  of
deploying  a  defense  strategy  by  type-I  nodes,  the  faster  the
channel network reaches (Cooperation, Cooperation), which
results in faster convergence.
4) Convergence Under Different Attack Success Ratios
To  study  the  convergence  under  different  attack  success
ratios of type-II nodes, we change P values when type-I nodes
adopt a cooperation strategy. Let CD = 0.46 and CR = 0.4. CD >
CR. For 1/3 type-II nodes, P is 0.1, 0.2, and 0.4, respectively.
The convergence concerning P  is shown in Fig. 8. The speed
at  which  type-I  nodes  reach  a  stable  state  of  cooperation
increases  with P .  It  remains  unchanged  when  type-II  nodes
reach a stable state of cooperation. If CD > CR, the higher the
attack  success  ratio,  the  faster  the  channel  network  reaches
(Cooperation, Cooperation).
 
1.0
0.8
0.6
0.4
0.2
0 40 6020
Time (s)
80 100 120 140
P = 0.1 x1
P = 0.1 y1
P = 0.2 x1
P = 0.2 y1
P = 0.4 x1
P = 0.4 y1
160 180 200
N
od
e 
ra
tio
 
Fig. 8.     Convergence under different attack success ratios.  
C.  Channel Stability and Convergence if CD < CR
1) Equilibrium Stability of Evolution If Type-I Nodes Adopt
a Defense Strategy
x0
3
i) Let CD = 0.3 and CR = 0.4. All nodes use Ω1 for an evolu-
tionary  game.  According  to  Ω1,  no  node  adopts  a  defense
strategy, i.e.,  = 0. The equilibrium stability is shown in Fig. 9
if  no  type-I  node  adopts  a  defense  strategy.  Type-II  nodes
choose an attack strategy in order to maximize their own prof-
its.  After  several  games,  type-II  nodes  discover  that  type-I
nodes have adopted a cooperation strategy. They also choose a
cooperation strategy to reduce their own loss by evolutionary
learning.  The channel  network eventually converges to a  sta-
ble state where both parties converge to (Cooperation, Coop-
eration).
x0
3
ii)  Let CD  =  0.3  and CR  =  0.4.  All  nodes  use  Ω2 with  a
defense  strategy  for  an  evolutionary  game.  According  to  Ω2,
 = 1/3. The equilibrium stability is shown in Fig. 10. 1/3 of
the type-I nodes adopt a defense strategy, as observed by type-
II nodes. After a period of evolutionary learning, type-II nodes
choose  a  cooperation  strategy  to  maximize  their  own profits.
The  channel  network  eventually  converges  to  a  stable  state
where  type-I  nodes  choose  a  defense  strategy  and  type-II
nodes  choose  a  cooperation  strategy,  i.e.,  converging  to
(Defense, Cooperation ).  If CD  <  CR ,  whether  type-I  nodes
take a defense strategy or not, it does not affect the final equi-
 
1.2
1.0
0.8
0.6
0.4
0.2
0
−0.2
0 40 6020 80 100
Time (s)
120 140 160 180 200
N
od
e 
ra
tio
x1
x2
x3
y1
y2
y3
 
Fig. 4.     Convergence when all nodes adopt Ω3.
 
 
1.2
1.0
0.8
0.6
0.4
0.2
0
−0.2
0 40 6020 80 100
Time (s)
120 140 160 180 200
N
od
e 
ra
tio
x1
x2
x3
y1
y2
y3
 
Fig. 5.     Convergence when all nodes adopt Ω4.
 
 
1.2
1.0
0.8
0.6
0.4
0.2
0
−0.2
0 40 6020 80 100
Time (s)
120 140 160 180 200
N
od
e 
ra
tio
x1
x2
x3
y1
y2
y3
 
Fig. 6.     Convergence when all nodes adopt Ω5.
 
 
1.0
0.8
0.6
0.4
0.2
0 100 15050
Time (s)
200 250 300 350
CD = 0.42 x1
CD = 0.42 y1
CD = 0.44 x1
CD = 0.44 y1
CD = 0.46 x1
CD = 0.46 y1
400
N
od
e 
ra
tio
 
Fig. 7.     Convergence under different cost.
 
ZHANG et al.: DYNAMIC EVOLUTIONARY GAME-BASED MODELING, ANALYSIS AND PERFORMANCE ENHANCEMENT 197 
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:00:11 UTC from IEEE Xplore.  Restrictions apply. 
librium stability of the channel network.
2) Convergence Under Different Strategies
Both type-I and type-II nodes adopt a cooperation strategy.
By  Theorem  2,  we  know  that  the  combination  strategy  of
(Defense, Cooperation )  is  an  ESS.  On  this  basis,  Ω3,  Ω6,
and Ω7 are used to carry out an evolutionary game to reach the
ESS.  The  convergence  under  different  initial  strategies  is
shown in Figs. 11–13. Let CD = 0.3 and CR = 0.4.
x0
3
x0
3
x0
3
In Fig. 11, all nodes use Ω3 for an evolutionary game where
 = 1/3. In Fig. 12, all nodes use Ω6 for an evolutionary game
where  =  1/2.  From Figs. 11  and  12 ,  we  can  see  that  the
greater  the  initial  ratio  ( ),  the  faster  the  channel  network
reaches the ESS, i.e., the faster the convergence.
y0
1
y0
1
y0
1
In Fig. 12, the ratio ( ) of the cooperation strategy adopted
by type-II nodes in Ω6 is 1/2. In Fig. 13, all nodes use Ω7 for
an evolutionary game.  = 1/3. From Figs. 12 and 13, we can
see that the greater the initial ratio ( ), the faster the channel
network reaches the ESS.
3) Convergence Under Different Cost
To  test  convergence  under  a  different  cost  of  deploying  a
defense strategy by type-I nodes, we change cost CD. Let CR =
0.4. If CD < CR, (Defense, Cooperation) can be achieved. The
evolution  process  of  type-I  nodes  adopts  a  defense  strategy
and type-II ones adopt a cooperation one. Ω2 is used and CD <
CR. For 1/3 of the type-I nodes, CD is 0.1, 0.2, and 0.3, respec-
tively. The convergence is shown in Fig. 14. As CD increases,
the speed decreases at which type-I nodes reach a stable state
of  defense  slightly,  and  the  speed  decreases  at  which  type-II
nodes  reach a  stable  state  of  cooperation.  The lower  the  cost
of  deploying  a  defense  strategy,  the  faster  the  channel  net-
work reaches (Defense, Cooperation).
4) Convergence Under Different Attack Success Ratios
In order to study the convergence under different attack suc-
cess ratios of type-II nodes, we change P if type-I nodes adopt
a cooperation strategy. Let CD = 0.3 and CR = 0.4. Ω2 is used.
CD < CR .  For 1/3 of the type-II  nodes, P  is  0.1,  0.2,  and 0.4,
respectively.  The  convergence  under  different P  is  shown  in
 
1.2
1.0
0.8
0.6
0.4
0.2
0
−0.2
0 20 3010 40 50
Time (s)
60 70 80 90 100
N
od
e 
ra
tio
x1
x2
x3
y1
y2
y3
 
Fig. 9.     Equilibrium stability if CD < CR and all nodes adopt Ω1.
 
 
1.2
1.0
0.8
0.6
0.4
0.2
0
−0.2
0 20 3010 40 50
Time (s)
60 70 80 90 100
N
od
e 
ra
tio
x1
x2
x3
y1
y2
y3
 
Fig. 10.     Equilibrium stability if CD < CR and all nodes adopt Ω2.
 
 
1.2
1.0
0.8
0.6
0.4
0.2
0
−0.2
0 20 3010 40 50
Time (s)
60 70 80 90 100
N
od
e 
ra
tio
x1
x2
x3
y1
y2
y3
 
Fig. 11.     Convergence when all nodes adopt Ω3.
 
 
1.2
1.0
0.8
0.6
0.4
0.2
0
−0.2
0 20 3010 40 50
Time (s)
60 70 80 90 100
N
od
e 
ra
tio
x1
x2
x3
y1
y2
y3
 
Fig. 12.     Convergence when all nodes adopt Ω6.
 
 
1.2
1.0
0.8
0.6
0.4
0.2
0
−0.2
0 20 3010 40 50
Time (s)
60 70 80 90 100
N
od
e 
ra
tio
x1
x2
x3
y1
y2
y3
 
Fig. 13.     Convergence when all nodes adopt Ω7.
 
 198 IEEE/CAA JOURNAL OF AUTOMATICA SINICA, VOL. 10, NO. 1, JANUARY 2023
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:00:11 UTC from IEEE Xplore.  Restrictions apply. 
Fig. 15. As P increases, the speed at which type-I nodes reach
a  stable  state  of  cooperation  decreases;  while  that  at  which
type-II  nodes  reach  a  stable  state  of  cooperation  remains
unchanged. If CD < CR, the lower the attack success ratios, the
faster the channel network reaches the ESS.
 
1.0
1.2
0.8
0.4
0.6
0
0.2
0 10 155
Time (s)
20 25 30 35
P = 0.1 x1
P = 0.1 y1
P = 0.2 x1
P = 0.2 y1
P = 0.3 x1
P = 0.3 y1
40 45 50 55 60
N
od
e 
ra
tio
 
Fig. 15.     Convergence under different attack success ratios.
   
D.  Transaction Success Ratio and Delay
1) Comparative Methods
The  proposed  model  can  be  applied  to  a  general  channel
network.  It  is  compared  with  two  state-of-the-art  blockchain
channels:  Lightning  network  (payment  channels)  [10]  and
Sprites channels (state channels) [12].
Lightning network: It  is  the earliest  popular payment chan-
nel network. It mainly includes RSMC and HTLC contracts to
implement  two-way  payment  channels  and  realize  that  the
transfer of balances between any two nodes in the channel net-
work can be completed through these two-way payment chan-
nels.
Sprites  channels: Sprites  are  a  kind  of  state  channels.  It
solves  the  problem  of  excessive  time  overhead  when  cross-
channel payment is unsuccessful in Lightning network. It also
supports partial withdrawals and deposits without interruption.
2) Transaction Success Ratio
Ω2 is  used and P  = 0.5.  Transaction success ratio is shown
in Fig. 16. In the Lightning network and Sprites channels, due
to the existence of type-II nodes and the lack of security mea-
sures,  the  non-cooperation  behavior  causes  their  transaction
success  ratio  to  decrease.  For  the  proposed  model  with  a
defense  strategy,  type-I  nodes  can  resist  different  attack
behaviors with a certain ratio to make the network reach a sta-
ble cooperative state. Therefore, their transaction success ratio
increases. Although Sprites channel shows an increasing suc-
cess ratio, it is much slower than our method.
 
Proposed
Lightning network
Sprites channels
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0
0 1.0 1.50.5 2.0 2.5
Time (s) ×104
3.0 3.5 4.0
ρ
 
Fig. 16.     Transaction success ratio.
 
3) Transaction Transmission Delay
Ω2 is used and the probability for a type-II node to attack a
type-I node successfully that adopts a defense strategy is 0.5,
i.e., P  =  0.5.  The  transaction  transmission  delay  is  shown  as
Y-axis in Fig. 17. The X-axis shows the system running time.
In the Lightning network and Sprites channels, the uncoopera-
tive  type-II  nodes  lead  to  a  longer  transaction  transmission
delay. However, our designed model, i.e., the proposed one in
Figs. 16 and 17, can reach a stable cooperative state through a
defense strategy and an evolutionary game process. Hence, it
can mitigate the impact on the transaction transmission delay
as caused by uncooperative nodes.
 
Proposed
Lightning network
Sprites channels
1700
1600
1500
1400
1300
1200
1100
1000
0 1.0 1.50.5 2.0 2.5
Time (s) ×104
3.0 3.5 4.0
T D
(s
)
 
Fig. 17.     Transaction transmission delay.
 
Based  on  the  experimental  results  and  their  analysis,  we
conclude that:
i) Equilibrium stability analysis: Whether type-I nodes take
a defense strategy or not affects the equilibrium stability of a
blockchain  channel  network.  In  other  words,  it  does  not  dis-
rupt the equilibrium stability of the channel network.
x0
1 y0
1
ii)  Convergence  vs.  different  strategies:  If CD  >  CR ,  the
greater the initial strategy ratio ( ) or ( ), the faster the con-
 
1.0
1.2
0.8
0.4
0.6
0
0.2
−0.2
0 10 155
Time (s)
20 25 30 35
CD = 0.1 x1
CD = 0.1 y1
CD = 0.2 x1
CD = 0.2 y1
CD = 0.3 x1
CD = 0.3 y1
40 45 50 55 60
N
od
e 
ra
tio
 
Fig. 14.     Convergence under different cost.
 
ZHANG et al.: DYNAMIC EVOLUTIONARY GAME-BASED MODELING, ANALYSIS AND PERFORMANCE ENHANCEMENT 199 
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:00:11 UTC from IEEE Xplore.  Restrictions apply. 
x0
3 y0
1vergence.  If CD  <CR ,  the  greater  the  initial  ratio  ( )  or  ( ),
the faster the convergence.
iii)  Convergence  vs.  different  cost:  The  higher  the  cost  of
adopting a defense strategy, the faster the convergence if CD >
CR.  The  lower  cost  of  adopting  a  defense  strategy,  the  faster
the convergence if CD < CR.
iv)  Convergence  vs.  different  attack  success  ratios:  The
higher attack success ratio, the faster the convergence if CD >
CR. The lower attack success ratio, the faster the convergence
if CD < CR.
v)  The  proposed  method  achieves  a  better  transaction  suc-
cess  ratio  and  lower  transaction  transmission  delay  than  the
existing  popular  method.  Because  the  compared  methods  do
not adopt game strategies,  they do not have convergence and
stability issues.  
E.  Implementation of Proposed Model
The  proposed  model  can  be  deployed  to  a  blockchain  by
compiling it into a smart contract that can be applied to a gen-
eral  channel  network.  A  smart  contract  is  deployed  on  the
Ethereum blockchain  to  maintain  its  state  and respond to  the
received external  information.  The common process  of  chan-
nel transaction transmission can be divided into three phases:
1) Initialization: Both parties establish a channel; 2) Payment:
After  both  parties  transmit  a  transaction,  they  update  their
channel states; and 3) Closing: Both parties close the channel
and  net  balance  is  recorded  their  respective  edge  in  the
blockchain. A scenario of using the proposed model is shown
in Fig. 18.
 
Supplier Client
Access
control
chaincode
Policy
management
chaincode
Blockchain channels
Off-chain
transaction
a
b
d
c
e
f
Users
A system
using a
blockchain
Block k Block 2 Block 1...
transaction
On-chain
A blockchain
 
Fig. 18.     A scenario of using the proposed model.
 
In Fig. 18 ,  a  supplier,  i.e.,  node a ,  intends  to  transmit  a
transaction  to  a  user,  i.e.,  node f .  This  can  be  done  with  the
help of  other  nodes,  e.g., d  and e .  The channels  from a  to  d,
from d  to e ,  and from e  to f  have sufficient funds to transmit
transactions.  Node a  can  also  transmit  transactions  to f
through b, c, and e or through b, d, and e. These nodes may be
type-II  nodes  (with  attack  behaviors),  which  adversely  affect
the  results  of  transaction  transmission  in  channels.  Channels
are implemented by using smart  contracts,  which allow us to
transfer  funds  according  to  certain  rules.  Smart  contracts  are
programmable  currency  and  are  described  in  form  of  self-
enforcing  programs  that  are  published  on  the  ledger.  A  con-
tract  executes  its  code  and  is  running  on  a  blockchain,  or
inside of a channel. Thus, the proposed model is compiled into
a  smart  contract  and  deployed  to  a  blockchain  with  a
blockchain  channel  network.  Its  specific  deployment  process
has the following steps:
i)  Two nodes initiate  a  transaction T  in  a  blockchain chan-
nel network and broadcast it to the network. Each node in the
network  sets  its  strategy  and  its  initial  strategy  ratios,  which
are served as an input of the proposed model.
ii) Nodes adjust their strategies according to ESS, i.e., each
node  determines  its  strategy  for  transaction T  in  the  channel
network.  
VI.  Conclusions and Future Work
Stability  is  an  important  indicator  of  a  blockchain  channel
network. A stable one can help improve the quality of transac-
tion  transmission  via  channels.  But  internal  attacks  and  non-
operation  from  nodes  bring  about  instability,  which  is  an
important issue to address.  In order to reduce the attacks and
increase  cooperation  among  nodes,  based  on  the  characteri-
stics  of  node  behaviors  in  a  blockchain  channel  network,  we
propose  a  model  for  a  general  channel  network  based  on  a
dynamic  evolutionary  game.  Profit  matrices  of  nodes  are
designed. The analysis of the equilibrium stability of an evolu-
tionary  game  is  presented.  The  theoretical  proof  shows  that
the proposed model has stable states. The stability analysis is
presented  under  different  behaviors  with  attacks  and  non-
cooperation.  We  carry  out  experiments  to  validate  equilib-
rium  stability  and  reveal  convergence  results  given  different
strategies and attack success ratios. Experimental results show
that  a  blockchain  channel  network  can  converge  and  reach
desired  equilibrium  stability  under  internal  attacks  and  non-
cooperation  behaviors.  The  proposed  model  can  be  used  to
offer  a  better  transaction  success  ratio  and  lower  transaction
transmission delay than the popular method.
One of the challenges of using a blockchain is its high com-
putation  cost  for  block  generation  and  verification.  To  deal
with this  issue,  we have proposed an optimized consensus to
decrease  the  time  cost  of  block  generation,  which  also  pro-
vides  high  throughput  and  low  consumption  for  blockchain
verification [47]. As future research work, we plan to design a
punishment mechanism for non-cooperation and attack behav-
iors  of  nodes  and  study  its  impact  on  the  performance  of  a
blockchain  channel  network.  For  example,  a  lightning  net-
work has a punishment mechanism. It stipulates that if a node
has  uncooperative  behavior,  either  node  can  immediately
close the channel between them and broadcast the states of the
current  channel  network  to  the  blockchain.  However,  the
mechanism  reduces  the  channel  utility  in  a  blockchain  net-
work.  Hence,  we  plan  to  take  channel  utility  into  account
when  designing  a  punishment  mechanism.  In  addition,  if  a
node randomly chooses a channel to transmit a transaction, the
transmission  may  be  aborted  due  to  the  chosen  channels’
insufficient  funds.  Based  on  the  proposed  model,  we  plan  to
 200 IEEE/CAA JOURNAL OF AUTOMATICA SINICA, VOL. 10, NO. 1, JANUARY 2023
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:00:11 UTC from IEEE Xplore.  Restrictions apply. 
optimize  transaction  transmission  to  further  increase  transac-
tion  success  ratio  and  reduce  transaction  transmission  delay,
thus making model work with various applications [48]–[59].  
Acknowledgment
We  thank  Weifeng  Guo,  the  School  of  Computer  Science,
Nanjing  University  of  Information  Science  &  Technology,
Nanjing 210044, China, for his help in the paper’s revision.
References
 D.  E.  Kouicem,  Y.  Imine,  A.  Bouabdallah  and  H.  Lakhlef,
“Decentralized  blockchain-based  trust  management  protocol  for  the
Internet  of  Things,” IEEE  Trans.  Dependable  and  Secure  Computing,
vol. 19, no. 2, pp. 1292–1306, Mar.–Apr. 2022.
[1]
 S.  Nakamoto, “ Bitcoin:  A  peer-to-peer  electronic  cash  system,”
https://bitcoin.org/bitcoin.pdf, 2008.
[2]
 G.  Malavolta,  P.  Moreno-Sanchez,  A.  Kate,  M.  Maffei,  and  S.  Ravi,
“Concurrency  and  privacy  with  payment-channel  networks,” in  Proc.
ACM  SIGSAC  Conf.  Computer  and  Communications  Security,  Sept.
2017, pp. 455–471.
[3]
 M.  Moser,  I.  Eyal,  and  E.  G.  Sirer, “ Bitcoin  covenants,” in  Proc.  Int.
Conf.  Financial  Cryptography  and  Data  Security,  Springer,  Berlin,
Heidelberg, Feb. 2016, pp. 1746–1761.
[4]
 T.  Nguyen  and  M.  Thai, “A blockchain-based  iterative  double  auction
protocol  using  multiparty  state  channels,” ACM  Trans.  on  Internet
Technology, vol. 21, no. 2, pp. 1–22, Mar. 2021.
[5]
 P. Zhang, C. Li,  and M. Zhou, “Game-theoretic modeling and stability
analysis  of  blockchain  channels,” in  Proc.  IEEE  Int.  Conf.  Systems,
Man, and Cybernetics, Toronto, 2020, pp. 836–840.
[6]
 Z.  Li,  J.  Kang,  R.  Yu,  D.  Ye,  Q.  Deng,  and  Y.  Zhang, “Consortium
blockchain  for  secure  energy  trading  in  industrial  internet  of  things,”
IEEE Trans. Ind. Inform., vol. 14, no. 8, pp. 3690–3700, 2018.
[7]
 J. Coleman, L. Horne, and L. Xuanji, “Counterfactual: Generalized state
channels,” [Online] Available: https://counterfactual.com/statechannels,
2018.
[8]
 H.  Cui,  Z.  Wan,  X.  Wei,  S.  Nepal,  and  X.  Yi, “ Pay  as  you  decrypt:
Decryption  oursoucing  for  functional  encryption  using  blockchain,”
IEEE Trans. Inform. Foren. and Sec.,  pp. 3227–3238,  2020. DOI:  10.
1109/TIFS.2020.2973864
[9]
 J. Poon and T. Dryja, “The bitcoin lightning network: Scalable off-chain
instant  payments,” [Online]  Available: https://lightning.network/light
ning-network-paper.pdf, 2016.
[10]
 D.  Zhang,  J.  Le,  N.  Mu,  and  X.  Liao, “An  anonymous  off-blockchain
micropayments  scheme  for  cryptocurrencies  in  the  real  world,” IEEE
Trans.  Systems, Man,  and  Cybernetics:  Systems,  vol. 50,  no. 1,
pp. 32–42, Jan. 2020.
[11]
 A. Miller, et al., “Sprites and state channels: Payment networks that go
faster  than  lightning,” in  Proc.  Int.  Conf.  Financial  Cryptography  and
Data Security, Sept. 2019, pp. 508–526.
[12]
 R.  Khalil  and  A.  Gervais, “ Revive:  Rebalancing  off-blockchain
payment  networks,” in  Proc.  ACM  SIGSAC  Conf.  Computer  and
Communications Security, Oct. 2017, pp. 439–453.
[13]
 C. Lin, D. He, X. Huang, M. Khan, and K. Choo, “DCAP: A secure and
efficient decentralized conditional anonymous payment system based on
blockchain,” IEEE Trans. Inform. Foren. and Sec ,  vol. 15,  pp. 2440–
2452, Feb. 2020.
[14]
 P. Prihodko, S. Zhigulin, M. Sahno, A. Ostrovskiy, and O. Osuntokun,
“Flare:  An  approach  to  routing  in  lightning  network,” [Online]
Available:  whitepaper_flare_an_approach_to_routing_in_lightning_net
work_7_7_2016, 2016.
[15]
 K. Chen and H. Shen, “DTN-FLOW: Inter-landmark data flow for high-
throughput  routing  in  DTNs,” IEEE/ACM Trans. on Networking,
vol. 23, no. 1, pp. 212–226, Feb. 2015.
[16]
 S.  Thakur  and  J.  G.  Breslin, “Coordinated  landmark-based  routing  for
blockchain  offline  channels,” in  Proc.  2nd  Int.  Conf.  Blockchain
[17]
Computing and Applications, Nov. 2020, pp. 108–114.
 M. Arcak and N. Martins, “Dissipativity tools for convergence to Nash
equilibria  in  population  games,” IEEE Trans. on Control of Network
Systems, vol. 8, no. 1, pp. 39–50, Mar. 2021.
[18]
 S.  Dziembowski,  S.  Faust,  and  K.  Hostáková, “ General  state  channel
networks,” in  Proc.  ACM  SIGSAC  Conf.  Computer  and  Communic-
ations Security, Jan. 2018, pp. 949–966.
[19]
 S.  Wu,  Y.  Chen,  Q.  Wang,  M.  Li,  C.  Wang,  and  X.  Luo, “CReam:  A
smart  contract  enabled  collusion-resistant  e-auction,” IEEE  Trans.
Inform. Foren. and Sec., vol. 14, no. 7, pp. 1687–1701, Mar. 2018.
[20]
 J.  Spilman. “ Anti  DoS  for  tx  replacement,” [Online]  Available:
https://lists.Linuxfoundation.org/pipermail/bitcoin-dev/2013-
April/002433.html. 2013.
[21]
 X. Li, Y. Wang, P. Vijayakumar, D. He, and J. Ma, “Blockchain-based
mutual-healing  group  key  distribution  scheme  in  unmanned  aerial
vehicles Ad-Hoc network,” IEEE Trans. Vehicular Technology ,  vol. 68,
no. 11, pp. 11309–11322, Nov. 2019.
[22]
 Y. Liu, M. Ma, X. Liu, N. Xiong, and Y. Zhu, “Design and analysis of
probing  route  to  defense  sink-hole  attacks  for  internet  of  things
security,” IEEE Trans. Network Sci. and Eng. ,  vol. 7,  no. 1,  pp. 356–
372, Jan.–Mar. 2020.
[23]
 M.  Karaliopoulos  and  E.  Bakali, “ Optimizing  mobile  crowdsensing
platforms  for  boundedly  rational  users,” IEEE  Trans.  Mobile
Computing, vol. 21, no. 4, pp. 1305–1318, Apr. 2022.
[24]
 M.  Jiang,  Z.  Wang,  L.  Qiu,  S.  Guo,  and  K.  Tan, “ A  fast  dynamic
evolutionary  multiobjective  algorithm  via  manifold  transfer  learning,”
IEEE Trans. Cybernetics, vol. 51, no. 7, pp. 3417–3428, Jul. 2021.
[25]
 R. Qin, Y. Yuan, and F. Wang, “Research on the selection strategies of
blockchain  mining  pools,” IEEE Trans. Computational Social Systems,
vol. 5, no. 3, pp. 748–757, Aug. 2018.
[26]
 W. Dai, C. Dai, K. Choo, C. Cui, D. Zou, and H. Jin, “SDTE: A secure
blockchain-based  data  trading  ecosystem,” IEEE Trans. Inform. Foren.
and Sec., vol. 15, pp. 725–737, Sept. 2020.
[27]
 H.  Shi,  S.  Wang,  Q.  Hu,  X.  Cheng,  J.  Zhang,  and  J.  Yu, “Fee-free
pooled mining for countering pool-hopping attack in blockchain,” IEEE
Trans.  Dependable  and  Secure  Computing,  vol. 18,  no. 4,  pp. 1580–
1590, Jul./Aug. 2021.
[28]
 P. Zhang and M. Zhou, “Security and trust in blockchains: Architecture,
key  technologies,  and  open  issues,” IEEE Trans. Computational Social
Systems, vol. 7, no. 3, pp. 790–801, Jun. 2020.
[29]
 A. Asheralieva, T. Quek, and D. Niyato, “An asymmetric evolutionary
Bayesian coalition formation game for distributed resource sharing in a
multi-cell  device-to-device  enabled  cellular  network,” IEEE Trans.
Wireless Communications, vol. 17, no. 6, pp. 3752–3767, Jun. 2018.
[30]
 M.  Chica,  R.  Chiong,  M.  Kirley,  and  H.  Ishibuchi, “ A  networked  N-
player  trust  game  and  its  evolutionary  dynamics,” IEEE Trans.
Evolutionary Computation, vol. 22, no. 6, pp. 866–878, Dec. 2018.
[31]
 P.  Semasinghe,  E.  Hossain,  and  K.  Zhu, “ An  evolutionary  game  for
distributed  resource  allocation  in  self-organizing  small  cells,” IEEE
Trans. Mobile Computing, vol. 14, no. 2, pp. 274–287, Dec. 2015.
[32]
 Y.  Zhang  and  D.  Yang, “ RobustPay+:  Robust  payment  routing  with
approximation  guarantee  in  blockchain-based  payment  channel
networks,” IEEE/ACM  Trans.  Networking,  vol. 29,  no. 4,  pp. 1676–
1686, Aug. 2021.
[33]
 C. Chen, X. Chen, J. Yu, W. Wu, and D. Wu, “Impact of temporary fork
on  the  evolution  of  mining  pools  in  blockchain  networks:  An
evolutionary game analysis,” IEEE Trans. Network Sci. and Eng., vol. 8,
no. 1, pp. 400–418, Jan.–Mar. 2021.
[34]
 S.  Li,  M.  Zhou,  X.  Luo,  and  Z.  You, “ Distributed  winner-take-all  in
dynamic  networks,” IEEE Trans. Automatic Control ,  vol. 62,  no. 2,
pp. 577–589, Jan. 2017.
[35]
 Z. Liu, S. Mei, S. Yao, W. Yuan, and H. Hua, “Existence and stability
of  equilibrium  of  DC  microgrid  with  constant  power  loads,” IEEE
Trans. Power Syst., vol. 33, no. 6, pp. 6999–7010, Oct. 2018.
[36]
 T.  Shigekuni  and  T.  Takimoto, “Stabilization  of  uncertain  equilibrium
points by dynamic state-derivative feedback control,” in Proc. 13th Int.
Conf. Control, Automat. and Syst., Oct. 2013, pp. 23–27.
[37]
ZHANG et al.: DYNAMIC EVOLUTIONARY GAME-BASED MODELING, ANALYSIS AND PERFORMANCE ENHANCEMENT 201 
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:00:11 UTC from IEEE Xplore.  Restrictions apply. 
 N.  Baron, et  al., “ On  the  false  positives  and  false  negatives  of  the
Jacobian matrix in kinematically redundant parallel mechanisms,” IEEE
Trans. Robot., vol. 36, no. 3, pp. 951–958, Feb. 2020.
[38]
 P.  Zhang,  C.  Li,  and  M.  Zhou, “ Supplementary  file,” [Online]
Available: https://www.dropbox.com/s/kdms1g4tjugy6ag/Blockchain-
channel-network-2021.pdf?dl=0 Or  https://1drv.ms/b/s!Avoj112p4Tjyr-
mII_kTQcHPI1d9d?e=9gv5ud, 2021.
[39]
 D.  Cheng,  T.  Xu,  and  H.  Qi, “ Evolutionarily  stable  strategy  of
networked  evolutionary  games,” IEEE Trans. Neural Networks and
Learning Systems, vol. 25, no. 7, pp. 1335–1345, Jun. 2014.
[40]
 D.  Said, “ A  decentralized  electricity  trading  framework  (DETF)  for
connected  EVs:  A  blockchain  and  machine  learning  for  profit  margin
optimization,” IEEE Trans. Ind. Inform., vol. 17, no. 10, pp. 6594–6602,
Oct. 2021.
[41]
 A.  Keränen,  J.  Ott,  and  T.  Kärkkäinen, “The  ONE simulator  for  DTN
protocol  evaluation,” in  Proc.  2nd  Int.  Conf.  Simulation  Tools  and
Techniques, 2009, p. 55.
[42]
 C.  Sommer,  R.  German,  and  F.  Dressler, “ Bidirectionally  coupled
network and road traffic simulation for improved IVC analysis,” IEEE
Trans. Mobile Computing, vol. 10, no. 1, pp. 3–15, Jan. 2011.
[43]
 S.  Eshghi,  M.  Khouzani,  S.  Sarkar.  N.  Shroff,  and  S.  Venkatesh,
“Optimal  energy-aware  epidemic  routing  in  DTNs,” IEEE Trans.
Automatic Control, vol. 60, no. 6, pp. 1554–1569, May 2015.
[44]
 L. Xue, C. Sun, D. Wunsch, Y. Zhou, and F. Yu, “An adaptive strategy
via  reinforcement  learning  for  the  prisoner’s  dilemma  game,”
IEEE/CAA J. Autom. Sinica, vol. 5, no. 1, pp. 301–310, Jan. 2018.
[45]
 G. Zhao, Y. Wang, and H. Li, “A matrix approach to the modeling and
analysis of networked evolutionary games with time delays,” IEEE/CAA
J. Autom. Sinica, vol. 5, no. 4, pp. 818–826, Jul. 2018.
[46]
 P.  Zhang, et  al., “ A  performance-optimized  consensus  mechanism  for
consortium blockchains consisting of trust-varying nodes,” IEEE Trans.
Network  Science  and  Engineering,  vol. 8,  no. 3,  pp. 2147–2159,
Jul.–Sept. 2021.
[47]
 S.  Dustdar,  P.  Fernández,  J.  M.  García,  and  A.  Ruiz-Cortés, “Elastic
smart  contracts  in  blockchains,” IEEE/CAA J. Autom. Sinica ,  vol. 8,
no. 12, pp. 1901–1912, Dec. 2021.
[48]
 S.  K.  Dwivedi, et  al., “ Blockchain-based  secured  IPFS-enable  event
storage technique with authentication protocol in VANET,” IEEE/CAA
J. Autom. Sinica, vol. 8, no. 12, pp. 1913–1922, Dec. 2021.
[49]
 D. L. Xu, W. Shi, W. S. Zhai, and Z. H. Tian, “Multi-candidate voting
model based on blockchain,” IEEE/CAA J. Autom. Sinica, vol. 8, no. 12,
pp. 1891–1900, Dec. 2021.
[50]
 Mamta,  B.  B.  Gupta,  K.-C.  Li,  V.  C.  M. Leung,  K.  E.  Psannis,  and S.
Yamaguchi, “ Blockchain-assisted  secure  fine-grained  searchable
encryption  for  a  cloud-based  healthcare  cyber-physical  system,”
IEEE/CAA J. Autom. Sinica, vol. 8, no. 12, pp. 1877–1890, Dec. 2021.
[51]
 M.  M.  Hassan,  G.  Fortino,  L.  T.  Yang,  H.  Jiang,  K.-K.  R.  Choo,  J.
Zhang, and F.-Y. Wang, “Guest editorial for special issue on blockchain
for  Internet-of-Things  and  cyber-physical  systems,” IEEE/CAA  J.
Autom. Sinica, vol. 8, no. 12, pp. 1867, Dec. 2021.
[52]
 G.  Fortino,  C.  Savaglio,  G.  Spezzano,  and  M.  C.  Zhou, “ Internet  of
Things as system of systems: A review of methodologies, frameworks,
platforms  and  tools,” IEEE  Trans.  Systems, Man,  and  Cybernetics:
Systems, vol. 51, no. 1, pp. 223–236, Jan. 2021.
[53]
 Z. Tan, C. Wang, C. G. Yan, M. C. Zhou, and C. J.  Jiang, “Protecting
privacy  of  location-based  services  in  road  networks,” IEEE  Trans.
Intelligent Transportation Systems, vol. 22, no. 10, pp. 6435–6448, Oct.
2021.
[54]
 Y. Xie, G. J. Liu, C. G. Yan, C. J. Jiang, and M. C. Zhou, “Time-aware
attention-based  gated  network  for  credit  card  fraud  detection  by
extracting transactional  behaviors,” IEEE Trans.  Computational  Social
Systems, DOI: 10.1109/TCSS.2022.3158318, 2022.
[55]
 C. Liu,  Q.  T.  Zeng,  L.  Cheng,  H.  Duan,  M. C.  Zhou,  and J.  J.  Cheng,
“Privacy-preserving  behavioral  correctness  verification  of  cross-
organizational  workflow  with  task  synchronization  patterns,” IEEE
Trans.  Automation  Science  and  Engineering,  vol.  18,  no.  3,  pp.
1037–1048, Jul. 2021.
[56]
 S.  Deng,  Z.  Xiang,  P.  Zhao,  J.  Taheri,  H.  Gao,  J.  Yin,  and  A.  Y.
Zomaya, “Dynamical resource allocation in edge for trustable internet-
of-things systems: A reinforcement learning method,” IEEE Trans. Ind.
Informatics, vol. 16, no. 9, pp. 6103–6113, 2020.
[57]
 P. Y. Zhang, M. C. Zhou, and G. Fortino, “Security and trust issues in
fog  computing:  A survey,” Future  Generation  Computer  Systems,  vol.
88, pp. 16–27, Nov. 2018.
[58]
 H.  Zhu  and  M.  Zhou, “ Role-based  collaboration  and  its  kernel
mechanisms,” IEEE Trans. Systems, Man and Cybernetics, Part C, vol.
36, no. 4, pp. 578–589, Jul. 2006.
[59]
PeiYun Zhang (Senior Member, IEEE) received the
Ph.D. degree in computer science from the School of
Computer  Science  and  Technology  at  the  Nanjing
University of Science and Technology, in 2008. She
is currently a Professor at Engineering Research Cen-
ter of Digital Forensics of Ministry of Education, and
the School of Computer Science, Nanjing University
of  Information Science & Technology.  Her  research
interests  include  blockchains,  trust  computing,  and
service computing. She has published over 60 papers
in these fields.
MengChu  Zhou (Fellow,  IEEE)  received  the  B.S.
degree  in  control  engineering  from Nanjing  Univer-
sity  of  Science  and  Technology  in  1983,  the  M.S.
degree in automatic control from Beijing Institute of
Technology  in  1986,  and  the  Ph.D.  degree  from
Rensselaer  Polytechnic  Institute,  USA.  He  joined
New Jersey Institute of Technology where he is now
a Distinguished  Professor.  His  research  interests  are
in  intelligent  automation,  Petri  nets,  robotics,  Inter-
net of Things, big data, cloud/edge computing, trans-
portation  and  energy  systems.  He  has  over  1000  publications  including  12
books, over 700 journal papers (over 600 in IEEE transactions), and 30 book-
chapters.  He  holds  31  patents  and  several  pending  ones.  His  recently  co-
authored/edited  books  include  Supervisory  Control  and  Scheduling  of
Resource  Allocation  Systems:  Reachability  Graph  Perspective,  IEEE
Press/Wiley, Hoboken, Hoboken, New Jersey, 2020 (with B. Huang). He is a
recipient  of  Excellence  in  Research  Prize  and  Medal  from  NJIT,  Humboldt
Research  Award  for  US  Senior  Scientists  from  Alexander  von  Humboldt
Foundation, and Franklin V. Taylor Memorial Award and the Norbert Wiener
Award  from  IEEE  SMC  Society,  Computer-Integrated  Manufacturing  UNI-
VERSITY-LEAD  Award  from  Society  of  Manufacturing  Engineers,  Distin-
guished  Service  Award  from  IEEE  Robotics  and  Automation  Society,  and
Edison Patent Award from the Research & Development Council of New Jer-
sey.  He  is  a  Life  Member  of  Chinese  Association  for  Science  and  Technol-
ogy-USA and  served  as  its  President  in  1999.  He  is  Fellow of  International
Federation  of  Automatic  Control  (IFAC),  American  Association  for  the
Advancement  of  Science  (AAAS),  Chinese  Association  of  Automation
(CAA) and National Academy of Inventors (NAI).
ChenXi  Li received  the  B.S.  degree  in  information
management  and  information  system  from  Bengbu
Medical  College,  in  2018,  and  the  master  degree  in
computer  science  at  Anhui  Normal  University,  in
2021. Her research interests include blockchains and
intelligent information processing.
Abdullah  Abusorrah (Senior  Member,  IEEE)
received  the  Ph.D.  degree  in  electrical  engineering
from  the  University  of  Nottingham  in  United  King-
dom  in  2007.  He  is  now  a  Professor  in  the  Depart-
ment of Electrical and Computer Engineering at King
Abdulaziz  University.  He  is  the  Head  of  the  Center
for  Renewable  Energy  and  Power  Systems  at  King
Abdulaziz  University.  His  research  interests  include
energy systems, smart grid, and system analysis.
 202 IEEE/CAA JOURNAL OF AUTOMATICA SINICA, VOL. 10, NO. 1, JANUARY 2023
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:00:11 UTC from IEEE Xplore.  Restrictions apply.