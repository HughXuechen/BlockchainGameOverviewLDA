Designing a High Performance and High-Profit P2P Energy Trading System Using a Consortium Blockchain Network
12th International Conference on Computer and Knowledge Engineering (ICCKE 2022), November 17-18, 2022, Ferdowsi University of Mashhad, Iran 
978-1-6654-7613-3/22/$31.00 Â©2022 IEEE 
Designing a High Performance and High-Profit  
P2P Energy Trading System  
Using a Consortium Blockchain Network 
 
Poonia Taheri Makhsoos, Behnam Bahrak, Fattaneh Taghiyareh 
Department of Electrical and Computer Engineering 
University of Tehran 
Tehran, Iran 
poonia.taheri@ut.ac.ir, bahrak@ut.ac.ir, ftaghiyar@ut.ac.ir 
 
 
Abstractâ€”Renewable energy generating systems can be used to 
supply some or all of electricity needs, using technologies like 
solar, wind, or micro hydropower systems. Trading this kind of 
decentralized energy is essential to owners of these local systems. 
Regional p2p energy trading systems provide a solution for this 
issue. Due to expanding the concept of decentralization and 
blockchain-based trading models, some studies in recent years 
have proposed such models for local surplus energy trading. In 
this paper, we propose a distributed energy-trading framework 
based on a consortium blockchain for p2p energy trading energy 
of renewable energy systems. Our proposed model uses 
Jointgraph, a novel Byzantine fault-tolerance consensus 
algorithm, and a DAG-based consortium energy blockchain 
framework, which highly improves the performance of the 
trading model. Furthermore, we use Belief Distorted Nash 
Equilibrium (BDNE) for pricing strategy to increase the 
profitability of the system for both buyers and sellers. The 
implemented simulation confirms that the proposed framework 
outperforms similar p2p trading models in terms of both 
performance and profitability and can be used in real local 
energy trading systems. 
Keywords: Renewable energy system, Decentralized Energy 
Trading; Consortium Blockchain; Consensus algorithms; Pricing 
strategy; Belief Distorted Nash Equilibrium 
I.  INTRODUCTION 
Along with many other businesses, decentralized solutions 
have received a lot of attention in energy management systems 
in recent years. They bring advantages such as privacy, 
transparency, security, lower costs, etc. in comparison with 
centralized solutions. In this paper, we proposed a novel 
energy trading system for surplus energy trading between 
renewable energy system owners as producer and their 
neighborhoods as consumers. We focus on the efficiency and 
profitability of the trading system. 
Unlike traditional energy generation (by burning fossil 
fuels such as gas or coal), renewable energy is generated from 
natural sources that are continually replenished, such as 
sunlight, wind, or waves. When fossil fuels burn to meet the 
demands for energy, they emit carbon dioxide, the main 
greenhouse gas that is causing climate change. Local energy 
systems will play an important role in helping governments 
decrease their need for this energy and preventing climate 
change. Local energy systems are ones, which find ways to 
link the supply and demand of energy services within a local 
area. Consumers such as manufacturing industries, hospitals, 
buildings, large offices, and dry cleaners, who need a lot of 
energy during the day, can use these kind of systems to reduce 
their costs and contribute to the health of the earth. Another 
advantage of using renewable energy systems is that the local 
natural resources (solar, wind, etc.) can be used as primary 
energy in the system. These generated energies can be used 
locally and internally, but they can be transferred to power 
grids or individuals who need energy [1]. All of the benefits 
of the renewable energy systems lead to attracting people to 
this ecosystem. 
Renewable energy systems may have an overabundance of 
energy sometimes. This extra energy of the system can be 
offered to others who need energy in the neighborhood, 
probably at lower prices (because of lower transfer costs and 
higher energy throughput). Such energy trading decreases the 
total cost of accessible energy and the operation cost of the 
renewable energy generation system [2]. 
In order to collect surplus energy for trading, buildings 
with renewable energy systems are equipped with an energy 
storage system (ESS). An equipped building in this context 
refers to a building that is equipped with a renewable energy 
system, ESSs, and smart meters connected to the distribution 
network. In this way, for selling surplus energy, the building 
must be operated in islanded mode. In this mode, the ESS is 
being charged with surplus power, especially during off-peak 
load intervals. Then this energy can be traded in the trading 
network [3]. Selling this extra energy through a reliable, 
accessible, and straightway trading network, especially to 
close and local customers, is profitable and economically 
attractive. 
Few studies have focused on trading the energy produced 
by local renewable energy systems and making a profitable 
p2p network in this ecosystem. Most of these studies are based 
on blockchain and smart contracts. Some of them use public 
blockchains such as Bitcoin and Ethereum for trading [4]. 
Others propose using private or consortium blockchains [5]. 
Achieving acceptable performance in the order of thousands 
of transactions that enable the network to support many 
prosumers and a perfect pricing strategy, which increases 
profitability for both sellers and buyers of energy, are two 
substantial challenges unsolved by previous studies. 
Therefore, in this paper, we focus on these two challenges and 
propose a decentralized framework for energy trading in a 
local ecosystem. In fact, we propose an energy supply 
framework based on a decentralized energy exchange network 
built with a novel DAG-based consortium blockchain between 
owners of local renewable energy generator systems as 
458
20
22
 1
2t
h 
In
te
rn
at
io
na
l C
on
fe
re
nc
e 
on
 C
om
pu
te
r a
nd
 K
no
w
le
dg
e 
En
gi
ne
er
in
g 
(I
C
C
K
E)
 | 
97
8-
1-
66
54
-7
61
3-
3/
22
/$
31
.0
0 
Â©
20
22
 IE
EE
 | 
D
O
I: 
10
.1
10
9/
IC
C
K
E5
71
76
.2
02
2.
99
60
01
5
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:55:17 UTC from IEEE Xplore.  Restrictions apply. 
  
producers and their local communities as customers. In 
addition, an optimal pricing model considering seller and 
buyer utilization among trading has been proposed, which uses 
Belief Distorted Nash Equilibrium (BDNE), a novel Nash 
equilibrium technique for distorted and non-cooperative game 
models. 
II. RELATED WORK 
Today, distributed energy resources (DERs) and energy 
storage systems are becoming more and more popular. 
Accordingly, it is urgently requested to develop distributed 
system design and solutions for p2p energy trading. A p2p 
trading system is an integrated system that includes DERs and 
multiple electrical loads [6]. 
But, it is a fact that researches in this field are still at an 
early stage of development [11]. Most implementations are at 
the level of proof of concept. Public blockchain systems such 
as Bitcoin or Ethereum wallet services have emerged as an 
important factor in many areas. It allows automated 
transactions, and it is also likely to influence the energy sector 
[2]. Permissioned blockchain systems share the benefit that all 
players are known, which makes it possible to rely on less 
computationally complex consensus mechanismsâ€”the 
protocol which ensures that all network participants have 
identical copies of the transaction log and agree on the state of 
the system [3]; this significantly increases the number of 
transactions the system can process and reduces the ecological 
footprint. However, the content of transactions remains visible 
to all network participants, complicating the implementation 
of privacy-preserving features [4], [5]. The scientific 
community calls for more research in this field and encourages 
investigating alternative blockchain frameworks. Hyperledger 
Fabricâ€”originally contributed by IBM and Digital Asset and 
now hosted by the Linux Foundationâ€”is one of the most 
mature permissioned blockchain frameworks [15]. Since its 
release in 2017, more and more projects rely on Hyperledger 
Fabric and leverage some of the frameworkâ€™s advantages: (1) 
its modularity, facilitating the integration with existing ICT 
infrastructure, for instance; (2) its good scalability, meaning it 
can process high levels of transactions in a short amount of 
time; and (3) its support for private transactions, making it 
possible to keep private data confidential between a subgroup 
of authorized parties. These advantages make Hyperledger 
Fabric a promising candidate for building a decentralized 
permissioned energy trading platform [7], [8]. 
In recent years, many solutions for local energy trading 
have been proposed, and appropriate designs are being 
discussed in scientific literature. The authors in [9] used the 
shared and internal energy trading approach to develop a P2P 
energy sharing model by applying the Stackelberg game 
approach and the Lyapunov optimization method. In [10], in 
order to optimize microgrid energy cost, a P2P energy dealing 
model for smart houses was introduced. The optimization 
factor was minimizing the cost of total energy. In another 
study based on P2P energy markets proposed in [11], the 
authors used bill sharing (BS) and mid-market rate (MMR) for 
residential customers. Prosumers contribute to trade energy in 
this approach. The mechanism to guarantee pricing stability is 
MMR. The researchers used the Feed-In-Tariff scheme to 
examine their study compared to other P2P energy trading 
solutions. Sharing energy storage ownership between multiple 
shared facility controllers (SFCs) is the basis of the proposed 
P2P trading mechanism introduced in [12]. In [13], a novel 
P2P energy trading mechanism was introduced that works in 
a cooperative market, analyzing optimality and fairness 
amongst prosumers. Enhanced control of landlords and 
automatic buying and selling in the P2P electricity market is 
the innovation of the study in [14]. The authors in [14] 
proposed a mechanism that automatically performs the 
purchase and sale of electricity with increased control to 
householders in the P2P electricity exchange network. In [15], 
researchers used Bayesian game theory to build a bidding 
strategy in p2p electricity trading that guarantees efficiency 
and fairness for each buyer. In [16], a p2p trading scheme is 
proposed with attention to the network constraints and the 
feasibility of p2p trading in a grid power network. A p2p 
energy exchange scheme focusing on residential prosumers is 
proposed in [17]. The authors investigate an optimal power 
flow problem using a multi-bilateral economic dispatch 
formulation as the objective function. Since price monitoring 
is a requirement for prosumers in the smart grid community, 
many researchers focused on this aspect of the trade. Demand 
Response (DR) is a parameter that is widely used in different 
researches. An incentive-based DR solution was proposed in 
[18]. The incentive in this solution is a fair amount of load 
change. A similar approach that does not use consumer 
behavior in the model is proposed in [19]. This model can 
predict house power consumption changes. Confidentiality of 
user information in the microgrid and maximizing the benefit 
to participants are the primary concerns addressed in [20]. 
Stackelberg competition is a model used in [21] to maximize 
the benefit of P2P energy trading. These are DR-based 
approaches in that consumersâ€™ behavior is modeled as an 
evolutionary game, and producersâ€™ behavior is modeled using 
the Stackelberg game. In [22], researchers introduced an 
algorithm to minimize the costs to all prosumers in the energy 
sharing market. 
In [19] and [23], prosumers trade with others in the local 
network based on residential demand response schemes to 
balance supply and demand. In these studies, prosumers 
manage their energy usage and learn about other producers 
and consumersâ€™ production/consumption patterns. In [24], a 
marketplace for electricity was proposed using a blockchain-
based shift load mechanism to represent a mixed 
complementarity problem. A producer in this model generates 
energy tokens based on load shifting, and consumers buy the 
tokens to pay their bills. The authors of [25] used a non-
cooperative game-theoretic approach to propose a demand-
side management system. In [11], a microgrid P2P electricity 
exchange model is introduced that uses blockchain as the 
transaction system. A blockchain-based Bidding System for 
Peer-to-Peer Energy Trading in a microgrid is proposed in 
[26]. It proposes a P2P energy trading system based on smart 
contract and a dynamic pricing approach on the Ethereum 
blockchain. 
III. PROPOSED METHOD 
In this section, our proposed approach for p2p energy 
trading has been discussed. First, we propose our 
decentralized system design. Then, Jointgraph as a consensus 
algorithm is presented. This algorithm causes efficiency 
improvement in the trading system. After that, our proposed 
pricing strategy, which is based on BDNE, is discussed. Using 
BDNE instead of NE increases the profitability of the system 
and causes to more people attract for joining to the system in 
the real world. 
A. Decentralized system design 
We propose a decentralized system consisting of 
prosumers (producers and consumers), smart elements, 
supervisor, energy storage systems (ESS), and a DAG-based 
blockchain, with a novel efficient consensus algorithm; 
Jointgraph. Fig. 1.  illustrates a schematic view of the proposed 
459
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:55:17 UTC from IEEE Xplore.  Restrictions apply. 
  
system model. Each smart meter is connected to an ESS, and 
each prosumer has one ESS to transfer its receiving energy. 
Similar to [27], we assume that the smart element is a trusted, 
unbreakable device for measuring the amount of energy which 
users cannot manipulate. In addition, it is connected to the data 
network. The energy trading process is initiated by the 
prosumer who offers a price and amount of energy for buying 
or selling. Then the supervisor node collects all offers and runs 
a pricing algorithm based on BDNE. It calculates the fair price 
and announces it to all users. Then, each pair of seller/buyer 
users agree with each other, and a smart contract is signed and 
sent to the network for consensus, verification, and registration 
using Jointgraph.  
We assume that EESs are connected to a transmission 
system mechanism. Thus, energy is transferred from the buyer 
ESS to the seller ESS after the agreement. In this paper, such 
as most similar studies, we do not deal with the details of 
power-transmission lines.  
In our proposed framework, the supervisor is a mediator, 
and according to the seller-buyer matching information 
provided by the blockchain, it updates the seller and buyer 
information such as their credit scores, bills, etc. Users can 
anonymously negotiate with each other without revealing their 
identity to any third party. This functionality would be 
implemented in the trading mechanism by performing DAG-
based decentralized systems. The strength of the designed 
system is using Jointgraph as a consensus method in 
blockchain, which leads to a high-performance consensus and 
makes the system usable for real-life and real-time transaction 
handling. On the other hand, the supervisor's energy price is 
determined by a non-cooperative game with a Nash 
equilibrium using BDNE, which causes mutual utilization for 
both buyers and sellers. 
In the following, Jointgraph, BDNE, and the way we use 
them in the trading system have been discussed. 
B. Consortium blockchain based on Jointgraph 
As mentioned before, we use Jointgraph as a novel DAG-
based blockchain and consensus algorithm for the first time in 
trading models. The main advantage of Jointgraph is its 
efficiency, which makes it perfect for real-life trading systems. 
Details of this algorithm and its usage in our proposed trading 
system will be presented below. 
 
Fig. 1.  A schematic view of the proposed system model 
 
1) What is Jointgraph 
Jointgraph is one of the newest and most efficient 
consortium blockchains. The consensus in Jointgraph is 
achieved using a Byzantine fault-tolerant algorithm. In this 
algorithm, each node reaches an agreement with another node 
on their transaction. The concept of the event is used in 
Jointgraph for a package of transactions. These packages 
transfer between nodes through a gossip protocol; it means any 
node can send events to any random node. Nodes in Jointgraph 
structure are categorized into two types: ordinary (user) nodes 
and supervisor node. Buyers and sellers in the trading 
application are user nodes that send transactions (events) when 
a trade has been done. Also, they are responsible for the 
validation of transactions of other users. If a user node can 
verify the transaction and add it to its own Jointgraph copy, he 
votes YES. The supervisory node has two responsibilities. The 
first one is the determination of pricing for energy based on 
the game model, which is explained in the following section. 
The second job is collecting votes in the consensus process 
and determination of the finality of events. This finality 
depends on the "YES" votes, and the minimum "YES" votes 
must be 2/3 of the total votes. Also, a supervisor node monitors 
the behavior of the user nodes and identifies malicious 
behavior [27]. 
2) Consensus in Jointgraph 
The graph structure of the Jointgraph is dynamic and 
changeable during its lifetime. An edge from A to B means 
that event A has verified event B and event A in one of the 
children of B. User nodes validate the receiving events from 
each other. The validation means that transaction source and 
destination, transaction signature, and hashes of self-parent 
and other-parent are valid. The events that are invalid will be 
dropped by the receiver node. If an event is verified by more 
than 2/3 of all user nodes and the supervisory node, its finality 
will be confirmed. In the energy context, the events include 
energy trading transactions between a seller and a buyer. 
Along the lifetime of the trading system, the older events will 
be verified by the newcomers. Therefore, former event can 
participate in the consensus process. Fig. 2. shows the 
eudocode of consensus algorithmps  that is run by the user 
nodes and the supervisor node. The consensus process in 
Jointgraph is almost similar to this process in Hashgraph 
because of the use of gossip protocol [39]. However, using a 
supervisor node in Jointgraph, which does not exist in 
Hashgraph, makes a huge difference; Jointgraph only needs 
one round of voting, whereas Hashgraph needs no less than 
three rounds. In the worst case, a Jointgraph can go on without 
the supervisor node in the consensus process. In this unlikely 
case, the Jointgraph turns to a Hashgraph, and the system does 
not shut down. 
C. Pricing strategy 
In the proposed decentralized energy trading system, users 
do not have information about each other's demands and 
supplies. So, the information is not fully available, and the 
system has a non-cooperative game space. Therefore, we 
chose Belief distorted Nash equilibria (BDNE) theory to 
develop a profitable pricing strategy. 
Joining the network and pricing process includes four 
steps: 
1. Join & verification: for identification and verification 
to join the network, each prosumer (producer or 
consumer) of energy sends a request to the supervisor. 
If it is qualified to enter the market, the verified user's 
information is published to the network. 
460
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:55:17 UTC from IEEE Xplore.  Restrictions apply. 
  
 
Fig. 2.  Pseudocode of consensus algorithm that is run by the user nodes and 
the supervisor node 
2. Pricing step: each market entity announces its daily 
energy demand or supply and its offered price for 
buying or selling. Then according to the BDNE 
algorithm of dynamic games, the transaction price and 
transaction volume are determined by the supervisor. 
3. Transaction execution step: each buyer chooses one or 
more sellers and makes a transaction contract with the 
seller(s). After that, users sign the smart contract 
according to price and transaction volume. Then, the 
transaction information is sent to the DAG-based 
blockchain network. If the consensus process verifies 
the transaction, recording it to the general ledger will 
complete the transaction. 
4. Settlement step: after the transaction finalization, 
energy dispatching will complete by calling the 
dispatching system. Then, the supervisor reads the 
trusted smart meter's data to ensure the accuracy of the 
energy exchange. 
Nash equilibrium is the most important concept in non-
cooperative games. But, it is a complete solution when players 
have full information about the other users' data in the game, 
such as their payoff functions and strategies and the number 
of players. This information might be incomplete or even 
distorted in dynamic games, so as the proposed energy trading 
system. In these games, the Nash equilibrium (NE) algorithm 
cannot establish the desired mutual balance. Decentralized 
energy trading networks, like many real-life situations, have 
incomplete and ambiguous information. Thus NE must be 
extended to be applicable to such situations. Many studies 
have been done to extend the Nash equilibria concept to make 
it work in the case of incomplete information, including 
Bayesian equilibria [28], correlated equilibria [29], delta- 
rationalizability [30], self-confirming equilibria [31], and 
subjective equilibria [44]. BDNE is one of the most complete 
extensions of NE. It is proved that BDNE can be fully applied 
in dynamic games with incomplete information. This feature 
separates BDNE from any other related NE extensions. Also, 
it seems to be especially appropriate for games with many 
players [32]. Another advantage of BDNE is that it can 
scientifically model the problems of a particular structure, 
which is common in the socio-economic context[32]. These 
reasons make BDNE a practical algorithm for many real-life 
situations, like massive trading markets with high micro-
transactions. 
We assume that the pricing game is defined as 
 ğº =  {ğ´1, ğ´2, â€¦ , ğ´ğ‘›, ğœƒ1, ğœƒ2, â€¦ , ğœƒğ‘›, ğ‘¢1, ğ‘¢2, â€¦ , ğ‘¢ğ‘› } ï€ 
ï€  ğ´ğ‘–(ğœƒğ‘–), ğ‘– = 1 ğ‘¡ğ‘œ ğ‘› âˆ¶ strategy spaceï€  ï€ 
ï€  ğœƒğ‘– , ğ‘– = 1 ğ‘¡ğ‘œ ğ‘› âˆ¶ strategiesï€  ï€ 
ï€  ğ‘¢ğ‘– , ğ‘– = 1 ğ‘¡ğ‘œ ğ‘› âˆ¶ ğ‘ ğ‘’ğ‘™ğ‘“ âˆ’ ğ‘¢ğ‘¡ğ‘–ğ‘™ğ‘–ğ‘¡ğ‘¦ ğ‘“ğ‘¢ğ‘›ğ‘ğ‘¡ğ‘–ğ‘œğ‘›ï€  ï€¨ï€±ï€©ï€ 
Each participant ğ‘– relies on the strategy ğœƒğ‘–  in the case of 
maximizing the self-utility function ğ‘¢ğ‘– . 
So 
ï€  ğ‘âˆ— = (ğ‘1
âˆ—(ğœƒ1), â€¦ , ğ‘ğ‘›
âˆ— (ğœƒğ‘›))ï€  ï€¨ï€²ï€©ï€ 
Is a belief distorted equilibrium, for any ğ‘– , ğ‘ğ‘–  âˆˆ  ğ´ğ‘–(ğœƒğ‘–). 
According to the volume of each producer's surplus energy 
and the buyer's demand, the user load of each transaction can 
be found as 
ï€  ğ‘’ğ¿,ğ‘– = [ğ‘’ğ¿,ğ‘–
1  , ğ‘’ğ¿,ğ‘–
2  , â€¦ , ğ‘’ğ¿,ğ‘–
ğ‘‘ ] ï€  ï€ 
ï€   ğ‘– = 1 ğ‘¡ğ‘œ ğ‘› , ğ‘‘ = 24â„ ğ‘¡ğ‘Ÿğ‘ğ‘‘ğ‘–ğ‘›ğ‘” ğ‘‘ğ‘ğ‘¦ï€  ï€¨ï€³ï€©ï€ 
Where, ğ‘› is the number of users in the market network. In 
our implemented simulation, one trading period is 24â„ . In 
each trading period, the actors in the network play a game 
under the supervision of the supervisor node to reach an 
optimal price and the amount of energy trading. So, the sellers 
adjust their energy load ğ‘’ğ¿,ğ‘– to obtain more benefits. 
The users of the proposed trading network are three types: 
sellers, buyers, and supervisors. ğ‘ denotes the set of all users 
in the network, ğ‘ğ‘  represents the buyersâ€™ set, and ğ‘ğ‘   is the 
sellersâ€™ set. ğ‘’ğ¿,ğ‘–  is positive (ğ‘’ğ¿,ğ‘– > 0)  for ğ‘ğ‘  , and negative 
(ğ‘’ğ¿,ğ‘– <  0) for ğ‘ğ‘. 
The price of energy should satisfy the following 
conditions: 
 ğ‘ğ‘š <  ğ‘ğ‘‘ < ğ‘ğ‘” (4)ï€ 
Where ğ‘ğ‘š  is the price that renewable energy system 
owners (sellers) pay for power generation, ğ‘ğ‘‘ is the price of 
energy in a day, and ğ‘ğ‘” is the price of energy in the grid.  
Sellers will adjust their surplus energy prices to obtain 
higher benefits in the competition of energy trading. The 
benefit function of sellers is: 
 ğ‘¢ğ‘– =  ğ›¼ğ‘– ğ‘™ğ‘› (1 + ğ‘’ğ¿,ğ‘–) + ğ‘(ğ‘’ğ¿,ğ‘–)ï€  ï€¨ï€µï€©ï€ 
461
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:55:17 UTC from IEEE Xplore.  Restrictions apply. 
  
Where ğ‘¢ğ‘– is the benefit factor of seller ğ‘– in the period ğ‘‘, ğ›¼ğ‘– 
is the adjustment coefficient of the seller's energy generation 
behavior, and ğ‘ is the energy price.  
 Buyers need to pay lower purchase costs in comparison 
with buying energy from the power grid. The purchasing cost 
of the buyer is expressed as follows: 
 ğ¶ğ‘— =  ğ‘ğ‘—ğ‘ + ğ‘’ğ¿,ğ‘—ğ‘ğ‘ ï€  ï€¨ï€¶ï€©ï€ 
Where ğ‘ğ‘—  is the amount of energy purchased during the 
lifetime of buyer j in the network, ğ‘ is the total paid amount in 
this duration. ğ‘’ğ¿,ğ‘—  is the current buyer need and ğ‘ğ‘  is the 
offered price for current need.  
Finally, the buyer and the seller play a multi-participant 
dynamic game which is formulated as follows: 
 ğº = {(ğ‘ğ‘  âˆª  ğ‘ğ‘ ), {ğ¸ğ‘–}ğ‘– âˆˆ ğ‘ğ‘ 
, {ğ‘¢ğ‘–}ğ‘– âˆˆ ğ‘, ğ‘ƒ , ğ¶ğ‘‡} (7)ï€ 
Where the sellers in ğ‘ğ‘  offer the energy consumption plan 
(price and amount). ğ¸ğ‘–  is the strategy set of energy 
consumption ğ‘’ğ¿,ğ‘—  of buyer ğ‘– . ğ‘ƒ  points to the strategy set of 
energy prices in the network, ğ¶ğ‘‡ is the total cost of purchased 
energy by buyers. 
Buyers want to pay the lowest cost for energy, and sellers 
wish to maximize their benefit from sales. So, the equilibrium 
of ğº as the game model is the optimal problem solution. The 
supervisor node finds the optimal price using BDNE, and the 
consumers adjust their consumption strategy based on the 
price. 
The equilibrium (ğ‘’âˆ—, ğ‘âˆ— ) in period ğ‘‘  of the game  ğº  is 
reached if and only if ğ‘’ and ğ‘ satisfy the following conditions: 
 ğ‘¢ğ‘–(ğ‘’âˆ—, ğ‘âˆ—) â‰¥  ğ‘¢ğ‘–(ğ‘’ğ‘–, ğ‘’âˆ’1
âˆ— , ğ‘âˆ—)    âˆ€ ğ‘– âˆˆ  ğ‘ğ‘   , âˆ€ ğ‘’ğ‘–  âˆˆ ğ¸    
 ğ¶ğ‘¡(ğ‘’âˆ—, ğ‘âˆ—) â‰¤  ğ¶ğ‘¡(ğ‘’âˆ—, ğ‘)    âˆ€ ğ‘ âˆˆ ğ‘ƒ (8) 
Where  
ï€  ğ‘’âˆ— =  [ğ‘’ğ¿,1, ğ‘’ğ¿,2, â€¦ . , ğ‘’ğ¿,ğ‘ğ‘ 
]ï€  ï€ 
ï€  ğ‘’âˆ’1
âˆ— =  [ğ‘’ğ¿,1, ğ‘’ğ¿,2, â€¦ , ğ‘’ğ¿,ğ‘–âˆ’1 , ğ‘’ğ¿,ğ‘–+1 , â€¦ , ğ‘’ğ¿,ğ‘ğ‘ 
]ï€  ï€¨ï€¹ï€©ï€ 
IV. SIMULATION OF PROPOSED FRAMEWORK 
 
Through the deployment of the proposed chaincode, the 
network was implemented in Hyperledger fabric. Then, 
Hyperledger Caliper evaluated the performances of the trading 
model. Also, the utilization and trading benefits for both 
sellers and buyers were measured. Simulations are done on a 
VPS with four CPU cores and 16 GB of RAM, on which 
Ubuntu 18.04 x64 is installed. As mentioned before, the 
consensus mechanism used in these simulations is Jointgraph. 
Also, the pricing strategy is based on BDNE. Go language, as 
a compatible and well-known programming language for the 
Fabric environment, was used to code the deployed system. 
In general, a sample of energy market trading scenarios 
between owners of renewable energy systems and local buyers 
was set up and simulated in a Fabric network environment. We 
considered daily trading periods. Finally, the simulation was 
performed for a two-week (14 days) duration of energy trading 
with daily transactions. The simulated trading network 
consists of five sellers, each with an ESS storage equipped 
with a trusted smart meter. There are ten buyers for energy 
with variable amounts of daily energy requirements. The ESS 
power of each seller in the network is shown in TABLE I. The 
initial (minimum) price of "surplus energy to the network" for 
local users has assumed 0.77 dollars (the minimum price that 
covers the store and buys surplus energy). This price is 
changed during trading based on the pricing strategy. 
TABLE I.  THE ESS POWER OF EACH SELLER IN THE SIMULATED 
NETWORK IN EACH DAY (KW/H) 
period Seller 1 Seller 2 Seller 3 Seller 4 Seller 5 
1 5.21 8.47 1.54 4.75 10.88 
2 6.52 8.76 5.56 9.38 15.22 
3 6.43 10.37 2.48 10.34 16.38 
4 5.86 9.78 9.3 10.45 17.45 
5 5.34 9.86 8.23 11.64 18.45 
6 8.02 9.57 11.36 11.4 18.32 
7 9.7 9.45 10.49 11.74 17.56 
8 9.56 9.28 8.79 10.56 19.09 
9 6.45 8.51 6.33 9.36 22.65 
10 5.52 8.4 11.02 9.34 13.98 
11 6.55 8.37 10.44 8.29 13.01 
12 6.41 9.76 6.38 2.13 7.9 
13 6.52 8.77 4.66 7.68 17.12 
14 6.83 9.36 13.78 8.34 14.38 
TABLE II. shows users' total power supply and needs. In 
period 7 and 8 the demand is less than surplus energy for sale. 
After selling energy to buyers by sellers, the surplus power 
remains for the next period of the market. In other periods, the 
power loads are less than the needs; therefore, after purchasing 
energy in the network, buyers have to buy their remaining 
needs from the power grid (with 0.77$). 
TABLE II.  THE TOTAL POWER SUPPLY AND DEMAND OF USERS IN 
EACH DAY (KW/H) 
period total 
energy for 
Sale 
total 
energy 
need 
total energy 
Sold  
based on NE  
total energy 
Sold 
based on BDNE  
1 30.85 -37.21 29.82 30.85 
2 45.44 -48.57 43.27 45.44 
3 46 -50.72 45.72 46 
4 52.84 -53.02 51.93 52.84 
5 53.52 -58.56 53.1 53.52 
6 58.67 -61.51 58.67 58.67 
7 58.94 -45.33 45.33 45.1 
8 57.28 -36.12 36.12 36.12 
9 53.3 -57.27 53.3 53.13 
10 48.26 -49.84 47.63 48.26 
11 46.66 -51.44 46.66 46.66 
12 32.58 -44.65 27.15 30.24 
13 44.75 -47.91 44.75 44.75 
14 52.69 -58.7 48.14 50.29 
V. EVALUATION RESULTS 
The simulation results are discussed in two parts. The first 
one is the evaluation results of the pricing strategy of our 
trading model, and the performance test results of the 
transaction processing in the sample configuration are 
discussed in the second part. 
A. Pricing Strategy Simulation Results 
Fig. 3. shows the calculated optimal price for each period 
according to the sellers' offered price. As expected, the results 
show that the energy price is related to supply and demand. 
Remember that the initial cost of energy is 0.77 dollars. 
Here we compare the purchase cost of our proposed 
trading model with the cost of purchasing energy using NE as 
a common pricing strategy. Also, the power sales benefit of 
the model and power sales benefit using NE are shown in 
Error! Reference source not found. The results of purchase 
costs and sale benefit show that our model has lower energy 
462
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:55:17 UTC from IEEE Xplore.  Restrictions apply. 
  
purchase costs than the model with NE. The energy sale 
benefit obtained from NE is significantly less than the benefit 
received by our BDNE-based proposed model. In general, the 
simulation results of the model show that using BDNE instead 
of NE in the decentralized trading model of the network 
preserves the profit, increases the seller's revenue, and reduces 
the buyer's energy purchase cost. 
 
Fig. 3.  The results of the optimal price which has been calculated for each 
period according to the offered price of energy by sellers 
 
Fig. 4.  The sales benefit of the proposed model (using BDNE) and sales 
benefit using NE . The vertical axis shows the total price of the benefit of 
sellers and buyers compared with buy or sale to the gird daily. 
B. Performance Evaluation 
The proposed trading model's performance was evaluated 
using Hyperledger Caliper, which is a performance 
benchmarking framework for blockchains developed by using 
Hyper Ledger Fabric [33].  
The transaction processing capacity of a blockchain 
network can be reproduced by two metrics: throughput and 
latency. Throughput is an important reference metric to 
measure the performance of blockchain solutions, especially 
in real life. This index is presented as the number of network's 
handled transactions in a certain period. Tps (transactions per 
second) is used to determine the number of processed 
transactions per second. Latency is another important metric 
that shows the time a blockchain system needs to process a 
transaction. In performance evaluation, the latency of requests 
determines the amount of time a transaction needs to go from 
a client to the blockchain network. In general, ms 
(milliseconds) is used as the unit of this index. In the 
implemented evaluation bed, Caliper sends transaction 
requests to the blockchain network through a specific HTTP 
port. Then the trend of throughput and latency of the proposed 
model is measured. The results are shown in TABLE III.  
To compare the performance of the proposed model with 
similar existing models, the data of throughput and latency for 
a model by Hashgraph consensus instead of Jointgraph, were 
extracted. 
Throughput and latency were compared, respectively and 
shown in Fig. 5. And Fig. 6. It is apparent that in the whole 
period, for the proposed model, throughput is higher, and 
latency is less than in the other model.  
 
Fig. 5.  The throughput of the system in each period using Jointgraph and 
Hashgraph as consensus method. 
 
Fig. 6.  The average latency of the system in each period using Jointgraph 
and Hashgraph as consensus methods. 
TABLE III.  THE RESULTS OF BENCHMARKING USING HYPERLEDGER 
CALIPER FOR THE PROPOSED BLOCKCHAIN NETWORK 
Period Success 
rate 
Fail 
rate 
Send 
Rate 
(Tps) 
Max 
latency 
(ms) 
Min 
latency 
(ms) 
Avg. 
latency 
(ms) 
Throughput 
(Tps) 
1 100 0 20 160 40 120 20 
2 100 0 12 115 33 94 12 
3 100 0 18 127 35 98 18 
4 100 0 31 187 58 132 31 
5 100 0 40 201 66 160 38 
6 100 0 24 132 32 101 24 
7 100 0 64 219 43 187 45 
8 100 0 53 184 50 120 45 
9 100 0 33 175 53 115 33 
10 100 0 37 181 46 143 37 
11 100 0 17 117 38 89 17 
12 100 0 18 120 29 92 18 
13 100 0 24 166 58 111 24 
14 100 0 54 182 42 118 45 
VI. CONCLUSIONS  
In this work, the Belief distorted Nash equilibrium theory 
has been combined with DAG-based consortium blockchain 
and Jointgraph consensus algorithm to develop an energy 
trading model for surplus energy trading in local ecosystems. 
The simulations and result evaluations show that the pricing 
strategy based on BDNE theory can reduce the cost of energy 
consumers by about 2%, and increase the benefits for both 
sellers and buyers by about 1.3% compared with the way of 
using NE, instead. In addition, the trading model based on 
DAG-based blockchain technology using Jointgraph as a 
consensus algorithm is better than a similar blockchain using 
a Hashgraph as consensus process in both metrics of 
Throughput and Latency. However, the implemented scenario 
in the simulation of the work is relatively simple, and the 
transaction rate is low in specific durations. So, the evaluation 
463
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:55:17 UTC from IEEE Xplore.  Restrictions apply. 
  
of the ability of the model in real-life application scenarios will 
be considered as future works. 
ACKNOWLEDGMENT 
Department of Electrical and Computer Engineering, 
University of Tehran, Iran. Correspondence: bahrak@ut.ac.ir; 
Tel.: +98-912-450-0195. 
 
REFERENCES 
[1] J. Vergne, â€œDecentralized vs. Distributed Organization: Blockchain, 
Machine Learning and the Future of the Digital Platform,â€ Organ. 
Theory, vol. 1, no. 4, p. 263178772097705, 2020. 
[2] M. K. Thukral, â€œEmergence of blockchain-technology application in 
peer-to-peer electrical-energy trading: A review,â€ Clean Energy, vol. 
5, no. 1, pp. 104â€“123, 2021. 
[3] Y. M. Thibodeau Hafid, D. Makrakis, and E. Elie, â€œAn Ethereum-based 
Energy Trading Protocol (EETP),â€ Proc. - 2020 Int. Conf. Cyber-
Enabled Distrib. Comput. Knowl. Discov. CyberC 2020, pp. 29â€“34, 
2020. 
[4] R. Zhang, R. Xue, and L. Liu, â€œSecurity and privacy on blockchain,â€ 
ACM Comput. Surv., vol. 52, no. 3, 2019. 
[5] T. T. Kuo, J. Kim, and R. A. Gabriel, â€œPrivacy-preserving model 
learning on a blockchain network-of-networks,â€ J. Am. Med. 
Informatics Assoc., vol. 27, no. 3, pp. 343â€“354, 2020. 
[6] D. Gielen, F. Boshell, D. Saygin, M. D. Bazilian, N. Wagner, and R. 
Gorini, â€œThe role of renewable energy in the global energy 
transformation,â€ Energy Strateg. Rev., vol. 24, no. June 2018, pp. 38â€“
50, 2019. 
[7] H. Performance, The Hyperledger White Paper Working Group, and H. 
Performance, â€œHyperledger Blockchain Performance Metrics,â€ 
Hyperledger.org, pp. 1â€“17, 2018. 
[8] A. Baliga, N. Solanki, S. Verekar, A. Pednekar, P. Kamat, and S. 
Chatterjee, â€œPerformance characterization of hyperledger fabric,â€ Proc. 
- 2018 Crypto Val. Conf. Blockchain Technol. CVCBT 2018, pp. 65â€“
74, 2018. 
[9] D. Zhu et al., â€œEnergy trading in microgrids for synergies among 
electricity, hydrogen and heat networks,â€ Appl. Energy, vol. 272, no. 
February, p. 115225, 2020. 
[10] A. Kumari et al., â€œBlockchain-Based Peer-to-Peer Transactive Energy 
Management Scheme for Smart Grid System,â€ Sensors, vol. 22, no. 13, 
p. 4826, Jun. 2022, doi: 10.3390/s22134826.  
[11] C. Long, J. Wu, C. Zhang, L. Thomas, M. Cheng, and N. Jenkins, 
â€œPeer-to-peer energy trading in a community microgrid,â€ IEEE Power 
Energy Soc. Gen. Meet., vol. 2018-Janua, pp. 1â€“5, Jan. 2018. 
[12] W. Tushar et al., â€œEnergy Storage Sharing in Smart Grid: A Modified 
Auction-Based Approach,â€ IEEE Trans. Smart Grid, vol. 7, no. 3, pp. 
1462â€“1475, 2016. 
[13] H. Huang, S. Nie, J. Lin, Y. Wang, and J. Dong, â€œOptimization of peer-
to-peer power trading in a microgrid with distributed PV and battery 
energy storage systems,â€ Sustain., vol. 12, no. 3, 2020. 
[14] S. Park et al., â€œDistributed energy IoT-based real-time virtual energy 
prosumer business model for distributed power resource,â€ Sensors, vol. 
21, no. 13, pp. 1â€“26, 2021. 
[15] C. H. Leong, C. Gu, and F. Li, â€œAuction mechanism for P2P local 
energy trading considering physical constraints,â€ Energy Procedia, vol. 
158, pp. 6613â€“6618, 2019. 
[16] M. F. Dynge, P. Crespo del Granado, N. Hashemipour, and M. KorpÃ¥s, 
â€œImpact of local electricity markets and peer-to-peer trading on low-
voltage grid operations,â€ Appl. Energy, vol. 301, no. April, p. 117404, 
2021. 
[17] D. K. Winter, R. Khatri, and M. Schmidt, â€œDecentralized prosumer-
centric p2p electricity market coordination with grid security,â€ 
Energies, vol. 14, no. 15, 2021. 
[18] Y. Chai, Y. Xiang, J. Liu, C. Gu, W. Zhang, and W. Xu, â€œIncentive-
based demand response model for maximizing benefits of electricity 
retailers,â€ J. Mod. Power Syst. Clean Energy, vol. 7, no. 6, pp. 1644â€“
1650, 2019. 
[19] M. Yu, S. H. Hong, Y. Ding, and X. Ye, â€œAn Incentive-Based Demand 
Response (DR) Model Considering Composited DR Resources,â€ IEEE 
Trans. Ind. Electron., vol. 66, no. 2, pp. 1488â€“1498, 2019. 
[20] N. Z. Aitzhan and D. Svetinovic, â€œSecurity and Privacy in 
Decentralized Energy Trading Through Multi-Signatures, Blockchain 
and Anonymous Messaging Streams,â€ IEEE Trans. Dependable Secur. 
Comput., vol. 15, no. 5, pp. 840â€“852, Sep. 2018. 
[21] C. Deng and K. Wu, â€œResidential demand response strategy based on 
deep deterministic policy gradient,â€ Processes, vol. 9, no. 4, pp. 1â€“16, 
2021. 
[22] Z. Che, Y. Wang, J. Zhao, Y. Qiang, Y. Ma, and J. Liu, â€œA distributed 
energy trading authentication mechanism based on a consortium 
blockchain,â€ Energies, vol. 12, no. 15, Jul. 2019. 
[23] M. E. Honarmand, V. Hosseinnezhad, B. Hayes, and P. Siano, â€œLocal 
energy trading in future distribution systems,â€ Energies, vol. 14, no. 11, 
pp. 1â€“19, 2021. 
[24] W. Zhao et al., â€œConsortium blockchain-based microgrid market 
transaction research,â€ Energies, vol. 12, no. 20, Oct. 2019. 
[25] S. Mohseni, A. C. Brent, and S. Kelly, â€œA hierarchical, market-based, 
non-cooperative game-theoretic approach to projecting flexible 
demand-side resources: Towards more realistic demand response-
integrated, long-term energy planning models,â€ Int. Conf. Eur. Energy 
Mark. EEM, vol. 2020-Septe, pp. 1â€“6, 2020. 
[26] J. G. Song, E. S. Kang, H. W. Shin, and J. W. Jang, â€œA smart contract-
based p2p energy trading system with dynamic pricing on ethereum 
blockchain,â€ Sensors, vol. 21, no. 6, pp. 1â€“27, 2021. 
[27] F. Xiang, W. Huaimin, S. Peichang, O. Xue, and Z. Xunhui, 
â€œJointgraph: A DAG-based efficient consensus algorithm for 
consortium blockchains,â€ Softw. - Pract. Exp., no. July, pp. 1â€“13, 2019. 
[28] Harsanyi, J. C. (1967). Games with incomplete information played by 
bayesian players, part I. Management Science, 14, 159â€“182. 
[29] Aumann, R. J. (1974). Subjectivity and correlation in randomized 
strategies. Journal of Mathematical Economics, 1, 67â€“96. 
[30] Battigalli, P., & Siniscalchi, M. (2003). Rationalization and incomplete 
information. Advances in Theoretical Economics, 3(1). 
[31] Fudenberg, D., & Levine, D. K. (1993). Self-confirming equilibrium. 
Econometrica, 61, 523â€“545. 
[32] Wiszniewska-Matyszkiel, A. Belief distorted Nash equilibria: 
introduction of a new kind of equilibrium in dynamic games with 
distorted information. Ann Oper Res 243, 147â€“177 (2016). 
https://doi.org/10.1007/s10479-015-1920-7 
[33] https://www.hyperledger.org/blog/2018/03/19/measuring-blockchain-
performance-with-hyperledger-caliper 
 
 
464
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 08:55:17 UTC from IEEE Xplore.  Restrictions apply.