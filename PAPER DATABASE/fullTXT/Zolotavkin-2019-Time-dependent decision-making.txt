Time-Dependent Decision-Making and Decentralization in Proof-of-Work Cryptocurrencies
Time-dependent Decision-making and
Decentralization in Proof-of-Work Cryptocurrencies
Yevhen Zolotavkin, Julian Garcia, Joseph K. Liu
Faculty of Information Technology
Monash University, Clayton
3800 Victoria, Australia
Email: yevhen.zolotavkin@monash.edu, julian.garcia@monash.edu, joseph.liu@monash.edu
Abstract—Pool mining is a common way to reduce income
variance for miners in Proof of Work Cryptocurrencies. A vast
majority of mining does happen in pools, where a popular scheme
to distribute rewards is Pay per last N Shares (PPLNS). In PPLNS
and related schemes, miners are frequently making decisions
whose rewards are not immediate and will only manifest in
the future. This implies that models of inter-temporal utility
are relevant when considering the incentives of miners. We
show that when including these features of human behaviour
in models of rational pool miners, the conditions that lead to
decentralisation are hampered because larger pools may be more
attractive to miners. We present a new game theoretical model
of PPLNS where rational miners have time preferences. In this
setup, the incentives of miners to work for a pool depend on
the initial distribution of power between mining pools, as well
as the specific details of how time is discounted. Agents jumping
to larger pools face a trade-off between reducing the expected
payoff from their shares in their current pool, or getting faster
rewards in the future by joining a larger pool. We consider a
case where pools of different mining power have the same size
of reward window N. According to our study, in equilibrium
larger pools have a tendency to accumulate a disproportionate
share of the network power at the expense of smaller pools.
This outcome is prevalent over a large range of realistic model
parameters. Our model shows that PPLNS may be harmful
to the decentralised governance of cryptocurrencies. A way to
ameliorate these negative effects, is to encourage pools to have
diverse window sizes, or use different reward mechanisms. Doing
this in a decentralised fashion is an open challenge.
Index Terms—blockchain, pooled mining, game theory, time
discounting
I. Introduction
A variety of cryptocurrencies rely on the Proof-of-Work
(PoW) principle, whereby consensus is reached solving costly
computation puzzles [1]–[3]. Miners exchange computation
for the chance to earn newly minted currency [4]. Solo mining
entails a very large variance in expected monetary payoffs.
Because miners prefer stable income across time, solo mining
is rare. Instead, miners join pools, in which the benefits of
newly found blocks are shared among the pool members,
guaranteeing a stable and steadier compensation for mining.
Pools have different compensation schemes, determining how
effort translates into monetary payoffs [5], [6].
Pools have adopted a variety of reward schemes, including,
Pay Per Share (PPS), Proportional reward (PROP) and Pay per
Last N Shares (PPLNS). Historically, PPS and PROP where
the first schemes implemented in bitcoin mining pools. With
PPS, miners are immediately compensated for their mining
which requires solving puzzles of a lower complexity which
are called “shares”. Upon submission, every share is rewarded
by the pool manager in proportion to its complexity. On
the other hand, the pool profits from a full block, randomly
appearing among the shares. A strong disadvantage of PPS
is that managers need to absorb the variance associated with
finding full solutions. This is reflected by higher pool fees on
miners [7].
In PROP pools, fees collected from miners are smaller.
However, the rewards are distributed among the shares that
were submitted during one round of mining and only when the
full solution of the puzzle is found by that pool. As a result,
the reward is distributed over a variable number of shares.
Due to this, PROP is vulnerable to “pool hopping” attacks, in
which rational miners increase their returns by switching their
mining activity between different pools [8].
PPLNS promises to reduce the incentives for hopping [9]
while retaining cheaper fees [7], [10]. It is therefore the most
popular mining reward scheme in operation, and its main idea
is to reward only N of the most recent shares preceding the
full solution. This temporal dimension for rewards has strong
implications in decision making, that as we will show, can
ultimately increase centralisation in the network.
Mining decisions (e.g., how much power to allocate across
pools, which pools to join, etc) have immediate costs (elec-
tricity, equipment) but deferred benefits (mining reward). Inter-
temporal utility is accordingly an important factor to consider.
Most rational decision-makers would prefer 100 dollars now
than tomorrow, for a variety of reasons [11]. Thus we say,
that rational decision makers discount the future. By how
much, will depend on their time preferences. The standard
model to capture this basic idea is exponential discounting. In
case of discrete time registration (e.g. days) it is defined by
a discount parameter 0 < δ < 1. Thus, a level of utility u is
worth uδ tomorrow, uδ2 the day after tomorrow and so forth.
Discounting is prevalent in decision-making models involving
a time horizon, and has a wealth of empirical and theoretical
support [12]. Our aim here is to introduce time preferences
into models of rational miners, and to study its consequences.
Time preferences are known and documented in the decision
making literature, and can be compounded by the investment
nature of cryptocurrency mining. To see why consider the
following example. It is common for PPLNS pools to charge
1% fee, while PPS pools charge 2%. In the case of a small
108
2019 IEEE 32nd Computer Security Foundations Symposium (CSF)
© 2019, Yevhen Zolotavkin. Under license to IEEE.
DOI 10.1109/CSF.2019.00015
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 06:37:13 UTC from IEEE Xplore.  Restrictions apply. 
PPLNS pool, a share submitted today will be fully compen-
sated in 2 weeks (on average) [13], [14]. On the other hand,
a PPS pool guarantees same-day compensation. If a miner
decides to mine with PPS pool and immediately deposits her
revenue for 14 days with 1.5% interest [15], she will obtain
0.98×1.015 ≈ 0.995 value out of every share which is greater
than the 0.99 corresponding to PPLNS. Thus, deferred rewards
can only be compared with the immediate compensation
when the appropriate discounting is applied. In the proposed
example, this discount factor is δ = 1.015−
1
14 ≈ 0.9989.
In addition to purely economical motivations, discounting
the future has a broader appeal in technical terms. Pool hard-
ware infrastructure – including central servers and network
equipment – need to remain functional in the future in order to
compensate current mining contribution of a miner. Reliability
of this hardware, often expressed by Time to Failure (TTF), is
exponentially distributed [16]. Likewise, regular and accurate
payments to the miners require that pool accounts remain
secure and protected from malicious cyber attacks. This se-
curity also deteriorates with a probability that is exponentially
dependent on time [17]. Thus, the intrinsic features of the
technical infrastructure add up to the importance of miners
discounting their future rewards.
A. Related work
Questions related to mining decisions and their impact on
blockchain decentralization have been previously discussed
in the cybersecurity literature. In particular, a number of
identified attacks directly concern centralization of mining
power. These include double spending [1], [18]–[20], block
withholding [8], [21], [22], selfish mining [7], [23] among oth-
ers [4], [24], [25]. A number of desirable blockchain properties
can be hampered due to incompatible mining incentives. Game
theoretical models have been shown to be useful in mitigating
these phenomena [26], [27].
While many factors have been studied, including network
characteristics [5], reward systems [28], mechanisms to reduce
payments variance [29] among others; it remains unclear why
compensation times have attracted so little attention [10]. Here,
we show that the time of compensation of individual mining
contributions to the pool is an important tool. It is therefore
necessary to take it into account to encourage a healthy
ecosystem robust to the attacks described in the literature. We
do this by studying the incentives of miners to migrate across
mining pools.
B. Our contribution
We present a new game theoretical model that shows that
miners with reasonable behavioral assumptions have incentives
to migrate from smaller PPLNS pools to larger PPLNS pools.
In order to understand migration incentives we study the
trade-offs between leaving and staying in the initial pool, in
the presence of other more powerful pool. This problem is
tackled by applying standard exponential time discounting. We
show the existence of a Nash equilibrium of the underlying
game and propose an algorithm to efficiently compute this
equilibrium.
We reason that different pools may offer different com-
pensation speeds. This fact may play an important role for
miners who seek to increase their short-term future income.
On the other hand, computational effort that has already been
contributed by the miners (in the past) in their initial pool,
entitles them to certain compensation, according to PPLNS
defined in that pool. In the case of leaving their initial pool, the
rewards for the previous efforts will be received by the miners
at a slower pace. Actions of other miners may dictate a specific
action for each miner because the speed of compensation in
each pool depends on the total power of all its miners. Our
model demonstrates that even marginal differences in pool
size are enough to incentivise small miners to seek larger
pools. This process accelerates when pools have either a high
proportion of small-power miners or higher time-preferences.
The process of migration from smaller to larger PPLNS
pools induces a pool market dominated by a handful of very
large pools – as observed in reality. This centralization of
power, runs counter to the spirit of decentralized cryptocur-
rencies. Large pools getting larger and small pools getting
smaller will ultimately lead to an environment prone harmful
attacks [21], [22], [25]. Our model also suggests how this
“aggregation” effect can mitigated.
The rest of this paper is organized as follows. A game-
theoretical model for competition between PPLNS pools is
presented in Section II. It describes our assumptions about
individual beliefs and the distribution mining power in the fu-
ture. Section III presents a novel method that finds equilibrium
in the system with two PPLNS pools. We analyze different
properties of the system including migration rate, long-term
effect on the utilities of the miners, as well as a sufficient
condition to prevent migration from the smaller pools. We
also present experimental results and discuss their impact on
the security of PoW blockchains are discussed in Section IV.
We present conclusions in Section V.
II. A game-theoretical model of pool competition
A schematic representation of PPLNS on fig. 1 explains
the principle behind the reward scheme for a window size
N = 20 shares. Miners A and B have 40% and 60% of the
power inside the pool, and receive proportional payments to
their shares submitted in two overlapping windows of size N.
Full solutions are not usually considered a valid share and
are excluded from the count. For instance, the most recent
payment is equally divided among 20 shares: 8 shares belong
to miner A and 12 shares belong to miner B fig. 1. As a result,
in this particular example, miners receive 40% and 60% of
block reward, respectively (for simplicity, the mining fees are
not taken into account). Further, we will analyze PPLNS on a
more detailed level.
/ \
\ / \
\
\
\ / \
\ $/ \
\
\
\ / \
\ / / \
\
\
\ / \
\
\
\ $ \
\ / \
\ /\
\
payments ($)
... Miner B
60% of 
Power
\
\
Miner A
40% of 
Power
/
N=20 (excludes $)
......
t  E
Figure 1: Rewards in PPLNS pool with two miners.
We consider a system of two PPLNS pools which is
closed in the sense that nobody either joins nor leaves it. For
109
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 06:37:13 UTC from IEEE Xplore.  Restrictions apply. 
convenience, we regard a continuous model of mining where
total mining power of the system is 1. In contrast to submission
of shares at discrete moments, miners in our model prove their
work by committing energy. They report personal consumption
of (electrical) energy that is used for computations of PoW
puzzle for a particular pool. We assume no network delays,
computational equipment of all miners is equally efficient.
Supposing that miners are never switching off their equipment,
amount of computations delivered by every miner in each
of the pools is determined by her computational power and
pool membership. Continuous nature of our model simplifies
reasoning about future rewards subject to time discounting.
The process of migration between the pools begins at
moment t0 and unfolds in time t ∈ [t0,∞). An elementary
portion of energy consumed by the system on computations
during Δt is ΔE. The corresponding elementary contribution
of miner i with individual power pi is Δtpi = ΔEpi. At
every moment in the interval [t0,∞) each miner finds the best
allocation for her elementary contribution. The choice affects
the reward chances for her past contributions in that pool (as
a result of finding a full solution B of the puzzle). If this
does not happen, her elementary contribution is expected to
be rewarded in the future as a result of mining activity in that
pool.
A. Preliminaries
We assume that every miner in the system is aware of the
past and present moves of other miners. The decisions of all
the miners at time t determine how mining power is distributed
between the pools. In our model, t ∝ E, hence we will express
the quantities of interest as a function of E, instead of t (see
table I for a list of variables and their meaning). These two
views are equivalent, but we will focus on E for simplicity.
Let us discuss competition between pool #1 and pool #2.
Each pool has PPLNS windows N1 and N2 measured as
number of discrete shares. Because we work with a con-
tinuous model, these PPLNS windows are expressed as the
corresponding amounts of mining energy, EN,1 and EN,2. A
schematic picture of the setup is presented in fig. 2. The areas
inside the large bars are used to denote energy consumed
by computations in the corresponding pool. It also includes
shaded areas that represent the contribution of miner i. The
current elementary portion of effort ΔEpi of miner i (small
black rectangle) should be allocated at moment E
′ ≥ E0 to a
pool that provides the best possible utility for that miner.
variable power after
pool #2
pool #1
constant power before
...
...
...
#1 is faster
#2 is faster
discounting
Miner i
#1
#2
?
Past Future
Figure 2: Response of miner i under specific beliefs and time
discounting.
Prior to moment E0 the composition of both pools is
constant, with n miners whose membership to either pool
#1 or pool #2. To denote pool membership we use M1 and
Table I: Main variables
Variable Description
E Total mining energy spent by both pools as for the moment
t
E0, t0 The moment when competition between the pools begins
P∗
1
,
1 − P∗
1
Power of pool #1 and pool #2, resp., at E < E0
pi Individual power of miner i
Fi,1 (E),
Fi,2 (E)
Past contribution of miner i to the pools #1 and #2, resp.,
at moment E
D1,i (E),
D2,i (E)
Estimation of miner i for the discounting coefficients in the
pools #1 and #2, resp.
M1,M2 Sets of indices of miners, who work at E < E0 for pool #1
and pool #2, resp.
ME
′
1
,ME
′
2
Sets of indices of miners, who work at E
′ ≥ E0 for pool
#1 and pool #2, resp.
N1, N2 Size (in numbers of shares) of the reward windows for
pool #1 and #2, resp.
EN,1,
EN,2
Size (amounts of energy) of the reward windows for pool
#1 and #2, resp.
R Monetary reward for mining block B
ψ1 (E),
ψ2 (E)
Power of pool #1 and pool #2, respectively, at moment E
ψ1,i (E),
ψ2,i (E)
Individual estimation of miner i (using beliefs) for power
of pool #1 and pool #2, respectively, at moment E
Ψ1,i, Ψ2,i Individual constant estimation of miner i (using beliefs) for
power of pool #1 and pool #2, respectively
Ψ1, Ψ2 Constant power of pool #1 and pool #2, respectively, in
equilibrium at E ≥ E0
f (E−E0) Discounting that a miner makes at E0 for the future reward
collected at E ≥ E0
k Parameter of exponential and discounting
θ Discount coefficient such that θ = kEN,1
bi (E) Best response of miner i at moment E
Ui,1 (E),
Ui,2 (E)
Utilities of miner i at moment E for selecting pool #1 or
#2, respectively
Ũi (E) Comparative utility (pool #1 vs #2) of miner i at moment E
Ci,1, Ci,2 Cumulative utilities of miner i for “stay” and “leave”, resp.
C∗i,1 Cumulative utility of miner i ∈M1 for the “no competition
– no move” mining scenario
Qi Indicator of relative change of cumulative utility of miner i
M2; such that i ∈ M1 indicates miner i is in pool #1. We
assume M1∩M2 = ∅. The total power of each pool is P∗1 and
1 − P∗1, respectively. Without loss of generality, we condier
P∗1 ≤ 0.5. Membership of the miners can change during the
interval [E0, ∞) as a result of miners migrating across pools. In
order to calculate her utility, a miner i should estimate possible
monetary compensations associated with the past (index P)
and the future (index F ) performance of the system.
The past and future distribution of the power between
the pools determines the incentives of miner i. The past
distribution of mining power between the two pools, ψ1 (E)
and ψ2 (E), E ≤ E
′
, are unique and known to every miner.
The future distribution is unknown, however, every miner i can
estimate ψ1,i (E) and ψ2,i (E) for pool #1 and #2, respectively,
E ≥ E
′
, based on prior beliefs.
The importance of personal beliefs for the decisions that
are made at E
′
can be illustrated with the following example.
Suppose miner i expects that between moments E
′
and E
′′
pool
#1 carries out more computations than pool #2, but expects the
opposite in the interval E
′′
and E
′′′
(see fig. 2). Other miners
also have (potentially different) personal beliefs and make their
choices between E
′
and E
′′′
. The behavior of all the miners in
the whole interval E ∈
[
E
′
, E
′′′]
defines the actual power of the
110
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 06:37:13 UTC from IEEE Xplore.  Restrictions apply. 
pools. The beliefs held by each miners can be assessed against
evidence in the future. For some miners, the actual power of
the pools at E ∈
[
E
′
, E
′′′]
, may contradict their initial beliefs.
For instance, the described beliefs of miner i are not consistent
if
E
′′∫
E′
ψ1(E)dE ≤
E
′′∫
E′
ψ2(E)dE or
E
′′′∫
E′′
ψ1(E)dE ≥
E
′′′∫
E′′
ψ2(E)dE. In
our approach, we only consider beliefs that are consistent for
every miner at any moment E ≥ E0. This is not a stringent
assumption, since we assume all players are rational.
Let us discuss utility and best response of miner i. We
denote the response of miner i as bi (E) where bi (E) = 0
indicates her choice of pool #1 and bi (E) = 1 indicates of
choice of pool #2. Then, the functions for the past distribution
of power are defined as:
ψ1 (E) =
⎧⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎩
P∗1, if E < E0;
n∑
j=1
p j
(
1 − b j (E)
)
, if E ≥ E0;
ψ2 (E) =
⎧⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎩
1 − P∗1, if E < E0;
n∑
j=1
p jb j (E), if E ≥ E0.
The utility for selecting pool #1 will be denoted Ui,1
(
E
′)
.
Similarly, Ui,2
(
E
′)
will denote the utility for selecting pool
#2. These utilities should account for components related to
the past and future of the system (see fig. 2).
Let us start by discussing the past. The immediate effort
piΔE of miner i that is produced at E
′
rewards her past
contribution only if she discovers full solution. This will
happen with probability piPr
(
B
∣∣∣ΔE)
, where Pr
(
B
∣∣∣ΔE)
is the
chance of finding a full solution B by spending energy ΔE.
As a result of this, the pool of her choice will be rewarded
with a monetary value R. The components for past rewards
are:
UP
i,1
(
E
′)
= RpiPr
(
B
∣∣∣ΔE)
Fi,1
(
E
′)
,
UP
i,2
(
E
′)
= RpiPr
(
B
∣∣∣ΔE)
Fi,2
(
E
′)
.
Here, the parameters Fi,1
(
E
′)
and Fi,2
(
E
′)
indicate cumulative
effort of the miner relatively to the total computational effort in
each pool. These parameters are calculated using information
from the most recent PPLNS windows of size EN,1 and EN,2,
respectively.
The values of parameters Fi,1
(
E
′)
and Fi,2
(
E
′)
are deter-
mined by ψ1 (E), ψ2 (E), and bi (E), fig. 3. We will calculate
Fi,1
(
E
′)
and Fi,2
(
E
′)
using intervals
[
Ě1, Ê1
]
and
[
Ě2, Ê2
]
for pool #1 and pool #2, respectively. The upper interval
bounds are defined such that ∃l ≤ n
(
bl(Ê1) = 0, Ê1 ≤ E
′)
and
∃m ≤ n
(
bm(Ê2) = 1, Ê2 ≤ E
′)
but �l ≤ n
(
bl(E) = 0, E > Ê1
)
and �m ≤ n
(
bm(E) = 1, E > Ê2
)
. For example, in the dia-
gram for the calculation of Fi,1
(
E
′)
and Fi,2
(
E
′)
on fig. 3
the right endpoints for both pools coincide with the current
moment E
′
. In general, it is required that at least one of
them coincides with E
′
. The lower interval bounds are defined
such that
Ê1∫
Ě1
ψ1(E)dE = EN,1 and
Ê2∫
Ě2
ψ2(E)dE = EN,2. Fractional
contributions of miner i to pools #1 and #2 are computed as
Fi,1
(
E
′)
=
1
EN,1
Ê1∫
Ě1
pi (1 − bi(E)) dE,
Fi,2
(
E
′)
=
1
EN,2
Ê2∫
Ě2
pibi(E)dE .
(1)
Figure 3: Calculation of past contribution of miner i in both
pools at moment E
′
.
If miner i is not successful in finding a full solution B for
the chosen pool at moment E
′
, her elementary contribution
piΔE will be rewarded in the future. This will happen with
probability 1 − piPr
(
B
∣∣∣ΔE)
. The monetary value of her con-
tribution RpiPr
(
B
∣∣∣ΔE)
will be reimbursed throughout some
time which duration may be different for each pool. Rational
agents valuate reward paid in such form at a level which
is lower compared to the equivalent monetary value that is
payed instantly. The corresponding coefficients that discount
monetary reward of miner i at moment E
′
will be denoted as
D1,i(E
′
) and D2,i(E
′
) for pool #1 and pool #2, respectively.
Therefore, for miner i, components of total utilities that are
associated with future performance of corresponding pool can
be expressed as
UF
i,1
(
E
′)
=
(
1 − piPr
(
B
∣∣∣ΔE))
RpiPr
(
B
∣∣∣ΔE)
D1,i(E
′
) ,
UF
i,2
(
E
′)
=
(
1 − piPr
(
B
∣∣∣ΔE))
RpiPr
(
B
∣∣∣ΔE)
D2,i(E
′
) .
Let us express discount coefficients D1,i(E
′
) and D2,i(E
′
).
Their values depend on the speed of future compensation. This
is reflected by discounting function f (E − E′
) ∈ (0, 1) which
is decreasing in E ≥ E
′
. A new influx of ΔE energy into
the system at E implies that ψ1,i(E)ΔE is consumed by pool
#1. In expectation, this mining activity induces compensation
that is
ψ1,i(E)ΔE
EN,1
in proportion to the total monetary reward,
RpiPr
(
B
∣∣∣ΔE)
, for miner i. Her contribution made at E
′
is
111
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 06:37:13 UTC from IEEE Xplore.  Restrictions apply. 
eligible for payments as long as it is within the most recent
portion EN,1. We denote È1 the moment when cumulative
amount of energy that has been used by pool #1 since E
′
equals to EN,1. Therefore, discount coefficients for miner i at
moment E
′
are calculated as
D1,i(E
′
) =
1
EN,1
È1∫
E′
ψ1,i(E) f (E − E′
)dE ,
D2,i(E
′
) =
1
EN,2
È2∫
E′
ψ2,i(E) f (E − E′
)dE ,
(2)
where
È1∫
E′
ψ1,i(E)dE = EN,1 and
È2∫
E′
ψ2,i(E)dE = EN,2 for pool #1
and pool #2, respectively.
Complete utilities for selecting pool #1 and pool #2 are
Ui,1
(
E
′)
= UP
i,1
(
E
′)
+ UF
i,1
(
E
′)
and Ui,2
(
E
′)
= UP
i,2
(
E
′)
+
UF
i,2
(
E
′)
, respectively. Substituting the corresponding expres-
sions for the utilities for the past and the future, we obtain
Ui,1
(
E
′)
= RpiPr
(
B
∣∣∣ΔE) (
Fi,1
(
E
′)
+
(
1 − piPr
(
B
∣∣∣ΔE))
D1,i(E
′
)
)
,
Ui,2
(
E
′)
= RpiPr
(
B
∣∣∣ΔE) (
Fi,2
(
E
′)
+
(
1 − piPr
(
B
∣∣∣ΔE))
D2,i(E
′
)
)
.
In order to play a best response at E
′
, miner i should
select the pool yielding greater utility. Hence, the sign of the
expression Ui,1
(
E
′)−Ui,2
(
E
′)
determines best response bi
(
E
′)
.
Further we will use comparative utility Ũi
(
E
′)
such that
Ui,1
(
E
′) − Ui,2
(
E
′)
= RpiPr
(
B
∣∣∣ΔE)
Ũi
(
E
′)
.
Taking into account that RpiPr
(
B
∣∣∣ΔE)
is non-negative we
arrive to
sgn
(
Ui,1
(
E
′) − Ui,2
(
E
′))
= sgn
(
Ũi
(
E
′))
,
where sgn(·) is the signum function.
We use that lim
ΔE→0
[
1 − piPr
(
B
∣∣∣ΔE)]
= 1 to obtain:
Ũi
(
E
′)
= Fi,1
(
E
′)
+D1,i(E
′
) − Fi,2
(
E
′) −D2,i(E
′
) , (3)
which represents incentives of miner i. The best response is
bi
(
E
′)
=
⎧⎪⎪⎨⎪⎪⎩
0, if Ũi
(
E
′) ≥ 0;
1, if Ũi
(
E
′)
< 0.
(4)
Future compensations entail more elaborate calculations for
Ũi
(
E
′)
. Unlike ψ1(E) and ψ2(E), the functions ψ1,i(E) and
ψ2,i(E) represent the estimates of miner i only. In the future,
these individual estimations (or indirect beliefs about them)
can be verified because functions ψ1(E) and ψ2(E) will be
updated based on the known best responses of all miners. As
expressed before, we will assume consistent beliefs at any
E ≥ E0.
We proceed as follows. Lemma 1 and Lemma 2 deal with
the consistency of specific beliefs, allowing us to state that
there is a Nash equilibrium and it is reached at moment E0.
In order to define all the possible configurations of equilibrium
we will consider a special case of our model of miners’
incentives where E
′
= E0. For time discounting we will use
the exponential function, as is often standard in models with
discounting. Based on the properties of this discounting model,
an efficient algorithm for equilibrium search will be developed
and its complexity will be estimated. Finally, in the experiment
section, we will analyze influence of several parameters of the
system including initial distribution of mining power in the
pools and the degree of time preference on the characteristics
of equilibrium as well as its consequences for miners.
B. Payoff function with consistent beliefs
We will focus on the case when EN,1 = EN,2, with specific
beliefs about the values of ψ1,i (E) and ψ2,i (E) that will be
shown to be consistent. We will focus for now on pure strategy
Nash equilibria and how to find it. N may vary for different
pools, however, as general rule N = kD where D expresses
current puzzle complexity over the average number of required
shares, and k is usually a small integer number (e.g. 1, 2 or
5). This convention among pool administrators causes many
different pools to have same value of N. In some cases, this
number remains constant for a pool during long period of time
due to the conservative attitudes of pool miners who oppose
frequent changes [13], [14]. Next, we will introduce game-
theoretical settings and definitions that will be applied to our
model.
The process of migration of miners between the pools
will be studied in the context of game-theoretical framework.
Due to the continuous nature of the mining model, the game
between the pools is an infinitely repeated game. The game
begins at the moment t0 and progresses through time t. For
the closed system, there is an equivalence between time and
total energy that is spent on computations by the both pools.
Therefore, notations E0 and E will be used to designate
corresponding moments.
At any moment E ≥ E0, the strategy of miner i will be
encoded using set S =
{
0, 1
}
. Different moves of miner i,
si = 0 and si = 1 indicate mining in pool #1 and pool #2,
respectively. Strategy profile at moment E ≥ E0 is a vector
sE =
{
sEi
}n
i=1, sE ∈ S n. We will use sE−i =
{
sEj
}n
j=1
j�i
to denote
strategy profile that excludes move of miner i.
Definition 1. For miner i observing strategy profile sE
′
−i at
moment E
′ ≥ E0 beliefs about the distribution of mining power
(between the pools #1 and #2, respectively) in the future, at
E ≥ E
′
, are represented by functions ψ1,−i (E) and ψ2,−i (E):
ψ1,−i (E) =
n∑
j=1, j�i
(
1 − sE′j
)
p j, ψ2,−i (E) =
n∑
j=1, j�i
sE
′
j p j .
To discuss the incentives of miner i, we use functions
ψ1,i (E) = ψ1,−i (E) + pi, and ψ2,i (E) = ψ2,−i (E) + pi. For
any E
′ ≥ E0 utility of miner i is a function Ui
(
E
′
, sE
′
i , sE
′
−i
)
:
E
′ × S n → R.
112
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 06:37:13 UTC from IEEE Xplore.  Restrictions apply. 
Definition 2. Best response of miner i at moment E′ ≥ E0
is represented using function bi
(
E
′
, sE
′
−i
)
: E
′ × S n−1 → {0, 1},
such that Ui
(
E
′
, bi
(
E
′
, sE
′
−i
)
, sE
′
−i
)
≥ Ui
(
E
′
, 1 − bi
(
E
′
, sE
′
−i
)
, sE
′
−i
)
.
We simplify the notation, by using bi
(
E
′)
= bi
(
E
′
, bE
′
−i
)
,
Ũi
(
E
′) ∝ Ui,1
(
E
′) − Ui,2
(
E
′)
, where Ui,1
(
E
′)
= Ui
(
E
′
, 0, bE
′
−i
)
,
Ui,2
(
E
′)
= Ui
(
E
′
, 1, bE
′
−i
)
under assumption that prior to mo-
ment E0 the distribution of mining power between the pools
is such that ∀ j ∈M2
(
P∗1 + p j < 0.5
)
. It will be demonstrated
that given assumption is sufficient to guarantee at least one
Nash equilibrium at E ≥ E0 with a profile bE0 . Some intuition
about the equilibrium can be gained from the fact that for
every member of the larger pool, best response is to remain
in it.
Remark 1. [Larger pool discounts less] We consider 2 pools
for which mining power is expressed with the functions ψ
′
(E)
and ψ
′′
(E) for pool #1 and pool #2, respectively.
∀E ≥ E0
(
ψ
′′
(E) ≥ ψ
′
(E) ≥ 0
)
∧
( E′′∫
E0
ψ
′
(E) dE =
E
′∫
E0
ψ
′′
(E) dE
)
�
�
E
′∫
E0
f (E − E0)ψ′′
(E) dE ≥
E
′′∫
E0
f (E − E0)ψ′
(E) dE
if the discounting function f (E − E0) ≥ 0 is monotonically
decreasing on E ∈ [E0, ∞). (See section A)
Based on the result of remark 1 we can reason that condition
∀ j ∈M2
(
P∗1 + p j < 0.5
)
prevents miners in M2 from joining
pool #1. This allows us to restrict the study of incentives of
switching between the pools (at different moments in time)
to the set M1 of miners only. Next, we present results from
lemma 1 and lemma 2 and discuss them in the context of
Perfect Subgame Equilibrium (PSE) at every instance E
′ ≥ E0
of the game (for the proof see section B). We adopt notations
ME
′
1 and ME
′
2 to refer to the set of all miners working at E
′
for pool #1 and pool #2, respectively (see table I).
Lemma 1. ∀E′
, E
′′
if
(
∀ j ∈M2
(
P∗1 + p j < 0.5
)
∧
(
E
′′ ≥ E
′ ≥
E0
))
then ME
′
2 ⊆ME
′′
2 .
The fact that no miner ever leaves pool #2 guarantees that
there is an equilibrium. The moment when equilibrium is
achieved depends solely on the actions of miners from pool
#1. Next, we will point out that if a miner leaves pool #1,
her dominant strategy is to do so at E0.1 (for the proof see
section B).
Lemma 2. ∀E′
if
(
∀ j ∈M2
(
P∗1 + p j < 0.5
)
∧
(
E
′ ≥ E0
))
then
ME0
1
⊆ME
′
1 .
As a result, neither set ME
1 nor set ME
2 ever lose their
elements on (E0, ∞) and PSE is guaranteed. Another important
conclusion about results of lemma 1 and lemma 2 is that
ψ1,i(E) and ψ2,i(E) are indeed constants on (E0, ∞) which
connotates that assumption about the future expressed in
1Meaning of notation M1 should be distinguished from the meaning of
ME0
1
where the first specifies miners in pool #1 prior to E0, while the second
defines miners who are mining for pool #1 at E0.
definition 1 is correct. Further in the paper, estimations of
miner i about future power for pool #1 and pool #2 will be
referred as Ψ1,i and Ψ2,i, respectively.
Lastly, soundness of the results requires validity of premise
∀ j ∈M2
(
P∗1 + p j < 0.5
)
. Nevertheless, given condition is
sufficient, but not necessary to reach an equilibrium at E0.
Besides that, cases with near equal mining power of two
random PPLNS pools are quite rare. This supports soundness
on practice.
We aim at analyzing possible profiles of equilibrium
and discuss consequences for the community of PoW min-
ers including questions of decentralization of corresponding
blockchains. This requires algorithm that is computationally
efficient for the pools with large number of miners. The task
demands a closer investigation of properties of utility functions
that may include different time-discounting models.
Let us reason about properties of the mining utility. For each
miner, strategy profile consists of two possible actions, which
in case of brute-force approach to the search of equilibrium
would require 2n operations. Therefore, even for pools with a
moderate number of miners, brute-force search for equilibrium
is not feasible. Here we discuss on how results of lemma 1,
lemma 2 and properties of utility functions can be used to
design a more efficient algorithm to find equilibrium at E0.
We will discuss properties of miner utilities that are depen-
dent on selection of discounting function f (E − E0). Exponen-
tial discounting function is one of the most popular [12]. It is
defined as f (E − E0) = e−k(E−E0), where k specifies intensity of
time discounting. We substitute parameters k with expression
k = θ
EN
, θ ≥ 0. For instance, for the monetary reward obtained
at E = E0 + EN discount factor is e−θ.
Results of lemma 1 suggest that miners who leave pool
#1 never return back. Assuming there are n1 =
∣∣∣M1
∣∣∣ miners
prior to moment E0, we re-initiate the procedure that searchers
for a new candidate to leave the pool among the remain-
ing miners. Maximum number of operations in that case is
n1∑
i=1
i = 0.5n(n − 1) which corresponds to O(
n2
)
. Further, we
will address property that will allow to reduce complexity to
O(
n
)
for the case when information about power of miners is
in the form of a sorted array.
Let us analyze utility of miner i. According to eqs. (1)
and (2), Fi,1 (E0) =
pi
P∗
1
, Fi,2 (E0) = 0, D1,i(E0) =
Ψ1,i
EN
E0+
EN
Ψ1,i∫
E0
f (E − E0)dE, D2,i(E0) =
Ψ2,i
EN
E0+
EN
Ψ2,i∫
E0
f (E − E0)dE.
According to eq. (3), utility that is using exponential discount-
ing function has expression of
Ũi (E0) =
pi
P∗
1
+
Ψ1,i
EN
E0+
EN
Ψ1,i∫
E0
e−θ
(E−E0)
EN dE −
− Ψ2,i
EN
E0+
EN
Ψ2,i∫
E0
e−θ
(E−E0)
EN dE =
=
pi
P∗
1
+
Ψ1,i
θ
(
1 − e− θ
Ψ1,i
)
− Ψ2,i
θ
(
1 − e− θ
Ψ2,i
)
.
(5)
113
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 06:37:13 UTC from IEEE Xplore.  Restrictions apply. 
The following results will allow to reduce the number of
computations and to discuss conditions when none of the
miners in pool #1 has incentive to join pool #2. Their proofs
(see section C) use some of the results from lemmas 1 and 2.
Corollary 1. Under exponential discounting,
∀Ψ1,i, ∀θ ≤ 0.5
(
∂ Ũi(E0)
∂pi
≥ 0
)
.
Domain θ ∈ [0, 0.5] is sufficient to represent intensity of
time discounting for the majority of rational miners. Higher
values of discount parameters are associated with extremely
impatient miners. For example, in case θ = 0.5, a miner at E0
should valuate the reward that she will obtain at E0 + EN as
e−0.5 ≈ 61%.
The presented outcomes indicate that miners with smaller
power pi have greater incentive to leave pool #1. Using results
of lemmas 1 and 2 as well as corollary 1 we will design an
efficient method to find pure strategy Nash equilibrium which
is suitable in the context of the proposed discounting function.
We will also question sufficient individual power to stay in
pool #1.
III. Method, Equilibrium and its characteristics
A. Method to find equilibrium
The method to find Nash equilibrium between two PPLNS
pools can be described as (fig. 4):
1) Sort the indices of all the miners in pool #1 in ascending
order according to their power, so that ∀i, pi ≥ p1;
2) Execute |M1| steps of the algorithm. On step i of the
algorithm, verify the incentive to leave (e.g. if Ũi < 0 is
true) for the miner with power pi and Ψ1,i = P∗1 −
i−1∑
l=1
pl,
record her decision as best response bi. After step |M1|,
return vector b.
3) Analyze if b is either: i) “all 0”; ii) “all 1”; iii) contains
‘0’ and ‘1’. In the cases i) and ii) there is only one
possible equilibrium which is “all stay in pool #1” and
“all leave pool #1”, respectively. However, in case iii)
there may be more than one equilibrium.
Table II: Distribution of mining power (normalized) in Kano
pool
Power range
Number of miners Total powerpmin pmax
4.3 × 10−8 0.0048 692 26.29%
0.0053 0.0081 7 4.36%
0.0102 0.015 4 4.93%
0.0166 0.0185 2 3.51%
0.0247 0.0247 1 2.47%
0.0374 0.0374 1 3.74%
0.0443 0.0443 1 4.43%
0.0706 0.0706 1 7.06%
0.1875 0.1875 1 18.75%
0.2445 0.2445 1 24.45%
B. Experimental evaluation of equilibrium between two
PPLNS pools
The resulting size of pool #1, Ψ1, depends on the initial
power P∗1, distribution, and discounting. With the aim to
estimate the severity of changes caused by miners leaving
the pool, we run computer simulation. Data about distribu-
tion of mining power was collected from Kano pool, which
Figure 4: Diagram for the method to find equilibrium.
Distribution D is obtained from Kano pool, normalized
set,
∑
D Dl = 1.
incorporates 711 miners table II. As it can be seen from the
table, according to individual mining power of the miners, their
distribution is significantly skewed. The data is normalized
(total mining power sums to 1) and is denoted as D on
the diagram fig. 4. Despite the fact that many equilibria are
possible, on practice outcomes with more than one equilibrium
were rare and occurred for P∗1 ≈ 0.5.
Exponential discounting function was used for the exper-
iment, with 0 < P∗1 < 0.5, θ ∈ (0, 0.1]. Fraction of mining
power that is fleeing pool #1 in equilibrium was calculated
and is depicted on fig. 5. It can be seen from there that the
fraction is quickly increasing with θ, and, decreasing with P∗1.
On the both plots, there are noticeably large areas of a single
color, meaning that the fleeing fraction remains stable even
if P∗1 decreases and θ increases. This can be explained by
highly disproportional power distribution inside the pools on
practice, where vast majority are small miners, and few miners
have significant power. In that regard, an important question
to ask is the minimum power requirement that can provide
resistance to pool migration. Such condition may be sufficient
for decentralized PoW mining.
C. Sufficient individual power for incentive compatible mining
in pool #1
We question the lower limit for individual power that guar-
anties incentive compatible mining in pool #1 for a miner in
that pool. According to corollary 1, that condition is sufficient
for more powerful miners to stay in pool #1, too. The value of
sufficient individual power (SIP) is dictated by initial power of
pool #1, P∗1, and discount parameter θ . The latter is an intrinsic
characteristic of miners’ valuations and do not change over
time. However, P∗1 may change if new miners join the pool,
or current miners leave due to the reasons other than migration
to pool #2. In order to provide practical recommendations
for SIP, we remove previously agreed constraints of a closed
system of two PPLNS pools. Since P∗1 may change its exact
value is unknown. We consider the worst case scenario for
that parameter. We plot SIP as empirical dependencies S (θ),
(fig. 6):
114
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 06:37:13 UTC from IEEE Xplore.  Restrictions apply. 
Figure 5: Fraction of the mining power of pool #1 that
is fleeing to pool #2 under given θ and P∗1.
S (θ) = max
P∗
1
min{Ũ1≥0 | θ, P∗
1}
p1 = max{P∗1|Ũ1=0, θ} p1,
where P∗1 ∈
[
2p1, 0.5) which is explained by the fact that a
pool should have at least two miners with SIP. For instance, a
practical recommendation that can be retrieved from the graphs
for discount factor at 0.1 is to compose pool #1 from the
miners which power is larger than 3% of the total power (of
both pools).
Figure 6: Sufficient individual power (SIP) for incentive com-
patible mining in pool #1.
D. Effect of equilibrium on cumulative utility of miners from
pool #1
In case when requirement for SIP is not satisfied miners
may leave pool #1. Migration of miners from pool #1 to pool
#2 affects their long-term valuations. Miners from pool #2 are
in a more advantageous position as they never abandon their
pool, their individual past contributions are always rewarded,
and, total power of their pool increases which according to
remark 1 guarantees better valuations for the future rewards.
On the other hand, miners from pool #1 may suffer losses.
We express relative change in long-term expectations of these
miners.
For each miner i from pool #1 we calculate her cumulative
utility, Ci,1 or Ci,2 for bi (E0) = 0 or bi (E0) = 1, respectively,
see section D. The utility is calculated over E ∈ [E0, ∞] and
is defined by parameters P∗1 and θ, equilibrium profile, total
power Ψ1 of pool #1, individual mining power pi. This is
further compared with the cumulative utility C∗
i,1 of miner i for
the hypothetical case when no miner leaves pool #1, Ψ1 = P∗1.
The indicator of relative changes in cumulative utility is
determined as
Qi =
⎧⎪⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎪⎩
Ci,1 −C∗
i,1
C∗
i,1
, if bi (E0) = 0;
Ci,2 −C∗
i,1
C∗
i,1
, if bi (E0) = 1.
Value of Qi was computed for every miner in pool #1, with
θ and θ∗ taking values from diapason [0, 0.1]. The indices were
assigned to the miners sorted in ascending order, according to
their power, e.g. ∀i, pi ≥ p1, see fig. 7.
Figure 7: Indicator Qi of relative change of cumulative
utility for exponential discounting function, initial power
of pool #1, P∗1 = 0.3.
From the results it is observable that, under exponential
discounting function, indicator Qi is decreasing with P∗1. This
is explained by the impact of a more powerful pool #2 on
miners with bi (E0) = 1. In equilibrium, the lower estimate
for its power is 1 − P∗1. This fosters faster compensation for
smaller P∗1.
Value of Qi is increasing with θ. That is explained by
the importance of time discounting which is increasing. This
amplifies the incentives to join more powerful pool for miners
with bi (E0) = 1.
Finally, the effect of equilibrium between the two pools
is not equal for different miners. Under the same discount
parameter θ, indicator Qi is comparable for all except few most
powerful miners, which performance is significantly worse.
115
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 06:37:13 UTC from IEEE Xplore.  Restrictions apply. 
This is due to the fact that they face a tough dilemma between
benefiting from their (substantial) past contributions in pool #1
or faster future reward in pool #2.
IV. Discussion
Our model describes the incentives of miners to join differ-
ent PPLNS pools. It takes into account the essential aspects of
pooled mining, including compensation of past contributions
as well as expected reward for her future activity. The latter
is analysed using standard time discounting, which has strong
implications for the model outcomes. Based on the proposed
model we conclude that under the condition N1 = N2 miners
will tend to migrate from smaller to larger PPLNS pools. It
should be stressed that without time discounting D1,i = D2,i
(see eq. (3)), which means none of the miners has an incentive
to leave their initial pool. Hence, game theoretical models
that do not include time discounting may underestimate the
existing risk of centralization in PoW cryptocurrencies.
It is important to consider the beliefs of the miners and
substantiate how they align with the future observations. This
us done by analyzing a special case where we proposed defini-
tion 1 and demonstrated in lemmas 1 and 2 that the proposed
beliefs are indeed consistent. As a result, an equilibrium exists
in the system of two pools and should be reached at moment
E0. The Result of corollary 1 supports our thesis that miners
with lower mining power have stronger incentive to abandon
smaller pool in favor of a larger one. This allowed to design
an efficient method to find Nash equilibrium which complexity
is only O (n). The property discussed in corollary 1 is more
profound for the case of higher time preference which is
defined by parameter θ, and disproportionally divided mining
power of the pools which is defined by value of P∗1. For
example, from fig. 5 it can be noticed that under very moderate
intensity of time discounting, near half of the pool hash power
is fleeing to a larger pool if the initial power distribution
between two PPLNS pools is 30% vs 70%.
Our study of the changes in mining power of PPLNS pools
with the same size of reward window can be interpreted for
the systems with more than two pools. For such case, the
incentives to leave a pool can be calculated by comparing
individual utilities of independent miners in that pool with
the utilities that can be obtained by the miners in the most
powerful pool in the system.
The redistribution of mining power can cause a nega-
tive effect on decentralized governance of cryptocurrencies,
their resilience to attacks, and public trust. As a practical
recommendation to the administrators of PPLNS pools, the
authors suggest to control incentives of the affiliated miners
by adjusting the size of rewarding windows for each pool
individually. The intuition to such recommendation can be
gained from eq. (5) and the fact that θ = kEN . For instance,
for k that is the same for both pools, condition Ψ1,i
EN,1
≥ Ψ2,i
EN,2
is
sufficient to make utility Ũi (E0) positive. Yet another approach
to avoid deterioration of the pool performance is to compose
it only from miners whose individual power is higher than
corresponding SIP (fig. 6).
Our results may seem contradictory to previous research on
this topic. This is due to the specifics of PPLNS and time
discounting, two essential factors often not taken into account
in modelling exercises. For example, [5] concludes non-
existence of equilibria. We, on the other hand, demonstrate
that there is an equilibrium in the system of PPLNS pools.
The argument that supports our statement can be found in
the utility eq. (5) which contains components representing a
fraction of past contribution of miner i in the pool of her
initial membership. In the alternative pool, this component
cannot be immediately obtained, which reflects the inertia of
the system, thus making frequent migration between the pools
hardly rational.
In future work, we plan to investigate scenarios of a higher
complexity including: larger number of competing pools;
different sizes of PPLNS reward window, and different time
preferences for different miners.
V. Conclusions
In this paper, we analyzed miner-driven redistribution of
mining power between the pools supporting PoW cryptocur-
rencies. We looked at competition between two PPLNS pools
with the same parameter N. This is explained by the fact that
PPLNS pools constitute significant part of mining power in
PoW blockchains [4], [8]. This redistribution has a direct effect
on centralization, which in turn leads to severe and harmful
attacks [20], [21].
We proposed a new game theoretical model describing
miners incentives to migrate between the pools and designed
an efficient method to find Nash equilibrium. Our model high-
lights the importance of realistic and documented behavioural
assumptions in models of decision making in the context of
pooled mining. In particular, time preferences here are shown
to play a crucial role in the predictions of the model and its
security implications. To the best of authors expertise, this is
the first case of utilizing inter-temporal utility in modelling of
miners incentives to migrate between the pools.
Our results demonstrate that even moderate time discounting
can cause migration of miners from smaller pools to larger
pools. These results are obtained when modelling specific
features of human behavior (i.e., time discounting) as well as
specifics of pool mining (PPLNS). We thus posit that the effect
of different mining schemes in centralisation is underplayed in
discussions about security.
Finally, we provide an intuition for how the negative ef-
fects of power redistribution can be mitigated by individually
adjusting the parameter N – window size – in each of the
competing PPLNS pools.
116
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 06:37:13 UTC from IEEE Xplore.  Restrictions apply. 
REFERENCES
References
[1] Nakamoto, Satoshi, “Bitcoin: A peer-to-peer electronic
cash system”, 2008, Online; accessed 29 January 2016.
[2] G. Malavolta, P. Moreno-Sanchez, A. Kate, M. Maffei,
and S. Ravi, “Concurrency and privacy with payment-
channel networks”, in Proceedings of the 2017 ACM
SIGSAC Conference on Computer and Communications
Security, ser. CCS ’17, Dallas, Texas, USA: ACM,
2017, pp. 455–471, isbn: 978-1-4503-4946-8. doi: 10.
1145/3133956.3134096. [Online]. Available: http://doi.
acm.org/10.1145/3133956.3134096.
[3] I. Giechaskiel, C. Cremers, and K. B. Rasmussen,
“When the crypto in cryptocurrencies breaks: Bitcoin
security under broken primitives”, IEEE Security &
Privacy, 2018. [Online]. Available: https://publications.
cispa.saarland/2656/.
[4] Y. Zolotavkin, J. Garcı́a, and C. Rudolph, “Incentive
compatibility of pay per last n shares in bitcoin mining
pools”, in Decision and Game Theory for Security,
S. Rass, B. An, C. Kiekintveld, F. Fang, and S. Schauer,
Eds., Cham: Springer International Publishing, 2017,
pp. 21–39, isbn: 978-3-319-68711-7.
[5] Y. Lewenberg, Y. Bachrach, Y. Sompolinsky, A. Zo-
har, and J. S. Rosenschein, “Bitcoin mining pools: A
cooperative game theoretic analysis”, in Proceedings
of the 2015 International Conference on Autonomous
Agents and Multiagent Systems, ser. AAMAS ’15, Istan-
bul, Turkey: International Foundation for Autonomous
Agents and Multiagent Systems, 2015, pp. 919–927,
isbn: 978-1-4503-3413-6. [Online]. Available: http://dl.
acm.org/citation.cfm?id=2772879.2773270.
[6] A. Zamyatin, K. Wolter, S. Werner, P. G. Harrison,
C. E. A. Mulligan, and W. J. Knottenbelt, “Swim-
ming with fishes and sharks: Beneath the surface of
queue-based ethereum mining pools”, in 2017 IEEE
25th International Symposium on Modeling, Analysis,
and Simulation of Computer and Telecommunication
Systems (MASCOTS), Sep. 2017, pp. 99–109. doi: 10.
1109/MASCOTS.2017.22.
[7] R. Qin, Y. Yuan, S. Wang, and F. Wang, “Economic
issues in bitcoin mining and blockchain research”, in
2018 IEEE Intelligent Vehicles Symposium (IV), Jun.
2018, pp. 268–273. doi: 10.1109/IVS.2018.8500377.
[8] M. Rosenfeld, “Analysis of bitcoin pooled mining re-
ward systems”, arXiv preprint arXiv:1112.4980, 2011.
[9] J. J. G. Chávez and C. K. da Silva Rodrigues, “Auto-
matic hopping among pools and distributed applications
in the bitcoin network”, in 2016 XXI Symposium on Sig-
nal Processing, Images and Artificial Vision (STSIVA),
Aug. 2016, pp. 1–7. doi: 10 . 1109 / STSIVA . 2016 .
7743340.
[10] B. Fisch, R. Pass, and A. Shelat, “Socially optimal
mining pools”, in Web and Internet Economics, N.
R. Devanur and P. Lu, Eds., Cham: Springer Interna-
tional Publishing, 2017, pp. 205–218, isbn: 978-3-319-
71924-5.
[11] E. Angner, A Course in Behavioral Economics. Palgrave
Macmillan, 2012, isbn: 9781137017512.
[12] S. Frederick, G. Loewenstein, and T. O’Donoghue,
“Time discounting and time preference: A critical re-
view”, Journal of Economic Literature, vol. 40, no. 2,
pp. 351–401, 2002, issn: 00220515. [Online]. Available:
http://www.jstor.org/stable/2698382.
[13] Kano pool, “Pool payout”, 2017, Online; accessed Au-
gust 13, 2018.
[14] BCmonster, “Mining Statistics”, 2018, Online; accessed
September 22, 2018.
[15] Coinlend, Automated margin lending: A possibility for
passive income with cryptocurrencies, Press Release,
https : / /www. coinspeaker . com / automated - margin -
lending - a - possibility - for - passive - income - with -
cryptocurrencies/, 2018.
[16] D. Smith, Reliability, Maintainability and Risk: Prac-
tical Methods for Engineers including Reliability Cen-
tred Maintenance and Safety-Related Systems. Elsevier
Science, 2011, isbn: 9780080969039. [Online]. Avail-
able: https : / / www. elsevier . com / books / reliability -
maintainability-and-risk/smith/978-0-08-096902-2.
[17] F. Arnold, H. Hermanns, R. Pulungan, and M. Stoelinga,
“Time-dependent analysis of attacks”, in Principles of
Security and Trust, M. Abadi and S. Kremer, Eds.,
Berlin, Heidelberg: Springer Berlin Heidelberg, 2014,
pp. 285–305, isbn: 978-3-642-54792-8.
[18] G. O. Karame, E. Androulaki, and S. Capkun, “Double-
spending fast payments in bitcoin”, in Proceedings of
the 2012 ACM Conference on Computer and Com-
munications Security, ser. CCS ’12, Raleigh, North
Carolina, USA: ACM, 2012, pp. 906–917, isbn: 978-1-
4503-1651-4. doi: 10.1145/2382196.2382292. [Online].
Available: http : / / doi . acm . org / 10 . 1145 / 2382196 .
2382292.
[19] J. A. Kroll, I. C. Davey, and E. W. Felten, “The eco-
nomics of bitcoin mining, or bitcoin in the presence of
adversaries”, in Proceedings of WEIS, vol. 2013, 2013,
p. 11. [Online]. Available: https://pdfs.semanticscholar.
org / c55a / 6c95b869938b817ed3fe3ea482bc65a7206b .
pdf.
[20] G. O. Karame, E. Androulaki, M. Roeschlin, A. Ger-
vais, and S. Čapkun, “Misbehavior in bitcoin: A study
of double-spending and accountability”, ACM Trans.
Inf. Syst. Secur., vol. 18, no. 1, 2:1–2:32, May 2015,
issn: 1094-9224. doi: 10 . 1145 / 2732196. [Online].
Available: http://doi.acm.org/10.1145/2732196.
[21] I. Eyal, “The miner’s dilemma”, in 2015 IEEE Sympo-
sium on Security and Privacy, May 2015, pp. 89–103.
doi: 10.1109/SP.2015.13.
[22] K. Chatterjee, A. K. Goharshady, R. Ibsen-Jensen,
and Y. Velner, “Ergodic Mean-Payoff Games for
the Analysis of Attacks in Crypto-Currencies”, in
29th International Conference on Concurrency Theory
(CONCUR 2018), S. Schewe and L. Zhang, Eds.,
ser. Leibniz International Proceedings in Informat-
ics (LIPIcs), vol. 118, Dagstuhl, Germany: Schloss
Dagstuhl–Leibniz-Zentrum fuer Informatik, 2018, 11:1–
117
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 06:37:13 UTC from IEEE Xplore.  Restrictions apply. 
11:17, isbn: 978-3-95977-087-3. doi: 10.4230 /LIPIcs.
CONCUR.2018.11. [Online]. Available: http: / /drops.
dagstuhl.de/opus/volltexte/2018/9549.
[23] I. Eyal and E. G. Sirer, “Majority is not enough: Bitcoin
mining is vulnerable”, Commun. ACM, vol. 61, no. 7,
pp. 95–102, Jun. 2018, issn: 0001-0782. doi: 10.1145/
3212998. [Online]. Available: http: / /doi .acm.org /10.
1145/3212998.
[24] K. Nayak, S. Kumar, A. Miller, and E. Shi, “Stubborn
mining: Generalizing selfish mining and combining
with an eclipse attack”, in 2016 IEEE European Sym-
posium on Security and Privacy (EuroS P), Mar. 2016,
pp. 305–320. doi: 10.1109/EuroSP.2016.32.
[25] H. Liu, N. Ruan, R. Du, and W. Jia, “On the strat-
egy and behavior of bitcoin mining with n-attackers”,
in Proceedings of the 2018 on Asia Conference on
Computer and Communications Security, ser. ASIACCS
’18, Incheon, Republic of Korea: ACM, 2018, pp. 357–
368, isbn: 978-1-4503-5576-6. doi: 10.1145/3196494.
3196512. [Online]. Available: http: / /doi .acm.org /10.
1145/3196494.3196512.
[26] S. Bag, S. Ruj, and K. Sakurai, “Bitcoin block withhold-
ing attack: Analysis and mitigation”, IEEE Transactions
on Information Forensics and Security, vol. 12, no. 8,
pp. 1967–1978, Aug. 2017, issn: 1556-6013. doi: 10.
1109/TIFS.2016.2623588.
[27] S. Yoo, S. Kim, J. Joy, and M. Gerla, “Promoting
cooperative strategies on proof-of-work blockchain”, in
2018 International Joint Conference on Neural Net-
works (IJCNN), Jul. 2018, pp. 1–8. doi: 10.1109/IJCNN.
2018.8489267.
[28] O. Schrijvers, J. Bonneau, D. Boneh, and T. Rough-
garden, “Incentive compatibility of bitcoin mining pool
reward functions”, in Financial Cryptography and Data
Security: 20th International Conference, FC 2016,
Christ Church, Barbados, February 22–26, 2016, Re-
vised Selected Papers, J. Grossklags and B. Preneel,
Eds. Berlin, Heidelberg: Springer Berlin Heidelberg,
2017, pp. 477–498, isbn: 978-3-662-54970-4. doi: 10.
1007 / 978 - 3 - 662 - 54970 - 4 28. [Online]. Available:
https://doi.org/10.1007/978-3-662-54970-4 28.
[29] Z. Li and Q. Liao, “Toward socially optimal bitcoin
mining”, in 2018 5th International Conference on Infor-
mation Science and Control Engineering (ICISCE), Jul.
2018, pp. 582–586. doi: 10.1109/ICISCE.2018.00126.
118
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 06:37:13 UTC from IEEE Xplore.  Restrictions apply. 
Appendix A
Remark
Remark 1. [Larger pool discounts less] We consider 2 pools
for which mining power is expressed with the functions ψ
′
(E)
and ψ
′′
(E) for pool #1 and pool #2, respectively.
∀E ≥ E0
(
ψ
′′
(E) ≥ ψ
′
(E) ≥ 0
)
∧
( E′′∫
E0
ψ
′
(E) dE =
E
′∫
E0
ψ
′′
(E) dE
)
�
�
E
′∫
E0
f (E − E0)ψ′′
(E) dE ≥
E
′′∫
E0
f (E − E0)ψ′
(E) dE
if the discounting function f (E − E0) ≥ 0 is monotonically
decreasing on E ∈ [E0, ∞). (See section A)
Proof. Clearly, E
′′ ≥ E
′
as otherwise
E
′′∫
E0
ψ
′
(E) dE <
E
′∫
E0
ψ
′′
(E) dE. We analyze
E
′∫
E0
f (E − E0)ψ′′
(E) dE −
E
′′∫
E0
f (E − E0)ψ′
(E) dE =
E
′∫
E0
f (E − E0)
(
ψ
′′
(E) − ψ
′
(E)
)
dE −
E
′′∫
E′
f (E − E0)ψ′
(E) dE. Because f (E − E0) is monotonically
decreasing,
E
′∫
E0
f (E − E0)
(
ψ
′′
(E) − ψ
′
(E)
)
dE ≥ f (E
′ −
E0)
E
′∫
E0
(
ψ
′′
(E) − ψ
′
(E)
)
dE and
E
′′∫
E′
f (E − E0)ψ′
(E) dE ≤
f (E
′ − E0)
E
′′∫
E′
ψ
′
(E) dE. Finally, we point out that
f (E
′ − E0)
E
′∫
E0
(
ψ
′′
(E) − ψ
′
(E)
)
dE − f (E
′ − E0)
E
′′∫
E′
ψ
′
(E) dE =
f (E
′ − E0)
( E′∫
E0
ψ
′′
(E) dE −
E
′′∫
E0
ψ
′
(E) dE
)
= 0 according to the
premise of the argument. �
Appendix B
Lemmas
Lemma 1. ∀E′
, E
′′
if
(
∀ j ∈M2
(
P∗1 + p j < 0.5
)
∧
(
E
′′ ≥ E
′ ≥
E0
))
then ME
′
2 ⊆ME
′′
2 .
Proof. For the validity, it is sufficient to substantiate the
following two arguments:
(a) ∀E′
(
∀ j ∈M2
(
P∗1 + p j < 0.5
)
∧
(
E
′ ≥ E0
)
�
(
M2 ⊆ME
′
2
))
,
(b) ∀E′
, E
′′
(
∀ j ∈M2
(
P∗1 + p j < 0.5
)
∧
(
E
′′ ≥ E
′ ≥ E0
)
�(
ME
′
2 \M2 ⊆ME
′′
2 \M2
))
,
where ME
′
2 \M2 =ME
′
2 ∩ (
M2
)c
and ME
′′
2 \M2 =ME
′′
2 ∩ (
M2
)c
represent relative complements of set M2 in the sets ME
′
2 and
ME
′′
2 , respectively.
For item (a) we proceed as follows. According to proof by
contradiction, let us assume that
∃E′
(
∀ j ∈M2
(
P∗1 + p j < 0.5
)
∧
(
E
′ ≥ E0
)
∧
(
M2 �ME
′
2
))
.
This means that ∃ j
(
j ∈M2 ∧ j �ME
′
2
)
which implies that
there is a moment E∗ ∈
[
E0, E
′]
when miner j decides to
switch her mining activity from pool #2 to pool #1 and,
hence, b j (E∗) = 0. We regard the case when Ũ j (E∗) =
F j,1 (E∗) +D1, j(E∗) − F j,2 (E∗) −D2, j(E∗) > 0.
At the moment E∗ miner j does not have any contribution
in pool #1 and F j,1 (E∗) = 0. It is therefore necessary that
D1, j(E∗) − D2, j(E∗) > 0, which contradicts with the result of
remark 1 . This signifies that miners from pool #2 never switch
their mining to pool #1 if premise of item (a) is true.
Now, let us consider item (b). According to the principle of
proof by contradiction, we suppose that
∃E′
, E
′′
(
∀ j ∈M2
(
P∗1 + p j < 0.5
)
∧
(
E
′′ ≥ E
′ ≥ E0
)
∧
(
ME
′
2 \M2 �ME
′′
2 \M2
))
.
This requires that ∃i
(
i ∈ME
′
2 \M2 ∧ i �ME
′′
2 \M2
)
. In that
regard, we distinguish two moments E∗ ∈
[
E0, E
′]
and E∗∗ ∈[
E
′
E
′′]
when miner i first moved from pool #1 to pool #2 and
first moved from pool #2 to pool #1, respectively. Further we
will analyze incentives of miner i assuming that she is the first
miner that leaves pool #2:
∀E′
, E
′′
(
∀ j � i
(
E
′′ ≥ E
′ ≥ E0
)
∧
(
b j(E
′
) = 1
)
∧
(
b j(E
′′
) = 0
)
�
�
(
E
′′ ≥ E∗∗
))
.
From the definition 1 we infer that at any moment E ∈
[E∗, E∗∗] miner i estimates ψ2,i(E) on E ∈ [E∗, ∞] as a
non-decreasing function because she does not observe any
other miner leaving pool #2. Correspondingly, any estimation
ψ1,i(E) that is produced during [E∗, E∗∗] is non-increasing on
E ∈ [E∗, ∞].
However, from the best responses eq. (4) bi (E∗) = 1 and
bi (E∗∗) = 0, we infer that Ũi (E∗) < 0 and Ũi (E∗∗) ≥ 0.
According to eq. (3) this implies that Fi,1 (E∗) + D1,i(E∗) −
Fi,2 (E∗) − D2,i(E∗) < Fi,1 (E∗∗) + D1,i(E∗∗) − Fi,2 (E∗∗) −
D2,i(E∗∗). We arrive to a contradiction: i) Fi,1 (E∗)−Fi,1 (E∗∗) ≥
0 because contribution of the miner in pool #1 cannot increase
while she is in pool #2; ii) Fi,2 (E∗) − Fi,2 (E∗∗) ≤ 0 because
contribution in pool #2 increases as she is mining for that pool;
iii) D1,i(E∗)−D1,i(E∗∗) ≥ 0 because ψ1,i(E) is non-increasing;
iv) D2,i(E∗)−D2,i(E∗∗) ≤ 0 because ψ2,i(E) is non-decreasing.
We complete the proof by noting that validity of item (a)
and item (b) implies that
∀E′
, E
′′
(
∀ j ∈M2
(
P∗1 + p j < 0.5
)
∧
(
E
′′ ≥ E
′ ≥ E0
)
�
�
(
ME
′
2 ⊆ME
′′
2
))
is valid. �
119
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 06:37:13 UTC from IEEE Xplore.  Restrictions apply. 
Lemma 2. ∀E′
if
(
∀ j ∈M2
(
P∗1 + p j < 0.5
)
∧
(
E
′ ≥ E0
))
then
ME0
1
⊆ME
′
1 .
Proof. We question validity of the argument by analyzing the
truth value of the contradicting statement:
∃E′
(
∀ j ∈M2
(
P∗1 + p j < 0.5
)
∧
(
E
′
> E0
)
∧
(
ME0
1
�ME
′
1
))
,
meaning that ∃i
(
i ∈ME0
1
∧ i �ME
′
1
)
. We analyze incentives of
miner i who is the first miner that leaves pool #1 at the moment
E∗ ∈
(
E0, E
′]
providing that argument:
∀E
(
∀ j � i
(
E > E0
)
∧
(
b j(E0) = 0
)
∧
(
b j(E) = 1
)
�
(
E ≥ E∗
))
is valid.
Let us consider best responses of i at E0 and E∗. According
to eq. (4), values bi(E0) = 0 and bi(E∗) = 1 require that
Ũi (E0) ≥ 0 and Ũi (E∗) < 0. From eq. (3), this implies
that Fi,1 (E0) + D1,i(E0) − Fi,2 (E0) − D2,i(E0) > Fi,1 (E∗) +
D1,i(E∗)− Fi,2 (E∗)−D2,i(E∗). We arrive to a contradiction: i)
Fi,1 (E0) − Fi,1 (E∗) ≤ 0 because fractional contribution of the
miner in pool #1 is non-decreasing as she continues to mine
there and no miner ever switches to pool #1 from pool #2
(according to lemma 1); ii) Fi,2 (E0) − Fi,2 (E∗) = 0 because
the miner does not contribute to pool #2 on (E0, E∗]; iii)
D1,i(E0)−D1,i(E∗) = 0, and iv)D2,i(E0)−D2,i(E∗) = 0 because
according to the definition, no transition happens on (E0, E∗]
in the direction from pool #1 to pool #2, and, no transition ever
happens in the direction from pool #2 to pool #1 (according
to lemma 1). �
Appendix C
Corollary
Corollary 1. Under exponential discounting,
∀Ψ1,i, ∀θ ≤ 0.5
(
∂ Ũi(E0)
∂pi
≥ 0
)
.
Proof. According to the definition 1, Ψ2,i = 1−Ψ1,i+ pi, which
we substitute into eq. (5), Ũi (E0) =
pi
P∗
1
+
Ψ1,i
θ
(
1 − e− θ
Ψ1,i
)
−
1−Ψ1,i+pi
θ
(
1 − e− θ
1−Ψ1,i+pi
)
. For the sake of simplicity, we abandon
index i and use Ũ instead of Ũ (E0). Let us analyze conditions
when ∂ Ũ
∂p ≥ 0:
∂
Ũ
∂p
=
1
P∗
1
− 1
θ
+
1
θ
e−
θ
1−Ψ1+p +
1
1 − Ψ1 + pe
− θ
1−Ψ1+p ≥ 0 .
Using lemma 1 we conclude that P∗1 ≥ Ψ1. According to the
initial assumption P∗1 ≤ 0.5 and, therefore 1
1−Ψ1+p ≤ 1
P∗
1
. This
provides
∂
Ũ
∂p
≥ 1
1 − Ψ1 + p −
1
θ
+
1
θ
e−
θ
1−Ψ1+p +
1
1 − Ψ1 + pe
− θ
1−Ψ1+p .
We question conditions that make the right part of the
last inequality positive, which requires that e−
θ
1−Ψ1+p ≥ 1 −
2θ
1−Ψ1+p+θ
. On the other hand, it can be observed that inequality
e−
2θ
1−Ψ1+p+θ ≥ 1 − 2θ
1−Ψ1+p+θ
is always satisfied. For our task it
is sufficient to define conditions when e−
θ
1−Ψ1+p ≥ e−
2θ
1−Ψ1+p+θ .
We arrive to 2θ
1−Ψ1+p+θ
≥ θ
1−Ψ1+p , where sufficient condition is
θ ∈ [0, 0.5]. �
Appendix D
Cumulative utility of miners from pool #1
Cumulative utility of miners under equilibrium
Depending on miner’s i best response bi(E0) in equilibrium
she either remains in pool #1 or moves to pool #2. We recall
expressions for the corresponding utility functions at E
′ ≥ E0:
Ui,1
(
E
′)
= RpiPr
(
B
∣∣∣ΔE) (
Fi,1
(
E
′)
+D1,i(E
′
)
)
,
Ui,2
(
E
′)
= RpiPr
(
B
∣∣∣ΔE) (
Fi,2
(
E
′)
+D2,i(E
′
)
)
.
For simplicity, we abandon multiplier RpiPr
(
B
∣∣∣ΔE)
which
is neither affected by the choice of miner i nor changes with
time. In addition, in equilibrium every miner knows exact
power of pool #1, Ψ1, and pool #2, 1−Ψ1, and, hence, we use
D1, D2 instead of D1,i, D2,i, respectively. Cumulative utility
function of miner i ∈M1 is calculated over E
′ ∈ [E0, ∞):
Ci,1 =
∞∫
E0
(
Fi,1
(
E
′)
+D1(E
′
)
)
dE
′
,
Ci,2 =
∞∫
E0
(
Fi,2
(
E
′)
+D2(E
′
)
)
dE
′
,
where the fractions of the past contribution of miner i into
pool #1 and #2 are
Fi,1
(
E
′)
=
⎧⎪⎪⎪⎪⎨⎪⎪⎪⎪⎩
(
1−Ψ1 E
′ −E0
EN
)
Fi,1 (E0) f
(
E
′ −E0
)
, if E
′ ≤ E0 +
EN
Ψ1
;
0, if E
′
> E0 +
EN
Ψ1
,
Fi,2
(
E
′)
= 0 .
Discount factors D1 and D2 are computed as following:
D1
(
E
′)
= 1
EN
E
′
+
EN
Ψ1∫
E′
Ψ1 f (E − E0) dE , D2
(
E
′)
=
1
EN
E
′
+
EN
1−Ψ1∫
E′
(1 − Ψ1) f (E − E0) dE .
We express Ci,1 and Ci,2 taking into account that Fi,1 (E0) =
pi
P∗
1
. For exponential discounting function, f (E − E0) = e−θ
E−E0
EN ,
therefore
Ci,1 =
pi
P∗
1
E0+
EN
Ψ1∫
E0
(
1−Ψ1 E
′ −E0
EN
)
e−θ
E
′ −E0
EN dE
′
+
Ψ
EN
∞∫
E0
dE
′
E
′
+
EN
Ψ1∫
E′
e−θ
E−E0
EN dE ,
Ci,2 =
1 − Ψ
EN
∞∫
E0
dE
′
E
′
+
EN
1−Ψ1∫
E′
e−θ
E−E0
EN dE .
120
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 06:37:13 UTC from IEEE Xplore.  Restrictions apply. 
Cumulative utility of miners for “no competition – no move”
scenario
For the hypothetical scenario of “no move”
∀i ∈M1, bi(E0) = 0. Thus, we only compute C∗
i,1 for a
special case Ψ1 = P∗1. Cumulative utility for exponential
time-discounting
C∗
i,1 =
pi
P∗
1
E0+
EN
P∗
1∫
E0
(
1−P∗1
E
′ −E0
EN
)
e−θ
E
′ −E0
EN dE
′
+
P∗1
EN
∞∫
E0
dE
′
E
′
+
EN
P∗
1∫
E′
e−θ
E−E0
EN dE .
121
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 06:37:13 UTC from IEEE Xplore.  Restrictions apply.