EVBlocks: A Blockchain-Based Secure Energy Trading Scheme for Electric Vehicles underlying 5G-V2X Ecosystems
Vol.:(0123456789)
Wireless Personal Communications (2022) 127:1943–1983
https://doi.org/10.1007/s11277-021-08732-5
1 3
EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme 
for Electric Vehicles underlying 5G‑V2X Ecosystems
Pronaya Bhattacharya1 · Sudeep Tanwar1  · Umesh Bodkhe1 · Ashwani Kumar2 · 
Neeraj Kumar3,4,5
Accepted: 29 June 2021 / Published online: 12 July 2021 
© The Author(s), under exclusive licence to Springer Science+Business Media, LLC, part of Springer Nature 2021
Abstract
In this paper, the authors propose a secure and trusted energy trading (ET) scheme for 
electric vehicles (EVs) for vehicle-to-anything (V2X) ecosystems. The scheme, named as 
EVBlocks, facilitates ET among entities (i.e., EVs, charging stations (CS), and smart grids 
(SG)) in a secured and trusted manner through a consortium blockchain (CBC) network. 
The scheme operates in three phases. In the first phase, to allow real-time and resilient 
network orchestration of V2X nodes, we consider the ET service designed over a fifth-
generation (5G) enabled software-defined networking (SDN) environment. Integration of 
SDN in 5G-V2X ecosystems allows V2X nodes to eliminate intermediaries and handle 
many requests with a minimum response time. Then, in the second phase, a non-cooper-
ative game is presented that optimizes a cost function and converges to reach at least one 
Nash equilibrium point. Finally, a consensus algorithm Proof-of-Greed (PoG) is proposed 
that handles fluctuations in charging/discharging EVs through an event-driven schedul-
ing mechanism. The obtained results are compared against parameters, such as ET time, 
State-of-Charge (SoC) levels, EV utility, block-convergence time, profits, computation, and 
communication costs. For example, EVBlocks achieve an average SOC charge of 22.8MW, 
with a peak at 377.5MW, the average power dissipation of 4.1125 kWH that is lower than 
25% against existing conventional and fixed tariff schemes. The scheme converges at stable 
profit values for 5 EVs through a non-cooperative game. For proposed PoG consensus, the 
block convergence time for 1000 nodes is 138.96 seconds, at a computation cost of 46.92 
milliseconds (ms) and communication cost of 149 bytes. The comparative analysis sug-
gests the proposed scheme is efficient as compared to existing state-of-the-art approaches 
against compared parameters.
Keywords 5G · Cellular vehicle-to-anything · Electric vehicles · Energy trading · 
Blockchain · Non-cooperative game · Distributed consensus
 * Sudeep Tanwar 
 sudeep.tanwar@nirmauni.ac.in
Extended author information available on the last page of the article
http://orcid.org/0000-0002-1776-4651
http://crossmark.crossref.org/dialog/?doi=10.1007/s11277-021-08732-5&domain=pdf
1944 P. Bhattacharya et al.
1 3
1 Introduction
Smart cities (SCs) provide sustainable growth and communication infrastructures to 
support the energy sector. In a similar direction, wireless communication infrastruc-
tures have transitioned from fourth generation (4G) enabled long term evolution (LTE) 
standards towards fifth-generation (5G) enabled communication services. 5G-enabled 
vehicle-to-anything (V2X) links allow short and directed relay communication in the 
5.9 gigahertz (GHz) spectrum unlicensed band [27]. The band supports reliable con-
nectivity among V2X nodes, with frequent mobility and handover access. Through 5G 
new radio (NR), as described in third generation partnership project (3GPP) request for 
comments RFC TR 22.186, distributed edge-based services are developed that allowed 
resource-based communication through flexible multicast operation support [35]. To 
support the latency concerns in edge-resource trading, 5G services like ultra-reliable 
low-latency communications (uRLLC), and enhanced mobile broadband (eMBB) are 
introduced that allow near response communication in V2X. Through these services, 
ubiquitous edge control, massive bandwidth, and dense resource profiling becomes 
available [4, 55]. This improves the quality of experience (QoE) for electric vehicle 
(EV) users in V2X ecosystems.
 However, with the rise of V2X links, 5G-based uRLLC faced stringent challenges of 
simple network management, flexible control, and ease of programmability. To address 
the issue, researchers across the globe investigated the integration of software-defined 
networking (SDN) in 5G-V2X ecosystems to allow abstraction and decoupling of con-
trol and data plane operations [26, 49]. SDN-controlled 5G-V2X supports resilient 
network management, dynamic flow configurations, frequent handovers, disconnected 
operations, and concurrent resource interactions [22]. For EVs, integration emerged 
as a viable solution to handle the challenges of energy trading (ET). According to the 
industry forecast market survey of 2019, the global EV market is valued at $118,864.5 
million in 2017 and is projected to reach $567,299.8 million by 2025, growing at a com-
pounded annual growth rate (CAGR) of 22.3% from 2018 to 2025 [28]. This rapid rise 
of the global EV market requires SDN-leveraged 5G-V2X service-based solutions to 
meet the requirements of seamless charging infrastructures, with real-time support over 
operational and billing maintenance [7].
 EVs support self-sustainability in 5G-V2X and performs the dual operation of trans-
portation and energy carrier in internet-of-everything (IoE). In case of an energy deficit in 
IoE, EVs can purchase energy units from nearby energy nodes like charging stations (CS) 
or grid stations (GS), which then could be recycled back to the system in case of a defi-
cit. However, inefficient practices may lead to mismanagement of energy demands, lead-
ing to power fluctuations. Moreover, in 5G-V2X environments, transactions are performed 
through centralized control planes in SDN. The central control plane is prone to network 
attacks like- impersonation, disclosure of private information of users, alteration of the 
quantity of charging units and prices, and denial-of-service to authentic users [50]. Moreo-
ver, centralized SDN control has to service bulk connection requests of clients. The trans-
actions suffer from frequent latency issues in the case of low bandwidth channels. EVs are 
mainly resource-constrained nodes with limited computing and storage capabilities. This 
hampers the real-time interaction between CS, EVs, and associated GS in an SG. Thus, 
to address the aforementioned issues, a decentralized 5G-V2X edge-based mechanism is 
applicable to handle transactional requests and reduce computational overheads [46]. How-
ever, trading decisions need to be secured from unidentified peer malicious intruders. Such 
1945EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
intruders could drain energy from EVs and CS by modifying energy transactional units 
[10]. The communication infrastructure and protocol stacks are not matured enough to han-
dle the security issues, owing to a lack of global and open standards [43]. A comprehensive 
solution needs to be raised that allows EVs to query CS for energy prices in a local area, 
and at the same time, preserve their identity.
The issues mentioned above could be addressed by deploying a consortium blockchain 
(CBC) that allows only authorized stakeholders to add nodes as a chronological and times-
tamped ledger. This allows higher efficiency and transactional privacy than private chains 
and allows data provenance and consensus among EVs and CS to perform ET decisions 
via smart contracts in 5G-V2X ecosystems [33, 51]. Owing to limited resources, CBC 
needs to adopt an SDN ecosystem for network and plane management. EVs trade energy 
units through CS or GS via an edge-based service through SDN control planes based on 
measured State-of-Charge (SoC) levels to measure the energy dissipation after travelling a 
distance. 
Through CBC, EVs trade energy with peer EVs and energy refuelling at CS, where the 
exchange is facilitated through a wire transfer. The billing price of energy units is added 
as ET and stored in CBC. Once the EVs are refilled, they can travel large distances. It is 
estimated that ≈ 42% of energy consumption in EVs is used to propel the vehicle through 
a travelled distance d, and around 25% of the energy is lost in the form of heat, 23% energy 
of EVs is wasted to accelerate the vehicle against air drags, and 10% consumption is done 
in other forms [20]. Thus, EVs consistently trade energy with other IoE stakeholders and 
employ energy harvesting to convert mechanical energy into electrical energy stored in an 
EV battery. This improves the dissipation rate of SOC levels of EVs throughout the day 
and improves the overall mileage and covered distance of EVs. In 5G-V2X scenarios and 
SDN, easy decoupling achieves efficient and resilient ET services, as energy requirement 
messages are broadcasted in V2X networks with low latency from neighbouring roadside 
units (RSU) that acts as the central node to facilitate the energy transfer. The EV position 
is tracked through location coordinates, which are more precise and accurate in 5G-V2X 
based ecosystems. Once the ET is finalized, the transactions are stored in CBC and auto-
mated payments among entities are instantiated through SCs, which provides a stream-
lined experience to IoE users. Table  1 depicts the list of acronyms and their associated 
descriptions.
1.1  Motivation
Motivated from the aforementioned discussions, the paper presents an ET scheme 
between EVs and CS through CBC in an SDN-enabled 5G-V2X infrastructure envi-
ronment. Adopting an SDN-based CBC has the dual benefits of cost-effective network 
management through restructuring data requests via programmable switches. Block-
chain allows chronology and trust in mined transactions for authorized user groups in 
the 5G-V2X ecosystem. To handle resource constraints, at the SDN controller layer, 
we propose an edge-based service mechanism that allows task offloading that improves 
block creation probability and ensures better scalability of mined transactions. This 
addresses the challenges of an efficient charge management and SoC operational levels, 
which authors did not discuss in [18, 57], and [12]. Further, a dynamic pricing scheme 
to maximize profits of EVs and the event-driven consensus is proposed to improve the 
1946 P. Bhattacharya et al.
1 3
response time of execution of contracts and dampen charge fluctuations. This reduces 
the information asymmetry and increases the lifetime of EVs rated battery capacity.
1.2  Research Contributions
The following are the main contributions of this paper.
– An SDN-leveraged edge-based environment is deployed for 5G-V2X via a CBC scheme 
to coordinate secure ET among EVs and CS.
– A non-cooperative game model is proposed to maximize the benefits of players and it 
guarantees at least one Nash equilibrium state.
– A consensus mechanism termed as Proof-of-Greed (PoG) is presented to minimize 
charge fluctuations during excess energy transfer between EVs, CSs, and GS.
1.3  Article Structure
The rest of the paper is organized as follows. Section 2 presents the related state-of-the-art 
schemes. Section 3 discusses the reference architecture that includes the network model, 
resource-trading model and problem formulation. Section 4 discusses the proposed scheme 
to secure ET between EVs and CSs. Section  5 discusses the performance evaluation of 
EVBlocks. Section 6 presents the limitations of BC-based ET schemes and future direc-
tions, and finally, Sect. 7 concludes the paper.
Table 1  Acronyms and their description
Acronyms Description Acronyms Description
3GPP Third Generation Partnership Project GS Grid Stations
4G Fourth Generation IoE Internet-of-Energy
5G Fifth Generation LAGs Location Aggregators
CAGR Compounded Annual Growth Rate LTE Long Term Evolution
CBC Consortium Blockchain NR New Radio
CS Charging Stations PoG Proof-of-Greed
CSMA Carrier Sense Multiple Access RFC Request for Comments
DFS Depth First Search RFID Radio Frequency Identification
ECC Edge Computing Controller SDN Software-Defined Networking
eMBB Enhanced Mobile Broadband SG Smart Grids
ESP Edge Service Providers SoC State-of-Charge
ETaaS Energy Trading-as-a-Service uRLLC Ultra-Reliable Low-Latency 
Communications
EV Electric Vehicles V2X Vehicle-to-Anything
GPRS General Packet Radio Service Wi-Fi Wireless Fidelity
1947EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
2  State‑of‑the‑Art
The section discusses the recent state-of-the-art schemes for responsive V2X communi-
cation, resource management, allocation, and ET in V2X scenarios. Researchers world-
wide are working towards the integration of 5G services in V2X environments to provide 
responsive and resilient solutions for resource allocations and optimize energy manage-
ment. For example, Sharma et al. [41] studied about 5G-V2X security schemes and com-
pared them with existing 4G-LTE services. They proposed a novel security reflex archi-
tecture for ultra-dense transmission and mobility support in 5G-V2X. Rasheed et al. [38] 
demonstrated ultra-low delay V2X transmissions based on 5G millimeter wave (mmWave) 
systems that can support > 1 Gbps user bandwidth. The authors proposed 3D-based posi-
tion beam alignment schemes to segment the road traffic into different groups, with group 
authentication provided through elliptic curve cryptography. However, the security vali-
dations are not discussed in the proposed approach. Do et al. [15] discussed about non-
orthogonal multiple access scheme for 5G-V2X infrastructures. The author’s proposed 
vehicular communications through multiple antennas over Nakagami-m fading channels 
and studied outage probability and successive interference cancellation (SIC) of vehicles. 
They found out the outage performance of NOMA-V2X based on channel fading param-
eters, imperfect SIC, and NOMA-based power allocation factors through analysis. Chen et 
al. [13] discussed cellular V2X evolution with 5G-NR to leverage low-latency and high-
throughput for vehicular communication. The technical evolution of the standards about 
NR-V2X is discussed and is compared to the 4G counterparts.
 In resource trading, load balancing, and optimizing energy management for EVs, 
researchers across the globe have proposed efficient schemes for V2X infrastructures. For 
example, Hua et al. [21] implemented smart contracts-based solutions to manage battery 
refuelling and swapping to facilitate the trust management issue charging EVs and GS. 
The security vulnerabilities of managing and executing smart contracts are not discussed. 
Authors in [8, 57] designed a blockchain-based renewable energy incentive system for EVs 
that provides additional incentives to users. The aforementioned works failed to address 
issues of scalability, integrity, and user privacy.
Authors in [9, 24] presented an edge-as-a-service scheme to manage ET of EVs in an 
SDN scheme for vehicle-to-grid (V2G) platforms to reduce the overall latency of the system. 
Chaudhary et al. [12] proposed a CBC to manage SoC levels for battery refueling of EVs in 
the SDN environment. Hayes et al. [18] proposed a peer-to-peer trading scheme for trading 
energy in SG by balancing network voltage profiles. A more comprehensive analysis of user 
profiles and base voltage is required.
Florea et al. [16] proposed an efficient battery management system, that allows battery 
swap from nearby registered stations and facilitates the transaction, BC-based ledgers are 
proposed. For payments, two payment modes are made available. The first mode allows 
payments through ethereum based SC, and the second mode designs a directed acyclic 
graph (DAG) system, with a proposed IOTA tangle for data-driven battery management. 
However, the scheme does not address the privacy and security constraints of shared user 
data. The payment mode through the IOTA tangle allows even non-registered users to gain 
access to the BC network. Thus malign users can launch fake propagation updates, which 
poses a critical issue. Samuel et al. [40] proposed ET based on a game model that allows 
demand-responsive pricing and addresses the issue of demurrage payments for IoE stake-
holders. However, the scheme has not considered the genuineness of added users in the 
proposed game, allowing malicious users to increase demand, and correspondingly, the 
1948 P. Bhattacharya et al.
1 3
prices hike up. Authors in [2] proposed a peer-to-peer ET scheme UBETA, for permis-
sioned BC, and designs a hyper-ledger-driven consensus named as Hyperledger Basu, that 
operates on a node-size of 60 nodes. However, with increasing node additions, the obtained 
transactional throughput gets affected, which is not considered. Jamil et  al. proposes ET 
to achieve optimal power and energy crowd-sourcing on a real-energy dataset collected 
from Jeju province of the Republic of Korea. The scheme supports ET among the con-
sumer and prosumer and is based on real-time scheduling and control of SG loads and 
demands throughout the day. The collected time-series data is analyzed to form accurate 
predictions on the model performance, and the simulation is performed on various metrics. 
The performance of BC is analyzed through resource utilization, latency in node additions, 
and resource utilization. However, machine learning (ML) algorithms are not compared to 
diverse metric sets.
The presented state-of-the-art schemes have focused on ET through BC based on 
resource pricing, SC, predictive models, and demand-forecast pricing. Some schemes have 
to combine SDN with BC to effectively orchestrate the network and leverage effective 
management through the programmable nodes. However, none of the works has proposed a 
coherent presentation of ET in V2X ecosystems that combines the key benefits of SDN to 
facilitate edge-based ET services, dynamic pricing scheme, and consensus to achieve flex-
ibility and management of charging and discharging profiles of EV. To address the research 
gap, we present the scheme, EVBlocks, that unifies the key concepts of BC-based secure 
ET with SDN-based ET services, coupled with effective models for dynamic pricing and 
consensus schemes to manage additional charge levels. Table  2 presents a comparative 
analysis of existing schemes with the proposed scheme.
3  EVBlocks: The Reference Architecture
The section proposes the reference architecture of EVBlocks based on the SDN-leveraged 
5G-V2X infrastructure ecosystem. This section discusses the 5G-V2X network model, the 
resource-trading model, and the problem formulation of the proposed architecture.
3.1  The Network Model
The section proposes the network model of the proposed scheme. The section discusses the 
communication infrastructure, the components, and the reference 5G components. Figure 1 
discusses the proposed network model for EVBlocks trading scheme based on 5G-V2X 
ecosystems.
3.1.1  5G‑V2X Channel
In the 5G-V2X ecosystem, we consider a mmWave channel-based communication that 
operates on the range from 30-300 GHz range. In C-V2X, any two nodes N1 and N2 com-
municate based on transmitting and receiving antennas, denoted as At and Ar respectively. 
The aggregate channel matrix can be modelled as follows [19],
(1)M(t) =
Et∑
Ecl
Np∑
p
MEcl
⋅ p(t)
1949EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
Ta
bl
e 
2 
 C
om
pa
ra
tiv
e 
an
al
ys
is
 o
f p
ro
po
se
d 
sc
he
m
e 
ag
ai
ns
t e
xi
sti
ng
 st
at
e-
of
-th
e-
ar
t s
ch
em
es
Re
se
ar
ch
Ye
ar
Pa
ra
m
et
er
s
O
bj
ec
tiv
e
Pr
os
C
on
s
1
2
3
4
5
6
7
H
ua
 e
t a
l. 
[2
1]
20
18
Y
N
Y
N
N
N
N
B
C
-b
as
ed
 b
at
te
ry
 re
fu
el
in
g 
fo
r E
V,
 
an
d 
pr
op
os
ed
 e
th
er
eu
m
 b
as
ed
 S
C
 to
 
fa
ci
lit
at
e 
pa
ym
en
ts
Pr
op
os
ed
 sl
ot
s f
or
 fa
ir 
ch
ar
gi
ng
 
ev
al
ua
tio
n 
vi
a 
m
ea
su
re
m
en
t o
f 
en
er
gy
 le
ve
ls
Th
e 
au
th
or
s h
av
e 
no
t c
on
si
de
re
d 
th
e 
fe
as
ib
ili
ty
 o
f b
at
te
r r
ef
ue
lin
g 
th
ro
ug
h 
ex
te
ns
iv
e 
re
al
-w
or
ld
 si
m
ul
at
io
ns
Zh
an
g 
et
 a
l. 
[5
7]
20
18
Y
N
Y
N
Y
Y
N
A
n 
in
ce
nt
iv
e-
ba
se
d 
cr
yp
to
cu
rr
en
cy
 
sc
he
m
e 
fo
r E
T 
am
on
g 
EV
,
Th
ro
ug
h 
pr
io
rit
y-
ba
se
d 
in
ce
nt
iv
es
, 
th
e 
pr
op
os
ed
 sc
he
m
e 
ac
hi
ev
es
 a
 
N
as
h 
eq
ui
lib
riu
m
 th
at
 o
pt
im
iz
es
 
ET
 sh
ar
in
g
Th
e 
sc
he
m
e 
do
es
 n
ot
 d
is
cu
ss
 th
e 
se
cu
rit
y 
tra
de
-o
ffs
 w
hi
le
 p
ro
po
si
ng
 
in
ce
nt
iv
es
 o
f d
iff
er
en
t E
V
 th
ro
ug
h 
th
e 
ga
m
e 
m
od
el
.
Jin
da
l e
t a
l. 
[2
4]
20
19
Y
Y
Y
Y
N
Y
N
A
 B
C
-b
as
ed
 E
T 
sc
he
m
e 
na
m
ed
 
SU
RV
IV
O
R,
 w
he
re
 a
pp
ro
ve
r n
od
es
 
ar
e 
se
le
ct
ed
 fo
r v
al
id
at
io
n 
of
 tr
an
s-
ac
tio
ns
 in
 S
D
N
 e
nv
iro
nm
en
t
D
ur
in
g 
ET
, l
oa
d 
pr
ofi
le
s o
f E
V
 a
nd
 
SG
 a
re
 c
on
si
de
re
d 
be
fo
re
 a
nd
 a
fte
r 
tra
ns
ac
tio
ns
, a
nd
 v
ia
 S
D
N
 e
dg
e-
ba
se
d 
ET
 sc
he
m
e 
is
 p
re
se
nt
ed
Th
e 
au
th
or
s h
av
e 
no
t c
on
si
de
re
d 
th
e 
de
pl
oy
m
en
ts
 in
 c
on
so
rti
um
 B
C
, a
nd
 
ha
ve
 to
 a
dd
re
ss
 tr
ad
in
g 
sc
en
ar
io
s 
du
rin
g 
ve
hi
cl
e 
m
ov
em
en
ts
, a
nd
 
co
nt
en
t c
ac
he
s
C
ha
ud
ha
ry
 e
t a
l. 
[1
2]
20
19
Y
Y
Y
Y
N
Y
Y
B
C
-b
as
ed
 E
T 
sc
he
m
e,
 B
ES
T,
 w
he
re
 
en
er
gy
 n
od
es
 a
re
 v
al
id
at
ed
 o
n 
ba
si
s 
of
 d
yn
am
ic
 p
ric
in
g,
 a
nd
 c
on
ne
ct
iv
-
ity
 re
co
rd
s
SD
N
 b
as
ed
 E
T 
to
 fa
ci
lit
at
e 
re
sp
on
-
si
ve
 e
dg
e 
tra
ns
ac
tio
ns
, s
up
po
rte
d 
th
ro
ug
h 
ta
ct
ile
 in
te
rn
et
Fl
ow
-c
on
tro
l p
ol
ic
ie
s i
n 
SD
N
 is
 
no
t d
is
cu
ss
ed
, t
ha
t e
ns
ur
es
 m
as
s 
co
nn
ec
tiv
ity
 a
nd
 sc
al
ab
ili
ty
 o
f E
T 
tra
ns
ac
tio
ns
Sh
ar
m
a 
et
 a
l. 
[4
1]
20
20
N
Y
N
N
N
Y
Y
A
 se
cu
rit
y 
ba
se
d 
sc
he
m
e 
fo
r 5
G
-C
-
V
2X
Se
cu
rit
y-
re
fle
x 
fu
nc
tio
n 
(S
R
F)
 
re
du
ce
s b
ur
de
n 
of
 v
eh
ic
ul
ar
 m
ob
il-
ity
 m
an
ag
em
en
t
A
ut
ho
rs
 h
av
e 
no
t c
on
si
de
re
d 
th
e 
is
su
es
 
of
 c
re
de
nt
ia
l t
he
fts
 a
nd
 d
en
se
 se
ns
or
 
ba
se
d 
re
pl
ay
 a
tta
ck
s
R
as
he
ed
 e
t a
l. 
[3
8]
20
20
N
Y
N
N
N
N
Y
3D
-b
ea
m
 a
lig
nm
en
t s
ch
em
e 
fo
r 
C
-V
2X
 fo
r m
m
W
av
e 
5G
A
 d
yn
am
ic
 v
eh
ic
le
 ro
ut
in
g 
sc
he
m
e 
is
 p
ro
po
se
d 
ba
se
d 
on
 o
pt
ic
al
 b
ea
m
 
se
le
ct
io
n 
, t
ha
t i
m
pr
ov
es
 th
e 
V
2X
 
pe
rfo
rm
an
ce
Se
cu
rit
y 
co
ns
id
er
at
io
n 
ar
e 
no
t d
is
-
cu
ss
ed
 w
hi
le
 ro
ut
in
g 
da
ta
 a
m
on
g 
di
fff
er
en
t V
2X
 n
od
es
D
o 
et
 a
l. 
[1
5]
20
20
N
Y
N
N
N
N
Y
N
O
M
A
-b
as
ed
 c
om
m
un
ic
at
io
n 
in
 
V
2X
 su
pp
or
te
d 
ov
er
 N
ak
ag
am
i-m
 
fa
di
ng
 c
ha
nn
el
s
Re
la
y-
as
si
ste
d 
br
oa
dc
as
tin
g 
su
p-
po
rte
d 
N
O
M
A
 th
at
 im
pr
ov
es
 
co
nn
ec
tio
n 
de
ns
ity
, s
pe
ct
ru
m
 
effi
ci
en
cy
, l
ow
 la
te
nc
y 
an
d 
hi
gh
 
re
la
ib
ili
ty
 in
 V
2X
N
um
er
ic
al
 si
m
ul
at
io
ns
 o
n 
an
te
nn
a 
se
le
ct
io
n 
to
 o
pt
im
iz
e 
th
e 
ou
ta
ge
 
pe
rfo
rm
an
ce
 o
f N
O
M
A
-V
2X
 is
 n
ot
 
co
ns
id
er
ed
1950 P. Bhattacharya et al.
1 3
Ta
bl
e 
2 
 (c
on
tin
ue
d)
Re
se
ar
ch
Ye
ar
Pa
ra
m
et
er
s
O
bj
ec
tiv
e
Pr
os
C
on
s
1
2
3
4
5
6
7
C
he
n 
et
 a
l. 
[1
3]
20
20
N
Y
N
N
N
N
Y
A
 v
is
io
n 
an
d 
ro
ad
-m
ap
 o
f e
m
er
ge
nc
e 
of
 C
-V
2X
 fr
om
 L
TE
-V
2X
 to
 N
R-
V
2X
 is
 p
re
se
nt
ed
Th
e 
ar
tic
le
 d
is
cu
ss
es
 th
e 
te
ch
ni
ca
l 
st
an
da
rd
s a
nd
 d
ep
lo
ym
en
ts
 o
f 
C
-V
2X
C
ha
nn
el
 m
od
el
lin
g 
an
d 
ed
ge
 b
as
ed
 
co
m
pu
ta
tio
ns
 in
 C
-v
2X
 a
re
 n
ot
 
co
ns
id
er
ed
H
ay
es
 e
t a
l. 
[1
8]
20
20
Y
Y
Y
N
Y
N
N
B
C
-b
as
ed
 d
ou
bl
e 
au
ct
io
n 
tra
di
ng
 to
 
fa
ci
lit
at
e 
pe
er
-to
-p
ee
r E
T 
pa
ym
en
ts
M
od
el
lin
g 
of
 th
re
e-
ph
as
e 
di
str
ib
u-
tio
n 
ne
tw
or
ks
 th
ro
ug
h 
M
A
TL
A
B
 
O
pe
n 
D
SS
, t
ha
t a
llo
w
s E
T 
fo
r l
oc
al
 
di
str
ib
ut
io
n 
ne
tw
or
ks
Th
e 
se
ns
iti
vi
ty
 o
f t
he
 d
ist
rib
ut
io
n 
ne
t-
w
or
ks
 a
nd
 it
s i
m
pa
ct
 o
n 
ET
 tr
ad
in
g 
is
 n
ot
 c
on
si
de
re
d
Fl
or
ea
 e
t a
l. 
[1
6]
20
20
Y
N
Y
N
N
Y
N
B
C
- b
as
ed
 b
at
te
ry
 m
an
ag
em
en
t 
sy
ste
m
 (B
M
S)
B
C
-im
pl
em
en
ta
tio
n 
fo
r b
at
te
ry
 
sw
ap
 a
nd
 c
ha
rg
e 
to
 fa
ci
lit
at
e 
ET
 is
 
ad
dr
es
se
d 
vi
a 
Et
he
re
um
, a
nd
 d
ire
ct
 
ac
yc
lic
 g
ra
ph
 b
as
ed
 IO
TA
Ta
g-
ba
se
d 
IO
TA
 a
lg
or
ith
m
s b
y 
no
n-
re
gi
ste
re
d 
us
er
s, 
th
at
 c
an
 a
dd
 fa
ke
 
tra
ns
ac
tio
ns
 in
 th
e 
ec
os
ys
te
m
Sa
m
ue
l e
t a
l. 
[4
0]
20
21
Y
Y
Y
N
N
Y
N
A
ut
ho
rs
 p
ro
po
se
 E
T 
sc
he
m
e 
w
ith
 
de
m
an
d 
re
sp
on
se
 p
ric
in
g 
m
od
el
 , 
w
ith
 in
cl
us
io
n 
of
 d
em
ur
ra
ge
 fe
es
Se
cu
re
 E
T 
in
 C
B
C
 th
at
 a
dd
re
ss
es
 
th
e 
di
sp
ut
es
 a
m
on
g 
Io
E 
st
ak
eh
ol
d-
er
s t
hr
ou
gh
 d
em
ur
ra
ge
 p
ay
m
en
ts
 
th
ro
ug
h 
B
C
A
ut
ho
rs
 d
id
 n
ot
 c
on
si
de
r a
 re
pu
ta
tio
n 
m
an
ag
em
en
t s
ys
te
m
 th
at
 m
ig
ht
 b
e 
co
m
pr
om
is
ed
 th
ro
ug
h 
m
al
ic
io
us
 
ag
gr
eg
at
or
s
A
bd
el
la
 e
t a
l. 
[2
]
20
21
Y
Y
Y
N
N
Y
N
Pr
op
os
e 
a 
un
ifi
ed
 p
ee
r-t
o-
pe
er
 
pe
rm
is
si
on
ed
 b
lo
ck
ch
ai
n 
sc
he
m
e 
fo
r E
T 
en
vi
ro
nm
en
ts
, a
nd
 n
am
ed
 it
 
U
B
ET
A
D
es
ig
ne
d 
a 
sc
he
m
e 
kn
ow
n 
as
 
H
yp
er
le
dg
er
 B
as
u,
 w
ith
 a
 n
et
w
or
k 
si
ze
 o
f 6
0 
no
de
s a
nd
 re
al
 E
T 
da
ta
 
fro
m
 w
es
te
rn
 A
us
tra
lia
 e
ne
rg
y 
m
ar
ke
t
Sc
al
ab
ili
ty
 w
ith
 m
or
e 
no
de
s i
n 
th
e 
ex
pe
rim
en
ta
l s
et
up
 is
 y
et
 to
 b
e 
co
ns
id
er
ed
Ja
m
il 
et
 a
l. 
[2
3]
20
21
Y
N
Y
N
N
Y
N
B
C
-b
as
ed
 p
re
di
ct
iv
e 
ET
 p
la
tfo
rm
 
w
ith
 re
al
-ti
m
e 
en
er
gy
 fl
uc
tu
at
io
n 
an
al
ys
is
 th
ro
ug
ho
ut
 th
e 
da
y
O
pt
im
al
 p
ow
er
 fl
ow
 a
nd
 e
ne
rg
y 
cr
ow
d-
se
ns
in
g 
to
 le
ve
ra
ge
 E
T 
am
on
g 
co
ns
um
er
 a
nd
 p
ro
su
m
er
C
om
pa
ra
tiv
e 
an
al
ys
is
 o
f m
ac
hi
ne
 
le
ar
ni
ng
 a
lg
or
ith
m
s o
n 
di
ve
rs
e 
pa
ra
m
et
er
s s
et
 is
 n
ot
 d
is
cu
ss
ed
Pr
op
os
ed
20
21
Y
Y
Y
Y
Y
Y
Y
C
B
C
 b
as
ed
 E
T 
sc
he
m
e 
in
 5
G
-V
2X
 
ec
os
ys
te
m
s
SD
N
 is
 e
m
pl
oy
ed
 to
 a
llo
w
 E
T-
as
-a
-S
er
vi
ce
 (E
Ta
aS
), 
an
d 
fo
r 
ch
ar
gi
ng
 p
ro
fil
es
 n
ov
el
 c
on
se
ns
us
 
is
 p
ro
po
se
d
In
he
re
nt
ly
 c
om
pl
ex
 d
ue
 to
 a
 la
rg
e 
nu
m
be
r o
f c
om
m
un
ic
at
io
n 
po
in
ts
 
w
ith
 d
is
cr
et
e 
st
at
es
1.
 E
ne
rg
y 
Tr
ad
in
g 
2.
 L
at
en
cy
 3
. T
ru
st 
4.
 S
D
N
 5
. G
am
e 
M
od
el
 6
. C
on
se
ns
us
 7
. 5
G
/6
G
 , 
Y-
sh
ow
s p
ar
am
et
er
 is
 c
on
si
de
re
d,
 N
-s
ho
w
s p
ar
am
et
er
 is
 n
ot
 c
on
si
de
re
d
1951EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
where Ecl denotes the total EV units that communicates with RSU units, Et is the total V2X 
nodes, p denotes the nodes that participates in communication, and Np denotes the com-
munication signals inside each communicating RSU. MEcl
.p(t) denotes the single mmWave 
channel contribution to any pth node in Np , at any given time instant t. The path loss model 
of mmWave depends on signal shadowing between At and Ar , over a communicating dis-
tance d, at a given carrier frequency f. The path-loss PL in decibels (dB) is defined as fol-
lows [19],
where d0 denotes the free-space reference distance, PL0
 denotes the free-space loss at a 
given distance d0 , �p denotes the path loss exponent, and Qsigmas
 denotes the normal log 
shadowing model. Based on Qsigmas
 , any kth entity EV position is determined based on 
associated distance dEVk
 and predicted angle �EVk
 . To notion the prediction, we consider 
(2)PL(dB) = (PL0
+ 10�p log(d∕d0)) + Q�s
Fig. 1  EVBlocks: SDN-leveraged network model underlying 5G-V2X communications
1952 P. Bhattacharya et al.
1 3
a spatial beam-forming process deployed within a servicing RSU unit to support bi-
directional communication among peer EVs. To model the same, we consider the EV set 
{EV1,EV2,… ,EVk} , divided into two bipartite regions, one denotes the source (S), and the 
other denotes the destination (D), respectively. We consider two EVs P and Q, separated 
through a distance d. The 5G-service antennas model the distance prediction based on 
3D-spherical coordinates denoted via latitude and longitude pairs. For EV P we denote the 
pair as P(�1,�1 ), and for EV Q, we denote the pair as P(�2,�2) . The spherical coordinates 
through the 5G-antenna can be depicted as follows,
where (x, y, z) represents the 3D-spherical co-ordinates for EV pairs P and Q respectively, r 
denote the radius, � denotes the latitude, with constraint, (−�∕2 ≤ � ≤ �∕2) , and � denotes 
the longitude, with constraint as (0 ≤ � ≤ 2�) . The distance DPQ between points P and Q 
can be computed based on Euclidean distance as follows.
Based on DPQ , the EVs position can be computed. At any general co-ordinate (u, t, w), the 
EV predicted mobility in 5G can be derived as follows,
where PPQ denotes the predicted covered distance by EVs at general point (u, t, w). Based 
on the predicted position, the beam gain (in dB) of 5G antenna can be depicted as follows,
where �max denotes the maximum 5G-antenna beam-width and is formulated as follows.
As RSU units deploy 5G-uRLLC services, parallel beam-forming antennas can be selected 
based on matching SDN rule set R. The 5G channel metrics can be depicted as follows,
(3)x = rcos�cos�
(4)y = rcos�sin�
(5)z = rsin�
(6)DPQ =
√
(x1 − x2)
2 + (y1 − y2)
2 + (z1 − z2)
2
(7)
PPQ(u, t,w) = Vpos(u) + DPQrcos�cos�
= Vpos(t) + DPQrcos�sin�
= Vpos(w) + DPQrsin�
(8)Gv =
4�r2
�(r2 tan2(�max∕2))
(9)�max = 2 tan−1
√
4
Gv
(10)CV =Blog2(1 + S∕N)
(11)S∕N =10log10(
SA
RA
)
1953EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
where CV denotes the 5G-channel capacity, B denotes the bandwidth, S/N denotes the sig-
nal-to-noise ratio, and SA and RA denotes the signal strength at the sending and receiving 
antennas respectively. The receiver signal power P(RA) can be determined as follows,
where Qc denotes the path loss exponent of the channel.
3.1.2  SDN Integration With 5G‑V2X
As depicted in Sect.  3.1.1, 5G-channel antennas compute DPQ to form intelligent pre-
dictions PPQ among two-point sets P and Q for EVs to allow an SDN-rule based policy 
framework at higher layers. To form the matching rule set R, decentralized SDN control-
lers are installed to perform network hypervisor services. To manage the trust among SDN 
nodes, a CBC approach is applicable. A local controller CL is installed at each SDN node 
to communicate with the 5G-core data plane [29]. To formulate the same at data plane, a 
wireless manager WM is installed that schedules resource sets based on virtual 5G-slicing 
{S1, S2, S… , Sl} . Thus, multiple virtual networks are instantiated, managed through SDN-
virtual resource managers based on the supply and demand of resources. These virtual 
managers dynamically adjust the demand-response ecosystems based on available channel 
capacity CV and predicted gain GV . The details of the resource-trading model are now pre-
sented in the following section.
3.2  Resource‑Trading Model
This section comprises two subsections-SDN-leveraged CBC resource-trading model and 
the associated problem formulation. Resource-trading model is divided into three layers, 
Layer 0, Layer 1, and Layer 2, depicted as follows.
3.2.1  SDN‑Leveraged CBC Resource‑Trading Model
An SDN-based CBC architecture is proposed for 5G-V2X infrastructure, as shown in 
Fig. 2. The data movement is from the lower layer Layer 0 to the higher layer Layer 2. 
Layer 0 is the data layer that generates energy transactions among entities like EVs, CS, 
and GS. EVs interact for energy exchange with CS located over-communicating GS with 
the desired frequency range. Inside every GS, there are smaller micro-grids, termed as 
location aggregators (LAGs), to facilitate load-balancing of GS. This provides faster reso-
lution to EVs during ET between EVs and CSs. LAGs can gather energy data generated 
by EVs and CSs in their local proximity (intra) or forward requests to other LAGs via 
GS to CS in other spatial coverage range (inter). LAGs forward meta-data information 
{bytes_exchanged, transaction_time, ID (EV), ID (CS), ID (LAG)} to Layer 1, thereby 
decreasing the volume of raw-data. Layer 1 is the decentralized SDN controller layer used 
to manage the network forwarding through routers [48]. Then, it executes the 5G-virtual 
slicing through hypervisors to manage EV charging requests and perform computational 
offloading closer to the edge nodes in Layer 0. Instances of virtual switches are created to 
cater to requests. Layer 2 is an energy transactional layer that collects the user transactional 
information among EVs and CSs from remote locations. Moreover, it provides a consensus 
(12)P(RA) = SA + Gv − Qc
1954 P. Bhattacharya et al.
1 3
mechanism to record transactional data on the chain as an agreed set of truths among par-
ticipating entities.
3.2.2  Problem Formulation
As depicted in subSect. 3.2.1, a CBC scheme operating over the SDN environment is 
proposed to secure ET between EVs and CSs over a LAG. The following is depicted 
in Fig. 3. To provide computational services to LAG and handle large trading requests, 
edge service providers (ESP) are present. The functionality of EVs, LAG and ESP are 
now presented as follows.
Fig. 2  EVBlocks: SDN-leveraged CBC resource-trading model
1955EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
– EVs: In the proposed scheme, EVs and CS aggregate the data for ET at the data 
layer. EVs mainly acts as an energy container because they supply energy back to GS 
during peak hours.
– LAG: At SDN, LAGs provides edge computing services to EVs via edge computing 
controller (ECC). ECC monitors information dissemination, location updates, SoC 
levels, and perform energy transactions supported by green cryptocurrency Energy-
Coin to be added to wallet W. LAGs require a transactional server (TS) (T), a mem-
ory unit (M), and cryptocurrency wallet (W) to support distributed heterogeneous 
requests. To ensure the privacy of EVs, the wallet (W) is added with a nonce, which 
generates random identifiers. W is mapped with corresponding T to ensure payments 
to correct recipients.
– Edge service providers: ESPs integrate the computations and network resources to pro-
vide a unified set of services based on a client-server model. It leverages edge com-
puting services for LAGs [9]. The ESP issues a price for its service, and each LAG 
Fig. 3  CBC-based ET in 5G-V2X ecosystem
1956 P. Bhattacharya et al.
1 3
determines the service demand be purchased based on the price. Then, computation-
intensive mining can be offloaded from a LAG to its proximate edge computing nodes 
instead of being processed locally or by remote cloud nodes.
The layer-wise description of the entities, as depicted in 3.2.1 are as follows.
– Layer 0: Consider a set of communicating GS G = {G1,G2,G3,…Gn} with coverage 
range as {r1, r2,… , rn} . Each range ri has LAGs L = {L1, L2,… , Ln} . Any ith LAG Li 
facilitates as vehicular aggregator for ET with a total of p EVs, denoted as vp within 
Li . Out of p vehicles, consider a kth instance of vp to denote any selected kth vehicle 
in an ith LAG, as Vi
k
 , such that 1 ≤ i ≤ n , and 1 ≤ k ≤ p , respectively. Generated data 
from vp is collected and sent to SDN controller through virtual SDN switches associ-
ated with it at Layer 1.
– Layer 1: As part of SDN controller layer, consider any kth EV data instance selected 
from vp , an utility function Ui
k
 is defined to optimally select kth node in the ith LAG as 
follows, 
where Uth
i
 is the maximum utilization factor of the SDN virtual switch, Bi
k
 is the ideal 
bandwidth of the kth node in the ith LAG, and Dk←i∕r is the average latency for the dis-
tance travelled by kth EV to the ith LAG to charge where the computational processing 
takes place at the rth node of the system.
– Layer 2: At energy transactional layer, consider kth EV, and cth CS, respectively, in 
the ith LAG, denoted by Vi
k
 and Vi
c
 . kth EV and cth CS want to trade energy over a CBC 
network CB having w nodes. To facilitate the trading scenario, kth EV performs a wal-
let transaction Ti with cth CS as follows, 
where Ii
k→c
 is information (control) units with scheduling, routing, and location infor-
mation shared by kth EV to cth CS under the supervision of the ith LAG. Ii
k→c
 is shared 
prior to payload bursts, denoted as Di
k→c
 by kth EV to cth CS in the ith LAG, and nonce 
is a unique pseudo-random number that includes timestamp information, and Ci
k→c
 is 
the credits distribution by kth EV in ith LAG. Similarly, the transactions super-set T will 
contain sub-transactions of all LAGs. 
 The information over the blockchain network CB is rewarded as follows. 
 The transactions performed over the blockchain CB can be secured for discharging 
total energy of vp EV units. In vp , the discharging information for EVs is denoted as 
D[EVs] = {D1,D2,D3,…Di} . Session data is secured by generating pseudo-random 
sequences of numbers {�1, �2,… , �i} for vp to gain access as a challenge from Li and 
launch a session in CB . Then, the session data is set to the closest grid stations Gk 
through a cth LAG Lc . Then, the shared data of transaction follows the pattern for sym-
metric encryption as follows. 
(13)Ui
k
= (Uth
i
× Bi
k
)∕(p × Bi
k
) × Dk←i∕r
(14)Ti = {Ii
k→c
,Di
k→c
, nonce,Ci
k→c
}
(15)T = {T1, T2,… , Tn}
(16)CB = {Hprev, nonce, Ti,Merkle_root}
1957EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
 For asymmetric encryption, we first hash the CB information with LAG hash value 
HLAG and form a combined hash H′ as follows. 
 Then, H′ is encrypted using the public key of grid G, denoted by Pub(G), which is rep-
resented as follows. 
 The corresponding grid decrypts the CS transaction using its private key Pr(G) as 
follows. 
Based on public/private key pairs of GS, a secure ET is proposed in CB between EVs and 
CSs over a LAG. Now, any kth EV in ith LAG that wants to trade energy with cth CS, sends 
its credentials as follows,
where Ck is the credential information of kth EV, Peu is the energy price unit cost, and nonce 
is timestamp identifier. The following computations are handled by a jth edge node at SDN 
controller layer that computes the hash of the transaction as follows,
where a 256 bit fixed output is formed using identity of jth node, and Jk
i
 is the desired SOC 
level of the battery, i.e., the rated capacity. The energy accumulated by the jth edge node 
in the ith LAG, is required by kth EV to perform energy transaction with cth CS as follows,
where Lmax
iSOC
 is the maximum SOC that can be attained and Lr
iSOC
 is the rated EV capacity. A 
threshold Thmin is set for each EV to trade energy with cth CS. Thus, the available average 
energy Jav
i
 is computed as follows.
The energy dissipation loss Lk
dis
 for kth EV is calculated as follows,
where Lk
dis
 denotes energy dissipation for kth EV in transit. Since EVs have limited comput-
ing resources, it is critical to compute energy loss of any kth EV at time instant t. Jcurr
i
 
denotes the current SOC charge levels in ith LAG and Lreq
iSOC
 is the required SOC level for ith 
LAG to support ET among kth EV and cth CS. As measured time intervals are continuous in 
nature, we integrate energy units from 0 to desired SOC Jr
i
 . Computing Lk
dis
 provides us 
with exact information of energy units required for future trading with CS.
(17)ELG[k, [CB||Gk||Lc||�ni ||Merkle_Root]]
(18)H� = HLAG||CB
(19)E[Pub(G), [CB||Gk||Lc||�ni ||Merkle_Root]]
(20)D[Pr(G), [E[Pub(G),CB||Gk||Lc||�ni ||Merkle_Root]]
(21)Ck = {IDk
EV
,Peu, nonce}
(22)H[Ck] = SHA − 256(Ck,Cert(j), J
k
i
)
(23)J
req
i
= (Lmax
iSOC
− Lr
iSOC
) × Jk
i
(24)Jav
i
= (J
req
i
+ Thmin)∕p
(25)Lk
dis
= ∫
Jr
i
0
[(Jav
i
− Jcurr
i
)(Lmax
iSOC
− L
req
iSOC
)]
1958 P. Bhattacharya et al.
1 3
4  EVBlocks: A Blockchain‑Based Secure ET Scheme for Electric Vehicles
EVBlocks secures ET based on the a phased scheme. The phases in the proposed scheme 
are now discussed in the following subsections. Also, to facilitate the reader, the detailed 
nomenclature of the symbols used throughout the paper, is presented in Table 3.
4.1  ETaaS: ET as‑a‑Service via Edge Systems in SDN‑Leveraged 5G‑V2X Ecosystems
As discussed in Sect.  4, LAGs provide edge-computing services through ECC. Any 
TS T in ECC trades energy billing units, represented by � from any kth EV for going 
from points A to B through SDN controlled switches. The transaction is represented as 
follows,
1959EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
where � denotes the units of energy exchanged. The LAG TS T regulates charging of a 
set of EVs E = {E1,E2,… ,En} where each Ei ∈ E gets charged based on specified time 
slots, known as frames. These frames F are divided uniformly over a day length (24 hours). 
The slot length for a particular frame is denoted as �f  . For EVs E = {E1,E2,… ,En} , the 
(26)�iA→B = Lk
dis
× �
Table 3  List of Symbols
Symbol Definition
ri Coverage range for ithLAG
vp Set of p EVs within ith LAG
Vi
k
Any kth vehicle in a ith LAG
Ui
k
Utility function to optimally select kth node in ith LAG
Dk←i∕r Average latency for kth EV to ith LAG
CB Consortium Blockchain network
Ii
k→c
Information units shared by kth EV to cth CS in ith LAG
nonce Unique random identifier
D[EVs] discharging information of combined vp EV units.
Ci
k→c
Credits distribution by kth node in ith LAG
�n
i Pesudo-random sequence of ith LAG, out of total n LAGs
Ck Secret credentials to trade energy units by kth EV in ith LAG
Peu Energy price cost per unit
J
req
i
Desired SOC level of EV battery
Lmax
iSOC
Maximum attainable SOC level
Lr
iSOC
Rated EV capacity
�iA→B ET bill units from location A to B
Jcurr
i Current SOC level in ith LAG.
L
req
i,SOC
SOC requirement of kth EV in ith LAG with cth CS.
�f Slot length for a particular frame
p
�fi
k
Price of charging EV k at a given slot �f
ps
k Selling price of an energy unit to kth EV
l
opt
i
Optimal edge charging node over set of all edge nodes
U
j
i
Utility function as defined in Eq. 31
c
j
i
Cost function for edge-service ETaaS
o
j
i
Objective function defined over the set of all LAGs L
�∗ Game moves in non-cooperative game
�i Payoff mechanism for kth EV
C̄i
Local convex optimization
e∗ Distinct and unique Nash equilibrium point in non-cooperative game model
C
j
i
 , Dj
i
Charging and discharging efficiency for kth EV in jth GS
CL , DL Charging and discharging length
P(t) Overall power consumption to determine rated capacity of EVs
Txi Charging profile to achieve consensus
d Local delegate from a set of delegates D
1960 P. Bhattacharya et al.
1 3
slots are represented as {�f1,�f2,… ,�fn} . EV charging is done by selecting a time frame 
�fi ∈ �f  . The price of charging any kth EV at a given slot is denoted by p�fi
k
 and is repre-
sented as follows,
s.t
where ps
k
 is the selling price of an energy unit to kth EV and pb
k
 is the buying price, respec-
tively, |�| is the real-time market deviation in cryptocurrency EnergyCoin price. Measuring 
|�| smoothes out the sudden hike in price fluctuations [25]. Figure 4 depicts the overall net-
work interaction of ET between CS and EV via LAG supported by edge services through 
ECC.To maximize the utility of energy transactions and minimize the latency, an optimal 
edge charging node lopt
i
 is selected over the set of all edge nodes. lopt
i
 provides the utility of 
edge-based peer ET service, termed as ETaaS, and is defined for kth EV over the jth optimal 
edge node as depicted in Fig. 5. The utility function is denoted as Uj
k
 and is calculated as 
follows,
where d(k, l) is the distance between kth EV and jth edge node. The cost function is defined 
as cj
k
 and is calculated as follows,
where Breq
j
 is the required bandwidth, Tj is the throughput provided by the jth edge node, 
and tj
k
 is the transactional delay. The function f(.) is a three-input linear convex approxima-
tion cost function, with variables throughput, delay and distance. The aim is to maximize 
f(.) w.r.t. jth edge node. As distance d(k, j) varies according to edge node location, we select 
constants k1 and k2 by equating �d
�j
f (.) = 0 . Plugging values of k1 and k2 in f(.), we compute 
local maxima (i.e. �
2f
�j2
 is negative). Similarly, to maximize the utility Uj
k
 , an objective func-
tion oj
k
 is defined for set of LAGs L = {1, 2,… , l} and represented as follows,
s.t
(27)p
�fi
k
= �
(
Lmax
iSOC
L
avg
iSOC
− L
req
iSOC
)
(28)0 > |𝛼| > 1
(29)ps
k
> pb
k
, if𝛼 > 0
(30)ps
k
< pb
k
, otherwise
(31)U
j
k
=
(
B
req
j
.Tj
(n + 1).tl
k
)
.
1
d(k, j)
(32)c
j
k
= B
req
j
.U
j
k
�d
�j
[f (Tj, t
j
k
.d(k, j)]
(33)o
j
k
= max[
l∑
j=1
(U
j
1
�
j
1
+ U
j
2
�
j
2
+⋯ + U
j
l
�
j
l
])
(34)0 < U
j
k
< Umax
1961EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
(35)0 < e
j
k
< emax
(36)Uk(S) > Uk(b)
Fig. 4  Trading interaction between EVs and CS in ETaaS by utilizing services via LAG
1962 P. Bhattacharya et al.
1 3
Based on the above discussion, we now present the ET Algorithm 1 that takes into account 
the interactions between CS and LAGs inside a GS G having public and private key pairs. 
The output is the energy bill units traded between EVs and CS, the utility function and the 
cost function of energy units traded.
4.2  EVBlocks: Proposed Non‑Cooperative Game model
To maintain charging benefit of EV, E requests offloaded energy service over a set of LAG 
Li ∈ L . To facilitate the same, a non-cooperative game N can be modeled based on energy 
units �i requested by kth EV over an optimal selected offloaded LAG i. The offloading ser-
vice is handled over a slot frame Fi ∈ F . At the initial phase, all the LAGs Li determine the 
charging time slots �fi for kth EV based on start time ts , and forms a basis information bk
i
 
for ith LAG providing offloading service to kth EV. The game N has a set of possible actions 
A = {a1, a2,… , an} and a set of possible strategies S = {s1, s2,… , sn} for each action 
ai ∈ A . The mapping function is defined as f ∶ A × S → {p
�f
k
, ai
k
, si
k
, �∗} where si
k
 denotes 
the kth EV strategy to maximize profit with the ith LAG during trading, and �∗ denotes the 
set of all possible moves (transitions) in the game N. The non-cooperative game N is mod-
eled as follows,
where P denotes the set of players (EV and CS) in the game, p�f
i
 denotes the allocated 
price decided by the game moves �∗ , and �k ∈ � denotes the payoff mechanism of kth EV 
for energy traded units. The actors in the game are as follows.
(37)dk(t) < dk(t − 1)
(38)N = {P,A, S, �∗, p
�f
i
, �}
Fig. 5  ETaaS: ET as-a-Service
1963EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
– Players P: ∀ek ∈ E , and ∀lj ∈ L denotes the EVs (buyers) and CS (sellers).
– Actions A: ∀ak ∈ A , determine ts and basis information bk
j
.
– Strategy S: sk ∈ S to maximize the pay utility Uj
k
 subject to constraints as defined in Eq. 
(38).
– Moves �∗ : Set of all state transitions moves that deterministically starts from an initial 
action state a0 , takes a label strategy transition over possible strategies S, to converge to 
a final action state af .
– Price p�f
j
 : Consists of selling price of energy units by CS, denoted as ps
j
 and buying 
price of energy units by EVs, denoted by pb
k
 . The objective is to maximize the function 
o
j
k
 subject to constraints defined in Eq. (38).
1964 P. Bhattacharya et al.
1 3
– Payoff �k : A payoff scheme � is designed for any EV supported by agreegator LAG 
lj ∈ L . �k is defined as follows. 
The game N operates over moves as sequence of state transitions �∗ = {�1, �2,… , �w} . Let 
�q ∈ �∗ be a possible general move for LAG l and EV e. Depending on the transaction pro-
files generated by the ESP server T, �q maps aq × sq → �q . The incorrect moves are marked 
as transition to a dead state D and contains the complement of moves in �∗ , and is denoted 
as �∗ . Depending on the actions and strategies to maximize profits, we construct a tree T 
having root node as Troot , which is initially an empty set � . The winner W of the game adds 
a newly created child node to parent Troot via an edge e. The tree grows by adding nodes 
{n1, n2,… , np} and edges {e1, e2,… , ep} by selecting moves {�1, �2,… , �p} . The local con-
vex optimization Ck [14] is represented as follows,
where {Ck(Ck,C−k)} ≡ �
j
k
 and C−k is the EV payoff principle �j for set of LAG aggregators 
lj ∈ L.
Proposition 1 The set of moves �∗ in the game N has a unique and distinct Nash equilib-
rium e∗.
Proof For a given C−k , the local optimization Ck is concave and is a Hermitian Matrix 
Hk [44] over the set of utilities Uj
k
 and is strictly negative. The distinct actions ak ∈ A are 
based on strategy set S that defines a payoff �k which is distinct and non-empty. The transi-
tions states are deterministic over the tree T by adding an edge, iff �q ∈ �∗ exists. Hence, 
there exists a pure Nash equilibrium strategy [39]. The Nash equilibrium for the game N is 
e∗ = {e1, e2,… , en} and can be found by traversing tree T using Depth first search (DFS) 
strategy. The equilibrium terminates when the relative distance between two consecutive 
iterations jk and jk−1 is small by a relative factor Φ , i.e., |� jk − � jk−1 | ≤ Φ .   ◻
Proposition 2 The nash equilibrium e∗ for the set of all moves �∗ has a perfect equilibrium 
for the game N.
Proof Since the game N is modeled as a tree space T, we traverse from Troot and reach 
node nj . The sub-moves �∗
s
 to nj are those path lengths P = {p1, p2,… , pj} where any edge 
pk ∈ P has a valid transition move defined in �∗ . Hence, the outcomes of the edge transi-
tions maximize the utility Uj
k
 and minimize pk . The remaining paths p = {pu, pu+1,… , ps} 
are invalid and does not reach a unique equilibrium state. Hence, they are not added to the 
solution set by DFS. Thus, for a given Nash Equilibrium that is distinct over �∗ , there exists 
a perfect equilibrium for the game N.
(39)�k = −c
j
k
= −[B
req
j
.U
j
k
�d
�j
[f (Tj, t
j
k
.d(k, j)]]
(40)Ck = argmax{Ck(Ck,C−k)}
1965EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
The non-cooperative game is depicted in Algorithm 2. As k EVs request energy units 
over slot charging slots �fi , the space complexity for maintaining slot information is O(kl). 
Also, the game N operates by a selection of state moves �∗ over n LAGs for p EVs. Thus, 
the time-complexity of algorithm 2 is O(p.n.� ∗) .   ◻
4.3  PoG: A consensus Serial Event‑Driven Algorithm for EVBlocks
Consider the set of transactions T = {T1, T2,… , Tn} operating between EVs and CS mod-
elled over game N. The power supplied from GS is maintained as a local state function � and 
is used for charging/discharging of EVs. The state function defined as �i = {�1, �2,… , �n} 
denotes the charging rate cj
k
 for kth EV and jth GS and is given as follows,
where v is the charging efficiency based on properties of electrical conductor and xj
k
 is the 
operational charged energy state of kth EV managed by jth GS during operational time Ct . 
Similarly, the discharging rate Dj
k
 is represented as follows,
where � is the discharging efficiency and yj
k
 is the operational discharged energy state and 
excess energy transferred back to jth GS over discharging time dt . The kth EV starts charg-
ing at time ts
k
 and finishes at time tf
k
 , hence the charging length is CL is denoted as follows.
Similarly, the discharging length DL is calculated as follows.
Charging length denotes the battery capacity of EVs. The overall power consumption is 
represented as follows.
where base(t) is the base power consumption to dampen electrical fluctuations in the net-
work. The optimization is defined as Cmax
L
 , and Dmin
L
 and is denoted by Oj
k
 , and defined as 
follows.
s.t.
(41)C
j
k
= v
∑
k∈Ct
x
j
k
(42)D
j
k
= �
∑
j∈Dt
u
j
k
(43)CL ≤ max(U
j
k
(ts
k
− t
f
k
)
�d
�j
(f (Lmax
jSOC
, c
j
k
, Tj)
(44)DL ≤ min(U
j
k
(ts
k
− t
f
k
)
�d
�j
(f (Lmin
jSOC
, c
j
k
, Tj)
(45)P(t) = ∫t∈T
(CL − D
j
k
)dt + base(t)
(46)O
j
k
= ∫
T
0
(P(t) − P(t − 1)2dt
1966 P. Bhattacharya et al.
1 3
The charging profile Txk = {C
j
k
,D
j
k
,CL,DL,O
j
k
} for kth EV performing energy transac-
tion with jth CS is communicated to GS via a local delegate d ∈ D . d assigns Txk to an 
event-driven scheduler S. S provides a serial-driven event schedule based on a locally 
c-competitive convex optimization problem [34]. To achieve it, the scheduler divides 
time frames �f  into discrete transfer slot units denoted as tk,m where k denotes the EV 
number and m denotes the input line for EVs. The slots are numbered as {1, 2,… , l} . 
Slots are differentiated on the basis of successful and collision slots. Any lth slot is 
successful if k successfully sends an energy transaction packet from input line m to 
leader EVL , and other nodes do not transmit in lth slot. Otherwise, in case of conten-
tion between two EVs p and q for slot l, it indicates a collision slot. The output of the 
contention is stored in S. Based on the output of S, the delegate d ∈ D forms a global 
and local consensus among transactional added to nodes. All EVs are now in conten-
tion for energy frame transfer via these common slots length Ls . To minimize collisions, 
a 0.01-persistent carrier sense multiple access (CSMA) is provided. Successful slots 
(47)�
t
f
k
ts
k
U
j
k
≥ C
j
k
, (k, j) ∈ {1, 2,… ,N}
(48)�
t
f
k
ts
k
U
j
i
≤ D
j
k
, (k, j) ∈ {1, 2,… ,N}
Fig. 6  PoG: Proof-of-Greed Consensus mechanism
1967EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
are then communicated via local coordinator � elected through the proposed consensus 
mechanism PoG among all EVs as depicted in Fig. 6.
The election procedure is based on the current value of traffic profiles of EVs that might 
change once excess energy is transferred back to GS. A traffic profile for any kth EV contains 
transaction information Tk . Hence, the election process is termed as greedy w.r.t. scheduler S 
as local consensus may not lead to a global consensus state. � then broadcasts the successful 
slots as follows,
where ATx
 are assigned transactions, h denotes the current block height, Hcurr is current 
block hash, q is a counter for managing re-transmissions (in case of collision slots), � is 
saturation cutoff range, and sigsqm(H(�)) is signature operation on � . The EVs are notified of 
unsuccessful transmission as follows,
(49)B = {ATx
, h,�,Hcurr, q, �, Sk, Lcurr}
(50)� = {T ,HTx
,E}
1968 P. Bhattacharya et al.
1 3
where E denotes the serial identifier of EV signed by sigsqm(H(�)) . In algorithm 3, initial-
ize_leader function elects a leader EVL based on EV that has maximum number of success-
ful transactions appended to chain. The leader is now appointed as local coordinator � to 
facilitate consensus. Once � is selected, the height h of blocks is increased by 1, and sig-
nature parameters defined in Eq. 49 are computed. The details are then broadcasted in the 
network through a simple broadcast address, as defined in Broadcast_Consensus function. 
If no leader is appointed, function Error_Notification with inputs as {T ,Hcurr, Si, Lcurr} 
is broadcasted to roll-back the election process to local state Si . Lcurr denotes the current 
length of chain at the instant. All participating EVs are notified through Notify_EV func-
tion. The parameters are mentioned in Eq. 50. The EVs whose slots have collided need to 
broadcast their energy frame as unsuccessful attempts. The leader EVL selected by � then 
verifies block-hash H(a) and adds it to the chain. At all times, the height h of the chain 
length is also stored as to purge same-length chains created via forking operations. If block 
verification fails, then cutoff � is increased by �=� + q , denoted as �q , and the count is 
maintained as count(�q) . An objective load function f is designed to minimize re-transmis-
sions.To comply with this, cutoff �q ≥ M − f  , where M is the message length. If conditions 
fail, the collision slot is considered for re-transmission, and counter q is incremented, and 
the entire process is then repeated. The details of the consensus mechanism are now pre-
sented in Algorithm 3.
5  Performance Evaluation of EVBlocks
In this section, we evaluate the performance of EVBlocks based on two factors. First, we 
present the obtained simulation results based on the adaptive charging network (ACN) EV 
dataset [31], to study the EV behaviour. The dataset consists of over 30,000 EV charging 
sessions from two CS sites, geographically located in California. The dataset is managed 
by PowerFlex, which is an EV charging startup. Next, based on the analyzed EV charg-
ing profile behaviour, we present the simulation parameters for the experimental setup and 
evaluation process.
5.1  ACN‑EV Dataset
The dataset consists of charging profiles of 54 EV supply units, or CS), located at the 
Caltech campus in California. The CS contains a 50 kilowatt DC fast charger and includes 
the charging profile details of parked EVs throughout the day. EVs are charged to full 
capacity through an adaptive scheduling algorithm, and rated battery usage is measured. 
The dataset consists of field descriptors like EV cluster_ id, charging_current, user_ID, 
connection_ID for charge transfer, and charging_duration (connect and disconnect time).
5.2  Plots of EV Charging Profiles
To begin the simulation, we import the acnsim library in Python, and set up the Caltech 
timezone, and kept the charging interval setup for 5 minutes. The network voltage is set to 
220 volts. We first set the default maximum charging rate of EV battery as follows,
(51)Cmax = 32 × V∕100
1969EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
where Cmax is the default battery power. Next, we set up the charging network with a 
defined constraint matrix representing the electrical wire interface in the dataset. The net-
work is manually configured through the add_constraint() method, register_EV() method, 
and charge() method. Next, we set up the event-driven charge scheduling through acn-
data_events package that simulates the real EV behaviour. The library is accessed through 
a token-based API. A scheduling algorithm is presented in acnsim that allows dynamic 
scheduling of EVs for charging-based slots at CS. We present the plots for SOC and charg-
ing profiles of EVs. Figure 7 depicts the plots. We consider a total of 50 nodes (EVs and 
CS) that perform ET over a day long. We measure the aggregate battery levels of EVs 
and CS during the transaction. As through PoG, we measure P(t), and set base(t) at 24 V. 
Based on charging profiles Txk , and slot lengths, we dampen the charge fluctuations for both 
EVs and CS. Figure 7 (a) presents the details. We only observe a charge shoot beyond 27 
V, and a minimum shoot below the threshold level of 24 V. Most of the charge fluctuations 
are balanced in the range, which indicates that event-driven simulation balances the volt-
age loads. Next, we measure the ET scenario and measurement of SOC levels for 20 EVs. 
Figure 7 (b) presents the EVs energy levels and charging requirements of batteries when 
traded exchange occurs with CS. As indicated, we present the SOC requirements of EVs 
and the present charge levels of EVs.
In some cases, the EVs are required to consume all the presented battery (complete red 
bars), and some have excess energy (blue with red bars) that can be traced back to the eco-
system. Based on the SOC levels, the difference between the required and present charge 
levels is highlighted. In most cases, the edge services handle most of the requests and form 
a resilient exchange. The ET transactions are recorded in BC, and the recycling fluctuations 
are minimized through the proposed event-driven consensus [30].
We now present the key analysis of the derived EV plots. Figure  8 (a) presents the 
energy transacted between CS and GS profile for a single day (24 hours). From the figure, 
it can be inferred the max-peak load range of 0.8 − 0.9 is achieved between 6:00 and 9:00 
AM (morning), and the load significantly reduces to 0.15 between 12:00 noon and 3:00 
PM. The load significantly drops as most EVs are parked after usage at evening hours. 
Thus, from the simulation, it can be inferred that EVs sufficiently trade energy with CS and 
GS at day-hours, and thus, responsive ET services at the edge are required. The edge nodes 
can be switched to SLEEP mode once the EVs are parked, as ET transactions decrease 
gradually. Next, we present the utilized current or total aggregate current of EV over a 
Fig. 7  SOC and Charging profiles of EVs-ACN-charging dataset: a Voltage levels of EVs during charging, 
and b Required and utilized SOC levels of EVs
1970 P. Bhattacharya et al.
1 3
specified time interval. Figure 8 (b) presents the details. The simulations show that EV has 
a peak aggregate of 981.6 ampere (A) at the elapsed period between 650 − 725 secs. As 
more time elapses, the current utility of EV gradually decreases and eventually drops to 
base level after 1200 seconds. Thus, the plot presents useful insights into EV SOC levels. 
After a specified time threshold, the proposed scheme maintains a charging set E of EVs 
and presents time intervals as slot lengths �fn . Once Lreq
SOC
 falls below the threshold, EVs 
have to start ET with the nearest LAG, and it invokes a non-cooperative game among EVs 
and CS for profit maximization.
 Next, we present the EV energy consumption profile over a day. The details of the 
same are presented in Fig. 8 (c). As evident, EVs maximum energy, ≈ 6.25 kJ, during the 
daytime slot. This validates the load assumption presented in Fig. 8 (a), as more EVs run 
out of charge and thus perform ET with CS. Thus, the energy transaction among CS and 
GS approaches maximum load during the daytime. The excess charge/discharge units can 
be supplied back to the sink through our proposed event-driven consensus scheme, which 
takes into account CL , and DL respectively, and dampens the charge fluctuations over base 
power consumption (or average load behaviour).
 Based on observed EV and GS charging and load profiles, we present the simula-
tion parameters for the EV setup. The details of the same are presented in Table 4. These 
parameters are chosen on the basis of ET [11, 57], measurement of SoC levels [12], mini-
mizing block latency [24], and maximizing profits by non-cooperative game approach 
[44]. We assume that most of the edge nodes are available in the desired spatial range 
and are uniformly distributed over the given map region to minimize latency. The pricing 
utility is modelled to minimize high fluctuations, where � is selected based on observed 
standard rather than mean deviation. We compare the performance of EVBlocks with 
conventional(flat) and fixed tariff schemes [47] in blockchain. In the conventional or flat 
scheme, the base unit price per unit P and the charged fee are the same for all transacting 
EVs with CS. In fixed-tariff scheme, a non-cooperative game model among players EVs 
and CSs with energy demand modeled as a linear function �(�) given as �(�) = cx(�) + Z , 
where c is a constant fixed for transactional consensus, and x is any kth EV.
5.3  Experimental Setup
The setup deploys open-source confidential consortium scheme (CCF) [1] v1.0. The path 
libraries are set on a virtual machine (VM) running Ubuntu Linux v18.04 LTS with two 
Fig. 8  Charging plots for EVs from ACN-charging dataset: a Transacted enegy between CS and GS (single 
day profile), b Utilized current by EV during charging, and c EV energy consumption profile (single day 
profile)
1971EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
virtual CPU cores. The internal memory is 4 GB RAM with 30 GB external hard-drive. 
The testing is performed on Node.js v8.9.1 with npm v6.7.0. For the SDN controller 
switch, we have used OpendayLight Controller Neon-SR1 to manage server hyper-visors.
Table 4  Simulation Parameters
Parameters Values
E: Total number of EVs e 35
LAG: l 2
CS: c 10
� : Mined energy transactions 0-3000
T: TS 1
h: hours (in a day) 0–24
U
j
i
 : ith EV utility with jth edge node ordinal scale 1–6 
1: low utility, 6: 
excellent
Ts : Transactions performed over TS T 2800
Lr
iSOC
 : rated battery capacity 27kW
L
req
iSOC
 : SoC levels (in mW) 10–38mW
ps
k
 : selling price of energy unit (1kwH) 1.4 $/kwH
pb
k
 : buying price of energy unit (1kwH) 0.7 $/kwH
� : constant to smoothen load in price fluctuations 0.4
k: iterations performed to maximize profit 0-16
Cb : Block transactions in CBC 0–1000
v: Charging efficiency 0.8
� : discharging efficiency 0.4
� : charging iterations 20–200
�t : max collision throughput (CSMA/CA, p = 0.01) 0.84
Table 5  Types of EV EV_Type Max battery capac-
ity (in kwH)
Charging voltage 
(in V)
Internal 
resistance 
(in Ω)
1 32 220 6.875
2 18 210 11.666
3 22 240 6
4 62 325 3.823
5 8 110 7.333
1972 P. Bhattacharya et al.
1 3
5.4  EV Setup
A sample area map distributed over a 20km spatial range is selected. The scenario 
considers 2 LAGs L operating over the range to support ET between 5 different types 
of EVs with 7 EVs in each type. The total number of CS is 10. EVs can supply excess 
energy back to CS and vice-versa, with an operational up-time of a day length (0-24 
hours). The performance of EV output is measured by fixing Thmin w.r.t. simulation 
parameters as listed in Table 4. The specifications of EV type are presented in Table 5.
5.4.1  Performance Analysis of ET
EVs trade excess energy to CS or require energy from CS. The energy profiles of EVs 
types are loaded, and SoC levels are measured for the proposed scheme, as shown in Fig. 9 
(a). It can be inferred that as the number of hours increases, the proposed scheme maintains 
an average SoC charge of 22.8MW, with a peak of 37.5 MW, which is 25% higher than 
other approaches. The decay in the proposed approach is also graceful at 17.4 MW. As 
more EVs are charged based on specific time frames, with frame length �f  , the charging 
is fast as we only need to refer to the index of the frame unit. Fig. 9 (b) shows the various 
values of � w.r.t. the block trading time Bt . At 1000 transactions, the value of Bt for both 
proposed and conventional methods is ≈ 12.06 secs. At 2750 transactions, the difference is 
≈ 396.97 secs, with a significant decrease of 67.3% in the proposed approach. As trading 
nodes are closer to the edge and employ content offloading services, the trading time is 
minimized. In Fig. 9 (c), we have compared our proposed approach against two conven-
tional schemes: tariff scheme and conventional (flat) schemes. The figure indicates that the 
average power dissipation of the proposed scheme is 4.1125 kWh, compared to 3.1127 
kWh for the tariff scheme and 2.225 kWh for conventional methods. The peak power dis-
sipated is 5.8kW at 16 energy transactions/hour among EVs. This peak is 29.31% higher 
than the combined approaches. As the objective function considers maximizing the utility 
function, more energy transactions can be performed. Thus, EVs can supply more excess 
energy back to CSs or GSs, indicating higher satisfaction of EVs.
(a) (b) (c)
Fig. 9  Performance analysis for ET: a Measurement of SoC charging levels , b Energy Trading time vs 
Mined Transactions, and c Power dissipated (in kWh)
1973EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
5.4.2  Impact of Non‑Cooperative Game in Maximizing Profits
The proposed non-cooperative game N assumes mapping between actions and strategies 
and designs a payoff function based on the defined cost function. The incorrect transition 
moves are discarded, and the space search tree is built based on moves �∗ . To simulate this, 
we assume different types of EVs with specifications, as depicted in Table 5. The profit 
function is measured between two consecutive iterations (k − 1) and k over slot length of 
�f  . The following is depicted in Fig. 10 (a). It can be inferred that initially, as the game 
moves are built, the profits are maximized for all EV types as the margin of pb
k
 and ps
k
 is 
high, but gradually the profit margin becomes constant for all EVs. The final stable profit 
values for EVs = {EV1,EV2,EV3,EV4,EV5} are (0.88,  0.74,  0.77,  0.84,  0.72) respec-
tively. The stable values indicate that search space for tree T is built and any path of the tree 
{pk, pk+1,… , pl} will lead to the same node at the final iteration following the defined path. 
This proves the existence of nash equilibrium e∗ for all EV types.
5.4.3  Performance of Consensus Mechanism PoG
To measure the performance of event-driven by PoG consensus algorithm, we compare the 
results against tariff and conventional schemes, as depicted in Fig. 10 (b). The proposed 
scheme has an average utility value of 4.883 compared to 3.317 for the tariff scheme and 
2.613 for the conventional scheme. Thus, the proposed scheme achieves higher utility by 
a factor of 1.64. As successful slots are higher, more blocks are hashed to be added to the 
chain, resulting in more EV utility. To minimize fluctuations during charge supply, we set 
charging and discharging parameters v and � as depicted in Table 4. Figure 10 (c) shows 
the block computation time for signing operations using symmetric key km over a hashed 
block. As blocks are increased, the signing time increases slowly with an average value of 
≈ 0.236 seconds for 1000 transactions. The average value of validation is ≈ 0.2722 seconds. 
As collision slots are minimized based on optimization function oj
i
 , only successful trans-
mission slots are communicated via block leader EVl resulting in less block computation 
time. Figure 10 (d) validates the advantage of proposed consensus mechanism PoG against 
other conventional consensus protocols. We consider an additional parameter ’block con-
vergence time’ as the time required by all nodes to agree on the same truth, i.e., consen-
sus vs. validated blocks via consensus. A node may contain a set of energy transactions 
{E1,E2,… ,En} . The results favour PoG, and it outperforms the said approaches for small 
values of mined nodes. At 200 nodes, the average converge time of conventional schemes 
is 16.10 secs, and the proposed is 7.27 secs. As the number of nodes increases, the dif-
ference of block convergence time reduces against conventional schemes. At 1000 nodes, 
the average of conventional schemes is 148.56 secs, compared to 138.96 secs in PoG. As 
Fig. 10  Impact of Non cooperative game and consensus mechanism PoG: a Profit in $∕kwH for charging 
EVs, b Utility of EVs , c Block computation time (in secs), and d Block Convergence Time (in secs)
1974 P. Bhattacharya et al.
1 3
PoG elects local coordinator � based on slot-lengths, the scheme is not scalable for a large 
number of nodes. However, EvBlocks exploits edge services through ETaaS, hence energy 
transactions are locally resolved. This allows proper load-balancing among all LAG serv-
ers. So fewer transactions are present at the local coverage range, thereby making PoG as 
optimal consensus protocol w.r.t. the limiting conditions.
5.5  Security Evaluation of EVBlocks
The proposed scheme is now evaluated for the secure and private transfer of EV identities 
over the CBC CB . To perform security computations, the computation costs (CC) and com-
munication costs(CCM) of security identifiers are taken from [45]. Table 6 depicts the CC 
and CCM of various identifiers as presented in [45].
5.5.1  Computation cost
The computation cost is evaluated in three phases. Firstly, EVs perform ET with CS as 
proposed in Algorithm 1. The proposed algorithm consists of a wallet Ti exchange, sym-
metric key operations between EVs and CSs, and asymmetric key operations based 
on public/private pairs of GS. The ET algorithm consists of 5 hash operations, two 
symmetric key operations, and one asymmetric operation. Thus, the time required 
is 5 × 0.00032 + 2 × 0.0056 + 0.0215 ≈ 0.0343 seconds. Secondly, the profit mar-
gin of EVs is maximized based on the non-cooperative game as depicted in Algo-
rithm  2. The algorithm consists of 2 block transaction appends. The cost required is 
2 × 0.00032 ≈ 0.00064 seconds. Finally, the consensus mechanism is framed to mini-
mize energy fluctuations while transferring excess energy of EVs back to GS, as pre-
sented in Algorithm  3. The algorithm contains three hash operations; two transac-
tions append operations, one signing and one verifying operation. The cost required is 
3 × 0.00032 + 2 × 0.00032 + 0.004085 + 0.005865 ≈ 0.011350 seconds. Thus, the overall 
computation cost for the proposed scheme is 0.0343 + 0.00064 + 0.011350 ≈ 0.046290 
seconds or 46.92 ms.
Table 6  Computation and 
communication cost of various 
identifiers
IDi : Identity cost; Esym : Symmetric encryption cost ; Easym : Asymmet-
ric encryption cost; nonce: random nonce cost;H(IDi) : Hash for fixed 
identity cost; Hm : Message hash; Sm : Message Signature cost; Vm : 
Message verification cost; Ti : Transaction appended to chain cost;
Identifier CC (in seconds) CCM (in bits)
IDi 0.00032 32
Esym 0.0056 32
Easym 0.0215 32
nonce 0.00032 16
H(IDi) 0.00032 160
Hm 0.00032 256
Sm 0.004085 192
Vm 0.005865 192
Ti 0.00032 160
1975EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
5.5.2  Communication Cost
The communication cost is evaluated in the same pattern of computation costs. Firstly, the 
ET algorithm  1 between EVs and CSs performs a wallet transaction exchange, one ses-
sion key exchange, one certificate issue to verify credentials of qth CS in ith LAG, and 
one encryption and decryption operation. Thus, the total bits involved in communication 
is 160 + 32 + 256 + 32 + 32 = 512 bits. Then, the non-cooperative game algorithm  2 
exchanges information of time slot �f  . Considering 100 frames, the total exchange is 100 
bits. The mapping operation ai × si → �i takes 32 bits exchange, then 16 iterations are 
performed for path addition to tree T, each path takes 1 bit information. So, 16 bits are 
required. To check the added move, � ∈ �∗ is valid/invalid, 1-bit check flag information 
is appended. Thus, total bits are 100 + 32 + 16 + 1 = 149 bits. At last, the consensus PoG 
algorithm 3 requires verification of transaction Tx , i.e., 192 bits, block creation takes 160 
bits, consensus broadcast message requires 160 bits, and the corresponding EV is notified, 
which requires 1 bit. Then, considering leader selection for 16 iterations, leader selection 
� requires 16 bits. Finally, slot identification as success or collision requires a flag of 1 
bit. Thus, total communication cost is 192 + 160 + 160 + 1 + 16 + 1 = 530 bits. Thus, the 
overall communication cost of the proposed scheme EVBlocks is 512 + 149 + 530 = 1191 
bits or 149 bytes of information. The number of message exchanges (ME) in ET algorithms 
are one for session exchange and one for certificate exchange, so the total is two messages. 
In the non-cooperative game path addition and flag information, a total of 2 messages, and 
in PoG algorithm, there is consensus broadcast, Notify_EV, leader selection, and slot col-
lision, i.e., a total of 4 messages. Total messages exchanged are 2 + 2 + 4 = 8 messages. 
Table  7 shows the overall comparison of Computation cost (CC), Communication Cost 
(CCM), and several messages exchange (ME) against existing schemes.
5.6  Efficiency of EVBlocks Against Conventional Schemes
The proposed scheme EVBlocks is now compared against existing state-of-the-art schemes. 
EVBlocks employs ET algorithm on a CBC to increase transactional speed, and at the 
same time, keep identities of EV secure and private. The dynamic pricing of energy con-
sumption per unit is optimized using a non-cooperative game to maximize utility and pay-
offs. After maximizing profits, an event-driven time slot-based scheduling is proposed to 
achieve consensus on locally optimal strategies. Table 8 shows the comparative analysis 
of the proposed scheme against other existing approaches. The results demonstrate that the 
proposed scheme has higher benefits against the chosen parameters than other state-of-the-
art methods.
Table 7  Comparison of overall computation (CC) and communication cost (CCM) against existing schemes
Easym : Asymmetric encryption cost; Hm : Hash output cost; Tpair : Bilinear pairing cost; Esym : Symmetric 
encryption cost; Ti ∶ Transaction append cost; Sm : Signing cost; Vm : Verification cost
Scheme CC CCM ME
Odelu et al. [37] 7Easym + 12Hm + 2Tpair ≈ 505.72ms 240 bytes 3
Hathaliya et al. [17] 9Hm + 3Esym + 4Easym ≈ 96.64 ms 176 bytes 3
Proposed EVBlocks 8Hm + 2Esym + Easym + 3Ti + Sm + Vm ≈ 46.92 
ms
149 bytes 8
1976 P. Bhattacharya et al.
1 3
6  Limitations of BC‑Based ET and Possible Future Directions
In ET-based ecosystems, deploying CBC offers significant advantages of secured trans-
action access among authorized stakeholders. However, there are inherent challenges in 
securing ET through an effective network and spectrum management in V2X scenarios. By 
2030, it is envisioned that massive internet-of-things (mIoT) devices would communicate, 
which significantly raises the processing and computing capabilities of the edge nodes. 
Thus, with massive and dense connectivity, there are technical and deployment challenges 
to integrating BC-based ET scenarios in V2X ecosystems. Some of the key challenges and 
potential solutions are listed as follows.
– Computational bottlenecks in 5G-V2X and transition towards 6G: Each CBC node is 
required to maintain and store a copy of the indexed ET transactional ledger, and with 
the rise of mIoT nodes, future V2X would require massive connection device density 
at the edge [52]. Although SDN addresses the network management issues through a 
virtualized set of services, current edge systems are required to run a local set of trans-
actional data, which increases a significant burden in terms of storage and computation 
costs. Moreover, mIoT requires computations to be resource-constrained, and thus the 
effective realization of BC-based integration with mIoT requires lightweight consen-
sus formation. Thus, current 5G-based v2X ecosystems face computational bottlenecks 
with increased participation of mIoT nodes for ET with CS through edge-based ser-
vices. To increase the computational capabilities, sixth-generation (6G) is a viable fit 
that integrates with BC as part of its underlying protocol stack. Also, 6G allows an 
intelligent mix of virtualized network management through SDN and artificial intel-
ligence-based responsive edge that can handle the vehicle mobility and dense sensor 
integrations [54].
– Limitations of BC scalability: As the number of ET transactions among EVs and CS 
increases, the scalability and performance of the BC networks significantly degrade. 
Table 8  Comparative analysis 
with existing schemes
A1: Energy Grids; A2: Multiple EVs; A3: Multiple CS; A4: Dynamic 
Price A5: EV utility; A6: Distributed Consensus; A7: Edge Service; 
A8: Event-Driven approach; A9: Game Theory; A10: Price index-
ing; Y: shows parameter is present; N: shows parameter is absent; & 
– shows parameter is not considered
Parameters Liang 
et al. 
[32]
Aujla et al. [5] Mondal 
et al. 
[36]
Jindal 
et al. 
[24]
Proposed 
EVBlocks
A1 Y Y Y Y Y
A2 Y Y Y Y Y
A3 N Y N Y Y
A4 Y Y Y N Y
A5 N Y Y Y Y
A6 N N N Y Y
A7 N N N Y Y
A8 – Y Y N Y
A9 N Y Y N Y
A10 – Y N Y Y
1977EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
Each node has to maintain a replica of transaction ledgers, and it directly affects the 
node throughput. Thus, with heavy transactional volumes in V2X, future networks are 
required to arbitrate effective strategies that address the limitations of transactional 
throughput. One possible solution is through off-chain storage, like in the case of inter-
planetary file systems (IPFS), that allows data to be stored in distributed file-systems 
that can be accessed via authorization schemes by verified stakeholders [42]. An exter-
nal reference of the file location is stored in BC through an effective hashmap struc-
ture and maintained as node replicas. Thus, each block stores more transactions, which 
improves the transactional throughput.
– Resource offloading: BC nodes are required to execute consensus algorithms, and to 
support mission-critical V2X communications, the bulk of the processing is shifted 
towards edge nodes. At present, a lot of bandwidth is required to run consensus 
schemes like PoW and PoS. As a possible solution, we can implement lightweight con-
sensus schemes for support. On the other hand, we require edge-based services to pro-
vide resources to miner nodes to support the consensus formation. Thus, the underlying 
networks should be designed to support resilient resource offloading to edge nodes to 
satisfy the resource requirements [56].
– Vulnerability of SC executions: In BC, SC facilitates automated payments among energy 
stakeholders based on a defined set of logic. However, SC execution containers are 
vulnerable to a range of attacks like- code reentrancy, injection flaws, gas attacks, and 
many more that allows an adversary to divert a large number of cryptocurrency coins to 
their wallets. Thus, with the increase in SC execution attacks, formal SC verification is 
required before contract deployment for secure information exchange among transactional 
flows and attack scenarios [3]. Currently, a set of standards and policies for monitoring of 
contract environment are not standardized, and only proprietary solutions exist.
– Involvement of third parties: To induce trust, energy stakeholders often communicate 
with a trusted third-party certification authority to facilitate the trading process between 
EV and CS. This brings in the concept of centralization in BC, and ET requires inher-
ent exchange through the third party. Thus, the privacy of energy stakeholders is at risk. 
One possible solution is combining anonymity with certificate schemes, where the pub-
lic keys of stakeholders are anonymous, and thus allows privacy-preservation of ET 
stakeholders [6].
– Loss of energy during ET: In V2X, peer EVs exchange energy with each other. The 
transferred energy from one EV to other involves mainly a wire-based transfer. In SG 
communication, the power transmission line is used that suffers from heavy transmis-
sion losses. Currently, the area is an open area of research and requires effective control 
messages that can minimize the energy losses [53].
7  Conclusions
This paper proposed a scheme 5G-envisioned ET scheme namedEVBlocks that integrates 
CBC and edge-based services in V2X environments. Through 5G location services, and 
based on EVs predicted distance, transactions are offloaded closer to edge nodes, thereby 
reducing the SDN controller latency and improving the speed of mining transactions in 
the blockchain. The transactional costs of EVs are then optimized by proposing a non-
cooperative game that increases the profit margins of players (EVs and CSs) and eventually 
1978 P. Bhattacharya et al.
1 3
converges to a unique nash equilibrium state. To dampen energy fluctuations in load trans-
fer between EVs, CS, and GS, a serial event-driven consensus termed as PoG is proposed 
that accelerates transactions through optimal local states. The limitations of the scheme 
are the overall complexity due to a large number of discrete parameters. This increases 
operational complexity, which is a critical issue. The above can be addressed in the future 
by reducing parameters generated during load initialization at the same desired operational 
efficiency.
Funding No funding available for this manuscript
Declarations 
 Conflicts of interest The authors declare that they have no conflict of interest statement.
References
 1. Coco framework whitepaper. https:// github. com/ Azure/ coco- frame work. Accessed: (2021)-04-21.
 2. Abdella, J., Tari, Z., Anwar, A., Mahmood, A., & Han, F. (2021). An architecture and performance 
evaluation of blockchain-based peer-to-peer energy trading. IEEE Transactions on Smart Grid pp. 1. 
https:// doi. org/ 10. 1109/ TSG. 2021. 30561 47.
 3. Almakhour, M., Sliman, L., Samhat, A. E., & Mellouk, A. (2020). Verification of smart contracts: A 
survey. Pervasive and Mobile Computing, 67, 101227. https:// doi. org/ 10. 1016/j. pmcj. 2020. 101227.
 4. Anand, A., de Veciana, G., & Shakkottai, S. (2020). Joint scheduling of urllc and embb traffic in 5g 
wireless networks. IEEE/ACM Transactions on Networking, 28(2), 477–490. https:// doi. org/ 10. 1109/ 
TNET. 2020. 29683 73.
 5. Aujla, G. S., Kumar, N., Singh, M., & Zomaya, A. Y. (2019). Energy trading with dynamic pricing 
for electric vehicles in a smart city environment. Journal of Parallel and Distributed Computing, 127, 
169–183.
 6. Batamuliza, J., & Hanyurwimfura, D. (2020). A secure and efficient anonymous certificateless sign-
cryption for key distribution scheme for smart grid. In: 2020 21st International Arab Conference on 
Information Technology (ACIT), pp. 1–7 . https:// doi. org/ 10. 1109/ ACIT5 0332. 2020. 93000 57.
 7. Bhatia, J., Modi, Y., Tanwar, S., & Bhavsar, M. (2019). Software defined vehicular networks: A com-
prehensive review. International Journal of Communication Systems, 32(12), e4005.
 8. Bhattacharya, P., Tanwar, S., Bodke, U., Tyagi, S., & Kumar, N. (2019) Bindaas: Blockchain-based 
deep-learning as-a-service in healthcare 4.0 applications. IEEE Transactions on Network Science and 
Engineering pp. 1. https:// doi. org/ 10. 1109/ TNSE. 2019. 29619 32.
 9. Bhattacharya, P., Tanwar, S., Shah, R., & Ladha, A. (2020). Mobile edge computing-enabled block-
chain framework—a survey. In: P.K. Singh, A.K. Kar, Y. Singh, M.H. Kolekar, S. Tanwar (eds.) Pro-
ceedings of ICRIC 2019, pp. 797–809. Springer, Cham .
 10. Bodkhe, U., Bhattacharya, P., Tanwar, S., Tyagi, S., Kumar, N., & Obaidat, M.S. (2019). Blohost: 
Blockchain enabled smart tourism and hospitality management. In: 2019 International Conference on 
Computer, Information and Telecommunication Systems, Beijing, China, pp. 237–241. IEEE .
 11. Bürer,  M.J.,  de  Lapparent,  M.,  Pallotta,  V.,  Capezzali,  M.,  Carpita,  M.:  Use  cases  for blockchain  
in  the  energy  industry  opportunities  of  emerging  business  models  and  related  risks.   Computers  
&   Industrial   Engineering 137,   106002   (2019).  https:// doi. org/ 10. 1016/j. cie. 2019. 106002. https:// 
www. scien cedir ect. com/ scien ce/ artic le/ pii/ S0360 83521 93046 07
 12. Chaudhary, R., Jindal, A., Aujla, G. S., Aggarwal, S., Kumar, N., & Choo, K. K. R. (2019). Best: 
Blockchain-based secure energy trading in sdn-enabled intelligent transportation system. Computers & 
Security, 85, 288–299.
 13. Chen, S., Hu, J., Shi, Y., Zhao, L., & Li, W. (2020). A vision of c-v2x: Technologies, field testing, and 
challenges with chinese development. IEEE Internet of Things Journal, 7(5), 3872–3881. https:// doi. 
org/ 10. 1109/ JIOT. 2020. 29748 23.
 14. Deng, R., Yang, Z., Chen, J., Asr, N. R., & Chow, M. Y. (2014). Residential energy consumption 
scheduling: A coupled-constraint game approach. IEEE Transactions on Smart Grid, 5(3), 1340–1350.
https://github.com/Azure/coco-framework
https://doi.org/10.1109/TSG.2021.3056147
https://doi.org/10.1016/j.pmcj.2020.101227
https://doi.org/10.1109/TNET.2020.2968373
https://doi.org/10.1109/TNET.2020.2968373
https://doi.org/10.1109/ACIT50332.2020.9300057
https://doi.org/10.1109/TNSE.2019.2961932
https://doi.org/10.1016/j.cie.2019.106002
https://www.sciencedirect.com/science/article/pii/S0360835219304607
https://www.sciencedirect.com/science/article/pii/S0360835219304607
https://doi.org/10.1109/JIOT.2020.2974823
https://doi.org/10.1109/JIOT.2020.2974823
1979EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
 15. Do, D. T., Nguyen, T. T. T., Le, C. B., & Lee, J. W. (2020). Two-way transmission for low-latency and 
high-reliability 5g cellular v2x communications. Sensors, 20(2), 386.
 16. Florea, B. C., & Taralunga, D. D. (2020). Blockchain iot for smart electric vehicles battery manage-
ment. Sustainability. https:// doi. org/ 10. 3390/ su121 03984.
 17. Hathaliya, J. J., Tanwar, S., Tyagi, S., & Kumar, N. (2019). Securing electronics healthcare records in 
healthcare 4.0 : A biometric-based approach. Computers & Electrical Engineering, 76, 398–410.
 18. Hayes, B., Thakur, S., & Breslin, J. (2020). Co-simulation of electricity distribution networks and peer 
to peer energy trading platforms. International Journal of Electrical Power & Energy Systems, 115, 
1–10. https:// doi. org/ 10. 1016/j. ijepes. 2019. 105419.
 19. Hemadeh, I. A., Satyanarayana, K., El-Hajjar, M., & Hanzo, L. (2018). Millimeter-wave communica-
tions: Physical channel models, design considerations, antenna constructions, and link-budget. IEEE 
Communications Surveys Tutorials, 20(2), 870–913. https:// doi. org/ 10. 1109/ COMST. 2017. 27835 41.
 20. Heydari, S., Fajri, P., Sabzehgar, R., & Asrari, A. (2020). Optimal brake allocation in electric vehicles 
for maximizing energy harvesting during braking. IEEE Transactions on Energy Conversion, 35(4), 
1806–1814. https:// doi. org/ 10. 1109/ TEC. 2020. 29945 20.
 21. Hua, S., Zhou, E., Pi, B., Sun, J., Nomura, Y., & Kurihara, H. (2018). Apply blockchain technology 
to electric vehicle battery refueling. In: Proceedings of the 51st Hawaii International Conference on 
System Sciences.
 22. Jalil Piran, M., Tran, N. H., Suh, D. Y., Song, J. B., Hong, C. S., & Han, Z. (2017). Qoe-driven 
channel allocation and handoff management for seamless multimedia in cognitive 5g cellular net-
works. IEEE Transactions on Vehicular Technology, 66(7), 6569–6585. https:// doi. org/ 10. 1109/ 
TVT. 2016. 26295 07.
 23. Jamil, F., Iqbal, N., Ahmad, S., & Kim, D. (2021). Peer-to-peer energy trading mechanism based 
on blockchain and machine learning for sustainable electrical power supply in smart grid. IEEE 
Access, 9, 39193–39217. https:// doi. org/ 10. 1109/ ACCESS. 2021. 30604 57.
 24. Jindal, A., Aujla, G. S., & Kumar, N. (2019). Survivor: A blockchain based edge-as-a-service 
framework for secure energy trading in sdn-enabled vehicle-to-grid environment. Computer Net-
works, 153, 36–48.
 25. Kabra, N., Bhattacharya, P., Tanwar, S., & Tyagi, S. (2020). Mudrachain: Blockchain-based frame-
work for automated cheque clearance in financial institutions. Future Generation Computer Sys-
tems, 120, 574–587.
 26. Khan Tayyaba, S., Khattak, H. A., Almogren, A., Shah, M. A., Ud Din, I., Alkhalifa, I., & Guizani, 
M. (2020). 5g vehicular network resource management for improving radio access through machine 
learning. IEEE Access, 8, 6792–6800. https:// doi. org/ 10. 1109/ ACCESS. 2020. 29646 97.
 27. Kim, Y. M., Jung, D., Chang, Y., & Choi, D. H. (2019). Intelligent micro energy grid in 5g era: 
Platforms, business cases, testbeds, and next generation applications. Electronics, 8(4), 468.
 28. Kumar, R. (2019). Report of Electric Vehicle Market-Global Opportunity analysis and Industry 
Forecast, 2018-2025. https:// www. allie dmark etres earch. com/ elect ric- vehic le- marke t  (2019). 
[Online; accessed 26-Aug-2020].
 29. Kumari, A., Gupta, R., Tanwar, S., & Kumar, N. (2020). A taxonomy of blockchain-enabled soft-
warization for secure uav network. Computer Communications, 161, 304–323. https:// doi. org/ 10. 
1016/j. comcom. 2020. 07. 042.
 30. Kumari, A., Shukla, A., Gupta, R., Tanwar, S., Tyagi, S., & Kumar, N. (2020). Et-deal: A p2p smart 
contract-based secure energy trading scheme for smart grid systems. In: IEEE INFOCOM 2020 - IEEE 
Conference on Computer Communications Workshops (INFOCOM WKSHPS), pp. 1051–1056 .
 31. Lee, Z.J., Li, T., & Low, S.H. (2019). Acn-data: Analysis and applications of an open ev charging 
dataset. In: Proceedings of the Tenth ACM International Conference on Future Energy Systems, 
e-Energy ’19, p. 139–149. Association for Computing Machinery, New York, NY, USA (2019). 
https:// doi. org/ 10. 1145/ 33077 72. 33283 13.
 32. Liang, Y., & Zhang, X. (2018). Battery swap pricing and charging strategy for electric taxis in 
china. Energy, 147, 561–577.
 33. Lin, X., Wu, J., Bashir, A. K., Li, J., Yang, W., & Piran, J. (2020). Blockchain-based incentive 
energy-knowledge trading in iot: Joint power transfer and ai design. IEEE Internet of Things Jour-
nal. https:// doi. org/ 10. 1109/ JIOT. 2020. 30242 46.
 34. Liu, C., Chai, K.K., Zhang, X., & Chen, Y. (2019). Proof-of-benefit: A blockchain-enabled ev 
charging scheme. In: 2019 IEEE 89th Vehicular Technology Conference (VTC2019-Spring), 
Kuala-Lumpur, Malaysia, pp. 1–6. IEEE .
 35. Meredith, J.M. (2020). 3gpp tr 22.186, service requirements for enhanced v2x scenarios. https:// 
portal. 3gpp. org/ deskt opmod ules/ Speci ficat ions/ Speci ficat ionDe tails. aspx? speci ficat ionId= 3180. 
Accessed: 2020.
https://doi.org/10.3390/su12103984
https://doi.org/10.1016/j.ijepes.2019.105419
https://doi.org/10.1109/COMST.2017.2783541
https://doi.org/10.1109/TEC.2020.2994520
https://doi.org/10.1109/TVT.2016.2629507
https://doi.org/10.1109/TVT.2016.2629507
https://doi.org/10.1109/ACCESS.2021.3060457
https://doi.org/10.1109/ACCESS.2020.2964697
https://www.alliedmarketresearch.com/electric-vehicle-market%20
https://doi.org/10.1016/j.comcom.2020.07.042
https://doi.org/10.1016/j.comcom.2020.07.042
https://doi.org/10.1145/3307772.3328313
https://doi.org/10.1109/JIOT.2020.3024246
https://portal.3gpp.org/desktopmodules/Specifications/SpecificationDetails.aspx?specificationId=3180
https://portal.3gpp.org/desktopmodules/Specifications/SpecificationDetails.aspx?specificationId=3180
1980 P. Bhattacharya et al.
1 3
 36. Mondal, A., & Misra, S. (2015). Game-theoretic energy trading network topology control for elec-
tric vehicles in mobile smart grid. IET Networks, 4(4), 220–228.
 37. Odelu, V., Das, A. K., Wazid, M., & Conti, M. (2018). Provably secure authenticated key agree-
ment scheme for smart grid. IEEE Transactions on Smart Grid, 9(3), 1900–1910.
 38. Rasheed, I., Hu, F., Hong, Y., & Balasubramanian, B. (2020). Intelligent vehicle network routing 
with adaptive 3d beam alignment for mmwave 5g-based v2x communications. IEEE Transactions 
on Intelligent Transportation Systems. https:// doi. org/ 10. 1109/ TITS. 2020. 29738 59.
 39. Rosen, J. B. “Existence and Uniqueness of Equilibrium Points for Concave N-Person Games.” 
Econometrica, vol. 33, no. 3, 1965, pp. 520–534. JSTOR, https:// doi. org/ 10. 2307/ 19117 49. 
Accessed 10 July 2021. 
 40. Samuel, O., & Javaid, N. (2021). A secure blockchain-based demurrage mechanism for energy trad-
ing in smart communities. International Journal of Energy Research, 45(1), 297–315.
 41. Sharma, V., You, I., & Guizani, N. (2020). Security of 5g–v2x: Technologies, standardization, and 
research directions. IEEE Network, 34(5), 306–314. https:// doi. org/ 10. 1109/ MNET. 001. 19006 62.
 42. Shukla, A., Bhattacharya, P., Tanwar, S., Kumar, N., & Guizani, M. (2020). Dwara: A deep learn-
ing-based dynamic toll pricing scheme for intelligent transportation systems. IEEE Transactions on 
Vehicular Technology, 69(11), 12510–12520. https:// doi. org/ 10. 1109/ TVT. 2020. 30221 68.
 43. Singh, M., & Kim, S. (2018). Branch based blockchain technology in intelligent vehicle. Computer 
Networks, 145, 219–231.
 44. Soliman, H. M., & Leon-Garcia, A. (2014). Game-theoretic demand-side management with storage 
devices for the future smart grid. IEEE Transactions on Smart Grid, 5(3), 1475–1485.
 45. Srinivas, J., Das, A. K., Kumar, N., & Rodrigues, J. J. P. C. (2020). Cloud centric authentication for 
wearable healthcare monitoring system. IEEE Transactions on Dependable and Secure Computing, 
17(5), 942–956. https:// doi. org/ 10. 1109/ TDSC. 2018. 28283 06.
 46. Srivastava, A., Bhattacharya, P., Singh, A., Mathur, A., Prakash, O., & Pradhan, R. (2018). A distrib-
uted credit transfer educational framework based on blockchain. In: 2018 Second International Confer-
ence on Advances in Computing, Control and Communication Technology (IAC3T), Allahabad, India, 
pp. 54–59. IEEE.
 47. Su, Z., Wang, Y., Xu, Q., Fei, M., Tian, Y. C., & Zhang, N. (2019). A secure charging scheme for 
electric vehicles with smart communities in energy blockchain. IEEE Internet of Things Journal, 6(3), 
4601–4613.
 48. Tanwar, S., Popat, A., Bhattacharya, P., Gupta, R., & Kumar, N. A taxonomy of energy optimiza-
tion techniques for smart cities: Architecture and future directions. Expert Systems n/a(n/a), e12703. 
https:// doi. org/ 10. 1111/ exsy. 12703.
 49. Tanwar, S., Tyagi, S., & Kumar, N. (2019). Multimedia Big Data Computing for IoT Applications: 
Concepts. Paradigms and Solutions: Springer.
 50. Tanwar, S., Vora, J., Tyagi, S., Kumar, N., & Obaidat, M. S. (2018). A systematic review on security 
issues in vehicular ad hoc network. Security and Privacy, 1(5), e39. https:// doi. org/ 10. 1002/ spy2. 39.
 51. Tedeschi, P., Piro, G., Murillo, J. A. S., Ignjatov, N., Pilc, M., Lebloch, K., & Boggia, G. (2019). 
Blockchain as a service: Securing bartering functionalities in the h2020 symbiote framework. Internet 
Technology Letters, 2(1), e72. https:// doi. org/ 10. 1002/ itl2. 72.
 52. Wang, K., Chen, C. M., Liang, Z., Hassan, M. M., Sarné, G. M., Fotia, L., & Fortino, G. (2021). A 
trusted consensus fusion scheme for decentralized collaborated learning in massive iot domain. Infor-
mation Fusion, 72, 100–109. https:// doi. org/ 10. 1016/j. inffus. 2021. 02. 011.
 53. Wang, K., Wang, W., Wang, L., & Li, L. (2020). An improved soc control strategy for electric vehicle 
hybrid energy storage systems. Energies. https:// doi. org/ 10. 3390/ en132 05297.
 54. Xu, H., Klaine, P. V., Onireti, O., Cao, B., Imran, M., & Zhang, L. (2020). Blockchain-enabled 
resource management and sharing for 6g communications. Digital Communications and Networks, 
6(3), 261–269. https:// doi. org/ 10. 1016/j. dcan. 2020. 06. 002.
 55. Yun, J., Piran, M. J., & Suh, D. Y. (2018). Qoe-driven resource allocation for live video streaming over 
d2d-underlaid 5g cellular networks. IEEE Access, 6, 72563–72580. https:// doi. org/ 10. 1109/ ACCESS. 
2018. 28824 41.
 56. Zhang, H., Wang, Z., & Liu, K. (2020). V2x offloading and resource allocation in sdn-assisted mec-
based vehicular networks. China Communications, 17(5), 266–283.
 57. Zhang, T., Pota, H., Chu, C. C., & Gadh, R. (2018). Real-time renewable energy incentive system for 
electric vehicles using prioritization and cryptocurrency. Applied Energy, 226, 582–594.
Publisher’s Note Springer Nature remains neutral with regard to jurisdictional claims in published maps and 
institutional affiliations.
https://doi.org/10.1109/TITS.2020.2973859
https://doi.org/10.2307/1911749
https://doi.org/10.1109/MNET.001.1900662
https://doi.org/10.1109/TVT.2020.3022168
https://doi.org/10.1109/TDSC.2018.2828306
https://doi.org/10.1111/exsy.12703
https://doi.org/10.1002/spy2.39
https://doi.org/10.1002/itl2.72
https://doi.org/10.1016/j.inffus.2021.02.011
https://doi.org/10.3390/en13205297
https://doi.org/10.1016/j.dcan.2020.06.002
https://doi.org/10.1109/ACCESS.2018.2882441
https://doi.org/10.1109/ACCESS.2018.2882441
1981EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
Pronaya Bhattacharya is employed as an Assistant Professor in Com-
puter Science and Engineering Department at the Institute of Technology, 
Nirma University, Ahmedabad, Gujarat, India. He has more than 8 years 
of teaching experience. He has completed PhD in Optical Networks from 
Dr. A. P. J Abdul Kalam Technical University, Lucknow, Uttar Pradesh, 
India. He has authored or co-authored 40 research papers in leading SCI 
journals and top A* core IEEE ComSoc conferences. Some of his top 
findings are published in IEEE-TVT, IEEE-TNSE, John Wiley- ETT, 
Elsevier- FGCS, Kuwait University- JER, IEEE-InfoCom, IEEE-ICC and 
IEEE-CITS. He is working as a reviewer of reputed SCI journals- IEEE- 
TII, IEEE Network, IEEE-Access, John Wiley-ETT, John-Wiley-SPS, 
John Wiley- IJCS, Elsevier-OSN, and Kuwait University-JER. He is 
awarded the best paper award in Springer ICRIC-2019. He has also been 
appointed as Session Chair in the IC4S-2019, IC4S-2020, IICT-2020, 
and PDGC-2020. His research interests include optical switching, high 
performance networking, blockchain, IoT and deep learning. He is a life-
time member of professional societies like ISTE and IAENG.
Sudeep Tanwar  (M’15, SM’21) is a  Full Professor in the Computer 
Science and Engineering Department at the Institute of Technology, 
Nirma University, Ahmedabad, Gujarat, India. He is a visiting Profes-
sor at Jan Wyzykowski University in Polkowice, Poland, and at the 
University of Pitesti in Pitesti, Romania. He received a B.Tech. in 2002 
from Kurukshetra University, India, an M.Tech (Honors) in 2009 from 
Guru Gobind Singh Indraprastha University, Delhi, India, and a PhD 
in 2016 with specialization in Wireless Sensor Networks. He has 
authored or coauthored more than 200 technical research papers pub-
lished in leading journals and conferences, such as IEEE TRANSAC-
TIONS ON NETWORK SCIENCE AND ENGINEERING, IEEE 
TRANSACTIONS ON VEHICULAR TECHNOLOGY, IEEE 
TRANSACTIONS ON INDUSTRIAL INFORMATICS, IEEE WIRE-
LESS COMMUNICATIONS, IEEE NETWORKS, ICC, GLOBE-
COM, and INFOCOMtop journals and top conferences, such as IEEE 
TRANSACTIONS ON NETWORK SCIENCE AND ENGINEER-
ING, IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, 
IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, IEEE WIRELESS COMMUNICATIONS, 
IEEE NETWORKS, ICC, GLOBECOM, and INFOCOM. He has edited/authored  books with International/
National Publishers like IET and Springer. He has guided many students to M.Eng./M.Tech. degrees, and 
has guided students to a PhD. He is an Associate Editor of IJCS (Wiley) and Security and Privacy Journal 
(Wiley). His current interests include Wireless Sensor Networks, Fog Computing, Smart Grids, the IoT, and 
Blockchain Technology. He has received best research paper awards from ECAI-2021, IEEE IWCMC-
2021,IEEE GLOBECOM 2018, IEEE ICC 2019, and Springer ICRIC-2019.  He is also leading the ST 
Research Laboratory, where group members are working on the latest cutting-edge technologies.
Umesh Bodkhe is currently pursuing a Ph.D. degree with Nirma Uni-
versity, Ahmedabad, India. He is currently working as an Assistant 
Professor in computer science and engineering with the Department at 
Institute of Technology, Nirma University. His current research inter-
ests include network security, IoT,6G, and blockchain technology. He 
is a Lifetime Member of the ISTE. He has published more than 15 
research papers in leading SCI/Scopus/WoS journals- IEEE- Access, 
John Wiley- ETT, IEEE-TNSE, John Wiley- SPE, IET Software jour-
nal, and conferences- IEEE- CITS-2019, Springer- IC4S-2019. He is 
working as a reviewer of reputed SCI/Scopus journals- IEEE- Access, 
Elsevier- IJIM, , and John Wiley-ETT.
1982 P. Bhattacharya et al.
1 3
Ashwani Kumar is currently working as an Associate Professor in the 
Department of Computer Science and Engineering at Vardhaman Col-
lege of Engineering, (AUTONOMOUS) Hyderabad, Telangana, India. 
He received his doctorate of philosophy (Ph.D) in Computer Science 
and Engineering, from Jaypee University of Information Technology, 
H.P in 2017. He received his M.Tech (CSE) from Jaypee University of 
Information Technology, H.P in 2011. He has done B.Tech from Uttar 
Pradesh Technical University (U.P.T.U) Lucknow, U.P in 2009. He has 
more than 9 years of teaching and research experience. He published 
more than 25 research papers in international reputed journals indexed 
in Web of Science & SCOPUS and top rank conferences as authored 
or co-authored. His research findings are published in Procedia Com-
puter Science Elsevier, JST Universiti Putra Malaysia, IJCAC IGI 
Global USA, IEEE Xplore. He is serving as the reviewer of many SCI 
Journals- IET Information IET Digital Library, Multimedia Tools and 
Application (MATP) Springer, National Academy Science Letters 
Springer, Journal of Intelligent and Fuzzy Systems (JIFS) IOS Press. 
Currently, he is editorial board member of many reputed Journals-IJDCF, IJISP, IJEUCD, IGI Global Jour-
nal USA indexed in WoS/Scopus. He has been guest editor for International Journal Recent Patent of Engi-
neering, Bentham Publication indexed in SCOPUS. He is the Book Series Editor of : Advancements in 
Security and Privacy Initiatives for Multimedia Images, IGI Global Journal USA. He is awarded as Bentham 
Brand Ambassador Award for the year 2019-2020. He served as session chair in several international con-
ferences-ICIIP-2019, MISS-2020, IC4S-2020, PGDC-2020. He has filing an Australian patent in the year 
2020. His research area includes Image Security, Watermarking Techniques, Multimedia Application, Secu-
rity & Privacy, Cryptography and Network Security. He is also a lifetime member of professional societies 
like ISTE, IACSIT, IAENG and SDIWC.
Neeraj Kumar  (M’16, SM’18) received his PhD in CSE from Shri 
Mata Vaishno Devi University, Katra (J&K), India. He was a postdoc-
toral research fellow at Coventry University, Coventry, UK. He is cur-
rently a Full Professor in the Department of Computer Science and 
Engineering, Thapar University, Patiala (Pb.), India. He has published 
more than 400 technical research papers in leading journals and con-
ferences from IEEE, Elsevier, Springer, John Wiley, etc. Some of his 
research findings were published in top-cited journals such as IEEE 
TIE, IEEE TDSC, IEEE TITS, IEEE TCC, IEEE TKDE, IEEE TVT, 
IEEE TCE, IEEE Netw., IEEE Comm., IEEE WC, IEEE IoTJ, IEEE 
SJ, FGCS, JNCA, and ComCom. He has guided many PhD and 
M.Eng./M.Tech. students. His research was supported with funding 
from Tata Consultancy Service, the Council of Scientific and Indus-
trial Research (CSIR), and the Department of Science & Technology. 
He received best research paper awards from IEEE ICC 2018 and 
IEEE Systems Journal 2018. He is leading the research group Sustain-
able Practices for Internet of Energy and Security (SPINES), where 
group members are working on the latest cutting-edge technologies. He is a TPC member, and a reviewer 
for many international conferences across the globe. He is a visiting professor at Coventry University, Cov-
entry, UK, and a senior member of IEEE.
1983EVBlocks: A Blockchain‑Based Secure Energy Trading Scheme…
1 3
Authors and Affiliations
Pronaya Bhattacharya1 · Sudeep Tanwar1  · Umesh Bodkhe1 · Ashwani Kumar2 · 
Neeraj Kumar3,4,5
 Pronaya Bhattacharya 
 pronoya.bhattacharya@nirmauni.ac.in
 Umesh Bodkhe 
 umesh.bodkhe@nirmauni.ac.in
 Ashwani Kumar 
 ashwani.kumarcse@gmail.com
 Neeraj Kumar 
 neeraj.kumar@thapar.edu
1 Department of Computer Science and Engineering, Institute of Technology, Nirma University, 
Ahmedabad, Gujarat, India
2 Sreyas Institute of Engineering and Technology, Nagole, Hyderabad, India
3 Thapar Institute of Engineering and Technology, Deemed to be University, Patiala, Punjab, India
4 The University of Petroleum and Energy Studies, Dehradhun, India
5 Department of Computer Science and Information Engineering, Asia University, Taiwan, Taiwan
http://orcid.org/0000-0002-1776-4651
	EVBlocks: A Blockchain-Based Secure Energy Trading Scheme for Electric Vehicles underlying 5G-V2X Ecosystems
	Abstract
	1 Introduction
	1.1 Motivation
	1.2 Research Contributions
	1.3 Article Structure
	2 State-of-the-Art
	3 EVBlocks: The Reference Architecture
	3.1 The Network Model
	3.1.1 5G-V2X Channel
	3.1.2 SDN Integration With 5G-V2X
	3.2 Resource-Trading Model
	3.2.1 SDN-Leveraged CBC Resource-Trading Model
	3.2.2 Problem Formulation
	4 EVBlocks: A Blockchain-Based Secure ET Scheme for Electric Vehicles
	4.1 ETaaS: ET as-a-Service via Edge Systems in SDN-Leveraged 5G-V2X Ecosystems
	4.2 EVBlocks: Proposed Non-Cooperative Game model
	4.3 PoG: A consensus Serial Event-Driven Algorithm for EVBlocks
	5 Performance Evaluation of EVBlocks
	5.1 ACN-EV Dataset
	5.2 Plots of EV Charging Profiles
	5.3 Experimental Setup
	5.4 EV Setup
	5.4.1 Performance Analysis of ET
	5.4.2 Impact of Non-Cooperative Game in Maximizing Profits
	5.4.3 Performance of Consensus Mechanism PoG
	5.5 Security Evaluation of EVBlocks
	5.5.1 Computation cost
	5.5.2 Communication Cost
	5.6 Efficiency of EVBlocks Against Conventional Schemes
	6 Limitations of BC-Based ET and Possible Future Directions
	7 Conclusions
	References