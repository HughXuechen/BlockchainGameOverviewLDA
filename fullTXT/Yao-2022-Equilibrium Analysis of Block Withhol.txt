Equilibrium Analysis of Block Withholding Attack: An Evolutionary Game Perspective
Equilibrium Analysis of Block
Withholding Attack: An Evolutionary
Game Perspective
Zhanghao Yao, Yukun Cheng(B), and Zhiqi Xu
Suzhou University of Science and Technology, Suzhou 215009, China
zhyao@post.usts.edu.cn, ykcheng@amss.ac.cn
Abstract. With the advancement of blockchain technology, blockchain-
based digital cryptocurrencies, like Bitcoin, have received broad interest.
Due to the permissionless environment, the blockchain is vulnerable to
different kinds of attacks, such as the block withholding (BWH) attack.
BWH attack is one common selfish mining attack, by which the attack-
ing pool infiltrates the attacked pool, and the infiltrating miners with-
hold all the blocks newly discovered in the attacked pool. Therefore,
the attacking pool benefit by withholding blocks, damaging the bene-
fits of victim pools. In this paper, we introduce the reward reallocation
mechanism by paying additional rewards to the miners who successfully
mine blocks, and propose an evolutionary game model for BWH attack
among pools to study the strategy selection of pools. By constructing the
replicator dynamic equations, the evolutionary stable strategies of pools
are explored based on different levels of additional rewards. Our results
provide enlightening significance to mitigate the negative influence from
BWH attacks in practice.
Keywords: Block withholding attack · Evolutionary game ·
Mitigation measure · Blockchain
1 Introduction
Bitcoin, being one of the most popular blockchain applications, has risen in
popularity in recent years. Satoshi Nakamoto [1] first proposed Bitcoin as a
digital cryptocurrency. The bitcoin system uses Proof of Work (PoW) as the
consensus protocol to secure transactions [2]. Under PoW protocol, the agents,
named as miners, compete to mine blocks by expending their computation power
and then obtain the corresponding rewards. As the computation power of the
whole network grows, the Bitcoin system automatically increases the difficulty
of block generation to preserve the block generation interval. This makes it more
difficult for an single miner to successfully mine a block. Therefore, miners join
in mining pools to mine blocks by aggregating their computation power [3].
This research is supported by the National Nature Science Foundation of China (No.
11871366).
c© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Li and X. Sun (Eds.): IJTCS-FAW 2022, LNCS 13461, pp. 81–86, 2022.
https://doi.org/10.1007/978-3-031-20796-9_6
http://crossmark.crossref.org/dialog/?doi=10.1007/978-3-031-20796-9_6&domain=pdf
https://doi.org/10.1007/978-3-031-20796-9_6
82 Z. Yao et al.
The manager of a mining pool assigns the mining work to all miners in this
pool. Miners need to complete the work and submit a partial proof of work
(PPoW). Miners also have the probability of directly finding a hash that meets
the bitcoin network’s difficulty goal, namely full proof of work (FPoW). When
a miner generates a FPoW, she submits it to the manager, who then sends it to
the Bitcoin system. As a result, the pool receives the entire reward of a newly
discovered block. This reward is then distributed by the manager, which depends
on each miner’s contribution, including the PPoW miners.
During the mining process in a mining pool, a miner may only submits PPoW
and withholds FPoW. Such a malicious behavior is called the block withhold-
ing (BWH) attack. A mining pool is also susceptible to BWH attack from the
opponent pools. Eyal [4] studied BWH attack among pools, in which the attack-
ing pool sends some infiltrators to the victim pool, and these infiltrators play
BWH attack by throwing away FPoW. Generally, the ratio of the infiltrator’s
computation power to the computation power of the mining pool is called the
infiltration ratio. The infiltrators share the rewards of the victim pool, but do
not make any contribution.
BWH attack was first proposed by Rosenfeld [5]. The attacker participates
open mining pool, submits only PPoW to the manager and withholds FPoW,
damaging both his own and the pool’s revenue. Courtois and Bahack expanded
the strategy choices of attackers who launch BWH attacks in [6], arguing that
attackers can freely allocate their computation power to mine and launch BWH
attack at the same time and demonstrating that higher rewards are achieved
in this situation. Luu et al. [7] developed a computational power-splitting game
model to analyze revenue under various computation power distributions. They
demonstrated that attackers are encouraged to launch a BWH attack in an
equilibrium state. Eyal [4] investigated a game between two mining pools to
evaluate the Nash equilibrium of BWH attack, and he discovered that miners
would confront the miner’s dilemma. Alkalay-Houlihan and Shah proposed [8] a
detailed analysis based for this game. They proved that this game always admits
a pure Nash equilibrium, and the pure price of anarchy (PPoA) is at most 3.
Wang and Chen [9] gave a tight bound of (1, 2) for PPoA, and showed the tight
bound holds in a more general setting, in which infiltrators may betray. Chen
et al. [10] proposed a revised approach to reallocate the reward to the miners.
Instead of proportionally allocating the reward to all miners, a pool manager
deducts a fraction from the reward to award the miner who actually mined the
block. Under this setting, the authors proved that for any number of mining
pools, no-pool-attacks is always a Nash equilibrium. Recently, many research
focus on how to mitigate BWH attack. Bag et al. [11] improved the existing
Bitcoin mining protocol to make it difficult for miners to distinguish between
PPoW and FPoW so as to resist BWH attack. Schrijver et al. [12] proposed a
game-theoretic model, in which a novel reward mechanism to encourage miners
to submit blocks as soon as possible is introduced. Kim et al. [13] explored the
evolutionary game model of the miner’s dilemma, and the change of the miner
numbers in the pool over time.
Equilibrium Analysis of Block Withholding Attack 83
In this article, we introduce an approach to mitigate the negative effect from
BWH attack by giving additional rewards to honest miners, and propose an
evolutionary game model for BWH attack between two mining pools to study
the strategy selection of pools.
2 The Evolutionary Game Model for BWH Attack
2.1 Basic Evolutionary Game Model
We consider that there are two pools in the evolutionary game, pool 1 and pool 2,
with the same computation power of m units. There may be other mining power
outside the game, solo miners or other mining pools, but we assume they have no
interaction with these two pools. Each of these two pools has two strategies. One
is to play BWH attack (denoted by A) by sending some miners with an amount
of computation power, called infiltration computation power, to another pool.
The other (denoted by N) is not to infiltrate another pool. Thus the strategy
profiles of two pools are: (N,N), (N,A), (A,N) and (A,A). To be specific,
let the infiltration rate of a pool during BWH attack be α, α ∈ (0, 1), and the
infiltration computation power of the pool be αm. When a pool behaves honestly,
the mining cost per unit time is denoted by C1. If a pool launches BWH attack,
then its free-riding behavior could decrease the mining cost, which is denoted
by C2, 0 ≤ C2 < C1. When a block is successfully appended on the blockchain
by a pool, this pool would obtain an amount of revenue. Here let R, R ≥ 0, be
the mining revenue per unit of computation power and per unit time. If neither
of these two pools plays BWH attack, then the favorable mining environment
will bring more revenue to the pools. Thus we assume that the revenue per unit
computation power and per unit time increases to be γR, γ > 1.
To mitigate the negative influence from BWH attack and to encourage the
miners to behave honestly, we introduce an approach to reallocate the reward,
that is to assign a portion of revenue βR, β ∈ [0, 1), to the honest miners who
submit the FPoW in advance. Here parameter β is named as the additional
rewards ratio. The rest of reward is shared by all miners proportional to their
computation power.
Based on the setting of the evolutionary game model, the payoff matrix of
two mining pools under different strategy profiles is shown in Table 1.
Table 1. Payoff matrix of the model.
Pool 1 Pool 2
Not attack(N) Attack(A)
Not attack(N) mγR − C1 βmR + (1 − k)mR m
m+αm − C1
mγR − C1 (m − αm)R + (1 − β)mR αm
m+αm − C2
Attack(N) (m − αm)R + (1 − β)mR αm
m+αm − C2 (m − αm)R − C2
βmR + (1 − k)mR m
m+αm − C1 (m − αm)R − C2
84 Z. Yao et al.
2.2 The Stable Solutions of the Evolutionary Game
Our evolutionary game model is symmetric because each mining pool has the
same amount of computation power and the infiltration ratio of each pool is
the same too. Thus we assume the probability that a pool does not attack by
x (0 ≤ x ≤ 1), and thus the probability to launch BWH attack is 1 − x. As
each pool constantly adjusts its probability of strategy selection by learning and
imitating the behavior of the opponent with higher revenue, we are interested in
the convergence of the probability, which is then the evolutionary stable solution
(ESS), denoted by x∗.
Since the evolutionary game is symmetric, the payoff of a pool is denoted to
be U1, when it plays honestly. Let U2 be the payoff, when a pool plays BWH
attack. Based on the payoff matrix Table 1, the expected payoffs U1 and U2 are
proposed in the following.
U1 = x(mγR − C1) + (1 − x)[βmR + (1 − βmR)
m
m + αm
− C1].
U2 = x[(m − αm)R + (1 − β)mR
αm
m + αm
− C2] + (1 − x)[(m − αm)R − C2].
Hence, the average expected payoff U3 of this pool is U3 = xU1 + (1 − x)U2.
By [14], the difference between the payoff by adopting this strategy and the
player’s average expected payoff determines the growth rate of strategy selection
probability. Hence,
F (x) =
dx
dt
= x(U1−U3) = x(1−x)
[
(γ − 1)mRx +
(βα + α2)mR
1 + α
− C1 + C2
]
.
(1)
Clearly, when the growth rate of strategy selection probability is equal to 0,
the participant will stably select this strategy at last, and thus this strategy is
stable. So, by setting F (x) = 0, we have three fixed points:
x1 = 0, x2 = 1, x3 =
(C1 − C2)(1 + α) − (β + α)αmR
(1 + α)(γ − 1)mR
. (2)
2.3 Evolutionary Equilibrium Analysis on the Decision of BWH
Attack
In our discussion for BWH attack between two mining pools, each pool needs to
decide the infiltration ratio α, besides whether to attack. In addition, to mitigate
the influence from BWH attack, we impose the additional reward mechanism to
the miners who submit the FPoW. So the additional rewards ratio β is also a
variable we need to determine.
Equilibrium Analysis of Block Withholding Attack 85
Fig. 1. The pool’s dynamic evolution
According to (2), we have three distinguished cases: x3 ≤ 0, 0 < x3 < 1 and
x3 ≥ 1.
• Case 1. x3 ≤ 0. Under this case, there are two fixed points x1 = 0 and
x2 = 1. Furthermore, as x3 = (C1−C2)(1+α)−(β+α)αmR
(1+α)(γ−1)mR ≤ 0, we have β ≥
−α + C1−C2
αmR + C1−C2
mR . Based on (1), the figure for this case is shown in
Fig. 1(a). If the slope of the tangent line at the intersection of the curve
and the horizontal coordinate is negative in the dynamic evolution diagram,
then this intersection point is an evolutionary stable strategy [15]. From the
Fig. 1(a), we can observe the evolutionary stable strategy is x∗ = 1, indicating
that when the additional rewards ratio β is higher, the mining pool gains fewer
when it attacks, which motivates it to mine honestly.
• Case 2. 0 < x3 < 1. Under this case, there are three fixed points x1 = 0,
x2 = 1 and x3 = (C1−C2)(1+α)−(β+α)αmR
(1+α)(γ−1)mR . As 0 < x3 < 1, we have −α +
[C1−C2−(γ−1)mR]
αmR + [C1−C2−(γ−1)mR]
mR < β < −α + (C1−C2)
αmR + (C1−C2)
mR . By (1),
the figure for this case is shown in Fig. 1(b). Two points x∗ = 0 or x∗ = 1 may
be the evolutionary stable strategies, which depends on the initial probability
selected by the mining pool. To be specific, if the initial probability x ∈ (0, x3),
then F (x) ≤ 0, and the probability converges to x∗ = 0 at last, meaning that
the pool selects to attack eventually. When x ∈ (x3, 1), we have F (x) ≥ 0
and the pool finally decides not to attack.
• Case 3. x3 ≥ 1. Under this case, there are two fixed points x1 = 0
and x2 = 1. Because (C1−C2)(1+α)−(β+α)αmR
(1+α)(γ−1)mR ≥ 1, we have 0 < β ≤
−α + [C1−C2−(γ−1)mR]
αmR + [C1−C2−(γ−1)mR]
mR . The phase diagram under this
case, shown in Fig. 1(c), and the evolutionary stable strategy is x∗ = 0. It
demonstrates that if reward ratio β is relatively small, then the infiltrators
get more from the victim pool, increasing the revenue of the attacker. So for
the case of x3 ≥ 1, launching BWH attack is the evolutionary stable strategy
of each pool.
86 Z. Yao et al.
3 Conclusions
In this paper, we construct an evolutionary game model to study the evolu-
tion process of mining pools’ behavior under different levels of mitigation mea-
sures. By analyzing the evolutionary stable strategy, we discover that the higher
additional reward to honest miners has a positive influence on pool’s strategy
selection. There are also some limitations in the model considered in this article.
Firstly, each mining pool has the same computation power and the same infiltra-
tion ratio, which make the evolutionary game be symmetric. Therefore exploring
the asymmetric evolutionary game model is our future work. Secondly, we only
consider the case that two mining pools may launch BWH attack in this paper.
Thus how to extend the study to the scenarios with more mining pools is very
interesting.
References
1. Nakamoto S. Bitcoin: A Peer-to-Peer Electronic Cash System (2008)
2. Tschorsch, F., Scheuermann, B. Bitcoin and beyond: a technical survey on decen-
tralized digital currencies. IEEE Commun. Surv. Tutor. 18(3), 2084–2123 (2016)
3. Liu, Y., Chen, X., Zhang, L., et al.: An intelligent strategy to gain profit for
bitcoin mining pools. In: 2017 10th International Symposium on Computational
Intelligence and Design (ISCID), vol. 2, pp. 427–430. IEEE (2017)
4. Eyal, I.: The miner’s dilemma. In 2015 IEEE Symposium on Security and Privacy,
pp. 89–103. IEEE (2015)
5. Rosenfeld, M. Analysis of bitcoin pooled mining reward systems. arXiv preprint
arXiv:1112.4980 (2011)
6. Courtois, N. T., Bahack, L. On subversive miner strategies and block withholding
attack in bitcoin digital currency. arXiv preprint arXiv:1402.1718 (2014)
7. Luu, L., Saha, R., Parameshwaran, I., et al.: On power splitting games in dis-
tributed computation: The case of bitcoin pooled mining. In 2015 IEEE 28th
Computer Security Foundations Symposium, pp. 397–411. IEEE (2015)
8. Alkalay-Houlihan, C., Shah, N.: The pure price of anarchy of pool block withhold-
ing attacks in bitcoin mining. Proc. AAAI Conf. Artif. Intell. 33(01), 1724–1731
(2019)
9. Wang, Q., Chen, Y. The tight bound for pure price of anarchy in an extended
miner’s dilemma game. arXiv preprint arXiv:2101.11855 (2021)
10. Chen, Z., Li, B., Shan, X. Discouraging pool block withholding attacks in Bitcoin.
J. Combinat. Optim. 43, 444–459 (2021)
11. Bag, S., Ruj, S., Sakurai, K.: Bitcoin block withholding attack: analysis and miti-
gation. IEEE Trans. Inf. Forensics Secur. 12(8), 1967–1978 (2016)
12. Schrijvers, O., Bonneau, J., Boneh, D., Roughgarden, T.: Incentive compatibility
of bitcoin mining pool reward functions. In: Grossklags, J., Preneel, B. (eds.) FC
2016. LNCS, vol. 9603, pp. 477–498. Springer, Heidelberg (2017). https://doi.org/
10.1007/978-3-662-54970-4 28
13. Kim, S., Hahn, S.G.: Mining pool manipulation in blockchain network over evolu-
tionary block withholding attack. IEEE Access 7, 144230–144244 (2019)
14. Friedman, D.: On economic applications of evolutionary game theory. J. Evol.
Econ. 8(1), 15–43 (1998)
15. Gong, H., Jin, W. Analysis of urban car owners commute mode choice based on
evolutionary game model. J. Control Sci. Eng. 2015(6), 1–5 (2015)
http://arxiv.org/abs/1112.4980
http://arxiv.org/abs/1402.1718
http://arxiv.org/abs/2101.11855
https://doi.org/10.1007/978-3-662-54970-4_28
https://doi.org/10.1007/978-3-662-54970-4_28
	Equilibrium Analysis of Block Withholding Attack: An Evolutionary Game Perspective
	1 Introduction
	2 The Evolutionary Game Model for BWH Attack
	2.1 Basic Evolutionary Game Model
	2.2 The Stable Solutions of the Evolutionary Game
	2.3 Evolutionary Equilibrium Analysis on the Decision of BWH Attack
	3 Conclusions
	References