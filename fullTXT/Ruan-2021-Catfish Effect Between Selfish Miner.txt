书书书
第４４卷　第１期
２０２１年１月
计　　算　　机　　学　　报
ＣＨＩＮＥＳＥＪＯＵＲＮＡＬＯＦＣＯＭＰＵＴＥＲＳ
Ｖｏｌ．４４Ｎｏ．１
Ｊａｎ．２０２１
收稿日期：２０１９１２０２；在线发布日期：２０２００７２８．本课题得到国家自然科学基金青年基金（６１７０２３３０）资助．阮　娜，博士，副教授，中国
计算机学会（ＣＣＦ）专业会员，主要研究方向为安全与隐私、区块链与大数据．Ｅｍａｉｌ：ｎａｒｕａｎ＠ｃｓ．ｓｊｔｕ．ｅｄｕ．ｃｎ．刘汉卿，硕士，主要研究方
向为区块链安全．斯雪明，教授，中国计算机学会（ＣＣＦ）会员，主要研究领域为密码学、数据科学、计算机体系结构、网络安全、区块链．
采用工作量证明共识机制的区块链中
挖矿攻击者间的“鲶鱼效应”
阮　娜１）　刘汉卿１） 斯雪明２），３）
１）（上海交通大学电子信息与电气工程学院　上海　２００２４０）
２）（中原工学院前沿信息技术研究院　郑州　４５０００７）
３）（复旦大学计算机科学技术学院上海市数据科学重点实验室　上海　２０１２０３）
摘　要　近年来，采用工作量证明共识机制（ＰｒｏｏｆｏｆＷｏｒｋ，ＰｏＷ）的区块链被广泛地应用于以比特币为代表的数
字加密货币中．自私挖矿攻击（Ｓｅｌｆｉｓｈｍｉｎｉｎｇ）等挖矿攻击（Ｍｉｎｉｎｇａｔｔａｃｋ）策略威胁了采用工作量证明共识机制的
区块链的安全性．在自私挖矿攻击策略被提出之后，研究者们进一步优化了单个攻击者的挖矿攻击策略．在前人工
作的基础上，本文提出了新颖的两阶段挖矿攻击模型，该模型包含拥有单攻击者的传统自私挖矿系统与拥有两个
攻击者的多攻击者系统．本文的模型同时提供了理论分析与仿真量化分析，并将两个攻击者区分为内部攻击者与
外部攻击者．通过引入内部攻击者与外部攻击者的概念，本文指出传统自私挖矿系统转化为多攻击者系统的条件．
本文进一步揭示了在多攻击者系统中两个攻击者将产生竞争并面临着“矿工困境”问题．攻击者间的竞争可被总结
为“鲶鱼效应”：外部攻击者的出现导致内部攻击者的相对收益下降至多６７．４％，因此内部攻击者需要优化攻击策
略．本文提出了名为部分主动发布策略的全新挖矿攻击策略，相较于自私挖矿策略，该策略是半诚实的攻击策略．
在特定场景下，部分主动发布策略可以提高攻击者的相对收益并破解攻击者面临的“矿工困境”问题．
关键词　区块链；比特币；工作量证明共识机制；挖矿攻击；自私挖矿
中图法分类号ＴＰ３１１　　　犇犗犐号１０．１１８９７／ＳＰ．Ｊ．１０１６．２０２１．００１７７
犆犪狋犳犻狊犺犈犳犳犲犮狋犅犲狋狑犲犲狀犛犲犾犳犻狊犺犕犻狀犲狉狊犻狀犘狉狅狅犳狅犳犠狅狉犽犅犪狊犲犱犅犾狅犮犽犮犺犪犻狀
ＲＵＡＮＮａ１）　ＬＩＵＨａｎＱｉｎｇ１）　ＳＩＸｕｅＭｉｎｇ２），３）
１）（犛犮犺狅狅犾狅犳犈犾犲犮狋狉狅狀犻犮犐狀犳狅狉犿犪狋犻狅狀犪狀犱犈犾犲犮狋狉犻犮犪犾犈狀犵犻狀犲犲狉犻狀犵，犛犺犪狀犵犺犪犻犑犻犪狅犜狅狀犵犝狀犻狏犲狉狊犻狋狔，犛犺犪狀犵犺犪犻　２００２４０）
２）（犣犺狅狀犵狔狌犪狀犝狀犻狏犲狉狊犻狋狔狅犳犜犲犮犺狀狅犾狅犵狔，犣犺犲狀犵狕犺狅狌　４５０００７）
３）（犛犺犪狀犵犺犪犻犓犲狔犔犪犫狅狉犪狋狅狉狔狅犳犇犪狋犪犛犮犻犲狀犮犲，犛犮犺狅狅犾狅犳犆狅犿狆狌狋犲狉犛犮犻犲狀犮犲犪狀犱犜犲犮犺狀狅犾狅犵狔，犉狌犱犪狀犝狀犻狏犲狉狊犻狋狔，犛犺犪狀犵犺犪犻　２０１２０３）
犃犫狊狋狉犪犮狋　Ｉｎｔｈｅｐａｓｔｄｅｃａｄｅ，ｔｈｅｃｏｎｓｅｎｓｕｓｍｅｃｈａｎｉｓｍｎａｍｅｄｐｒｏｏｆｏｆｗｏｒｋｈａｓｂｅｅｎｗｉｄｅｌｙ
ａｐｐｌｉｅｄｂｙｃｒｙｐｔｏｃｕｒｒｅｎｃｉｅｓｌｉｋｅＢｉｔｃｏｉｎ．ＴｈｏｕｇｈｔｈｅｓｅｃｕｒｉｔｙｏｆａＰｒｏｏｆｏｆＷｏｒｋｐｏｗｅｒｅｄ
ｃｒｙｐｔｏｃｕｒｒｅｎｃｙｉｓａｌｗａｙｓｔｈｅｔｏｐｐｒｉｏｒｉｔｙ，ｉｔｉｓｔｈｒｅａｔｅｎｅｄｂｙｍｉｎｉｎｇａｔｔａｃｋｓｌｉｋｅｓｅｌｆｉｓｈｍｉｎｉｎｇ．
Ｉｎ２０１４，ＥｙａｌｐｒｏｐｏｓｅｄｔｈｅｆｉｒｓｔｓｅｌｆｉｓｈｍｉｎｉｎｇｍｏｄｅｌｉｎａＰｒｏｏｆｏｆＷｏｒｋｐｏｗｅｒｅｄｂｌｏｃｋｃｈａｉｎ．
Ｓｅｌｆｉｓｈｍｉｎｉｎｇｉｓａｎｉｒｒａｔｉｏｎａｌｓｔｒａｔｅｇｙｓｏｔｈａｔｔｈｅａｂｓｏｌｕｔｅｖａｌｕｅｏｆｔｈｅａｔｔａｃｋｅｒ’ｓｒｅｗａｒｄｗｉｌｌ
ｄｒｏｐ．Ｈｏｗｅｖｅｒｔｈｅｒａｔｉｏｏｆｔｈｅａｔｔａｃｋｅｒ’ｓｒｅｗａｒｄｔｏｔｈｅｏｔｈｅｒｍｉｎｅｒ’ｓｂｌｏｃｋｒｅｗａｒｄｗｏｕｌｄ
ｉｎｃｒｅａｓｅ．Ｔｈｕｓ，ｔｈｅｒｅｌａｔｉｖｅｒｅｗａｒｄｏｆｔｈｅａｔｔａｃｋｅｒｉｓｕｓｅｄｔｏｍｅａｓｕｒｅｗｈｅｔｈｅｒｈｉｓａｔｔａｃｋｉｎｇ
ｓｔｒａｔｅｇｙｉｓｅｆｆｅｃｔｉｖｅｏｒｎｏｔ．Ｃｕｒｒｅｎｔｌｙ，ｔｈｅｖａｓｔｃｏｍｐｕｔａｔｉｏｎａｌｐｏｗｅｒｉｎｃｒｙｐｔｏｃｕｒｒｅｎｃｉｅｓｌｉｋｅ
ＢｉｔｃｏｉｎａｎｄＥｔｈｅｒｅｕｍｍａｋｅｓｉｔｕｎｒｅａｌｉｓｔｉｃｔｏｌａｕｎｃｈａｓｅｌｆｉｓｈｍｉｎｉｎｇａｔｔａｃｋａｇａｉｎｓｔｔｈｅｍ．Ｂｕｔ
ｍｉｎｉｎｇａｔｔａｃｋｓｔｒａｔｅｇｉｅｓａｒｅｃｏｎｔｉｎｕｏｕｓｌｙｏｐｔｉｍｉｚｅｄｉｎｒｅｃｅｎｔｙｅａｒｓ．ＡｆｔｅｒＥｙａｌ’ｓｗｏｒｋ，ｒｅｓｅａｒｃｈｅｒｓ
ｈａｖｅｐｒｏｐｏｓｅｄｍａｎｙｍｉｎｉｎｇａｔｔａｃｋｍｏｄｅｌｓｗｉｔｈａｓｉｎｇｌｅａｔｔａｃｋｅｒ．Ｉｎｔｈｅｓｅｍｉｎｉｎｇａｔｔａｃｋｍｏｄｅｌｓ，
《
 计
算
 机
学
 报
》
ｔｈｅａｔｔａｃｋｅｒ’ｓｓｔｒａｔｅｇｙｓｐａｃｅｉｓｅｘｔｅｎｄｅｄａｎｄｏｐｔｉｍｉｚｅｄｖｉａＭａｒｋｏｖｄｅｃｉｓｉｏｎｐｒｏｃｅｓｓ．Ｔｈｅｅｘｔｅｎｓｉｏｎ
ｏｆｔｈｅａｔｔａｃｋｅｒ’ｓｓｔｒａｔｅｇｙｓｐａｃｅｉｓｂａｓｅｄｏｎｔｈｅａｓｓｕｍｐｔｉｏｎｔｈａｔｔｈｅａｔｔａｃｋｅｒｉｓｔｈｅｏｎｌｙａｄｖｅｒｓａｒｉａｌ
ｎｏｄｅｉｎｔｈｅｂｌｏｃｋｃｈａｉｎｎｅｔｗｏｒｋｓｏｔｈａｔｔｈｅｓｔｒａｔｅｇｙｓｐａｃｅｏｆａｎａｔｔａｃｋｅｒｉｓｓｔｉｌｌｌｉｍｉｔｅｄ．Ｉｎｔｈｉｓ
ｐａｐｅｒ，ｗｅｐｒｏｐｏｓｅａｍｉｎｉｎｇａｔｔａｃｋｍｏｄｅｌｗｉｔｈｔｗｏａｔｔａｃｋｅｒｓ：ｔｈｅｉｎｔｅｒｎａｌａｔｔａｃｋｅｒａｎｄｔｈｅ
ｅｘｔｅｒｎａｌａｔｔａｃｋｅｒ．Ａｃｃｏｒｄｉｎｇｔｏｔｈｅａｔｔａｃｋｅｒ’ｓｏｒｄｅｒｏｆａｐｐｅａｒａｎｃｅ，ｗｅｄｉｖｉｄｅｔｈｅｍｏｄｅｌｉｎｔｏｔｗｏ
ｐｈａｓｅｓ：ｔｈｅｔｒａｄｉｔｉｏｎａｌｓｅｌｆｉｓｈｍｉｎｉｎｇｓｙｓｔｅｍｗｉｔｈｔｈｅｉｎｔｅｒｎａｌａｔｔａｃｋｅｒａｎｄｔｈｅｍｕｌｔｉａｔｔａｃｋｅｒ
ｓｙｓｔｅｍｗｉｔｈｔｈｅｉｎｔｅｒｎａｌａｔｔａｃｋｅｒａｎｄｔｈｅｅｘｔｅｒｎａｌａｔｔａｃｋｅｒ．Ｏｕｒｍｏｄｅｌｐｒｏｖｉｄｅｓｂｏｔｈｔｈｅｏｒｅｔｉｃａｌ
ａｎｄｑｕａｎｔｉｔａｔｉｖｅａｎａｌｙｓｉｓｏｆｈｏｗｔｈｅｔｒａｄｉｔｉｏｎａｌｓｅｌｆｉｓｈｍｉｎｉｎｇｓｙｓｔｅｍｔｕｒｎｓｉｎｔｏｔｈｅｍｕｌｔｉａｔｔａｃｋｅｒ
ｓｙｓｔｅｍ．Ｗｅｐｒｏｖｅｔｈａｔａｆｔｅｒｔｈｅｏｃｃｕｒｒｅｎｃｅｏｆｔｈｅｅｘｔｅｒｎａｌａｔｔａｃｋｅｒ，ｂｏｔｈａｔｔａｃｋｅｒｓｗｉｌｌｆａｃｅａ
ｄｉｌｅｍｍａｉｎｔｈｅｍｕｌｔｉａｔｔａｃｋｅｒｓｙｓｔｅｍ：Ｂｏｔｈａｔｔａｃｋｅｒｓ’ｒｅｌａｔｉｖｅｒｅｗａｒｄｉｓｌｅｓｓｔｈａｎｅｘｐｅｃｔｅｄ．Ｔｈｅ
ｕｎｅｘｐｅｃｔｅｄｃｏｍｐｅｔｉｔｉｏｎｓｂｅｔｗｅｅｎｔｈｅｉｎｔｅｒｎａｌａｔｔａｃｋｅｒａｎｄｔｈｅｅｘｔｅｒｎａｌａｔｔａｃｋｅｒ，ｔｈｅｏｖｅｒｅｓｔｉｍａｔｉｏｎ
ｏｆａｎａｔｔａｃｋｅｒ’ｓｉｎｆｌｕｅｎｃｅｒａｔｅｂｙｈｉｍｓｅｌｆａｎｄｔｈｅａｕｃｔｉｏｎｌｉｋｅｂｅｈａｖｉｏｒｏｆｔｈｅｉｎｔｅｒｎａｌａｔｔａｃｋｅｒａｎｄ
ｔｈｅｅｘｔｅｒｎａｌａｔｔａｃｋｅｒｉｎｔｈｅｍｕｌｔｉａｔｔａｃｋｅｒｓｙｓｔｅｍａｒｅｔｈｒｅｅｌｅａｄｉｎｇｃａｕｓｅｓｏｆｔｗｏａｔｔａｃｋｅｒｓ’
ｄｉｌｅｍｍａ．ＷｅｎａｍｅｔｈｉｓｐｈｅｎｏｍｅｎｏｎａｓＣａｔｆｉｓｈｅｆｆｅｃｔｉｎｔｈｅｍｕｌｔｉａｔｔａｃｋｅｒｓｙｓｔｅｍ．ＴｈｅＣａｔｆｉｓｈ
ｅｆｆｅｃｔｉｎｔｈｅｍｕｌｔｉａｔｔａｃｋｅｒｓｙｓｔｅｍｌｅａｄｓｔｏｔｈｅｃｏｎｓｅｑｕｅｎｃｅｔｈａｔｔｈｅｉｎｔｅｒｎａｌａｔｔａｃｋｅｒｏｒｔｈｅｅｘｔｅｒｎａｌ
ａｔｔａｃｋｅｒｈａｓｔｏｏｐｔｉｍｉｚｅｈｉｓａｔｔａｃｋｉｎｇｓｔｒａｔｅｇｙ．Ｔｈｅｉｎｔｅｒｎａｌａｔｔａｃｋｅｒｗｏｕｌｄｏｖｅｒｅｓｔｉｍａｔｅｈｉｓ
ｒｅｌａｔｉｖｅｒｅｗａｒｄｉｎｔｈｅｍｕｌｔｉａｔｔａｃｋｅｒｓｙｓｔｅｍｂｙｕｐｔｏ６７．４％ａｆｔｅｒｔｈｅｅｘｉｓｔｅｎｃｅｏｆｔｈｅｅｘｔｅｒｎａｌ
ａｔｔａｃｋｅｒ．Ｔｏｂｒｅａｋｔｈｅｄｉｌｅｍｍａｆａｃｅｄｂｙｔｈｅｉｎｔｅｒｎａｌａｔｔａｃｋｅｒａｎｄｔｈｅｅｘｔｅｒｎａｌａｔｔａｃｋｅｒ，ｗｅｐｒｏｐｏｓｅ
ａｎｏｖｅｌｍｉｎｉｎｇｓｔｒａｔｅｇｙｎａｍｅｄＰａｒｔｉａｌＩｎｉｔｉａｔｉｖｅＲｅｌｅａｓｅ，ｗｈｉｃｈｉｓａｓｅｍｉｈｏｎｅｓｔｍｉｎｉｎｇｓｔｒａｔｅｇｙ．
ＡｎａｔｔａｃｋｅｒｍａｋｅｓｈｉｓａｃｔｉｏｎｂａｓｅｄｏｎＰａｒｔｉａｌＩｎｉｔｉａｔｉｖｅＲｅｌｅａｓｅｓｔａｔｅｍａｃｈｉｎｅ．Ｔｈｅｍｏｓｔｓｉｇｎｉｆｉｃａｎｔ
ｄｉｆｆｅｒｅｎｃｅｂｅｔｗｅｅｎＰａｒｔｉａｌＩｎｉｔｉａｔｉｖｅＲｅｌｅａｓｅａｎｄｓｅｌｆｉｓｈｍｉｎｉｎｇｉｓｔｈａｔｔｈｅａｔｔａｃｋｅｒｍｉｇｈｔａｃｔａｓａｎ
ｈｏｎｅｓｔｍｉｎｅｒｗｈｅｎｈｅｉｓａｔｓｏｍｅｃｅｒｔａｉｎｓｔａｔｅ．Ｉｎｓｏｍｅｓｐｅｃｉｆｉｃｓｉｔｕａｔｉｏｎｓ，ＰａｒｔｉａｌＩｎｉｔｉａｔｉｖｅ
Ｒｅｌｅａｓｅａｌｌｏｗｓｔｈｅａｔｔａｃｋｅｒｓｔｏａｃｈｉｅｖｅａｈｉｇｈｅｒｒｅｌａｔｉｖｅｒｅｗａｒｄｃｏｍｐａｒｅｄｗｉｔｈｓｅｌｆｉｓｈｍｉｎｉｎｇ．
犓犲狔狑狅狉犱狊　ｂｌｏｃｋｃｈａｉｎ；Ｂｉｔｃｏｉｎ；ｐｒｏｏｆｏｆｗｏｒｋ；ｍｉｎｉｎｇａｔｔａｃｋ；ｓｅｌｆｉｓｈｍｉｎｉｎｇ
１　引　言
随着区块链技术的发展，去中心化的数字加密
货币逐渐被重视．以比特币［１］为代表的去中心化数
字加密货币通过区块链技术保证其安全性．共识机
制是区块链技术的核心之一，比特币采用了工作量
证明共识机制，该共识机制保证了比特币中交易的
一致性与不可篡改性．由于比特币的先发优势，基于
工作量证明区块链的数字加密货币占据了大部分市
场份额［２］．在采用工作量证明共识机制的区块链中，
节点以消耗计算力解决特定密码学问题的方式发现
新区块，这些节点被称为矿工节点．矿工尝试发现新
区块的行为被称为挖矿．当某一矿工发现新区块时，
该新区块将被传播至区块链网络中的其他矿工处，
其他矿工需要确认该新区块的合法性．若该区块合
法，其他矿工将在这个区块继续挖矿．挖到合法的新
区块的矿工将收到一定数额的区块奖励和区块中包
含交易的手续费作为挖矿收益．采用工作量证明共
识机制的区块链中的挖矿难度随着算力不断加入而
上升，矿工独自挖矿并最终发现新区块的概率也随
之下降．为了稳定地获得挖矿收益，拥有较小算力的
矿工自发组织起来并形成矿池［３］．
拥有高额算力的矿池或矿工威胁了采用工作量
证明共识机制的区块链的安全性．在最理想的情况
下，当矿工或矿池拥有的算力在全区块链网络算力
中的占比为σ时，该矿工或矿池获得的区块奖励在
全区块链网络中的占比也为σ．但是，现有的研究指
出，攻击者可以通过自私挖矿攻击［４６］、区块截留攻
击（Ｂｌｏｃｋｗｉｔｈｈｏｌｄｉｎｇａｔｔａｃｋ）［３］等方式获得额外的
挖矿收益．在自私挖矿攻击中，攻击者在区块链中主
动制造分叉链（即攻击者的私链），并根据主链高度、
攻击者的私链高度等因素选择性地发布区块．在区
块截留攻击中，攻击者派遣算力至受攻击矿池，被派
遣的算力为受害矿池工作并在挖到全工作量证明
（ＦｕｌｌＰｒｏｏｆｏｆＷｏｒｋ，ＦＰｏＷ）区块时抛弃该区块．当
８７１ 计　　算　　机　　学　　报 ２０２１年
《
 计
 算
 机
 学
 报
 》
区块截留攻击模型中存在多个攻击者时，攻击者将
面临囚徒困境［３，７］，该现象也被描述为“矿工困境”
（Ｍｉｎｅｒ’ｓｄｉｌｅｍｍａ）．现有研究也提出了ＦＡＷ攻击［８］
（ＦｏｒｋＡｆｔｅｒＷｉｔｈｈｏｌｄｉｎｇａｔｔａｃｋ）、ＰＡＷ攻击［９］
（ＰｏｗｅｒＡｄｊｕｓｔｉｎｇＷｉｔｈｈｏｌｄｉｎｇ）、Ｓｅｌｆｈｏｌｄｉｎｇ攻击［１０］
等攻击策略以破解矿工困境．
自私挖矿攻击模型中也可以引入多个攻击者．
Ｌｉｕ等研究者［１１］率先提出包含多个攻击者的挖矿攻
击模型．随后，Ｋａｔｚ等研究者［１２］与Ｂａｉ等研究者［１３］
进一步研究了多攻击者挖矿攻击模型．但是上述研
究者没有进一步分析多攻击者挖矿攻击模型中出现
多个攻击者的原因．同时，在多攻击者挖矿攻击模型
中，攻击者同样面临“矿工困境”，上述研究者没有详
细描述该问题．
本文通过理论分析与仿真量化分析解释了攻击
模型中出现两个攻击者的原因，并提出了全新的两
阶段挖矿攻击模型．本文第３节提出该挖矿攻击模
型的两个阶段：传统自私挖矿系统与多攻击者系统；
第４节引入内部攻击者与外部攻击者的概念，并
解释了攻击模型从传统自私挖矿系统向多攻击者
系统转化的条件；第５节解释了两个攻击者面临
“矿工困境”的原因；第６节揭示了攻击者间的“鲶
鱼效应”并提出了全新的半诚实攻击策略：部分主动
发布策略，该半诚实的攻击策略可以打破攻击者面临
的“矿工困境”．
本文的主要贡献可以归纳为以下三点：
（１）建立了两阶段挖矿攻击模型并通过理论分
析与仿真量化分析解释模型中出现两个攻击者的原
因：提出了全新的两阶段挖矿攻击模型，并引入了内
部攻击者与外部攻击者的概念．本文指出内部攻击
者将导致传统自私挖矿系统有效算力的下降，并首
次提出收缩系数的概念以度量内部攻击者对传统自
私挖矿系统的影响力．本文还证明了当外部攻击者
算力满足一定条件时，外部攻击者将攻击传统自私
挖矿系统．
（２）提出了多攻击者挖矿攻击模型中攻击者面
临“矿工困境”：攻击者预期之外的竞争、攻击者拍卖
式发布区块与攻击者高估自身影响力导致两个攻击
者收益下降，从而使攻击者面临“矿工困境”．
（３）揭示攻击者间的鲶鱼效应并提出全新的挖
矿攻击策略：讨论了两阶段挖矿攻击模型多攻击者
系统中的“鲶鱼效应”，并提出了名为部分主动发布
区块策略的全新的挖矿攻击策略．两阶段挖矿攻击
模型中的攻击者可以使用该策略提升自己的相对收
益并避免“矿工困境”问题．
２　相关工作
２１　比特币基础
化名为中本聪的学者在提出区块链的概念时，
同时提出了比特币［１］．因此，比特币是最具有代表性
的基于区块链技术的数字加密货币．比特币之后的
大部分数字加密货币均参考了比特币的架构．本节
通过介绍比特币中的要素展现基于工作量证明区块
链的数字加密货币的特性．
比特币中的区块由区块头与区块体构成．区块
头区分了比特币中的每一个区块，一个区块的区块
头包含了上一区块区块头的哈希值、区块中所有交
易的梅克尔根（Ｍｅｒｋｌｅｒｏｏｔ）［１４］与一个随机数．一个
区块的区块体存储了被该区块确认的交易信息．矿
工的工作是选取尚未被确认的交易以及生成一个随
机数．当矿工选取的交易与生成的随机数使得区块
头的哈希值拥有一定数量的前导零时，矿工成功挖
到新区块．该新区块将被矿工传播至区块链网络．其
余矿工在确认新区块的合法性后，将接受该区块并
将该区块加入主链的末端．矿工挖矿的过程消耗了
计算力，因此，比特币采用的共识机制被称为工作量
证明共识机制．比特币通过规定新区块区块头哈希
值前导零数量的方式调整挖矿难度，比特币中的算
力越多，挖矿难度越大．通常来说，比特币将新区块
产生的速度控制为每１０ｍｉｎ产生一个新区块．比特
币的挖矿难度约两周调整一次．
比特币的价格激励了大量计算力加入比特币系
统并挖矿．随着挖矿难度的上升，对于拥有较小算力
的独立矿工来说，短期内发现新区块并获得挖矿奖
励的概率几乎为零［１５］．因此，为了获得更加稳定的
挖矿收益，独立矿工们被组织起来，形成了矿池．比
特币历史上曾出现过算力在全比特币系统中占比超
过４０％的矿池［２］．矿池在为其成员带来了更加稳定
的收益的同时，威胁到了比特币的安全性．
比特币网络中产生的分叉（ｆｏｒｋ）可被分为两
类：自然产生的分叉与攻击者制造的分叉．自然产生
的分叉通常由诚实矿工在不经意间制造，由于比特
币网络中存在网络传播时延，两个诚实矿工可能在
接近同一时刻发布区块．Ｇｅｒｖａｉｓ等研究者［２］与
Ｄｅｃｋｅｒ等研究者［１６］对区块链网络中自然产生分叉
的概率做了预测．他们的研究显示，比特币网络中产
生自然分叉的概率处于０．４１％至１．７％之间．攻击
９７１１期 阮　娜等：采用工作量证明共识机制的区块链中挖矿攻击者间的“鲶鱼效应”
《
 计
 算
 机
 学
 报
 》
者制造的分叉由攻击者蓄意制造，在自私挖矿攻击
等攻击策略中，攻击者通过蓄意制造分叉链的方式
在区块链网络中发起竞争．
在比特币中，遵守比特币协议挖矿的矿工被称
为诚实矿工．在发现新区块后，诚实矿工将立即向区
块链网络广播．同时，诚实矿工将区块链网络中的最
长链视作主链．当区块链网络中出现高度相同的分
叉链时，诚实矿工将最先接收到的分叉链视作主链．
比特币中攻击者的行为与诚实矿工不同．一些典型
的攻击者行为包括：
（１）攻击者拒绝向区块链网络传播其他矿工挖
出的区块［１７２０］．
（２）在攻击者发现新区块后，攻击者拒绝立即
向区块链网络传播区块信息［４６，８］．
（３）攻击者拒绝接受区块链网络中的最长链作
为主链［４，１７，２１２２］．
２２　自私挖矿攻击
Ｅｙａｌ等研究者率先提出自私挖矿［４］．自私挖矿
攻击的基本思想是：攻击者制造分叉链且选择时机
发布分叉链中的区块．Ｅｙａｌ等研究者将攻击者的状
态定义为攻击者的分叉链领先主链的长度并根据攻击
者的状态、状态转移概率给出攻击者的状态机．同时，
Ｅｙａｌ为攻击者设计了四个基本动作：放弃（Ａｄｏｐｔ）、
匹配（Ｍａｔｃｈ）、持有（Ｈｏｌｄ）与覆盖（Ｏｖｅｒｒｉｄｅ）．当且
仅当攻击者处在特定状态时，攻击者会主动发布区
块（匹配或覆盖）．
图１　自私挖矿攻击典型状态（虚线代表攻击者未发布的区块）
图１展示了自私挖矿攻击中的三个典型状态．
通过图１中的三个状态可以很好地总结自私挖矿攻
击的特点．状态一展示了自私挖矿攻击者的Ｈｏｌｄ
操作：当诚实矿工未发布区块时，自私挖矿攻击者执
行Ｈｏｌｄ操作不发布区块；状态二展示了自私挖矿
攻击者的Ｏｖｅｒｒｉｄｅ操作：当诚实矿工挖出区块且自
私挖矿攻击者的分叉链长度为二时，攻击者将发布
整个分叉链，发布后的分叉链将成为新的主链；状态
三展示了自私挖矿攻击者的Ｍａｔｃｈ操作：当诚实矿
工挖出区块且自私挖矿攻击者的分叉链长度为一
时，攻击者将发布整个分叉链，此时诚实矿工与自私
挖矿攻击者间产生竞争．由此可见，自私挖矿攻击者
仅在特定的状态发布，这是自私挖矿攻击最显著的
特点．
自私挖矿攻击策略大幅降低了攻击者对区块链
系统发动攻击所需要的算力．攻击者算力在区块链
系统中占比为１／３时，攻击者即可确保其通过攻击
获得额外收益．
在自私挖矿攻击被提出后，Ｓａｐｉｒｓｈｔｅｉｎ等研究
者［６］与Ｎａｙａｋ等研究者［５］拓展了自私挖矿攻击者
的策略集．Ｓａｐｉｒｓｈｔｅｉｎ等研究者利用马尔科夫决
策，提出了优化自私挖矿策略，Ｎａｙａｋ等研究者将自
私挖矿攻击与区块链网络层攻击日蚀攻击结合，提
出了固执挖矿攻击．Ｌｉｕ等研究者［１１］探讨了自私挖
矿模型中出现多个攻击者时的情况．
自私挖矿攻击同时浪费了攻击者的算力与诚实
矿工的算力，是短期内非理性的攻击策略［２］．因此，
攻击者获得区块奖励的绝对数额无法直接衡量挖矿
攻击策略的表现．但是，挖矿攻击可以提升攻击者的
相对收益，即攻击者的收益占比．从长期来看，随着
比特币挖矿难度的调整，攻击者的相对收益将转换
为攻击者的绝对收益．通常来说，研究者们使用相对
收益（ＲｅｌａｔｉｖｅＲｅｗａｒｄ，ＲＲ）与孤块率（ＳｔａｌｅＢｌｏｃｋ
Ｒａｔｅ，ＳＢＲ）比较挖矿攻击策略的表现．
２３　攻击者间的博弈问题
Ｅｙａｌ等研究者首先提出区块截留攻击模型中
攻击者面临“囚徒困境”［３］：当多个矿池同时采用区
块截留攻击策略时，所有的攻击者将遭受损失．Ｅｙａｌ
将该现象命名为“矿工困境”．唐长兵等研究者［７］利
用零行列式策略对区块截留攻击中的矿工策略选择
进行优化．此后，Ｋｗｏｎ等研究者［８］、Ｇａｏ等研究
者［９］与Ｄｏｎｇ等研究者［１０］分别提出ＦＡＷ攻击、
ＰＡＷ攻击与Ｓｅｌｆｈｏｌｄｉｎｇ攻击帮助攻击者避免
“矿工困境”问题．
在挖矿攻击模型中引入多个攻击者时，攻击者
同样面临“矿工困境”问题．但是，目前挖矿攻击模型
中多个攻击者间的博弈问题尚未被深入研究．本文
作者［１１］率先提出了包含多个攻击者的挖矿攻击模
型．但是本文作者的前期工作仅通过数值仿真分析
了多个攻击者的收益情况，并未进一步分析攻击者
间的博弈问题．Ｋａｔｚ等研究者［１２］的工作是与本文同
步开展的工作，Ｋａｔｚ等研究者同样提出了一种半诚
０８１ 计　　算　　机　　学　　报 ２０２１年
《
 计
 算
 机
 学
 报
 》
实的挖矿攻击策略．本文的工作与Ｋａｔｚ等研究者工
作的区别在于：（１）半诚实挖矿攻击策略的区别；
（２）本文指出了挖矿攻击模型中攻击者们面临的
“矿工困境”问题，并将半诚实挖矿攻击策略用于破
解“矿工困境”问题．
３　攻击模型
３１　两阶段挖矿攻击模型
本文提出的两阶段挖矿攻击模型由两个部分构
成：传统自私挖矿系统与多攻击者系统．如图２所示，
两阶段挖矿攻击模型的第一阶段为传统自私挖矿阶
段．在传统自私挖矿阶段，内部攻击者针对诚实矿工
实施自私挖矿攻击．内部攻击者与诚实矿工组成了
传统自私挖矿系统．在内部攻击者实施发动攻击后．
传统自私挖矿系统的区块链出现分叉，区块链分叉
的后果是传统自私挖矿系统的有效算力下降．有效
算力下降的传统自私挖矿系统易被外部攻击者视作
目标．外部攻击者将针对传统自私挖矿系统发动挖
矿攻击．此时，两阶段挖矿攻击模型进入多攻击者阶
段．内部攻击者、诚实矿工与外部攻击者组成了多攻
击者系统．
图２　两阶段挖矿攻击模型
３２　攻击者状态与行为
两阶段挖矿攻击模型中，对攻击者状态与攻击
者行为的描述与前人的工作保持一致．
攻击者状态．攻击者的状态应包含如下信息：
攻击者未发布的私有链领先诚实矿工的区块数与攻
击者是否有参与到分叉链的竞争中．本文的模型使
用标记犛＝犻（犻＝０，１，２…）表示攻击者的私有链领先
诚实矿工的主链犻个区块，且攻击者没有参与到区
块链的竞争中．犛＝０′表示攻击者正在与其他矿工竞
争．犛＝犻′（犻＝１，２，３…）表示攻击者的私有链领先诚
实矿工的主链犻个区块，且区块链网络中存在着攻
击者并未参与的竞争．
攻击者行为．攻击者的行为应包含如下信息：攻
击者是否发布区块与攻击者发布区块的数量．攻击者
在区块链网络中的所有动作可以用以下五个行为描
述：（１）Ｈｏｌｄ：攻击者不发布任何区块；（２）Ｍａｔｃｈ：
攻击者发布至少一个区块，从而在区块链网络中制造
一个与当前主链长度相同的分叉链；（３）Ｏｖｅｒｒｉｄｅ：攻
击者发布至少两个区块，从而在区块链网络中制造一
个比当前主链长度多一个区块的分叉链；（４）Ａｄｏｐｔ：
攻击者放弃自己当前的私链；（５）Ｒｅｌｅａｓｅ：攻击者主
动发布一个区块．
３３　攻击者的表现
攻击者的孤块率与攻击者相对收益可以用来衡
量攻击者的表现．
攻击者的孤块率体现了攻击者发起挖矿攻击的
代价．将攻击者挖到并被全区块链网络承认的区块
数量记作犖犪犮，将攻击者挖到却并未被全区块链网
络接收的区块数量记作犖狀犪犮，将攻击者的孤块率记
作犛犅犚：
犛犅犚＝犖狀犪犮
犖狀犪犮＋犖犪犮 （１）
攻击者的相对收益体现了攻击者获得的收益在
全区块链网络中的占比．当攻击者的相对收益大于
攻击者的计算力在全区块链网络中的占比时，攻击
者的攻击行为是成功的．将除攻击者以外所有矿工
挖到并被全区块链网络承认的区块数量记作犖狅犪犮，
将攻击者的相对收益记作犚犚：
１８１１期 阮　娜等：采用工作量证明共识机制的区块链中挖矿攻击者间的“鲶鱼效应”
《
 计
 算
 机
 学
 报
 》
犚犚＝ 犖犪犮
犖犪犮＋犖狅犪犮 （２）
３４　理想化模型的假设
本文提出的两阶段挖矿攻击模型基于如下假设：
（１）诚实矿工、内部攻击者与外部攻击者是三
个不同的实体，三个实体间无交流．
（２）传统自私挖矿系统中只包含内部攻击者，
内部攻击者算力小于诚实矿工且内部攻击者不能预
测外部攻击者是否存在；在外部攻击者攻击传统自
私挖矿系统前，外部攻击者无法感知内部攻击者的
存在．
（３）外部攻击者对传统自私挖矿系统发起挖矿
攻击前，将传统自私挖矿系统内所有算力都判定为
诚实矿工．
（４）为方便计算，多攻击者系统中的全部算力
被标准化为１．
（５）传统自私挖矿系统与多攻击者系统不考虑
出现自然产生的分叉．
图３　传统自私挖矿系统区块链网络的五个状态
３５　模型中的参数
两阶段挖矿攻击模型使用了如下参数：
（１）α，β１与β２．α，β１与β２分别代表诚实矿工、内
部攻击者与外部攻击者在多攻击者系统中的算力占
比．α＋β１＋β２＝１．
（２）α′与β′．α′与β′分别代表诚实矿工与内部
攻击者在传统自私挖矿系统内的算力占比．α′＝
α
α＋β１
，β′＝β１
α＋β１．
（３）α狋与β″．α狋代表了外部攻击者在搜寻攻击目
标阶段对目标系统算力的估测值．外部攻击者根据
目标系统区块链主链增长速度与挖矿难度估算目标
系统算力．β″同样由外部攻击者在搜寻攻击目标阶
段计算得出，代表外部攻击者对发起攻击后算力占
比的预测值，β″＝β２
β２＋α狋．
（４）γ犺．γ犺表示在区块链网络中出现分叉链时，
诚实矿工支持攻击者（内部攻击者或外部攻击者）的
算力占诚实矿工总算力之比．
（５）γ１与γ２．γ１与γ２分别表示在区块链网络中
出现分叉链时，诚实矿工支持内部攻击者与外部攻
击者的算力占诚实矿工总算力之比．γ１与γ２分别体
现了两个攻击者的影响力．
３６　模型参数范围
参数α，β１与β２的范围难以通过现实情况确定，
因为目前尚未出现多个挖矿攻击者同时发起攻击的
案例．但是参数α′与β′仅涉及包含一位攻击者的传
统自私挖矿系统，其范围可以通过现实中矿池的规
模做出合理假设．本文通过前人研究［４］与比特币中
矿池算力占比确定参数α′与β′的范围．α′＝０．７５且
β′＝０．２５被研究者们认为是内部攻击者在传统自
私挖矿系统内成功发起自私挖矿攻击所需算力的最
小值；β′＝０．４５近似于比特币历史上出现的最大矿
池算力占比，此时α′＝０．５５．参数α′与β′决定了参数
α与参数β１之比．参数α狋由外部攻击者估算得出，α狋
与参数α、β１、α′与β′相关．依据参数α狋可以对参数β２
的范围做出合理的假设．
参数γ１、γ２与γ犺的范围可以根据现有研究与实
际情况确定．Ｎａｙａｋ等研究者［５］指出攻击者影响力
的范围可大至［０，０．９２］（即γ犺的范围是［０．０８，１］）．
在实际情况中，攻击者节点的部署情况、诚实矿工节
点的部署情况、节点的动态特性等因素都会导致攻
击者影响力的变化．因此，为了涵盖所有场景，本文
将参数γ犺的范围设定为［０，１］．内部攻击者与外部
攻击者将划分被影响的诚实矿工算力．
４　内部攻击者与外部攻击者
４１　传统自私挖矿系统与内部攻击者
两阶段挖矿攻击模型的传统自私挖矿系统包含
了内部攻击者与诚实矿工，内部攻击者对传统自私
挖矿系统内的诚实矿工发起自私挖矿攻击．
如图３所示的五个状态包含了传统自私挖矿系
统区块链网络的所有状态．这五个状态分别是：内部
２８１ 计　　算　　机　　学　　报 ２０２１年
《
 计
 算
 机
 学
 报
 》
攻击者不持有未发布的私有链、内部攻击者与诚实
矿工产生竞争、内部攻击者私有链领先诚实矿工的
主链一个区块、内部攻击者私有链领先诚实矿工的
主链两个区块与内部攻击者私有链领先诚实矿工的
主链多于两个区块．
从现有的研究工作［４］可以推出区链网络处于各
状态的概率．令α′与β′分别代表诚实矿工与内部攻
击者在传统自私挖矿系统内的算力占比．传统自私
挖矿系统处于状态一的概率是 β′－２β′２
β′（２β′３－４β′２＋１）
；
处于状态二的概率是α′（β′－２β′
２）
２β′３－４β′２＋１
；处于状态三
的概率是β′－２β′２
２β′３－４β′２＋１
；处于状态四的概率
是β′（β′－２β′２）
α′（２β′３－４β′２＋１）
；处于状态五的概率是
β′２（β′－２β′２）
α′（α′－β′）（２β′３－４β′２＋１）
．
４２　外部攻击者出现的原因
引理１．　传统自私挖矿系统中，每当内部攻击
者或诚实矿工挖到一个新区块时，主链的长度有一
定概率增加，该概率小于１且与内部攻击者的影响
力γ１无关．
证明．　在传统自私挖矿系统中，诚实矿工有α′
的几率发现新区块．无论在诚实矿工发现新区块前，
区块链处于何种状态，诚实矿工发现的新区块都将
导致主链长度增加．当区块链网络处于状态一、状态
二、状态三与状态五时，诚实矿工能使区块链主链长
度增加一个区块；当区块链网络处于状态四时，诚实
矿工能使区块链主链长度增加两个区块．因此，诚实
矿工使区块链网络长度增加的期望值为α′＋
β′（β′－２β′２）
（２β′３－４β′２＋１）
．
内部攻击者有β′的概率发现新区块．在内部攻
击者发现新区块前，若区块链网络处于状态一、状态
三、状态四与状态五，攻击者挖到的新区块无法使区
块链网络延长．若区块链网络处于状态二，则内部攻
击者能使区块链主链长度增加一个区块．因此，内部
攻击者使区块链网络主链长度增加的期望值为
α′β′（β′－２β′２）
２β′３－４β′２＋１
．
因此，每当一个新区块出现时，传统自私挖矿系统
主链增长：α′＋β′（β′－２β′２）
（２β′３－４β′２＋１）
＋α′β′（β′－２β′
２）
２β′３－４β′２＋１
．主
链的增长与内部攻击者的影响力γ１无关．此时，记
犳（β′）＝α′＋β′（β′－２β′２）
（２β′３－４β′２＋１）
＋α′β′（β′－２β′
２）
２β′３－４β′２＋１
－１，
则犱犳（β′）犱β′＝ －８β′４＋９β′２－４β′
４β′６－１６β′５－１６β′４＋４β′３－８β′２＋１
．
当０＜β′＜１２时，
犱犳（β′）
犱β′０．而犳（０）＝０，从而得出
犳（β′）＜０．因此当新区块被发现时主链增加的长度
小于１． 证毕．
区块链系统中的算力可被划分为有效算力与无
效算力．当一区块未被纳入主链成为孤块时，花费在
该区块上的算力即被视作无效算力；反之，当区块被
纳入主链时，花费在该区块上的算力则为有效算力．
因此，区块链系统的有效算力与挖出一个区块的难
度与区块链主链增长速度相关．当区块链系统中所
有节点均为诚实节点时，矿工挖出的每一个区块都
可以使区块链网络主链长度增加一个区块．此时区
块链系统内的有效算力等价于区块链系统中所有节
点的算力之和．但是，由引理１可知，内部攻击者在
传统自私挖矿系统中发起自私挖矿攻击后，每个区
块仅有概率α′＋β′（β′－２β′２）
（２β′３－４β′２＋１）
＋α′β′（β′－２β′
２）
２β′３－４β′２＋１
使主链长度增加一个区块，这意味着每个区块有
１－α′－β′（β′－２β′２）
（２β′３－４β′２＋１）
－α′β′（β′－２β′
２）
２β′３－４β′２＋１
的概率
成为孤块并被废弃，被遗弃的孤块无法增加区块
链系统的主链长度．尽管传统自私挖矿系统中的
总算力为（α＋β１），但是根据传统自私挖矿系统主
链增长速度与挖矿难度计算得出的系统内有效算
力将因为内部攻击者的行为而下降至（α＋β１）·
α′＋β′（β′－２β′２）
（２β′３－４β′２＋１）
＋α′β′（β′－２β′
２）
２β′３－４β′２（ ）＋１．本文定义
收缩系数ρ＝α′＋
（β′－２β′２）
（２β′３－４β′２＋１）
＋α′β′（β′－２β′
２）
２β′３－４β′２＋１
，
收缩系数可表示出内部攻击者对传统自私挖矿系统
造成的影响．收缩系数ρ与传统自私挖矿系统内的
总算力（α＋β１）的乘积ρ（α＋β１）表示了传统自私挖
矿系统的有效算力．
本文通过蒙特卡洛方法模拟区块的生成，并生
成了主链长度为１０６的区块链．
图４展示了仿真中γ１取不同值时，传统自私挖
矿系统收缩系数与内部攻击者算力在传统自私挖矿
系统中的占比的关系．仿真结果说明，内部攻击者的
３８１１期 阮　娜等：采用工作量证明共识机制的区块链中挖矿攻击者间的“鲶鱼效应”
《
 计
 算
 机
 学
 报
 》
影响力γ１的取值不影响传统自私挖矿系统的收缩
系数．这与引理１相符．此外，攻击者算力在传统自
私挖矿系统中占比越高，传统自私挖矿系统的收缩
系数越小．这表明，攻击者算力越高，传统自私挖矿
系统内的有效算力越低．
图４　传统自私挖矿系统中的收缩系数
本文的理论分析说明，收缩系数ρ＝α′＋
β′（β′－２β′２）
（２β′３－４β′２＋１）
＋α′β′（β′－２β′
２）
２β′３－４β′２＋１
．表１展示了收
缩系数ρ在理论中与仿真中的对比．表１中的误差
率说明了传统自私挖矿系统的收缩系数ρ是可预测
的，内部攻击者在传统自私挖矿系统中发起自私挖
矿攻击前即可预测到传统自私挖矿系统有效算力下
降的程度．
表１　传统自私挖矿系统收缩系数ρ在理论中与仿真中的对比
β′ ρ理论值 ρ仿真值 误差值／％
０．２５ ０．８１９９５ ０．８２０００ ０．００５９
０．２９ ０．７９４８２ ０．７９４７９ －０．００４６
０．３３ ０．７６７１４ ０．７６７１８ ０．００５３
０．３７ ０．７３４７１ ０．７３４７８ ０．００９８
０．４１ ０．６９３６３ ０．６９３３６ －０．０３８１
０．４５ ０．６３４８５ ０．６３４３１ －０．０８４３
４３　外部攻击者出现的条件
在外部攻击者寻找攻击目标时，外部攻击者将
根据目标系统的挖矿难度与其主链增长的速度推测
目标系统的算力，本文将外部攻击者推测的目标系
统算力记作α狋．在外部攻击者的推测中，外部攻击者
（具有算力β２）与目标系统（具有算力α狋）将构成一个
新的传统自私挖矿系统，该系统具有算力β２＋α狋．外
部攻击者在该系统内的算力占比β″＝β２
β２＋α狋．
引理２．若外部攻击者算力满足β２α狋
（１－γ２）
２－γ２，
外部攻击者将对目标系统发起自私挖矿攻击，其中
γ２为外部攻击者在目标系统内的影响力．
证明．　将外部攻击者的相对收益记作犚犚犲狓，则
外部攻击者的目标为犚犚犲狓β″；将外部攻击者在与
目标系统中矿工的竞争中获胜的概率记作τ２，τ２＝
β″＋γ２α″．由于外部攻击者将目标系统视作诚实矿工，
因此在外部攻击者的预期中，外部攻击者与目标系统
构成了传统自私挖矿系统．外部攻击者处于传统自私
挖矿系统状态一的概率为 β″－２β″２
β″（２β″３－４β″２＋１）
；外部攻
击者处于状态二的概率为（１－β″）（β″－２β″
２）
２β″３－４β″２＋１
；外部攻
击者处于状态三的概率为β″－２β″２
２β″３－４β″２＋１
；外部攻击
者处于状态四的概率为 β″（β″－２β″２）
（１－β″）（２β″３－４β″２＋１）
；外部
攻击者处于状态五的概率为 β″３
（１－β″）（２β″３－４β″２＋１）
．
当外部攻击者处于状态一时，外部攻击者的收
益为０．当外部攻击者处于状态二时，外部攻击者挖
出下一个区块并赢得竞争的概率为β″，此时收益为
２；受外部攻击者影响的诚实矿工挖出下一个区块并
导致外部攻击者在竞争中获胜的概率为τ２－β″，外
部攻击者收益为１．当外部攻击者处于状态三时，无
论外部攻击者是否挖到下一个区块，外部攻击者仅会
有状态的转移，而没有直接收益，因此收益为０．当外
部攻击者处于状态四时，若外部攻击者挖到下一个区
块，外部攻击者仅会有状态的转移，若诚实矿工挖到
区块（概率为１－β″），外部攻击者将会直接发布两个
区块，因此收益为２．外部攻击者处于状态五时，无论
外部攻击者是否挖到下一个区块，外部攻击者仅会有
状态的转移，而没有直接收益，因此收益为０．
因此在外部攻击者的预测中，外部攻击者的期
望收益犈犲狓可以表示为
　　　犈犲狓＝２β″（１－β″）（β″－２β″
２）
２β″３－４β″２＋１
＋
（τ２－β″）（１－β″）（β″－２β″２）
２β″３－４β″２＋１
＋
２β″（β″－２β″２）
２β″３－４β″２＋１
＋
β″３
（１－β″）（２β″３－４β″２＋１）
（３）
目标系统中的矿工收益来自于：（１）当外部攻
击者处于状态二时，受外部攻击者影响的诚实矿工
挖到下一个区块；（２）当外部攻击者处于状态二时，
未受外部攻击者影响的诚实矿工挖到下一个区块；
（３）当外部攻击者处于状态一时，诚实矿工挖到下
４８１ 计　　算　　机　　学　　报 ２０２１年
《
 计
 算
 机
 学
 报
 》
一个区块．
目标系统中的矿工的期望收益犈犺可以表示为
犈犺＝（τ２－β″）（１－β″）（β″－２β″
２）
２β″３－４β″２＋１
＋
２（１－τ２）（１－β″）（β″－２β″２）
２β″３－４β″２＋１
＋
（１－β″）（β″－２β″２）
β″（２β″３－４β″２＋１）
（４）
依据目标系统中的矿工与外部攻击者的期望收
益，可得外部攻击者相对收益：
犚犚犲狓＝犈犲狓
犈犲狓＋犈犺β″ （５）
由不等式（５）及β″＝β２
β２＋α狋
可推得：
（１－τ２）（β２２－α２狋）＋α狋β２０ （６）
将τ２代入后可推出外部攻击者算力β２与目标
系统算力α狋的关系：
β２α狋
（１－γ２）
２－γ２ （７）
证毕．
引理３．　传统自私挖矿系统中，内部攻击者算
力为β１，诚实矿工算力为α，收缩系数ρ＝α′＋
β′（β′－２β′２）
（２β′３－４β′２＋１）
＋α′β′（β′－２β′
２）
２β′３－４β′２＋１
．当且仅当外部
攻击者算力满足：１－γ２２－γ２ρ（α＋β１）β２
１－γ２
２－γ２（α＋
β１）时，外部攻击者会在内部攻击者发起攻击后对传
统自私挖矿系统发起自私挖矿攻击．
证明．　从外部攻击者的视角看，由于内部攻击
者已在传统自私挖矿系统内发起自私挖矿攻击，传
统自私挖矿系统的有效算力为ρ（α＋β１）．由引理３
可知，外部攻击者对传统自私挖矿系统发起攻击
的条件是：β２１－γ２２－γ２ρ（α＋β１）．与此同时，若β２＞
１－γ２
２－γ２（α＋β１），外部攻击者在内部攻击者发起攻
击之前便将传统自私挖矿系统视作目标．因此，
１－γ２
２－γ２ρ（α＋β１）β２
１－γ２
２－γ２（α＋β１）． 证毕．
１－γ２
２－γ２ρ（α＋β１）与
１－γ２
２－γ２（α＋β１）可分别被视作外
部攻击者算力的下界与上界．外部攻击者算力的下
界与上界受外部攻击者的影响力、内部攻击者的算
力与诚实矿工的算力影响．当外部攻击者算力低于
下界时，外部攻击者无法通过发起自私挖矿攻击获
得额外收益；当外部攻击者算力高于上界时，外部攻
击者无需等待内部攻击者出现即可发起自私挖矿
攻击．
在仿真中，本文通过蒙特卡洛方法模拟区块的
生成，并生成了主链长度为１０６的区块链．
图５（ａ）与图５（ｂ）分别展示了β′取值０．２５与
０．４５时，外部攻击者视角下外部攻击者发起攻击所
需要的算力的上界与下界．由图５可以看出，β′的增
长不影响外部攻击者发起攻击所需算力的上界，但
是外部攻击者发起攻击所需算力的下界将随β′的增
长而降低．
图５　外部攻击者预测中所需算力上界与下界
５　多攻击者系统中的“矿工困境”
在外部攻击者出现后，两阶段挖矿攻击模型由
传统自私挖矿系统转变为多攻击者系统．在多攻击
者系统中，外部攻击者与内部攻击者都将错误地预
估自己的攻击收益．采用自私挖矿攻击策略的内部
攻击者与外部攻击者将面临“矿工困境”问题：内部
攻击者与外部攻击者同时发动攻击导致了两个攻击
者的收益同时下降．
５１　外部攻击者的困境
在外部攻击者的视角下，一旦外部攻击者的算
力高于阈值１－γ２２－γ２ρ（α＋β１），外部攻击者便可通过发
５８１１期 阮　娜等：采用工作量证明共识机制的区块链中挖矿攻击者间的“鲶鱼效应”
《
 计
 算
 机
 学
 报
 》
起自私挖矿攻击获取额外收益．然而，该预期是不契
合实际的．
通过仿真可以说明外部攻击者往往高估自身的
攻击收益．在仿真中，β′的取值仍然为０．２５与０．４５，
对应的收缩系数ρ的取值则分别为０．８２与０．６３４．
同时，令外部攻击者算力取值１－γ２２－γ２×
１＋ρ
２×
（α＋β１），该算力确保外部攻击者的算力始终处于上
界与下界之间．图６（ａ）与图６（ｂ）分别展示了外部攻
击者在β′＝０．２５与β′＝０．４５时，获得相对收益的理
论值与实际值．仿真结果表明，外部攻击者在任何β′
取值下都将高估自身的相对收益．β′取值越高，外部
攻击者预估误差越大．
图６　外部攻击者相对收益的理论值与预测值
表２与表３说明了外部攻击者如何陷入“矿工
困境”．当β′＝０．４５时，外部攻击者估算的误差可以
高达４６．６６％．这是由于随着β′值的增加，传统自私
挖矿系统收缩系数降低，传统自私挖矿系统的有效
算力降低，这导致外部攻击者低估了发动自私挖矿
攻击所需要的算力．
表２　β′＝０２５时外部攻击者的相对收益
γ２ 理论值 实际值 误差值／％
０　 ０．３３３ ０．２９４ －１１．６８
０．２ ０．３５４ ０．３１０ －１２．４０
０．４ ０．３７４ ０．３２５ －１３．１７
０．６ ０．３９５ ０．３４１ －１３．７３
０．８ ０．４１５ ０．３５７ －１４．１６
１．０ ０．４３６ ０．３７４ －１４．３０
表３　β′＝０４５时外部攻击者的相对收益
γ２ 理论值 实际值 误差值／％
０　 ０．３３３ ０．１９０ －４２．８９
０．２ ０．３５４ ０．２０１ －４３．３１
０．４ ０．３７４ ０．２１４ －４２．９３
０．６ ０．３９５ ０．２２２ －４３．８７
０．８ ０．４１５ ０．２３１ －４４．３７
１．０ ０．４３６ ０．２４１ －４４．６６
５２　内部攻击者的困境
由于外部攻击者的出现，内部攻击者将分两个
阶段调整对自身相对收益的预期．
（１）阶段一．内部攻击者尚未发现外部算力的
加入．此时，内部攻击者基于传统自私挖矿系统的参
数预测自身相对收益．
（２）阶段二．内部攻击者发现外部算力的加入，
尚未发现外部算力的攻击行为．内部攻击者将外部
算力判定为诚实矿工并重新预测相对收益．
图７（ａ）与图７（ｂ）展示了外部攻击者算力取值
１－γ２
２－γ２×
１＋ρ
２×（α＋β１）且β′的取值为０．２５与０．４５
时，内部攻击者相对收益的预测值与实际值．
图７　内部攻击者相对收益的理论值与预测值
图７中，内部攻击者两阶段的相对收益预测值
都与实际值不相符，这使内部攻击者意识到外来算
力并非诚实矿工．表４和表５更直观地展示了内部
攻击者陷入“矿工困境”并错误地预估了相对收益．
内部攻击者会在阶段一高估自己的相对收益，误差
６８１ 计　　算　　机　　学　　报 ２０２１年
《
 计
 算
 机
 学
 报
 》
最大可达６７％；在β′＝０．２５且γ１较高时，内部攻击
者在阶段二高估自己的相对收益．
表４　β′＝０２５时外部攻击者的相对收益
γ１ 阶段一理论值 阶段二理论值 实际值
０　 ０．１９６（６２．６５％） ０．１０４（－１３．６７％） ０．１２０
０．２ ０．２１６（６２．０５％） ０．１２３（－７．６３％） ０．１３３
０．４ ０．２３９（６５．５８％） ０．１４３（－０．４６％） ０．１４４
０．６ ０．２６２（６６．１４％） ０．１６５（４．４１％） ０．１５８
０．８ ０．２８２（６７．１６％） ０．１８４（９．１２％） ０．１６８
１．０ ０．３０４（６７．４６％） ０．２０５（１２．７５％） ０．１８１
表５　β′＝０４５时外部攻击者的相对收益
γ１ 阶段一理论值 阶段二理论值 实际值
０　 ０．６５７（５４．８５％） ０．３５０（－１７．４１％） ０．４２４
０．２ ０．６５３（５２．６８％） ０．３６８（－１４．８８％） ０．４３３
０．４ ０．６７９（５２．９１％） ０．３９０（－１２．１８８％） ０．４４４
０．６ ０．６８５（４９．８４％） ０．４１１（－１０．１４％） ０．４５７
０．８ ０．６９８（５０．９３％） ０．４３０（－７．０１％） ０．４６２
１．０ ０．６９９（４６．８７％） ０．４４９（－５．６６％） ０．４７６
５３　出现“矿工困境”的原因
在两阶段挖矿攻击模型的多攻击者系统中，无
论是内部攻击者还是外部攻击者，都对自身的挖矿
相对收益产生了错误的预期并陷入“矿工困境”．在
多攻击者系统中，攻击者预期之外的竞争、攻击者拍
卖式发布区块与攻击者高估自身影响力是造成攻击
者陷入“矿工困境”并对自己的相对收益产生错误预
期的主要原因．
攻击者预期之外的竞争．通常来说，攻击者通
过Ｍａｔｃｈ行为在区块链网络中发布分叉链并产生竞
争，在这种情况下区块链网络中产生的竞争为攻击者
预期之内的竞争．但是，在多攻击者系统中，攻击者的
分叉链不仅需要与诚实矿工的主链竞争，还需要与
另一个攻击者竞争．这导致了攻击者Ｏｖｅｒｒｉｄｅ行为
同样可能导致竞争的出现，该结果与攻击者通过
Ｏｖｅｒｒｉｄｅ行为确保自己发布的分叉链成为区块链网
络新主链的目的相悖．因此，本文将攻击者Ｏｖｅｒｒｉｄｅ
行为在区块链网络中产生的竞争定义为攻击者预期
之外的竞争．
图８展示了区块链网络中的两类竞争：攻击者
预期之内的竞争与攻击者预期之外的竞争．在类型
一所示的攻击者预期之内的竞争中，某一攻击者（内
部攻击者或外部攻击者）持有一个未发布的区块．在
诚实矿工挖到新区块并发布后，攻击者通过Ｍａｔｃｈ
行为发布区块制造分叉链．此时，在区块链网络中出
现了在攻击者预期之内的竞争．在类型二所示的攻
击者预期之外的竞争中，内部攻击者与外部攻击者
各自持有两个未发布的区块．在诚实矿工挖到新区
块并发布后，两个攻击者同时通过Ｏｖｅｒｒｉｄｅ行为，
试图使自己发布的分叉链成为新的主链．区块链网
络中因此产生了攻击者预期之外的竞争．
图８　两类竞争（虚线代表攻击者未发布的区块）
攻击者拍卖式发布区块．通常来说，攻击者的
Ｏｖｅｒｒｉｄｅ行为能够确保攻击者发布的分叉链成为被
全区块链网络接受的新主链．但是，在多攻击者系统
中，即使并未出现攻击者预期之外的竞争，攻击者也
无法确保自己发布的分叉链成为新的主链．两个攻
击者可能以拍卖的形式，交替发布出比当前主链长
一个区块的分叉链．本文将两个攻击者交替发布更
长的分叉链行为定义为攻击者拍卖式发布区块．
图９　攻击者拍卖式发布区块（虚线代表攻击者未发布的区块）
图９是攻击者拍卖式发布区块的简单场景．外
部攻击者拥有两个尚未发布的区块，内部攻击者拥
有三个尚未发布的区块．当诚实矿工发布新区块后，
外部攻击者将首先执行Ｏｖｅｒｒｉｄｅ行为，而内部攻击
者由于仅收到了诚实矿工发布区块的信息，执行
Ｈｏｌｄ行为．当内部攻击者最终收到了外部攻击者发
７８１１期 阮　娜等：采用工作量证明共识机制的区块链中挖矿攻击者间的“鲶鱼效应”
《
 计
 算
 机
 学
 报
 》
布的分叉链后，内部攻击者通过Ｏｖｅｒｒｉｄｅ行为将三
个区块全部发布．在该场景中，外部攻击者执行了
Ｏｖｅｒｒｉｄｅ行为，但是由于攻击者拍卖式发布区块，外
部攻击者发布的分叉链并未成为主链．
攻击者高估自身影响力．在多攻击者系统中，
攻击者往往高估自身对诚实矿工的影响力γ１与γ２．
当区块链网络中的诚实矿工支持的主链与分叉链间
存在竞争时，占比γ犺的诚实矿工由于网络传播时延
的原因，先接收到了攻击者发布的分叉链．
两个攻击者预测自己的相对收益的仿真中，由
于内部攻击者与外部攻击者在起初都将对方视作诚
实矿工，因此γ１＝γ犺，γ２＝γ犺．
而在仿真两个攻击者相对收益的实际值时，为
了更符合现实情况，本文通过两个步骤计算参数γ１
与γ２：
（１）判定竞争类型．当攻击者参与的竞争为攻
击者预期外的竞争时，γ犺＝１；当攻击者参与的竞争
为攻击者预期内的竞争时，γ犺需要在仿真中设定．
（２）分配．将参与竞争的所有攻击者算力表示
为∑犽β犽．若内部攻击者参与竞争，γ１＝γ犺×β１
∑犽β犽
，
γ２＝γ犺－γ１；若内部攻击者未参与竞争，γ１＝０，
γ２＝γ犺．
６　多攻击者系统中的鲶鱼效应
由于外部攻击者的出现，内部攻击者发起挖矿
攻击的收益大幅下降并陷入“矿工困境”．因此内部
攻击者需要寻找一个更优的挖矿攻击策略作为针对
外部攻击者的对抗措施以破解“矿工困境”．
一个挖矿攻击策略的最终目的是：防止自身算
力被其余攻击者浪费；更好地浪费诚实矿工与其余
攻击者的算力．避免意料之外的竞争与避免攻击者
拍卖式发布区块可以有效地实现该目的．
６１　部分主动发布策略
本文提出了一个全新的挖矿攻击策略：部分主
动发布策略（ＰａｒｔｉａｌＩｎｉｔｉａｔｉｖｅＲｅｌｅａｓｅ，ＰＩＲ）．部分
主动发布策略是一系列策略的策略集，可以被表示
为｛犘犐犚１，犘犐犚２，犘犐犚３，…，犘犐犚狀，…｝．在策略犘犐犚狀
中，攻击者状态（攻击者未发布的私有链领先主链的
长度）的最大值被限定为狀，当攻击者状态超过狀
时，攻击者将主动发布区块．图１０展示了部分主动
发布策略集中犘犐犚３的状态机．当采用犘犐犚３策略的
攻击者的状态尚未达到３时，攻击者的表现与自私
挖矿攻击者相同．在采用犘犐犚３策略的攻击者状态达
到３后，若下一个区块仍然由该攻击者发现，那么攻
击者将主动发布一个区块；若下一个区块由诚实矿
工发现，那么攻击者将发布所有的未发布区块．
图１０　策略犘犐犚３的状态机
内部攻击者可以通过犘犐犚３策略降低攻击者预
料之外的竞争出现的概率与攻击者拍卖式发布区块
行为出现的概率．
６２　仿真量化分析
本文通过仿真揭示在采用自私挖矿策略的外部
攻击者出现后，内部攻击者该通过何种策略对抗外
部攻击者．内部攻击者的可选策略有：自私挖矿策
略、部分主动发布策略犘犐犚３与诚实挖矿．
在仿真中，本文将内部攻击者算力β１设置为变量，
分别探讨外部攻击者算力处于上界β２＝１－γ２２－γ２（α＋β１）
与外部攻击者算力处于下界β２＝１－γ２２－γ２ρ（α＋β１）时，
内部攻击者采取不同攻击策略时的相对收益．此外，
本文也将讨论不同的γ犺取值带来的影响，γ犺值取自
集合｛０，０．２５，０．５，０，７５｝．
外部攻击者算力处于下界．当外部攻击者算力
处于下界β２＝１－γ２２－γ２ρ（α＋β１）时，由于α＋β１＋β２＝１，
且ρ＝α′＋β′（β′－２β′２）
（２β′３－４β′２＋１）
＋α′β′（β′－２β′
２）
２β′３－４β′２＋１
，通过
β１的值可确定α与β２的值．受模型假设“内部攻击者
算力小于诚实矿工”即β１＜α的约束，仿真中内部攻
击者算力小于１／３．图１１展示了内部攻击者采取不
同策略时，内部攻击者相对收益与内部攻击者算力
β１的关系．此外图中还将内部攻击者算力作为基线，
当内部攻击者相对收益高于内部攻击者算力时，内
部攻击者将获得额外攻击收益．仿真结果表明，当
γ犺＝０时，若内部攻击者算力占比大于０．２７，采用部
分主动发布策略将为内部攻击者带来额外收益；若
内部攻击者算力占比处于区间［０．２７，０．３１］内，部分
主动发布策略优于自私挖矿与诚实挖矿．当γ犺＝
０．２５时，若内部攻击者算力占比大于０．２４，采用部
８８１ 计　　算　　机　　学　　报 ２０２１年
《
 计
 算
 机
 学
 报
 》
分主动发布策略将为内部攻击者带来额外收益；若
内部攻击者算力占比处于区间［０．２４，０．２８］内，部分
主动发布策略优于自私挖矿与诚实挖矿．当γ犺＝
０．５时，若内部攻击者算力占比大于０．２０，采用部分
主动发布策略将为内部攻击者带来额外收益；若内
部攻击者算力占比处于区间［０．２１，０．２６］内，部分主
动发布策略优于自私挖矿与诚实挖矿．当γ犺＝０．７５
时，若内部攻击者算力占比大于０．１６，采用部分主
动发布策略将为内部攻击者带来额外收益；若内部
攻击者算力占比处于区间［０．１７，０．２３］内，部分主动
发布策略优于自私挖矿与诚实挖矿．
图１１　外部攻击者算力处于下界时，内部攻击者的相对收益
由仿真结果可以看出，在外部攻击者算力较低
（处于下界）时，对于内部攻击者来说，部分主动发布
策略的优势区间随参数γ犺值变化而变化．相较于自
私挖矿策略与诚实挖矿，部分主动发布策略在优势
区间内对内部攻击者相对收益的提升有限．
外部攻击者算力处于上界．当外部攻击者算力
处于上界β２＝１－γ２２－γ２（α＋β１）时，由于α＋β１＋β２＝１，
通过β１的值可确定α与β２的值．为确保内部攻击者
算力小于诚实矿工，在仿真中内部攻击者算力小于
１／３．图１２展示了内部攻击者采取不同策略时，内部
攻击者相对收益与内部攻击者算力β１的关系．仿真
中，本文将内部攻击者算力作为基线，当内部攻击者
相对收益高于内部攻击者算力时，内部攻击者将获
得额外的攻击收益．仿真结果表明，当γ犺＝０时，若
内部攻击者算力占比大于０．２５，采用部分主动发布
策略将为内部攻击者带来额外收益；若内部攻击者
算力占比处于区间［０．２４，０．３３］内，部分主动发布策
略优于自私挖矿与诚实挖矿．当γ犺＝０．２５时，若内
部攻击者算力占比大于０．２４，采用部分主动发布策
略将为内部攻击者带来额外收益；若内部攻击者算
力占比处于区间［０．２３，０．３１］内，部分主动发布策略
优于自私挖矿与诚实挖矿．当γ犺＝０．５时，若内部攻
击者算力占比大于０．２１，采用部分主动发布策略将
为内部攻击者带来额外收益；若内部攻击者算力占
比处于区间［０．２２，０．２７］内，部分主动发布策略优于
自私挖矿与诚实挖矿．当γ犺＝０．７５时，若内部攻击
者算力占比大于０．１５，采用部分主动发布策略将为
内部攻击者带来额外收益；若内部攻击者算力占比
处于区间［０．１５，０．２４］内，部分主动发布策略优于自
私挖矿与诚实挖矿．
由仿真结果可以看出，在外部攻击者算力较高
（处于上界）时，对于内部攻击者来说，部分主动发布
策略的优势区间随参数γ犺值变化而变化．当γ犺较低
（γ犺＝０或γ犺＝０．２５）时，相较于自私挖矿策略与诚
实挖矿，部分主动发布策略在其优势区间内对内部
攻击者的相对收益有显著的提升．当γ犺较高（γ犺＝
０．５或γ犺＝０．７５）时，相较于自私挖矿策略与诚实挖
９８１１期 阮　娜等：采用工作量证明共识机制的区块链中挖矿攻击者间的“鲶鱼效应”
《
 计
 算
 机
 学
 报
 》
图１２　外部攻击者算力处于上界时，内部攻击者的相对收益
矿，部分主动发布策略在其优势区间内对内部攻击
者的相对收益提升有限．
仿真结果表明，在多攻击者系统中，内部攻击者
可以依据自身算力β１与外部攻击者算力β２选择攻
击策略以对抗外部攻击者．当外部攻击者算力较高
时，内部攻击者采用部分主动发布策略可以显著提
升自身的相对收益；而当外部攻击者算力较低时，部
分主动发布策略对内部攻击者相对收益的提升
有限．
７　结　论
本文提出了全新的两阶段挖矿攻击模型并指出
当挖矿攻击模型中存在多个攻击者时，攻击者将面
临“矿工困境”．两阶段挖矿攻击模型由传统自私挖
矿系统与多攻击者系统组成．本文解释了挖矿攻击模
型出现两个攻击者的原因与攻击者们陷入“矿工困
境”的原因．本文还揭示了多攻击者系统中存在着鲶
鱼效应：在多攻击者系统中，由于外部攻击者的出现
带来了预期之外的竞争问题与攻击者拍卖式发布区
块问题，内部攻击者需要优化攻击策略．本文提出了
名为部分主动发布策略的半诚实挖矿攻击策略，在
部分场景下，攻击者可以通过部分主动发布策略获
得更高的攻击收益，从而打破“矿工困境”．此外，尽
管本文从内部攻击者的视角提出了部分主动发布策
略，实际上外部攻击者同样可以使用该策略提升自
身的相对收益．
参考文献
［１］ＮａｋａｍｏｔｏＳ．Ｂｉｔｃｏｉｎ：Ａｐｅｅｒｔｏｐｅｅｒｅｌｅｃｔｒｏｎｉｃｃａｓｈｓｙｓｔｅｍ．
Ｂｉｔｃｏｉｎ．ＵＲＬ：ｈｔｔｐｓ：／／ｂｉｔｃｏｉｎ．ｏｒｇ／ｂｉｔｃｏｉｎ．ｐｄｆ，２００８
［２］ＧｅｒｖａｉｓＡ，ＫａｒａｍｅＧＯ，ＷüｓｔＫ，ｅｔａｌ．Ｏｎｔｈｅｓｅｃｕｒｉｔｙａｎｄ
ｐｅｒｆｏｒｍａｎｃｅｏｆｐｒｏｏｆｏｆｗｏｒｋｂｌｏｃｋｃｈａｉｎｓ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆ
ｔｈｅ２０１６ＡＣＭＳＩＧＳＡＣＣｏｎｆｅｒｅｎｃｅｏｎＣｏｍｐｕｔｅｒａｎｄ
ＣｏｍｍｕｎｉｃａｔｉｏｎｓＳｅｃｕｒｉｔｙ．Ｖｉｅｎｎａ，Ａｕｓｔｒｉａ，２０１６：３１６
［３］ＥｙａｌＩ．Ｔｈｅｍｉｎｅｒ’ｓｄｉｌｅｍｍａ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ２０１５ＩＥＥＥ
ＳｙｍｐｏｓｉｕｍｏｎＳｅｃｕｒｉｔｙａｎｄＰｒｉｖａｃｙ．ＳａｎＪｏｓｅ，ＵＳＡ，２０１５：
８９１０３
［４］ＥｙａｌＩ，ＳｉｒｅｒＥＧ．Ｍａｊｏｒｉｔｙｉｓｎｏｔｅｎｏｕｇｈ：Ｂｉｔｃｏｉｎｍｉｎｉｎｇｉｓ
ｖｕｌｎｅｒａｂｌｅ．ＣｏｍｍｕｎｉｃａｔｉｏｎｓｏｆｔｈｅＡＣＭ，２０１８，６１（７）：
９５１０２
［５］ＮａｙａｋＫ，ＫｕｍａｒＳ，ＭｉｌｌｅｒＡ，ｅｔａｌ．Ｓｔｕｂｂｏｒｎｍｉｎｉｎｇ：
Ｇｅｎｅｒａｌｉｚｉｎｇｓｅｌｆｉｓｈｍｉｎｉｎｇａｎｄｃｏｍｂｉｎｉｎｇｗｉｔｈａｎｅｃｌｉｐｓｅ
ａｔｔａｃｋ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ２０１６ＩＥＥＥＥｕｒｏｐｅａｎＳｙｍｐｏｓｉｕｍ
ｏｎＳｅｃｕｒｉｔｙａｎｄＰｒｉｖａｃｙ．Ｓａａｒｂｒüｃｋｅｎ，Ｇｅｒｍａｎｙ，２０１６：３０５
３２０
［６］ＳａｐｉｒｓｈｔｅｉｎＡ，ＳｏｍｐｏｌｉｎｓｋｙＹ，ＺｏｈａｒＡ．Ｏｐｔｉｍａｌｓｅｌｆｉｓｈ
ｍｉｎｉｎｇｓｔｒａｔｅｇｉｅｓｉｎＢｉｔｃｏｉｎ／／ＰｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅＩｎｔｅｒｎａｔｉｏｎａｌ
ＣｏｎｆｅｒｅｎｃｅｏｎＦｉｎａｎｃｉａｌＣｒｙｐｔｏｇｒａｐｈｙａｎｄＤａｔａＳｅｃｕｒｉｔｙ．
ＣｈｒｉｓｔＣｈｕｒｃｈ，Ｂａｒｂａｄｏｓ，２０１６：５１５５３２
［７］ＴａｎｇＣｈａｎｇＢｉｎｇ，ＹａｎｇＺｈｅｎ，ＺｈｅｎｇＺｈｏｎｇＬｏｎｇ，ｅｔａｌ．
Ａｎａｎａｌｙｓｉｓａｎｄｏｐｔｉｍｉｚａｔｉｏｎｏｎｍｉｎｅｒ’ｓｄｉｌｅｍｍａｉｎＰｏＷ
ｃｏｎｓｅｎｓｕｓｐｒｏｔｏｃｏｌ．ＡｃｔａＡｕｔｏｍａｔｉｃａＳｉｎｉｃａ，２０１７，４３（９）：
０９１ 计　　算　　机　　学　　报 ２０２１年
《
 计
 算
 机
 学
 报
 》
１５２０１５３１（ｉｎＣｈｉｎｅｓｅ）
（唐长兵，杨珍，郑忠龙等．ＰｏＷ共识算法中的博弈困境分
析与优化．自动化学报，２０１７，４３（９）：１５２０１５３１）
［８］ＫｗｏｎＹ，ＫｉｍＤ，ＳｏｎＹ，ｅｔａｌ．Ｂｅｓｅｌｆｉｓｈａｎｄａｖｏｉｄｄｉｌｅｍｍａｓ：
Ｆｏｒｋａｆｔｅｒｗｉｔｈｈｏｌｄｉｎｇ（ＦＡＷ）ａｔｔａｃｋｓｏｎＢｉｔｃｏｉｎ／／Ｐｒｏｃｅｅｄｉｎｇｓ
ｏｆｔｈｅ２０１７ＡＣＭＳＩＧＳＡＣＣｏｎｆｅｒｅｎｃｅｏｎＣｏｍｐｕｔｅｒａｎｄ
ＣｏｍｍｕｎｉｃａｔｉｏｎｓＳｅｃｕｒｉｔｙ．Ｄａｌｌａｓ，ＵＳＡ，２０１７：１９５２０９
［９］ＧａｏＳ，ＬｉＺ，ＰｅｎｇＺ，ＸｉａｏＢ．Ｐｏｗｅｒａｄｊｕｓｔｉｎｇａｎｄｂｒｉｂｅｒｙ
ｒａｃｉｎｇ：ＮｏｖｅｌｍｉｎｉｎｇａｔｔａｃｋｓｉｎｔｈｅＢｉｔｃｏｉｎｓｙｓｔｅｍ／／Ｐｒｏｃｅｅｄｉｎｇｓ
ｏｆｔｈｅ２０１９ＡＣＭＳＩＧＳＡＣＣｏｎｆｅｒｅｎｃｅｏｎＣｏｍｐｕｔｅｒａｎｄ
ＣｏｍｍｕｎｉｃａｔｉｏｎｓＳｅｃｕｒｉｔｙ．Ｌｏｎｄｏｎ，ＵＫ．２０１９：８３３８５０
［１０］ＤｏｎｇＸ，ＷｕＦ，ＦａｒｅｅＡ，ｅｔａｌ．Ｓｅｌｆｈｏｌｄｉｎｇ：Ａｃｏｍｂｉｎｅｄ
ａｔｔａｃｋｍｏｄｅｌｕｓｉｎｇｓｅｌｆｉｓｈｍｉｎｉｎｇｗｉｔｈｂｌｏｃｋｗｉｔｈｈｏｌｄｉｎｇ
ａｔｔａｃｋ．Ｃｏｍｐｕｔｅｒｓ＆Ｓｅｃｕｒｉｔｙ，２０１９，８７：１０１５８４
［１１］ＬｉｕＨ，ＲｕａｎＮ，ＤｕＲ，ｅｔａｌ．Ｏｎｔｈｅｓｔｒａｔｅｇｙａｎｄｂｅｈａｖｉｏｒ
ｏｆＢｉｔｃｏｉｎｍｉｎｉｎｇｗｉｔｈＮａｔｔａｃｋｅｒｓ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ２０１８
ｏｎＡｓｉａＣｏｎｆｅｒｅｎｃｅｏｎＣｏｍｐｕｔｅｒａｎｄＣｏｍｍｕｎｉｃａｔｉｏｎｓＳｅｃｕｒｉｔｙ．
Ｉｎｃｈｅｏｎ，ＳｏｕｔｈＫｏｒｅａ，２０１８：３５７３６８
［１２］ＭａｒｍｏｌｅｊｏＣｏｓｓíｏＪ，ＢｒｉｇｈａｍＥ，ＳｅｌａＢ，Ｋａｔｚ，Ｊ．Ｃｏｍｐｅｔｉｎｇ
（Ｓｅｍｉ）ｓｅｌｆｉｓｈｍｉｎｅｒｓｉｎＢｉｔｃｏｉｎ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ１ｓｔ
ＡＣＭＣｏｎｆｅｒｅｎｃｅｏｎＡｄｖａｎｃｅｓｉｎＦｉｎａｎｃｉａｌＴｅｃｈｎｏｌｏｇｉｅｓ．
ＮｅｗＹｏｒｋ，ＵＳＡ，２０１９：８９１０９
［１３］ＢａｉＱ，ＺｈｏｕＸ，ＷａｎｇＸ，ｅｔａｌ．Ａｄｅｅｐｄｉｖｅｉｎｔｏｂｌｏｃｋｃｈａｉｎ
ｓｅｌｆｉｓｈｍｉｎｉｎｇ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ２０１９ＩＥＥＥＩｎｔｅｒｎａｔｉｏｎａｌ
ＣｏｎｆｅｒｅｎｃｅｏｎＣｏｍｍｕｎｉｃａｔｉｏｎｓ．Ｓｈａｎｇｈａｉ，Ｃｈｉｎａ，２０１９：１６
［１４］ＭｅｒｋｌｅＲＣ．Ａｄｉｇｉｔａｌｓｉｇｎａｔｕｒｅｂａｓｅｄｏｎａｃｏｎｖｅｎｔｉｏｎａｌ
ｅｎｃｒｙｐｔｉｏｎｆｕｎｃｔｉｏｎ／／ＰｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅＣｏｎｆｅｒｅｎｃｅｏｎｔｈｅ
ＴｈｅｏｒｙａｎｄＡｐｐｌｉｃａｔｉｏｎｏｆＣｒｙｐｔｏｇｒａｐｈｉｃＴｅｃｈｎｉｑｕｅｓ．Ｂｅｒｌｉｎ，
Ｇｅｒｍａｎｙ，１９８７：３６９３７８
［１５］ＬａｓｚｋａＡ，ＪｏｈｎｓｏｎＢ，ＧｒｏｓｓｋｌａｇｓＪ．ＷｈｅｎＢｉｔｃｏｉｎｍｉｎｉｎｇ
ｐｏｏｌｓｒｕｎｄｒｙ／／ＰｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅＩｎｔｅｒｎａｔｉｏｎａｌＣｏｎｆｅｒｅｎｃｅ
ｏｎＦｉｎａｎｃｉａｌＣｒｙｐｔｏｙａｎｄＤａｔａＳｅｃｕｒｉｔｙ．ＳａｎＪｕａｎ，Ｐｕｅｒｔｏ
Ｒｉｃｏ，２０１５：６３７７
［１６］ＤｅｃｋｅｒＣ，ＷａｔｔｅｎｈｏｆｅｒＲ．Ｉｎｆｏｒｍａｔｉｏｎｐｒｏｐａｇａｔｉｏｎｉｎｔｈｅ
Ｂｉｔｃｏｉｎｎｅｔｗｏｒｋ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ２０１３ＩＥＥＥＰ２Ｐ．Ｔｒｅｎｔｏ，
Ｉｔａｌｙ，２０１３：１１０
［１７］ＢａｇＳ，ＳａｋｕｒａｉＫ．Ｙｅｔａｎｏｔｈｅｒｎｏｔｅｏｎｂｌｏｃｋｗｉｔｈｈｏｌｄｉｎｇ
ａｔｔａｃｋｏｎＢｉｔｃｏｉｎｍｉｎｉｎｇｐｏｏｌｓ／／ＰｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅＩｎｔｅｒｎａ
ｔｉｏｎａｌＣｏｎｆｅｒｅｎｃｅｏｎＩｎｆｏｒｍａｔｉｏｎＳｅｃｕｒｉｔｙ．Ｈｏｎｏｌｕｌｕ，ＵＳＡ，
２０１６：１６７１８０
［１８］ＢａｇＳ，ＲｕｊＳ，ＳａｋｕｒａｉＫ．Ｂｉｔｃｏｉｎｂｌｏｃｋｗｉｔｈｈｏｌｄｉｎｇａｔｔａｃｋ：
Ａｎａｌｙｓｉｓａｎｄｍｉｔｉｇａｔｉｏｎ．ＩＥＥＥＴｒａｎｓａｃｔｉｏｎｓｏｎＩｎｆｏｒｍａｔｉｏｎ
ＦｏｒｅｎｓｉｃｓａｎｄＳｅｃｕｒｉｔｙ，２０１６，１２（８）：１９６７１９７８
［１９］ＨｅｉｌｍａｎＥ，ＫｅｎｄｌｅｒＡ，ＺｏｈａｒＡ，ｅｔａｌ．Ｅｃｌｉｐｓｅａｔｔａｃｋｓｏｎ
Ｂｉｔｃｏｉｎ’ｓｐｅｅｒｔｏｐｅｅｒｎｅｔｗｏｒｋ／／Ｐｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅ２４ｔｈ
ＵＳＥＮＩＸＳｅｃｕｒｉｔｙＳｙｍｐｏｓｉｕｍ．Ｗａｓｈｉｎｇｔｏｎ，ＵＳＡ，２０１５：
１２９１４４
［２０］ＧｂｅｌＪ，ＫｅｅｌｅｒＨＰ，ＫｒｚｅｓｉｎｓｋｉＡＥ，ｅｔａｌ．Ｂｉｔｃｏｉｎ
ｂｌｏｃｋｃｈａｉｎｄｙｎａｍｉｃｓ：Ｔｈｅｓｅｌｆｉｓｈｍｉｎｅｓｔｒａｔｅｇｙｉｎｔｈｅ
ｐｒｅｓｅｎｃｅｏｆｐｒｏｐａｇａｔｉｏｎｄｅｌａｙ．ＰｅｒｆｏｒｍａｎｃｅＥｖａｌｕａｔｉｏｎ，
２０１６，１０４：２３４１
［２１］ＢｏｎｎｅａｕＪ，ＭｉｌｌｅｒＡ，ＣｌａｒｋＪ，ｅｔａｌ．ＳｏＫ：Ｒｅｓｅａｒｃｈｐｅｒｓｐｅｃｔｉｖｅｓ
ａｎｄｃｈａｌｌｅｎｇｅｓｆｏｒＢｉｔｃｏｉｎａｎｄｃｒｙｐｔｏｃｕｒｒｅｎｃｉｅｓ／／Ｐｒｏｃｅｅｄｉｎｇｓ
ｏｆｔｈｅ２０１５ＩＥＥＥＳｙｍｐｏｓｉｕｍｏｎＳｅｃｕｒｉｔｙａｎｄＰｒｉｖａｃｙ．Ｓａｎ
Ｊｏｓｅ，ＵＳＡ，２０１５：１０４１２１
［２２］ＬｉａｏＫ，ＫａｔｚＪ．Ｉｎｃｅｎｔｉｖｉｚｉｎｇｂｌｏｃｋｃｈａｉｎｆｏｒｋｓｖｉａｗｈａｌｅ
ｔｒａｎｓａｃｔｉｏｎｓ／／ＰｒｏｃｅｅｄｉｎｇｓｏｆｔｈｅＩｎｔｅｒｎａｔｉｏｎａｌＣｏｎｆｅｒｅｎｃｅｏｎ
ＦｉｎａｎｃｉａｌＣｒｙｐｔｏｇｒａｐｈｙａｎｄＤａｔａＳｅｃｕｒｉｔｙ．Ｓｌｉｅｍａ，Ｍａｌｔａ，
２０１７：２６４２７９
犚犝犃犖犖犪，Ｐｈ．Ｄ．，ａｓｓｏｃｉａｔｅｐｒｏ
ｆｅｓｓｏｒ．Ｈｅｒｒｅｓｅａｒｃｈｉｎｔｅｒｅｓｔｓｉｎｃｌｕｄｅ
ｓｅｃｕｒｉｔｙ＆ｐｒｉｖａｃｙ，ｂｌｏｃｋｃｈａｉｎａｎｄｂｉｇ
ｄａｔａ．
犔犐犝犎犪狀犙犻狀犵，Ｍ．Ｓ．Ｈｉｓｒｅｓｅａｒｃｈｉｎｔｅｒｅｓｔｓｉｎｃｌｕｄｅ
ｓｅｃｕｒｉｔｙｏｆｂｌｏｃｋｃｈａｉｎ．
犛犐犡狌犲犕犻狀犵，ｐｒｏｆｅｓｓｏｒ．Ｈｉｓｒｅｓｅａｒｃｈｉｎｔｅｒｅｓｔｓｉｎｃｌｕｄｅ
ｃｒｙｐｔｏｇｒａｐｈｙ，ｄａｔａｓｃｉｅｎｃｅ，ｃｏｍｐｕｔｅｒａｒｃｈｉｔｅｃｔｕｒｅ，ｎｅｔｗｏｒｋ
ｓｅｃｕｒｉｔｙａｎｄｂｌｏｃｋｃｈａｉｎ．
犅犪犮犽犵狉狅狌狀犱
Ｍｏｓｔｄｉｇｉｔａｌｃｒｙｐｔｏｃｕｒｒｅｎｃｉｅｓａｒｅｂａｓｅｄｏｎｔｈｅｂｌｏｃｋｃｈａｉｎ
ｔｅｃｈｎｏｌｏｇｙ．Ｔｈｅｃｏｎｓｅｎｓｕｓｍｅｃｈａｎｉｓｍｏｆａｂｌｏｃｋｃｈａｉｎ
ｇｕａｒａｎｔｅｅｓｔｈａｔｔｈｅｒｅｃｏｒｄｓ，ｅｓｐｅｃｉａｌｌｙｔｒａｎｓａｃｔｉｏｎｒｅｃｏｒｄｓ
ｓｔｏｒｅｄｉｎｔｈｅｂｌｏｃｋｃｈａｉｎａｒｅｉｒｒｅｖｅｒｓｉｂｌｅａｎｄｃｏｎｓｉｓｔｅｎｔｔｏａｌｌ
ｕｓｅｒｓ．ＰｒｏｏｆｏｆＷｏｒｋ，ＰｒｏｏｆｏｆＳｔａｋｅａｎｄＰｒａｃｔｉｃａｌＢｙｚａｎｔｉｎｅ
ＦａｕｌｔＴｏｌｅｒａｎｃｅａｒｅｓｏｍｅｃｏｎｓｅｎｓｕｓｍｅｃｈａｎｉｓｍｗｈｉｃｈａｒｅ
ａｐｐｌｉｅｄｂｙｂｌｏｃｋｃｈａｉｎ．Ａｍｏｎｇｔｈｅｓｅｃｏｎｓｅｎｓｕｓｍｅｃｈａｎｉｓｍｓ，
ＰｒｏｏｆｏｆＷｏｒｋｉｓｔｈｅｍｏｓｔｗｉｄｅｌｙｕｓｅｄｏｎｅ．Ｉｎｔｈｅｐａｓｔ
ｄｅｃａｄｅ，ｔｈｅｓｅｃｕｒｉｔｙｏｆａＰｒｏｏｆｏｆＷｏｒｋｐｏｗｅｒｅｄｂｌｏｃｋｃｈａｉｎ
ｈａｓｂｅｅｎａｈｏｔｔｏｐｉｃ．Ｒｅｓｅａｒｃｈｅｒｓｈａｖｅｐｒｏｐｏｓｅｄｍａｎｙ
ｍｉｎｉｎｇａｔｔａｃｋｓｔｒａｔｅｇｉｅｓｓｕｃｈａｓｓｅｌｆｉｓｈｍｉｎｉｎｇａｔｔａｃｋａｎｄ
ｂｌｏｃｋｗｉｔｈｈｏｌｄｉｎｇａｔｔａｃｋ．Ｔｈｅｓｅｍｉｎｉｎｇａｔｔａｃｋｓｔｒａｔｅｇｉｅｓａｒｅ
ｐｒｏｖｅｄｔｏｂｅｆｅａｓｉｂｌｅｎｏｔｏｎｌｙｂｙｔｈｅｒｅｓｅａｒｃｈｅｒｓ，ｂｕｔａｌｓｏｂｙ
ｔｈｅａｔｔａｃｋｅｒｓｉｎｔｈｅｒｅａｌｗｏｒｌｄ．Ｆｏｒｅｘａｍｐｌｅ，ｉｎＭａｙ２０１８，ａ
ＰｒｏｏｆｏｆＷｏｒｋｐｏｗｅｒｅｄｃｒｙｐｔｏｃｕｒｒｅｎｃｙｎａｍｅｄＭｏｎａｃｏｉｎｗａｓ
ａｔｔａｃｋｂｙａｎａｔｔａｃｋｅｒｗｉｔｈｔｈｅｆａｍｏｕｓｍｉｎｉｎｇａｔｔａｃｋｓｔｒａｔｅｇｙ
１９１１期 阮　娜等：采用工作量证明共识机制的区块链中挖矿攻击者间的“鲶鱼效应”
《
 计
 算
 机
 学
 报
 》
ｓｅｌｆｉｓｈｍｉｎｉｎｇ．
Ｍｉｎｉｎｇａｔｔａｃｋｓｃａｎｂｅｐｒｅｖｅｎｔｅｄｂｙｈｏｎｅｓｔｍｉｎｅｒｓｖｉａ
ｄｅｓｉｇｎｉｎｇａｐｐｒｏｐｒｉａｔｅｐｒｏｔｏｃｏｌｓ．Ｂｕｔａｎｉｎｔｅｒｅｓｔｉｎｇｆａｃｔｉｓ
ｔｈａｔｍｉｎｉｎｇａｔｔａｃｋｓｃａｎａｌｓｏｂｅｐｒｅｖｅｎｔｅｄｂｙａｔｔａｃｋｅｒｓ
ｔｈｅｍｓｅｌｖｅｓ．Ｓｏｍｅａｔｔａｃｋｅｒｓｈａｖｅｔｏｔｕｒｎｉｎｔｏｈｏｎｅｓｔｍｉｎｅｒｓ
ｄｕｅｔｏｔｈｅｃｏｍｐｅｔｉｔｉｏｎｓｂｅｔｗｅｅｎａｔｔａｃｋｅｒｓ．Ｓｏｍｅｒｅｓｅａｒｃｈｅｓ
ｒｅｖｅａｌｔｈａｔａｔｔａｃｋｅｒｓｍｉｇｈｔｆａｃｅｐｒｉｓｏｎｅｒ’ｓｄｉｌｅｍｍａｗｈｅｎ
ｔｈｅｙａｒｅｃｏｎｄｕｃｔｉｎｇｂｌｏｃｋｗｉｔｈｈｏｌｄｉｎｇａｔｔａｃｋ．Ｔｏｓｏｍｅ
ｅｘｔｅｎｔ，ｔｈｅｇａｍｅｂｅｔｗｅｅｎａｔｔａｃｋｅｒｓｄｅｃｒｅａｓｅｓａｌｌａｔｔａｃｋｅｒ’ｓ
ｒｅｗａｒｄ．Ｂｕｔｔｈｅｃｏｍｐｅｔｉｔｉｏｎｂｅｔｗｅｅｎａｔｔａｃｋｅｒｓｗｉｔｈｓｔｒａｔｅｇｙ
ｓｅｌｆｉｓｈｍｉｎｉｎｇｉｓｎｏｔｓｙｓｔｅｍａｔｉｃａｌｌｙｓｔｕｄｉｅｄｂｙｔｈｅｒｅｓｅａｒｃｈｅｒｓ．
Ｏｕｒｗｏｒｋｎａｍｅｄ‘ＯｎｔｈｅｓｔｒａｔｅｇｙａｎｄｂｅｈａｖｉｏｒｏｆＢｉｔｃｏｉｎ
ｍｉｎｉｎｇｗｉｔｈＮａｔｔａｃｋｅｒｓ’ｐｒｅｓｅｎｔｅｄｔｈｅｆｉｒｓｔｓｅｌｆｉｓｈｍｉｎｉｎｇ
ｍｏｄｅｌｗｉｔｈｔｗｏａｔｔａｃｋｅｒｓｉｎ２０１８．Ｏｎｔｈｅｂａｓｉｓｏｆｏｕｒｐｒｅｖｉｏｕｓ
ｗｏｒｋ，ｉｎｔｈｉｓｗｏｒｋ，ｗｅｐｒｅｓｅｎｔａｔｗｏｐｈａｓｅｍｉｎｉｎｇａｔｔａｃｋ
ｍｏｄｅｌａｎｄｒｅｖｅａｌｓｔｈｅＣａｔｆｉｓｈｅｆｆｅｃｔｂｅｔｗｅｅｎｔｗｏｓｅｌｆｉｓｈ
ｍｉｎｅｒｓ．Ｏｕｒｗｏｒｋｓｈｏｗｓｔｈａｔｉｎｔｈｅｍｉｎｉｎｇａｔｔａｃｋｍｏｄｅｌ
ｗｉｔｈｔｗｏａｔｔａｃｋｅｒｓ，ｂｅｉｎｇｓｅｍｉｈｏｎｅｓｔｉｓａｎｏｐｔｉｏｎｆｏｒｔｈｅ
ａｔｔａｃｋｅｒ．Ｔｈｕｓ，ｗｈｅｎｔｈｅｎｕｍｂｅｒｏｆａｔｔａｃｋｅｒｉｎｃｒｅａｓｅｓ，
ａｔｔａｃｋｅｒｓｈａｖｅｔｈｅｔｒｅｎｄｔｏｂｅｈｏｎｅｓｔｏｒｓｅｍｉｈｏｎｅｓｔ．
ＴｈｉｓｗｏｒｋｉｓｓｕｐｐｏｒｔｅｄｂｙｔｈｅＮａｔｉｏｎａｌＮａｔｕｒａｌＳｃｉｅｎｃｅ
ＦｏｕｎｄａｔｉｏｎｏｆＣｈｉｎａｕｎｄｅｒＧｒａｎｔＮｏ．６１７０２３３０．
２９１ 计　　算　　机　　学　　报 ２０２１年
《
 计
 算
 机
 学
 报
 》