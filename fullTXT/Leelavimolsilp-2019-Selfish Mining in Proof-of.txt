Selfish Mining in Proof-of-Work Blockchain with Multiple Miners: An Empirical Evaluation
Selfish Mining in Proof-of-Work
Blockchain with Multiple Miners:
An Empirical Evaluation
Tin Leelavimolsilp1(B), Viet Nguyen2, Sebastian Stein1,
and Long Tran-Thanh1
1 University of Southampton, Southampton SO17 1BJ, UK
{tin.leelavimolsilp,s.stein,l.tran-thanh}@soton.ac.uk
2 Imperial College London, London SW7 2AZ, UK
viet.nguyen17@imperial.ac.uk
Abstract. Proof-of-Work blockchain, despite its numerous benefits, is
still not an entirely secure technology due to the existence of Selfish Min-
ing (SM) strategies that can disrupt the system and its mining economy.
While the effect of SM has been studied mostly in a two-miners scenario,
it has not been investigated in a more practical context where there are
multiple malicious miners individually performing SM. To fill this gap,
we carry out an empirical study that separately accounts for different
numbers of SM miners (who always perform SM) and strategic miners
(who choose either SM or Nakamoto’s mining protocol depending on
which maximises their individual mining reward). Our result shows that
SM is generally more effective as the number of SM miners increases,
however its effectiveness does not vary in the presence of a large num-
ber of strategic miners. Under specific mining power distributions, we
also demonstrate that multiple miners can perform SM and simulta-
neously gain higher mining rewards than they should. Surprisingly, we
also show that the more strategic miners there are, the more robust the
systems become. Since blockchain miners should naturally be seen as
self-interested strategic miners, our findings encourage blockchain sys-
tem developers and engineers to attract as many miners as possible to
prevent SM and similar behaviour.
Keywords: Selfish mining · Proof-of-Work blockchain · Agent-based
model · Empirical multiplayer game
1 Introduction
With the aim to decrease reliance on financial institutions, blockchain was
designed and used to securely approve and record transactions among Internet
users [11]. A number of blockchain characteristics such as its security, trans-
parency, and decentralised authority have drawn many researchers and develop-
ers to apply blockchain to a wide range of application areas, such as personal
c© Springer Nature Switzerland AG 2019
M. Baldoni et al. (Eds.): PRIMA 2019, LNAI 11873, pp. 219–234, 2019.
https://doi.org/10.1007/978-3-030-33792-6_14
http://crossmark.crossref.org/dialog/?doi=10.1007/978-3-030-33792-6_14&domain=pdf
https://doi.org/10.1007/978-3-030-33792-6_14
220 T. Leelavimolsilp et al.
data management [1,16], Internet of Things [5], and decentralised platform as a
service [14].
The success of blockchain is based on two elements: an application of a cryp-
tographic puzzle, namely Proof-of-Work (PoW), and an economic incentive for
miners, who are the underlying workforce of the system. The mining process
is briefly described as follows. First, a miner composes a block which mainly
consists of locally verified transactions. The block also refers to the latest block
of the miner’s locally stored blockchain as its parent block. The miner then
performs a brute force search for a number that results in a hash value of the
block lower than the globally set target. When such a number (which is a “Proof
of Work” that the miner did) is found, the block together with the number is
broadcasted. Subsequently, a recipient of the block verifies the block’s transac-
tions and the block’s hash value. Once approved, the block is then appended to
the recipient’s locally stored blockchain. Later, the miner claims their mining
reward (which is the aforementioned incentive) by referring to the block in their
spending transaction. As such, every miner is fairly rewarded in proportion to a
number of blocks that they managed to create or an amount of hash rate that
they expended.1
One of the most fundamental and significant attacks against blockchain sys-
tems is forking, which is difficult in practice and widely known as the 51% attack.
Since the mining protocol instructs everyone to trust the longest chain2, a mali-
cious miner simply needs to produce a blockchain longer than the current one.
Once succeeded, part of the current blockchain will be replaced by the mali-
cious miner’s blocks. Consequently, all transactions and the mining reward of
the replaced blocks have been nullified, and the malicious miner earns all mining
reward from their blocks; thus resulting in a disproportionate reward distribu-
tion. However, forking is not easy since it requires at least a half of the total hash
rate in the system [11]. As such, it resulted in a public belief that blockchain
systems are strongly secure as long as no miner possesses more than 50% of the
total hash rate.
Eyal and Sirer later demonstrated that forking is still possible with lower
hash rates using their Selfish Mining (SM) strategy [6]. Essentially, SM hides and
privately mines their own blocks in contrast to publicly forking the blockchain.
Such hiding allows the malicious miner to gain an advantage by removing the
chance of the successive blocks being mined by the others. In addition, SM
gradually discloses their private blocks to keep the advantage as much as possible
to themselves. Most importantly, it requires only 1/3 of the total hash rate to
fork the blockchain and earn a higher mining reward than they should. Such a
hash rate is significantly lower than 1/2 of the total hash rate for publicly forking,
1 To be precise, there are two types of mining reward: namely, block reward and
transaction fee [2]. While there will be no block reward per block in the future,
miners will still be incentivized by the transaction fee to do their mining.
2 In practice, a chain that is the most computationally expensive or has the highest
difficulty sum is chosen [4]. If every block has the same computational difficulty, the
actual verification reduces to selecting the longest blockchain.
Selfish Mining in PoW Blockchain with Multiple Miners 221
and therefore greatly threatens the security of PoW blockchain systems. With
a larger hash rate, SM is even more effective and can fork the blockchain more
frequently. In the worst scenario, the mining economy and the system could
collapse due to the disrupted distribution of the economic incentive.
Moreover, SM can be difficult to detect in practice. While the rate of
orphaned blocks (i.e. blocks that were not part of the longest chain) is a main
indicator of SM activity [8], it can point out a network instability or a high
network delay that causes broadcasted blocks to arrive late or be lost. As such,
the practicality of the detection method based on the orphaned block rate is not
certain.
Despite the threats posed by SM, there are not sufficient investigations in
a more practical context: that is, a case where SM being used individually and
simultaneously by multiple miners. In particular, most research so far focused
on a system with one malicious miner who performs SM and has another who
follows Nakamoto’s mining protocol [6,7,9,12,13,15]. In practice, multiple min-
ers can perform SM at the same time. Whether SM is even more effective in
such situation is not clearly known.
For this reason, we carry out an investigation on SM in the context of mul-
tiple miners. Particularly, we seek to know (a) the effectiveness of SM in such
a context, (b) the minimum hash rate that SM requires to earn mining reward
more than it should, and (c) the minimum hash rate that non-malicious min-
ers require to prevent SM. We also consider strategic miners who choose either
SM or Nakamoto’s mining protocol depending on which gives a higher mining
reward. We believe that such miners better represent the actual miners since
earning mining reward is the main purpose of the mining and a higher reward
would be more preferable.
The rest of this paper is structured as follows. First, a literature review of
existing studies on SM is presented in Sect. 2. We then describe two models of
PoW blockchain systems (where one considers strategic miners and the another
does not) in Sect. 3 and some concepts that are necessary for our work in Sect. 4.
Subsequently, our empirical results for each model are described and discussed in
Sect. 5. We finally conclude this paper with our findings and interesting questions
that remain to be solved in Sect. 6.
2 Related Work
After Eyal and Sirer’s work, there has been further research on improving SM.
To exemplify this, the optimised (two-miners) SM strategy was proposed and
its effectiveness was slightly improved [7,13]. A combination of SM with other
attacks was also designed to increase the effectiveness of the attack [12]. In
general, such improvements further reduce the amount of required hash rate to
successfully employ SM.
A number of studies also shed more light on SM under different contexts. For
example, Göbel et al., who further explored the effect of network delay on the
SM strategy, demonstrated that SM will be more successful if every miner in the
222 T. Leelavimolsilp et al.
SM pool3 helps propagate the hidden block [8]. Kiayias et al. also showed that,
under the game-theoretical setting, every miner will follow Nakamoto’s mining
protocol if no one has greater than 30.8% of the total hash rate [9].
On the contrary, a number of improvements of Nakamoto’s mining protocol
have been suggested, but they are difficult to implement in practice [6,15]. In
particular, the improvements raise the hash rate required for SM to be effective,
but they needs a precise coordination among miners to adopt them at the same
time.
Despite the significant body of work on SM, the idea of multiple miners
individually and simultaneously employing SM has not been fully explored in
the existing literature. In particular, most works so far studied SM or sim-
ilar strategies in a setting with one malicious miner and one non-malicious
miner [6,7,9,12,13,15]. To our knowledge, there is a small-scale study which
was recently conducted in parallel [10]. Compared to their work, our findings
are more robust due to a large number of malicious miners in the system and
a fair treatment of the underlying network in our experiment. Our work also
offers a game-theoretical analysis which is a natural extension when malicious
miners are considered self-interested agents that act strategically to maximise
their mining rewards.
3 Models of the PoW Blockchain Mining
In this section, we formally define two models of PoW blockchain mining where
the difference between them lies in the miner’s capability of choosing a mining
strategy. To clearly observe SM under the effect of different numbers of miners,
assumptions are made as follows:
1. A fully connected network of miners without any communication delay;
2. An equal amount of mining reward per block to the creator of every block in
the blockchain; and
3. The same computational difficulty (the target hash value) for every block in
the blockchain.
While we adopt Assumptions 2 and 3 for the sake of comparing results with
the previous works, Assumption 1 is made to scope our study on the effect
of varying the number of miners in the system. In particular, unlike previous
works on two miners where the network can be easily addressed [6], modelling
miner’s network capabilities in a system of a large number of miners is not
straightforward. Therefore, we assume such a perfect network and focus on the
effect of different numbers of miners in the system.
3 A pool is a group of miners whose mining processes are coordinated such that they
receive their mining rewards more frequently but in a smaller chunk comparing to
solo mining [3].
Selfish Mining in PoW Blockchain with Multiple Miners 223
We consider two mining strategies: Honest Mining (HM) and Selfish Mining
(SM)4. The first is Nakamoto’s mining protocol where a miner always mines and
publishes a new block from the last block of the longest blockchain. On the other
hand, the latter (Algorithm 1) is a strategy that hides its recently created block
to privately mine from it and then strategically publishes its hidden blocks to
overwrite the currently longest chain [6]. That is, whenever SM receives a new
block created by the others, SM also publishes its block with the expectation that
it reaches and get accepted by the rest of the network quicker than the received
block. In addition, SM publishes all hidden blocks to completely overwrite the
other chain whenever possible.
Algorithm 1. Selfish Mining [6]
Initialise:
public chain, private chain ← all publicly known blocks
privateBranchLength ← 0
Mine from the tail block of the private chain
Upon any new block b:
Δ ← length(private chain) - length(public chain)
if b was created by the SM miner then
Append b to private chain
privateBranchLength ← privateBranchLen + 1
if Δ = 0 and privateBranchLen = 2 then
publish all of the private chain
privateBranchLength ← 0
else
Append b to public chain
if Δ = 0 then
private chain ← public chain
privateBranchLength ← 0
else if Δ = 1 then
publish the last block of private chain
else if Δ = 2 then
publish all of the private chain
privateBranchLength ← 0
else
Publish the 1st unpublished block in the private chain
Mine from the tail of the private chain
Subsequently there are three types of miners: Honest miner, Selfish miner,
and Strategic miner. By definition, Honest miner and Selfish miner perform HM
and SM respectively; henceforth HM and SM will also be used to denote them.
In contrast, Strategic miner (StrM) is a miner that performs either HM or SM
4 We do not use the optimised (two-miners) SM [7,13] since it might not be optimal
in our context of multiple miners. The method of obtaining an optimal strategy in
this context is also not yet known and lies outside the scope of this work.
224 T. Leelavimolsilp et al.
depending on which maximises its mining reward. Note that StrM will be referred
only in the second model where we consider miners are capable of choosing their
strategies.
3.1 Fixed Strategy Mining Model
Here, we describe the first model of the PoW blockchain mining process where
every miner employs a fixed mining strategy. Formally, a Markov model of the
fixed strategy mining M = (I, C, P, S,P (·) ,U (·)) is as follows:
– I = {1, 2, ..., N} denotes a set of all miners individually represented by a
positive integer.
– C = (ci|ci ∈ {HM,SM} , i ∈ I) is a list of miner’s mining strategies where the
i-th element is a mining strategy used by the i-th miner in I.
– P =
(
pi|pi ∈ [0, 1] ,
∑
i∈I pi = 1, i ∈ I
)
is a tuple of miner’s mining powers
where the i-th element is the i-th miner’s proportion of the total hash rate.
That is, P is a power allocation of miners in the system.
– S is a set of all states in this Markov model where each element s ∈ S is a
state of the blockchain. The initial state s0 ∈ S is the blockchain with only
one block that is not owned by any miner in I.
– P (·) is a state transition function where its probability mass is P (st+1|st) =
pi, and the next state st+1 is the current state st that includes the new block
created by miner i. In other words, a state transition from st to st+1 represents
a discovery of a new block with respect to miner’s mining powers.
– U (·) is a utility function that computes a proportion of a miner’s blocks in
the longest blockchain:
U (st, i) =
bi∑
i∈I bi
(1)
where bi is the total number of i-th miner’s blocks in the longest chain. Since
this is a stationary Markov model, the i-th miner’s mining reward U (st, i)
will converge given a sufficiently long time t and a state st ∈ S that has
only one longest chain of blocks. That is, there always exists the convergence
time t where ∀t1, t2 ∈ [t,∞) : |U (st1 , i) − U (st2 , i)| ≤ α and α is a negligible
positive real. Note that the converged value will be used throughout our work.
3.2 Dynamic Strategy Mining Model
In contrast to the previous model, the model here considers the malicious miner’s
capability of choosing a mining strategy that maximises their mining reward.
With a game-theoretical analysis, we account for a change of the SM miner’s
strategy in the previous model when they deem it is better off to use HM under
some power allocations.
In particular, we extend the previous model such that every SM miner
becomes a StrM miner who chooses their mining strategy given an informa-
tion of other miners’ strategies and all possible mining rewards that the StrM
Selfish Mining in PoW Blockchain with Multiple Miners 225
miner will receive in each outcome. In particular, an empirical normal-form game
of the PoW mining is denoted by G = (I, C ′, P,A (·) ,U′ (·)) where I and P are
the same as before and the rest are described as follows:
– C ′ = (c′
i|c′
i ∈ {HM,StrM} , i ∈ I) is a list of miner’s types where the i-th
element indicates whether an i-th miner is a HM miner or a StrM miner.
– A (·) is a function that maps a type of miner to a set of permissible strategies.
Given an i-th miner’s type c′
i ∈ C ′, A (·) performs a mapping as follows:
A (c′
i) =
{
{HM,SM} if c′
i = StrM;
{HM} otherwise.
A strategy profile is then denoted as A = (ai|ai ∈ A (c′
i) , c′
i ∈ C ′, i ∈ I) or
A = (ai, a−i) where ai is the i-th miner’s strategy and a−i collectively denotes
the rest.
– U′ : I×A �→ [0, 1] is a payoff function that computes a miner’s mining reward
given A is a set of all possible strategy profiles with respect to I. Given a
strategy profile A ∈ A, the computation of U′ (i, A) is simply done via the
utility function U of the previously described model M where its strategy
list C corresponds to A and other elements of the model are the same.
4 Power Threshold, Safety Level and Equilibrium
As mentioned in Sect. 1, we are interested in (a) the minimum mining power
that enables SM/StrM miners to earn an unfairly large mining reward and (b)
the minimum sum of HM miners’ mining power that can prevent such an unfair
outcome.
In more detail, an unfairly large mining reward in our models is one that
exceeds the miner’s mining power. Originally, a system of all HM miners will
allocate a mining reward equal to their individual mining power (since everyone
mines from the latest block and therefore the expected proportion of any miner’s
blocks is their mining power.) However, a miner with sufficiently high mining
power can use SM and gain a mining reward that is higher than their mining
power. Such an unfairly large reward will be demonstrated in the Sect. 5.
In our discussion, we then look for a power threshold which is the least mining
power that lets a SM/StrM earn its unfairly large reward regardless of how much
mining power the others possess. Consequently, a SM/StrM miner whose mining
power reaches the power threshold will earn a mining reward more than they
should.
Definition 1. Given that P̂ (p) is the set of all possible power allocations where
a SM/StrM miner has mining power p, and Up,P is the mining reward of the
SM/StrM miner with mining power p in a power allocation P , a power thresh-
old β is one that satisfies the following condition:
β = min { p | ∀P ∈ P̂ (p) : Up,P > p ; ∀q ∈ [p, 1] ,∀P ′ ∈ P̂ (q) : Uq,P ′ > q }
226 T. Leelavimolsilp et al.
In other words, for every SM/StrM’s mining power that yields mining reward
larger than their power regardless of the other miner’s power allocation, a power
threshold is the least SM/StrM’s power that also yields such a reward for every
SM/StrM’s power beyond the threshold.
Similarly, we also look for a safety level which is the least mining power of
the HM-miner collective that prevents all SM/StrM from earning their unfairly
large mining rewards. Once the safety level is reached, no SM/StrM miner will
gain a mining reward higher than their mining power.
Definition 2. Given that P̂ (pHM) is the set of all possible power allocations
where the sum of all HM miners’ mining powers is pHM, pi,P is an i-th miner’s
mining power in a power allocation P , and I ′ (P ) is the set of all SM/StrM min-
ers in a power allocation P , a safety level γ is one that satisfies the condition
below:
γ = min { pHM | ∀P ∈ P̂ (pHM ) , ∀i ∈ I ′ (P ) : Ui,P ≤ pi,P ;
∀qHM ∈ [pHM , 1] , ∀P ′ ∈ P̂ (qHM ) , ∀i′ ∈ I ′ (P ′) : Ui′,P ′ ≤ pi′,P ′ }
where Ui,P is a mining reward of the i-th miner with mining power p.
That is, for every mining power of the HM-miner collective that results in all
SM/StrM’s mining rewards no greater than their powers regardless of how much
power an SM/StrM individually can have, a safety level is the collective’s least
power that also yields such SM/StrM’s rewards for every HM-miner collective’s
power beyond the safety level.
In the dynamic strategy mining model (Sect. 3.2), we will retrieve an outcome
of the game prior to an analysis of the safety level and the power threshold. In
particular, we use the concept of pure-strategy ε-equilibrium (ε-PE) to derive the
choice of miners’ strategies that maximises their mining reward. The concept is
also useful to disregard small fluctuations in the payoff value; such a fluctuation
is caused by a stochastic nature of the PoW blockchain mining process and
consequently could lead us to misinterpret the result.
Definition 3. A pure-strategy ε-equilibrium (ε-PE) where ε > 0 is a strategy
profile A∗ = (a∗
i , a−i) that satisfies the following condition:
∀i ∈ I,∀ai ∈ A (c′
i) : U′ (i, A∗) ≥ U′ (i, (ai, a−i)) − ε
In other words, for each and every miner, there is no other mining strategy
that allows them to gain a higher utility than the strategy in the pure-strategy
ε-equilibrium by ε, given that the others’ strategies are fixed.
Finally, an extra assumption where HM is more preferable to SM will be
incorporated in the ε-PE analysis of the result. In Sect. 5, we will show the
existence of multiple equilibria due to a negligible difference in StrM’s mining
reward between HM and SM under the same power allocation. Since there is
neither an incentive nor a proper reason for the StrM to use SM instead of
HM in such cases, we disregard such equilibria with SM by the HM-preference
assumption, which is defined as follows:
Selfish Mining in PoW Blockchain with Multiple Miners 227
Definition 4. Given a pair of ε-equilibria A∗ = (a∗
i , a−i) and A∗∗ = (a∗∗
i , a−i)
where a∗
i 	= a∗∗
i (one i-th miner’s choice is HM and the another is SM) in a model
G, an HM-preferable ε-equilibrium is the equilibrium where the i-th miner’s choice
is HM.
5 Empirical Results and Discussion
To address our research question, we carry out discrete event simulations of
the models such that different numbers of SM/StrM miners and different power
allocations are accounted (Table 1).5 In particular, each element in the Markov
model that was described in Sect. 3 is varied, and a simulation where a state
transition occurs at each timestep is performed. Each simulation setting is also
repeatedly simulated 100 times to compute an average of the converged util-
ity value. In a rare case of non-convergence, we use the value at the 200,000th
timestep, which is analogous to 3–4 years in the Bitcoin system and well approx-
imates the system behaviour compared to the results of others [6,13].
Table 1. Simulation parameters
Parameter Value
α (Eq. 1) 0.0001
ε (Definition 3) 0.0001
Power step for 1, 2, 3 SM/StrM cases 0.01
for 4 SM/StrM case 0.02
for 5, 6, 7 SM/StrM cases 0.04
for 8, 9 SM/StrM cases 0.05
Due to an extremely large number of simulations to cover all settings, we
carry out simulations only for the base parameters and perform a permutation
to cover all necessary results. To exemplify this, we swap the miner’s utility of
the model M1 with C1 = (HM,SM) and P1 = (0.4, 0.6) and use it as a result
of the model M2 where C2 = (SM,HM) and P2 = (0.6, 0.4). We also treat a
collective of HM miners as a single HM miner since their individual earnings are
unnecessary in this work and an overall outcome of their individual minings is
the same as a solo HM mining with their combined mining powers.
5.1 Fixed Strategy Mining
In general, the mining powers of SM and HM that yield an unfairly large mining
reward decreases with the number of SM miners in the system. As shown in
5 Note that modelling the underlying network is not in the scope of this work. Con-
sequently, multiple broadcasted messages that occur in a single timestep will be
processed in a uniformly random manner.
228 T. Leelavimolsilp et al.
Fig. 1(a), the mean of SM’s mining reward among different power allocations
exponentially grows in an increase of SM’s mining power until its convergence
at one. However, the range of SM’s mining power during the exponential growth
gradually decreases with the number of SM miners. A similar trend in the HM’s
mining reward with respect to the HM’s mining power is also observed and
shown in Fig. 1(b).
(a) (b)
Fig. 1. Average of the SM’s mining reward among different power allocations with
specific SM’s mining power (a) and an average of the HM’s mining reward among dif-
ferent power allocations with specific HM’s mining power (b) in a system with different
numbers of SM. Standard error of the mean is shown as an error bar.
As shown by Liu et al. [10], our observation has also revealed a similar under-
lying cause of the trend of HM/SM’s mining reward. Generally, the higher the
number of miners, the less mining power each of them has. With a low mining
power, SM is less likely to create a private chain longer than the other chains and
therefore most of their computational resources are wasted. In turn, a mining
power that HM/SM requires to earn an unfairly large reward becomes less in a
system with a large number of miners.
Surprisingly, a number of SM miners can simultaneously get their unfairly
large rewards under some power allocations. In particular, their mining powers
in such a power allocation are equal and larger than a certain value. However,
the range of such mining powers decreases and shortens as the number of SM
increases, as shown in Fig. 2. We therefore hypothesise that this behaviour does
not exist in a system with an extremely large number of miners.
5.2 Dynamic Strategy Mining
Previously, we have shown that a SM miner with low mining power earns less
than their power. However, they might be able to earn more if they switch back
Selfish Mining in PoW Blockchain with Multiple Miners 229
Fig. 2. Ranges of a mining power of multiple and profitable SM (Multi-SM) with
respect to an increasing number of SM in the system. In such ranges, a number of SM
miners (indicated by the number of Multi-SM) individually have equal mining power
and simultaneously gain an unfairly large mining reward.
to HM instead. Such a switch can induce further strategy switches due to a
change in mining reward. In this section, we use a game-theoretical concept of
equilibria (Sect. 4) to tackle such strategy changes and discuss the outcome.
We first notice multiple equilibria in some specific power allocations and
at least one equilibrium in every power allocation. As shown in Fig. 3(a), the
average number of ε-PE per power allocation is always at least one. However,
it becomes extremely large in power allocations where there is a StrM with a
relatively high mining power.
In a following observation, we see that the large number of ε-PE is caused
by a StrM miner expressing an indifference between HM and SM strategy where
there is another StrM with a considerably large mining power. In such a situation,
there is no significant difference in mining reward between HM and SM used by
a StrM with a low mining power; which results in a moderate amount of StrM’s
SM over all ε-PE as depicted in Fig. 3(c). Consequently, the number of ε-PE
is a combinatorial number of the StrM’s HM/SM with low mining power and
therefore grows in an increase of the number of StrM in the system, as shown in
Fig. 3(a).
With the HM-preference assumption, a reasonable choice of StrM’s strategy
in ε-PE is obtained. In particular, StrM will no longer choose SM if there is
no significant difference between HM’s and SM’s mining reward. The change of
strategy in ε-PE is clearly demonstrated by a comparatively low number of ε-PE
per power allocation in Fig. 3(b) and no SM strategy chosen by a StrM with
mining power under 0.3 in Fig. 3(d).
Clearly, StrM prefers SM to HM and starts earning an unfairly large mining
reward as their mining power increases. These are confirmed in Figs. 3(d) and
4(a). That is, StrM starts to choose SM once their mining power exceeds one-
fourth. Once StrM possesses at least half of the total mining power, they always
choose SM to reap the whole mining reward from the system.
Interestingly, the more StrM in the system, the more their mining strategy
and their mining reward become similar to the case of one StrM. As demon-
strated in Fig. 3(d), when the number of StrM miners increases, the transition
of the StrM’s strategy from HM to SM gradually becomes sharper similarly to
230 T. Leelavimolsilp et al.
(a) (b)
(c) (d)
Fig. 3. Average number of ε-PE per power allocation (a, b) and an overall StrM’s
strategy in ε-PE (c, d) with different number of StrM in the system. Left figures (a,
c) are results not under the HM-preference assumption, while right figures (b, d) are
results under the HM-preference assumption.
the case of single StrM. Likewise, Fig. 4(a) shows a convergence of the mining
reward of StrM with a mining power lower than 1/2 to one of the case of one
StrM.
In contrast, HM’s mining reward does not converge to one in the case of
single StrM. Instead, it converges to their mining power as the number of StrM
increases. This is shown in Fig. 4(b), where the HM’s mining reward with a
mining power under 0.67 asymptotically approaches their power as the number
of StrM increases.
Even with the HM-preference assumption, there still are multiple ε-PE for
some power allocations. Such multiple equilibria are shown in Fig. 3(b) where an
average number of ε-PE per power allocation is more than one for any StrM’s
mining power below 0.36. We find that multiple StrM with the same mining
power larger than 0.3 together choose either HM or SM in such ε-PE. Since an
Selfish Mining in PoW Blockchain with Multiple Miners 231
(a) (b)
Fig. 4. Average of the StrM’s mining reward among different ε-PE with specific StrM’s
mining power (a) and average of the HM’s mining reward among different ε-PE with
specific HM’s mining power (b) in a system with different numbers of StrM. Standard
error of the mean is shown as an error bar.
individual deviation from HM to SM or vice versa yields a comparatively low
mining reward, multiple ε-PE with such StrM together choosing either HM or
SM are formed.
On further inspection, an ε-PE where multiple StrM choose SM becomes
less likely to occur as the number of StrM increases. Compared to the fixed
strategy model’s, a range of such StrM’s mining power in this model is even
less. As shown in Fig. 5, the mining-power range of multiple StrM that possess
nearly equal power and together choose SM in ε-PE shortens in an increase of
the number of StrM. Therefore, it is clear that this behaviour is highly unlikely
to occur in the presence of a large number of StrM.
Fig. 5. Ranges of a mining power of multiple and profitable SM (Multi-SM) with
respect to an increasing number of StrM in the system. In such ranges, a number of
StrM miners (indicated by the number of Multi-SM) individually have equal mining
power and simultaneously gain an unfairly large mining reward.
232 T. Leelavimolsilp et al.
5.3 Safety Level and Power Threshold
As shown in Fig. 6, a safety level against SM/StrM monotonically decreases as a
number of SM/StrM grows. Since a mining power that one miner possesses will
decrease in an increasing number of miners in the system, multiple SM/StrM
with a low mining power will become prominent. Such SM/StrM are unable to
frequently create a private chain longer than the others (Sect. 5.1) and conse-
quently choose HM to maximise their rewards (Sect. 5.2). As a result, the total
mining power of miners performing HM increases, and the HM miner requires
less mining power to prevent SM/StrM.
Fig. 6. Power thresholds and safety levels with respect to different numbers of
SM/StrM in the system. No difference of a safety level between one with the HM-
preference assumption and one without the assumption is found.
Moreover, the safety level is upper bounded by the case of one SM/StrM;
that is, it is no greater than 2/3. Intuitively, the case of one SM/StrM is the most
difficult to prevent since it is a coalition of all SM/StrM miners combining their
mining power and working together against HM miners. The safety level in this
case is therefore the greatest one.
Similarly, a power threshold of SM/StrM decreases in an increasing number
of SM/StrM after the case of single SM/StrM in the system. Due to SM with a
low mining power constantly wasting their effort, the amount of mining power
which is required to secretly build the longest chain becomes less in turn.
However, the power threshold of StrM is strictly lower bounded at 1/3. A
similar rationale can be applied here: HM with a mining power of 2/3 is the most
difficult for SM and therefore a mining power of 1/3 is at least required. On the
contrary, a StrM with a mining power lower than 1/3 will always choose HM, as
shown in Fig. 3(d).
Clearly an upper bound of the power threshold of SM/StrM is 1/2, which
corresponds to Nakamoto’s analysis [11]. Any mining power beyond the threshold
always allows SM/StrM to successfully create the longest chain.
Selfish Mining in PoW Blockchain with Multiple Miners 233
6 Conclusions and Future Work
In this work, an empirical investigation of the Selfish Mining (SM) strategy
employed by multiple malicious miners has been carried out. We separately con-
sidered two types of malicious miners where one (SM miner) always follow SM
and the another (StrM miner) chooses to follow either Nakamoto’s mining pro-
tocol or the SM strategy depending on which maximises its mining reward. Since
our work accounted for a large number of malicious miners in the system, our
findings (such as the case of multiple miners simultaneously and individually
performing SM) are more practical than the other’s so far.
The effectiveness of SM strategy varies when different types and different
numbers of malicious miners are considered. In general, SM is more effective in
the presence of a large number of SM miners than one in StrM miners since it
can reap a larger amount of mining reward with the same hash-rate proportion.
However, SM in a system with a low number of StrM miners is less effective
than one in SM miners since it yields a smaller mining reward with the same
hash-rate proportion.
Regardless of the type and the number of miners in the system, the least
hash-rate proportion to perform and to prevent SM are no greater than 1/2
and 2/3 respectively. Additionally, both proportions monotonically decrease in
an increasing number of malicious miners in the system. If only StrM miners are
considered, then the least hash-rate proportion required for SM is strictly 1/3.
However, such a proportion reduces further than 1/3 (as originally reported by
Eyal and Sirer [6]) if SM miners are considered.
Despite the aforementioned, our result suggests that PoW blockchain systems
are required to have a large number of miners to be more secure against SM. Since
blockchain miners work for their mining reward, they are utility-maximising
agents or StrM miners in our model. As shown in Sect. 5.2, SM is comparably
less chosen in a presence of a large number of StrM miners. Together with the
decreasing hash-rate proportion required for preventing SM, it can be concluded
that a large number of miners can prevent SM and similar malicious mining
strategies.
A number of interesting questions still remain to be investigated. As pointed
out by Eyal and Sirer [6], a network capability of SM miners is also an important
factor that affects the effectiveness of SM. This aspect will be taken into account
in our future work. Moreover, an optimal SM strategy in the context of multiple
miners, similar to that in the work of Sapirshtein et al. [13], is not yet known.
With the optimal strategy, it remains to be seen whether our findings are still
valid.
Acknowledgement. The authors gratefully acknowledge financial support from the
EPSRC Doctoral Training Partnership, and the use of IRIDIS High Performance Com-
puting Facility at the University of Southampton. We also would like to express our
gratitude to all anonymous reviewers for their insightful comments.
234 T. Leelavimolsilp et al.
References
1. Azaria, A., Ekblaw, A., Vieira, T., Lippman, A.: MedRec: using blockchain for
medical data access and permission management. In: 2016 2nd International Con-
ference on Open and Big Data, pp. 25–30 (2016)
2. Bitcoin Wiki: Mining (2018). https://en.bitcoin.it/wiki/Mining. Accessed 1 July
2019
3. Bitcoin Wiki: Pooled mining (2018). https://en.bitcoin.it/wiki/Pooled mining.
Accessed 14 June 2019
4. Bitcoin Wiki: Block (2019). https://en.bitcoin.it/wiki/Block. Accessed 13 June
2019
5. Christidis, K., Devetsikiotis, M.: Blockchains and smart contracts for the internet
of things. IEEE Access 4, 2292–2303 (2016)
6. Eyal, I., Sirer, E.G.: Majority is not enough: bitcoin mining is vulnerable. In:
Christin, N., Safavi-Naini, R. (eds.) FC 2014. LNCS, vol. 8437, pp. 436–454.
Springer, Heidelberg (2014). https://doi.org/10.1007/978-3-662-45472-5 28
7. Gervais, A., Karame, G.O., Wüst, K., Glykantzis, V., Ritzdorf, H., Capkun, S.:
On the security and performance of proof of work blockchains. In: Proceedings of
the 2016 ACM SIGSAC Conference on Computer and Communications Security,
CCS 2016, pp. 3–16. ACM, New York (2016)
8. Göbel, J., Keeler, H.P., Krzesinski, A.E., Taylor, P.G.: Bitcoin blockchain dynam-
ics: the selfish-mine strategy in the presence of propagation delay. Perform. Eval.
104, 23–41 (2016)
9. Kiayias, A., Koutsoupias, E., Kyropoulou, M., Tselekounis, Y.: Blockchain mining
games. In: Conitzer, V., Bergemann, D., Chen, Y. (eds.) Proceedings of the 2016
ACM Conference on Economics and Computation, EC 2016, pp. 365–382. ACM
Press, New York (2016)
10. Liu, H., Ruan, N., Du, R., Jia, W.: On the strategy and behavior of bitcoin mining
with n-attackers. In: Proceedings of the 2018 on Asia Conference on Computer and
Communications Security, ASIACCS 2018, pp. 357–368. ACM, New York (2018)
11. Nakamoto, S.: Bitcoin: a peer-to-peer electronic cash system (2008). https://
bitcoin.org/en/bitcoin-paper. Accessed 28 Nov 2015
12. Nayak, K., Kumar, S., Miller, A., Shi, E.: Stubborn mining: generalizing selfish
mining and combining with an eclipse attack. In: 2016 IEEE European Symposium
on Security and Privacy, pp. 305–320. IEEE Press, Los Alamitos (2016)
13. Sapirshtein, A., Sompolinsky, Y., Zohar, A.: Optimal selfish mining strategies in
bitcoin. In: Grossklags, J., Preneel, B. (eds.) FC 2016. LNCS, vol. 9603, pp. 515–
532. Springer, Heidelberg (2017). https://doi.org/10.1007/978-3-662-54970-4 30
14. Wood, G.: Ethereum: a secure decentralised generalised transaction ledger.
Ethereum Project Yellow Paper 151, 1–32 (2014)
15. Zhang, R., Preneel, B.: Publish or perish: a backward-compatible defense against
selfish mining in bitcoin. In: Handschuh, H. (ed.) CT-RSA 2017. LNCS, vol. 10159,
pp. 277–292. Springer, Cham (2017). https://doi.org/10.1007/978-3-319-52153-
4 16
16. Zyskind, G., Nathan, O., Pentland, A.: Decentralizing privacy: using blockchain to
protect personal data. In: 2015 IEEE Security and Privacy Workshops, pp. 180–184
(2015)
https://en.bitcoin.it/wiki/Mining
https://en.bitcoin.it/wiki/Pooled_mining
https://en.bitcoin.it/wiki/Block
https://doi.org/10.1007/978-3-662-45472-5_28
https://bitcoin.org/en/bitcoin-paper
https://bitcoin.org/en/bitcoin-paper
https://doi.org/10.1007/978-3-662-54970-4_30
https://doi.org/10.1007/978-3-319-52153-4_16
https://doi.org/10.1007/978-3-319-52153-4_16
	Selfish Mining in Proof-of-Work Blockchain with Multiple Miners: An Empirical Evaluation
	1 Introduction
	2 Related Work
	3 Models of the PoW Blockchain Mining
	3.1 Fixed Strategy Mining Model
	3.2 Dynamic Strategy Mining Model
	4 Power Threshold, Safety Level and Equilibrium
	5 Empirical Results and Discussion
	5.1 Fixed Strategy Mining
	5.2 Dynamic Strategy Mining
	5.3 Safety Level and Power Threshold
	6 Conclusions and Future Work
	References