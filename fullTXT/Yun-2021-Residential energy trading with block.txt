Residential energy trading with blockchain technology
Vol.:(0123456789)
Energy Systems (2021) 12:619–636
https://doi.org/10.1007/s12667-021-00426-y
1 3
ORIGINAL PAPER
Residential energy trading with blockchain technology
Guanxiang Yun1 · Viacheslav Zhygulin1  · Qipeng P. Zheng1
Received: 23 July 2020 / Accepted: 1 February 2021 / Published online: 25 February 2021 
© The Author(s), under exclusive licence to Springer-Verlag GmbH, DE part of Springer Nature 2021
Abstract
Blockchain technology is a peer-to-peer value transfer technology that guarantees 
the safety and correctness of transactions between parties who do not trust each 
other without a universally trusted entity. Because of this characteristic, we study 
possible integration of blockchain technology with a local neighborhood power grid, 
to design a truly decentralized energy trading market. The proposed design allows 
energy producers within the local power networks to safely transact with neighbor-
hood households. In other words, the users who have a redundant amount of power 
can sell it to users who need power at a fairer price, than is offered by a utility com-
pany. We show that such local trades provide benefits to both electricity buyers and 
sellers. This paper does two things: (1) establishes a mathematical game theory 
model for the users’ decision to buy or sell power in the peer-to-peer energy mar-
ket and (2) discuss blockchain software stack for deploying such a system. For the 
first part, we use a smart algorithm built upon KKT conditions to solve the multi-
level game theory model. Secondly, we show how the electricity price offered by 
the central company is influenced by the introduction of the blockchain to the power 
transaction system. As supporting evidence we provide experimental data—the sim-
ulation of the market and its infrastructure using blockchain Hyperledger’s Fabric 
framework. Finally, we found that the electricity price can decrease dramatically 
by allowing peer-to-peer transactions among prosumers and consumers unless the 
amount of generating power from prosumers is much lower than their demand. We 
foresee a great future for the applications of blockchain technology in this area with 
the increasing mass adoption of solar and renewable generation at the consumer 
level. However, these processes will enact more discussions on power delivery grid 
ownership and its public access, usage, and management.
Keywords Blockchain · Prosumer · Power transaction · Game theory · Hyperledger · 
Energy trading
 * Viacheslav Zhygulin 
 viacheslav.zhygulin@knights.ucf.edu
Extended author information available on the last page of the article
http://orcid.org/0000-0001-6921-2763
http://crossmark.crossref.org/dialog/?doi=10.1007/s12667-021-00426-y&domain=pdf
620 G. Yun et al.
1 3
List of symbols
A. Sets and indices for the Equilibrium model
e  Central energy (or utility) company
I  Set of users indexed by i
T  Set of consequent time periods indexed by t
B. Parameters
pe  Electricity unit’s selling price for the central energy company at time t
c  Electricity unit’s generation cost for central energy company
UBp  Maximum electricity selling price, which is enacted by the government
pi  Electricity unit’s selling price for user i
Git  Power generated by user i at time t
Dit  Power demand for user i at time t
�ij  Power transmission rate from user j to user i. 1 − �ij is a power loss rate dur-
ing transmission.
CBi  Capacity of the battery of user i
b
′
jit
  Amount of electricity bought by user j from user i at time t in an equilibrium 
point
C. Variables
biet  Amount of electricity user i bought from utility company at time t
bijt  Amount of electricity user i bought from user j at time t
rit  Remaining amount of electricity of user i at time t
wit  Released amount of electricity by user i at time t
s∗
it
  The amount of electricity which user i is willing to sell at time t
b
′′
iet
  Amount of electricity user i bought from central company at time t in a model 
(TL)
b
′′
ijt
  Amount of electricity user i bought from user j at time t in a model (TL)
r
′′
it
  Remaining amount of electricity of user i at time t in model (TL)
w
′′
it
  Released amount of electricity by user i at time t in model (TL)
1 Introduction
With the development of solar energy generating technologies more and more 
consumers of electricity have and will become power prosumers [1]. We define a 
prosumer as a grid user who is also able to generate power for themselves to use. 
Some prosumers could generate excess power which they can not fully used, hence, 
must be released or sold to the utility company at the price favorable to the util-
ity company. To reduce this inefficiency we develop an idea to apply a blockchain 
in the design of a peer-to-peer market, which will allow prosumers to sell redun-
dant power to other users at a fair market price. In this paper, we show that the pro-
posed technique is more efficient than just releasing excess electricity or selling it 
to a utility company at a discounted rate. However, the main obstacle to developing 
621
1 3
Residential energy trading with blockchain technology  
such a market is that for two users in the network who do not know each other it 
is almost impossible to establish trust relationships which will allow them to make 
transactions. Hence, currently, such systems utilize a central agency that is trusted 
by users. Apparently, as an intermediary, this agency is charging high fees for pro-
viding its services. That is where blockchain comes into play. In this paper, we pro-
pose a blockchain-based market infrastructure for secure power-to-money exchange 
between prosumers without the central authority. Moreover, we propose and solve 
the optimization problem which defines users’ decision strategies. We study a per-
fect information game theory model, which users are maximizing their profits in 
provided settings. After that, we analyze necessary changes to utility company’s 
electricity pricing decisions induced by the introduction of the peer-to-peer transac-
tion mechanism among prosumers and customers.
Blockchain technology [2–4] is what makes cryptocurrencies such as Bitcoin and 
Ethereum possible. It has also been widely used recently beyond simple currency 
use cases. One of the most useful aspects of blockchain is that its users can safely 
and transparently transact directly without any central authority. No one can cheat 
the system unless bearing extremely high costs while trying to break it, subject to 
individual blockchain protocol design. Hence, the security of the system is guaran-
teed by the fact that any attempt to break the system is economically inefficient. In 
addition, blockchain can solve personal data and privacy issues [5].
Blockchain technology allows the implementation of an uncontrolled censorship-
resistant energy marketplace, which is widely discussed in the literature [6–8]. The 
introduction of such a marketplace has two main advantages. First, the open elec-
tricity market will drive the energy price down due to a more efficient transaction 
cost structure and elimination of expensive long-range energy delivery systems [9]. 
Second, it will motivate prosumers to generate more renewable energy, since this 
system allows efficient monetization of surplus energy, more efficiently than just 
releasing it or selling to the utility company at a discounted price. Therefore with 
the possibility of transactions happening directly between prosumers and consum-
ers, the power utility company should deal with competition, and its price should 
be adapted in accordance to the prosumers’ selling price, which is apparently lower 
than the company’s price.
This paper also studies how exactly the power company’s pricing strategy is influ-
enced by introduction of peer-to-peer transacting between grid users. Clearly, the power 
utility company’s strategy is to set their selling price to maximize their profit. Obvi-
ously, if they set the price too high, users will buy the power from other users who 
have redundant power. Setting the price too low will result in low profits. Logically, the 
company should have a pricing strategy based on the data about the amount of electric-
ity generated by the prosumers, their prices, and the amount of electricity demanded by 
households. In addition, the feedback loop created caused by a decrease in utility com-
pany price, which has an influence back to the prosumer’s buying and selling behavior. 
Hence, a complex model is needed here. We provide an extensive mathematical model 
to predict a fair market price. The game theory model was previously used by some 
researchers in the power transaction system [10–13], but, to the best of our knowledge, 
they did not study it on a per-transaction basis. We assume agents’ perfect rationality, 
which means that each prosumer will perform in a way to maximize their own profit 
622 G. Yun et al.
1 3
and each customer is minimizing his costs. Further, we propose an agent-based sim-
ulation close to the real-world settings with imperfect information, which studies the 
dynamics of the market. Finally, we compare our two models with the status quo.
2  Game theory model
In this section, we propose a multi-level game-theoretic model of the system based on 
[14, 15]. We derived a three-level optimization model: the first level optimizes revenue 
for the central company, the second level is the model for each individual prosumers’ 
actual buying and selling behavior in the system, the third level is the game theory 
model for each individual users’ ideal strategy.
We have the following assumptions: 
1. The utility’s company selling price pe is a constant in the dynamic math model 
while the time progresses in the model. The objective is to derive such a value of 
pe which maximizes the utility’s company revenue.
2. Similarly, the selling price for each user is a constant value while time progresses 
in the model. We assume that orders can be fulfilled if there is enough demand, 
which can be different for different time periods.
3. All prosumers have batteries.
4. Finally, we assume perfect rationality, each prosumer’s buying and selling behav-
ior will maximize their own profits and/or minimize costs. 
Model (FL) is the first level optimization model to maximize the central company’s 
profits. However, we will also need to consider the minimization problem with the 
same constraints, because the behavior of user biet is not controlled by the central com-
pany, since users just follow their own strategies in the model (1b). The detailed dis-
cussion about this is provided in the model ( SLi ). Constraints (1b) are defined on the 
second level. 
(1a)
(FL):
max
biet
∕min
biet
∑
t
(
pe − c
)
∗
(
∑
i
biet
)
(1b)s.t.
(
SLi
)
, ∀ i
(2a)
(SLi) ∶
max
biet ,bijt
∑
t
pi ∗
(
∑
j
b
�
jit
)
−
∑
t
pj ∗
(
∑
j
bijt
)
−
∑
t
pe ∗ biet
(2b)s.t. Git − Dit + biet +
∑
j
�ij ∗ bijt −
∑
j
b
�
jit
+ ri,t−1 − wit = rit,∀t
623
1 3
Residential energy trading with blockchain technology  
Model ( SLi ) is the game theory model of each prosumer in the system. bijt is a 
variable that user i can control. However, b′
jit
 is the amount determined by user j, it is 
the relative value of bjit of the equilibrium for user j. In this model ( SLi ) it is used as 
a parameter, but not as decision variable.
Constraint (2b) is the balanced equation for user i. The amount of energy left for 
the user i at time t is determined by the amount of energy generated by himself, the 
amount bought from the power company, the amount bought from other users, and 
the remaining amount from the previous time period. The amount of energy actually 
used consists of the demand amount of user i, the amount sold to other users, and an 
amount released. The released amount can be positive only if the energy left for user 
i at time t exceeds the capacity of his battery, otherwise it is 0.
Constraint (2c) imposes the limitation on the amount that user i can buy from 
user j at time t, which is the amount user j want to sell minus the amount other users 
buy from user j. Here i− stands for the other users in the system except for the user i. 
s∗
jt
 is the amount of electricity the user j wants to sell at time t. We can get it from the 
third level model. But this value will also depend on the equilibrium values of the 
model ( SLi ). In that model, the chances that any user can successfully buy the 
amount they need from the user j are equal for any user willing to buy, there is no 
specific order for users. For example, if there are just three users i, j, k in the system, 
and user j want to sell 10 units of electricity at time t, but user i want to buy 8 and 
user k want to buy 7 at time t, then the final value of the equilibrium for the variable 
bijt and bkjt can be any values given that bijt + bkjt = 10 . However, in the real world, 
the values should be bijt = 8, bkjt = 2 or bijt = 3, bkjt = 7 only. This is caused by 
transaction atomicity, or the winner-takes-all approach, and it depends on the reac-
tion time of user i and user k. We will show in theorem (2) that the person with a fast 
reaction can buy the full amount he wants to buy provided by the result of the model. 
The final equilibrium value for bijt must fulfill the first L fast reaction users whole 
buying amounts. Then the remaining amount can be bought by the (L + 1)− th fast 
reaction user, partially fulfilling his demand.
Without the priority of different users’ reaction times, it will result in an uncer-
tainty set for the user’s behaviors in the equilibrium condition. And different behav-
iors in those uncertainty sets will lead to different profits for users and the central 
company. 
(2c)bijt ≤ s∗
jt
−
∑
i−
b
�
i−jt
,∀j, t
(2d)biet ≥ 0, bijt ≥ 0, 0 ≤ rit ≤ CBi,wit ≥ 0,∀j, t
(3a)
(
TLi
)
∶
s∗
it
= argmaxsit ,b
��
ijt
,b
��
iet
sit −
∑
t
pj ⋅
(
∑
j
b
��
ijt
)
−
∑
t
pe ⋅ b
��
iet
624 G. Yun et al.
1 3
Model ( TLi ) is the Nash Equilibrium model for computing the expected electric-
ity amount sold by each user. The mechanics are as follows. At time t user i will post 
limit order to sell s∗
it
 amount of electricity. However, it is possible that order will not 
be fully executed, so the real amount sold will depend on the amount bought by 
other users. The real amount sold in the model is SLi , and it is equal to 
∑
j bjit . Here 
the variables b′′
ijt
 , b′′
iet
 are artificial variables that help to derive s∗
it
 , and does not nec-
essarily represent the real transaction amount.
2.1  Theorem
Theorem 1 When all of the erosion coefficients equal to 1 for any i, j, or �ij = 1 , the 
energy price of the central power company should be set to match one of the pro-
sumer’s selling price or the upper bound of their price UBp to maximize their profit.
Here UBp is defined at the beginning of the article, it is the maximum selling price of 
the central company bounded by the government regulations.
Proof Without loss of generality, we can assume the selling price of prosumer 1 to n 
in the system is in a non-decreasing sequence, p1 ≤ p2 ≤ p3 ≤ ⋯ pn−1 ≤ pn ≤ UBp.
Let assume that pe is not equal to any of the users’ prices. Then, we must have 
pe be located between pi and pi+1 or between pn and UBp , where i must be one of 
1, 2,⋯ n − 1 . It also means pi < pe < pi+1 or pn < pe < UBp . We let � = pi+1 − pe or 
� = UBp − pe.
From the assumption 𝛿 > 0 , we can always find a 0 < 𝛿1 < 𝛿 , and let 
p
�
e
= pi+1 − �1 or p�
e
= UBp − �1 . Then we have p′
e
> pe . From the model SLi and 
TLi , we can conclude that if pe is the price to maximize the central company’s profit, 
then the current value of the decision variables biet must also be the solution if we 
change pe to p′
e
 . The reason is if biet > 0 then the user i can not find any other pro-
sumers to sell power at time t with price lower than pe . Then by the definition of 
p
′
e
 , this user also can not find any other prosumers to sell power at time t with price 
lower than p′
e
 . Hence, the value of the decision variable biet will remain the same 
after the change of the central company’s price.
Now we can conclude that 
∑
t(pe − c) ∗ (
∑
i biet) <
∑
t(p
�
e
− c) ∗ (
∑
i biet) . It is 
contradicting the assumption that pe is a price to maximize the company’s profit.  
 ◻
(3b)s.t. Git − Dit + b
��
iet
+
∑
j
�ij ⋅ b
��
ijt
− s∗
it
+ r
��
i,t−1
− w
��
it
= r
��
it
, ∀t
(3c)b
��
ijt
≤ sjt −
∑
i−
b
�
i−jt
, ∀j, t
(3d)b
��
iet
≥ 0, b
��
ijt
≥ 0, s∗
it
≥ 0, 0 ≤ r
��
it
≤ CBi,w
��
it
≥ 0, ∀j, t
625
1 3
Residential energy trading with blockchain technology  
From theorem  1, we know the utility company only needs to consider prices 
that are equal to the prosumer’s price or UBp given that there was no power loss of 
transaction between prosumers. In the real case, the power loss of transmissions is 
also very small. Therefore, we just need to consider the discrete pricing strategy, 
the solution derived from it will be accurately representing the solution to the real 
problem
Theorem 2 If the model SLi does not have any two prosumers with the same selling 
price, the solution s∗
jt
> 0 , and among bijt , if it has l of them is greater than 0 with 
l ≥ 1 . Then it has at least l − 1 prosumers such that l prosumers will not buy any 
power from other prosumers except j or the central company. If l = 1 , we denote this 
user as user k, then the model will have the result {bkj−t = 0, ∀j− ≠ j} and bket = 0 
except bkjt = s∗
jt
It means that in the model when a user makes a decision to buy power from user 
j, it will buy the electricity on the market until he fills his demand fully.
Proof If l = 1 , by contradiction, it must have a solution like bkjt > 0, bkj1t > 0 and 
bkjt < s∗
jt
, bkj1t < s∗
j1t
 . Without loss of generality, we have pj∕𝜖kj < pj1∕𝜖kj1 . We can 
find a small enough � to let b1
kjt
= bkjt + 𝜖kj1𝛿 > 0 and b1
kj1t
= bkj1t − 𝜖kj𝛿 > 0 . Both 
these two new variables are also feasible to model ( SLi ). Because the constraints 
(2b), (2c)and constraints (2d) will still keep their feasibility. But with this modifica-
tion, the objective function value is increased. Hence, it contradicts the assumption 
that bkjt > 0, bkj1t > 0 are the game theory model solutions.
For the case l > 1 , the proof is similar. By contradiction, if it has more than 2 
prosumers buying electricity from some other users except j, then, we just apply the 
same logic as in case l = 1 to these two users and get the contradiction.   ◻
3  Algorithm
In model (FL) the constraints defined in the model ( SLi ) also must be met. In the 
model ( SLi ) variables are derived from the model ( TLi ). However, we can not solve 
these three models separately, because all of these models are game theory mod-
els, users’ decisions also influence the decisions of each other. As we know, we can 
use the KKT condition method for model (SLi) and model ( TLi ). The KKT model is 
shown as follows. 
(4a)
(
FL − KKTSLi,TLi
)
∶
max ∕min
∑
t
(
pe − c
)
∗
(
∑
i
biet
)
626 G. Yun et al.
1 3
Where �it and �′′
it
 are the KKT multiplier for equation constraints (2b) and 
(3b), which are free variables. �it and �′′
it
 are the KKT multiplier for non-equa-
tion constraints (2c,2d) and (3c,3d), are non-negative variables. git and g′′
it
 are 
(4b)
s.t.
(
SLi − PF1
)
∶ Git − Dit + biet +
∑
j
�ij ∗ bijt −
∑
j
bjit + ri,t−1 − wit = rit, ∀i, t
(4c)
(
SLi − PF2
)
∶ bijt ≤ s∗
jt
−
∑
i−
bi−jt, ∀i, j, t
(4d)
(
SLi − PF3
)
∶ biet ≥ 0, bijt ≥ 0, 0 ≤ rit ≤ CBi,wit ≥ 0, ∀i, j, t
(4e)
(
SLi − DF
)
∶ ▽i
[
∑
t
pi ∗
(
∑
j
b
�
jit
)
−
∑
t
pj ∗
(
∑
j
bijt
)
−
∑
t
pe ∗ biet + �it
∗
(
Git − Dit + biet +
∑
j
�ij ∗ bijt −
∑
j
bjit + ri,t−1 − wit − rit
)
+�it ∗ git
]
= 0, ∀i, j, t
(4f)
(
SLi − CS
)
∶ �it ∗ git = 0, ∀i, t
(4g)
(
TLi − PF1
)
∶ Git − Dit + b
��
iet
+
∑
j
�ij ∗ b
��
ijt
− s∗
it
+ r
��
i,t−1
− w
��
it
= r
��
it
, ∀i, t
(4h)
(
TLi − PF2
)
∶ b
��
ijt
≤ s∗
jt
−
∑
i−
b
�
i−jt
, ∀i, j, t
(4i)
(
TLi − PF3
)
∶ b
��
iet
≥ 0, b
��
ijt
≥ 0, s∗
it
≥ 0, 0 ≤ r
��
it
≤ CBi,w
��
it
≥ 0, ∀i, j, t
(4j)
(
TLi − DF
)
∶ ▽i
[
s∗
it
−
∑
t
pj ∗
(
∑
j
b
��
ijt
)
−
∑
t
pe ∗ b
��
iet
+ �
��
it
∗ (Git − Dit + b
��
iet
+
∑
j
�ij ∗ b
��
ijt
− s∗
it
+ r
��
i,t−1
− w
��
it
− r
��
it
)
+�
��
it
∗ g
��
it
]
= 0, ∀i, j, t
(4k)
(
TLi − CS
)
∶ �
��
it
∗ g
��
it
= 0, ∀i, t
(4l)�it,�
��
it
≥ 0, ∀i, t
627
1 3
Residential energy trading with blockchain technology  
the corresponding inequalities as git ≤ 0 and g′′
it
≤ 0 . The detailed formulation is 
omitted here.
4  Blockchain implementation
In this section we describe the high level software stack needed for implementation 
of a blockchain peer-to-peer energy trading system. In general, this system can be 
divided into 4 subsystems or layers (Fig. 1): 
1. Order discovery and matching layer. Single or multiple servers where users 
advertise their intent to buy or sell electricity.
2. Trade clearance layer. When an order is matched, it should be confirmed by both 
transacting parties, and confirmation must be recorded on the ledger. This is done 
on the clearance layer, which is designed to guarantee the safety, legitimacy, and 
finality of transactions.
3. Energy delivery layer. A combination of software and hardware that guarantees 
the physical delivery of energy in accordance to transactions finalized on the 
previous layer.
4. Money settlement layer. The system ensures safe and legitimate money transfers 
in accordance with cleared transactions.
4.1  General approach
There are many examples of systems implementing peer-to-peer transactions 
between prosumers in energy grids. Some of them are centralized [16] and already 
running, others are distributed systems [17–19]. In centralized cases, the company 
controlling the system hosts and provides functionality for all four aforementioned 
marketplace aspects. In distributed cases, mostly, projects focused on building layers 
2 and 4 with the help of blockchain technology.
Our contribution to the system design is to suggest layer 1 implementation based 
on ideas of 0x protocol [20], whereas layer 2 is implemented using blockchain 
Fig. 1  Peer-to-peer energy marketplace structure
628 G. Yun et al.
1 3
technology (Fig. 2). General transaction flow is the following. A user decides to sell 
or buy energy, he must complete a transaction proposal with information about him-
self (public address), how much he wants to transact, and the price. This proposal 
is signed with the user’s private key and published on one or multiple order dis-
covery servers. After that, if there is a user who is willing to match this order, he 
should complete a proposal with his public address and sign it again with his private 
key. When all necessary information is collected and both signatures are present, 
the proposal is submitted to the blockchain layer 2 (usually it is done by the market 
taker), and the blockchain performs transaction clearance. In addition, Layer 4 can 
be implemented using one of the well-studied cryptocurrency protocols, integrated 
with layer 2, however, it is not completely necessary. The decision about the integra-
tion of cryptocurrency into the system depends on the architecture of layer 2.
We acknowledge that the problem of building layer 3 in a distributed system 
is the least developed, the most challenging, and a show-stopper for peer-to-peer 
energy marketplaces. In our point of view, two main obstacles in building studied 
distributed systems are: 
1. Ensuring correctness of data submitted to the marketplace by power meters. The 
solution to this problem involves solving the so-called “blockchain oracles prob-
lem”, which is not deployment-ready technology. However, much research and 
experiments are ongoing in this direction.
2. Maintaining a balance of demand and supply in the grid. The solution to this 
problem that is developed in a distributed manner can introduce a number of other 
types of transactions to layer 2.
Fig. 2  Simple 0x-like protocol for order discovery and clearance on layer 2. Order cancellation and par-
tial fills are not displayed here
629
1 3
Residential energy trading with blockchain technology  
We leave the discussion of the potential architecture of energy delivery in a distrib-
uted peer-to-peer energy marketplace to further research.
5  Agent based simulation setups
For the agent-based simulation described in this paper, we build the marketplace 
model on the blockchain using Hyperledger’s Fabric framework. Further in this sec-
tion, we describe the structure of the experiment (Fig. 3).
On the networking level, the system contains a single channel [21]. This channel 
has an ordering service [22], which is responsible for adding new blocks. It consists 
of a single orderer node. Peers [23] are connected to the ordering service. Through 
this connection, they broadcast transactions and download ledger updates. The net-
work has a single organization [24] within the channel, but it has three peers hosted 
on three different computers. Each machine has its own client software, connected to 
a local peer only. Each machine hosts 4 users, and each user interacts with the block-
chain through a local client.
Our Fabric instance has three smart contracts deployed on it or so-called chain-
codes in Fabric terminology [25]. Two of them represent assets in the system, which 
Fig. 3  Experiment structure. Network consist of 3 peers, 3 clients and single orderer service. Smart con-
tracts are enforced on each peer
630 G. Yun et al.
1 3
are electricity and currency. The third chaincode is used for the secure exchange 
of electricity for currency. It has the following inputs: addresses of trading parties, 
amounts of energy, and currency to be traded.
In our system price discovery is isolated from the blockchain settlement layer. For 
an order discovery, a single separate HTTP server is used, where users upload infor-
mation about their intent to trade. After matching demand with an appropriate order, 
the trade is cleared through the exchange chaincode.
5.1  Performance and scalability
Blockchain performance problems have been known as the biggest obstacle to the 
adoption of this technology [26]. In our simulation, we used a permissioned block-
chain, which can process up to 100 times more transactions per second in compari-
son to Bitcoin or Ethereum. Overall our simulation from the very beginning of gen-
erating data, user setup to the final calculations took 1253 seconds to finish. That 
involved roughly eight hundred blockchain transactions and twice less order discov-
ery service transactions. The more detailed performance evaluation can be found 
in Figure 4. The evaluation was made on the Ubuntu machine which was running 
orderer service and 10 out of 30 customers. It has 16 GB of RAM and Intel Core 
i7-8550U processor.
5.2  Computational results
In the game mathematical model, based on the different equilibrium state in the sys-
tem, we focus on the optimistic and pessimistic conditions for the central energy 
company. We have the results from the math model by using different customer data.
Fig. 4  Performance evaluation on a per epoch basis made on one of the three simulation machines. It 
displays the amount of transaction made per epoch per service (blockchain or order discovery), and total 
time spent for the epoch
631
1 3
Residential energy trading with blockchain technology  
Figure  5 is the amount of electricity generated and demanded within one day. 
It is splitted on 12 time periods of 2 hours each. In this simulation, we used 12 
users total. Time index 0 is corresponding to 6:00 AM - simulation starting point. 
When the index increases by 1, the hour time increases by 2 h. We assume that the 
users’ demand has a small peak in the morning time, and the high peak at night. The 
amount generated is positive from 6:00 AM to 6:00 PM, 12:00 PM has the peak 
value, which is a simulation of solar energy generation pattern.
In Fig. 6 we make an iterative price calculations with a step of 0.1. The model has 
four prosumers. Figure 6 shows the conditions with � = 1 and � ≠ 1 . The two lines 
are representing pessimistic and optimistic conditions for the power company. We 
consider the pessimistic case in more detail because we do want to have even the 
worst case scenario to be on an acceptable range. We were able to find in a pessi-
mistic case that it has three inflection points, which means that the situation changes 
dramatically for the central energy company when it reaches the level of the next 
prosumer’s price. We also find that when � is close to 1, the influence scale is not 
that big.
The next figure represents price calculations with the price step 0.01. Figure 7a is 
the condition with �=1. We can find it has four inflection points, which are reflect-
ing the four selling prices of the prosumers. We can conclude that if the price UBp is 
not large enough, then a good pricing strategy for a power company should be to set 
the price on the level about 1.05, which can make the total profit reach the highest 
point. However, if UBp can be a large enough value, then the power company’s best 
strategy to set the price to UBp . Figure 7b provides the result with � ≠ 1 . In this case, 
it can be concluded that it has three inflection points only. We can see the maximum 
price for the power company changed to 1.13, due to the fact that we let � to obtain 
the value not very close to 1. Therefore, this condition might influence the decision 
of prosumers a lot in the system. However, this case is unusual and does not reflect 
the real-world setting. It is used for demonstration purposes.
Figure  8 is the pessimistic case for a power company with 10 prosumers 
and 12 time periods. Figure  8a displays the case with prosumers’ total gen-
eration amounts that are larger than the prosumers’ demand amounts. Figure 8b 
(a) Demand Amount (b) Generation Amount
Fig. 5  The demand and generation amount for each user in different time periods
632 G. Yun et al.
1 3
represents the case with prosumers’ total generation amounts that are almost 
equal to the prosumers’ demand amounts. Figure 8c displays the condition with 
prosumers’ total generation amounts that are much smaller than the prosumers’ 
demand amounts. We can see in figure 8a that under those conditions the opti-
mal price increases to about 1.18. In this scenario the power company cannot 
get any meaningful profits due to the fact that the redundant amounts sold by 
prosumers with selling prices lower than 1.18 are already larger than the amount 
needed by other users. Hence, if the power company sets the price larger than 
1.18, then users who need the power will buy electricity from other prosumers at 
lower prices. Figure 8b shows the condition that may happen more often in real 
life, when the total amount generated is almost equal to the total demand amount. 
Hence, the power company will have to set their price at a moderate level. In this 
example, it is about 1.32. In figure 8c, when the total amount generated is smaller 
than the demanded amount, the utility company will still set their price to UBP . It 
(a) Without Transaction Loss (b) With Transaction Loss
Fig. 6  Profit of central company in minimization and maximization condition for different pricing strat-
egy
(a) Without Transaction Loss (b) With Transaction Loss
Fig. 7  Profit of central company in minimization and maximization condition for different pricing strat-
egy
633
1 3
Residential energy trading with blockchain technology  
means under this condition by introducing peer-to-peer transactions mechanism 
among prosumer will not influence the selling price of the utility company.
5.3  Comparison for user’s cost based on three models
The mathematical model can give us a more optimal result in comparison with simu-
lation model based on real-world blockchain settings. It supposes that each user in the 
system has perfect information knowledge and perfect rationality and they can make 
the optimal decisions. However, in the real application of blockchain technology, the 
system will have a latency issue, as well as the setting will not allow users to derive 
perfect information about the system state, and this may lead to different results. In 
this section, we compare the results of the mathematical optimization model, the real 
blockchain simulated model, and the model without blockchain and transaction.
In Fig. 9, some users have a negative cost. It means that the user’s total earned 
money for selling the energy to other users is larger than the amount of money it 
pays to other users and the central company. This is only achievable in the two 
models that applied transactions among users. The label ’Cost_ORBC’ is the cost 
for each user by using a mathematical optimization model. The label ’Cost_BC’ 
is the cost in the blockchain simulated model. And the label ’Cost_NONBC130’ 
(a) Generation Amount Domination (b) No Domination
(c) Demand Amount Domination
Fig. 8  Influence to price with different generation and demand amount
634 G. Yun et al.
1 3
is the cost if we do not use peer to peer transactions. The total costs of all users 
with the three methods are relatively 141310,  378430,  491920. Here, when we 
calculate the cost of the transaction, we also consider lowering the central com-
pany’s price if the system has peer-to-peer transactions. Even under this lower 
price, the total cost is still much higher than the other two cases.
6  Conclusion
In this article, we establish two models for computing equilibrium electricity 
price in the system of the power company and prosumers in a local electricity 
grid. The first one is a multi-level game theory model. We solve it by using the 
KKT condition and linearization method. The result suggests that introducing the 
transaction among prosumers and consumers with blockchain technology will 
decrease the current power price. The second one is the agent-based simulation 
with deployment on the blockchain, and greedy net cost/profit optimization algo-
rithms utilized by customers.
Our findings suggest that the utility company only needs to consider setting 
their price equal to one of the prosumer’s selling price (model helps to calculate 
which exactly one) or UBp . In other words, the company can find an optimal price 
which maximizes its profit among the price list of prosumers. For prosumers, if 
their generation capability is much higher than their demand, then the commu-
nity can cover their energy needs without the power company, which will greatly 
reduce the average energy bill. In the real world, with the permission of solar 
energy generation technology, more prosumers will have generation capabilities, 
and in this case, applying blockchain to make peer-to-peer transactions between 
grid users can push the power company to decrease its selling price. However, 
in the case where prosumers’ generation power is much less than their demand, 
the introduction of the blockchain energy marketplace almost has no influence 
on the price. We hope that with the increasing mass adoption of solar energy 
power generating systems we can expect great benefits from the use of blockchain 
technology.
Fig. 9  Energy cost for each user
635
1 3
Residential energy trading with blockchain technology  
References
 1. Kotler, P.: The Prosumer Movement, in Prosumer Revisited, pp. 51–60. Springer, Berlin (2010)
 2. Swan, M.: Blockchain: Blueprint for a New Economy. O’Reilly Media Inc., Newton (2015)
 3. Pilkington, M.: 11 Blockchain technology: principles and applications. Research handbook on digi-
tal transformations 225, (2016)
 4. Crosby, M., Pattanayak, P., Verma, S., Kalyanaraman, V., et  al.: Blockchain technology: beyond 
bitcoin. Appl. Innov. 2(6–10), 71 (2016)
 5. Zyskind, G., Nathan, O., et al.: Decentralizing privacy: using blockchain to protect personal data, In: 
2015 IEEE Security and Privacy Workshops. IEEE, pp. 180–184 (2015)
 6. Basden, J., Cottrell, M.: How utilities are using blockchain to modernize the grid. Harv. Bus. Rev. 
23, (2017)
 7. Peck, M.E., Wagman, D.: Energy trading for fun and profit buy your neighbor’s rooftop solar power 
or sell your own-it’ll all be on a blockchain. IEEE Spectr. 54(10), 56–61 (2017)
 8. Kotsiuba, I., Velykzhanin, A., Biloborodov, O., Skarga-Bandurova, I., Biloborodova, T., Yanovich, 
Y., Zhygulin, V.: Blockchain evolution: from bitcoin to forensic in smart grids, 2018 IEEE interna-
tional conference on big data (big data), pp. 3100–3106, (2018)
 9. Ferrero, R., Rivera, J., Shahidehpour, S.: Application of games with incomplete information for 
pricing electricity in deregulated power pools. IEEE Trans. Power Syst. 13(1), 184–189 (1998)
 10. Ferrero, R., Shahidehpour, S., Ramesh, V.: Transaction analysis in deregulated power systems using 
game theory. IEEE Trans. Power Syst. 12(3), 1340–1347 (1997)
 11. Park, J.-B., Kim, B.H., Kim, J.-H., Jung, M.-H., Park, J.-K.: A continuous strategy game for power 
transactions analysis in competitive electricity markets. IEEE Trans. Power Syst. 16(4), 847–855 
(2001)
 12. Stamtsis, G.C., Erlich, I.: Use of cooperative game theory in power system fixed-cost allocation. 
IEE Proc. Gener. Transm. Distrib. 151(3), 401–406 (2004)
 13. Bai, X., Shahidehpour, S., Ramesh, V., Yu, E.: Transmission analysis by nash game method. IEEE 
Trans. Power Syst. 12(3), 1046–1052 (1997)
 14. Khadgi, P., Bai, L., Evans, G., Zheng, Q.P.: A simulation model with multi-attribute utility func-
tions for energy consumption scheduling in a smart grid. Energy Syst. 6(4), 533–550 (2015)
 15. L. Bai, G. Xu, Q. P. Zheng, A game theoretical approach to modeling energy consumption with 
consumer preference, in 2014 IEEE PES general meeting| conference & exposition. IEEE, pp. 1–5 
(2014)
 16. Sonnen community. [Online]. Available: https ://sonne ngrou p.com/sonne ncomm unity / (2021)
 17. Wang, J., Wang, Q., Zhou, N., Chi, Y.: A novel electricity transaction mode of microgrids based on 
blockchain and continuous double auction. Energies 10, 1971 (2017)
 18. Brookly microgrid. [Online]. Available: https ://www.brook lyn.energ y/ (2019)
 19. Power ledger. [Online]. Available: https ://www.power ledge r.io/ (2021)
 20. 0x Protocol - powering decentralized exchange. [Online]. Available: https ://0x.org/ (2021)
 21. Hyperledger Fabric Documentation Glossary: Channel. [Online]. Available: https ://hyper ledge 
r-fabri c.readt hedoc s.io/en/relea se-1.4/gloss ary.html#chann el
 22. Hyperledger Fabric Documentation Glossary: Ordering Service. [Online]. Available: https ://hyper 
ledge r-fabri c.readt hedoc s.io/en/relea se-1.4/gloss ary.html#order ing-servi ce (2019)
 23. Hyperledger Fabric Documentation Glossary: Peer. [Online]. Available: https ://hyper ledge r-fabri 
c.readt hedoc s.io/en/relea se-1.4/gloss ary.html#peer (2019)
 24. Hyperledger Fabric Documentation Glossary: Organization. [Online]. Available: https ://hyper ledge 
r-fabri c.readt hedoc s.io/en/relea se-1.4/gloss ary.html#organ izati on (2019)
 25. Hyperledger Fabric Documentation Glossary: Chaincode. [Online]. Available: https ://hyper ledge 
r-fabri c.readt hedoc s.io/en/relea se-1.4/gloss ary.html#chain code (2019)
 26. Chauhan, A., Malviya, O. P., Verma, M., Mor, T. S.: Blockchain and scalability, in 2018 IEEE Inter-
national conference on software quality, reliability and security companion (QRS-C). IEEE, pp. 
122–128 (2018)
Publisher’s Note Springer Nature remains neutral with regard to jurisdictional claims in published 
maps and institutional affiliations.
https://sonnengroup.com/sonnencommunity/
https://www.brooklyn.energy/
https://www.powerledger.io/
https://0x.org/
https://hyperledger-fabric.readthedocs.io/en/release-1.4/glossary.html#channel
https://hyperledger-fabric.readthedocs.io/en/release-1.4/glossary.html#channel
https://hyperledger-fabric.readthedocs.io/en/release-1.4/glossary.html#ordering-service
https://hyperledger-fabric.readthedocs.io/en/release-1.4/glossary.html#ordering-service
https://hyperledger-fabric.readthedocs.io/en/release-1.4/glossary.html#peer
https://hyperledger-fabric.readthedocs.io/en/release-1.4/glossary.html#peer
https://hyperledger-fabric.readthedocs.io/en/release-1.4/glossary.html#organization
https://hyperledger-fabric.readthedocs.io/en/release-1.4/glossary.html#organization
https://hyperledger-fabric.readthedocs.io/en/release-1.4/glossary.html#chaincode
https://hyperledger-fabric.readthedocs.io/en/release-1.4/glossary.html#chaincode
636 G. Yun et al.
1 3
Authors and Affiliations
Guanxiang Yun1 · Viacheslav Zhygulin1  · Qipeng P. Zheng1
 Guanxiang Yun 
 ygx8822@knights.ucf.edu
 Qipeng P. Zheng 
 Qipeng.Zheng@ucf.edu
1 Department of Industrial Engineering and Management Systems, University of Central Florida, 
Orlando, FL 32816, USA
http://orcid.org/0000-0001-6921-2763
	Residential energy trading with blockchain technology
	Abstract
	1 Introduction
	2 Game theory model
	2.1 Theorem
	3 Algorithm
	4 Blockchain implementation
	4.1 General approach
	5 Agent based simulation setups
	5.1 Performance and scalability
	5.2 Computational results
	5.3 Comparison for user’s cost based on three models
	6 Conclusion
	References