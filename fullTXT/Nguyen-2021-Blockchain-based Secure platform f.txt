Blockchain-based Secure Platform for Coalition Loyalty Program Management
Blockchain-based Secure Platform for Coalition
Loyalty Program Management
Cong T. Nguyen1,2,3, Dinh Thai Hoang1, Diep N. Nguyen1, Hoang-Anh Pham2,3,
Nguyen Huynh Tuong2,3 and Eryk Dutkiewicz1
1 School of Electrical and Data Engineering, University of Technology Sydney, Australia
2 Ho Chi Minh City University of Technology, Vietnam
3 Vietnam National University Ho Chi Minh City, Vietnam
Abstract—In this paper, we propose a novel blockchain-based
platform for the coalition loyalty program management. The
platform allows the customers to freely exchange loyalty points
from different existing blockchain-based loyalty programs by
utilizing the sidechain technology. Moreover, by adopting the
Proof-of-Stake consensus mechanism, we can further increase
customer engagement by allowing the customers to participate
in the consensus process to earn additional tokens. However, this
might lead to situations where the customers centralize all tokens
to a single chain/loyalty program if the chain offers more rewards
for consensus participation. Through security and performance
analyses, we show that such centralization of stakes poses a threat
to the security and performance of the platform. Therefore, we
develop a non-cooperative game model to analyze the rational
behavior of the users. We reveal that the consensus participation
rewards govern the user behavior and the decentralization of
the system. Numerical experiments confirm our analytical results
and show that the ratios between the consensus rewards have a
significant impact on the system’s security and performance.
Keywords- Blockchain, Proof-of-Stake, loyalty programs, and
non-cooperative game.
I. INTRODUCTION
Despite the omnipresence of loyalty programs in various
industries such as travel, retail, and financial services, they are
still facing huge challenges. According to [1], companies have
spent more than $1.2 billion each year on loyalty programs in
the U.S. alone. Nevertheless, the performance of these programs
rarely met the expectations, which leads to the termination of
many programs [1]. The main reason is the wide diversity of
programs coupled with their complex processes, which leads
to many difficulties for the customers to exchange or use their
loyalty points [2]. To overcome these shortcomings, companies
have created coalition loyalty programs where the loyalty points
can be collectively accumulated and spent on different options
offered by different companies [3]. Nevertheless, these coalition
programs require highly secure and effective platforms for
loyalty points exchanging and redemption.
Recently, the blockchain technology has emerged to be
a secure and effective solution for many application areas
such as healthcare, finance, and Industry 4.0 [9]. For loy-
alty program management, the blockchain technology has
also been widely applied thanks to its advantages of trans-
parency, decentralization, and immutability. Organizations in-
cluding Singapore Airlines [4] and American Express [5] have
recently introduced their blockchain-based solutions for coali-
tion loyalty program management. Moreover, several compa-
nies have been forming blockchain-based coalition loyalty pro-
grams such as Loyalwallet (https://loyalwallet.io/) Dragonchain
(https://dragonchain.com/), and Krispay [4]. However, these
programs were developed on individual blockchains, which
requires merging different blockchains into a single blockchain
network. Such single-blockchain platforms have several limita-
tions. Firstly, once the blockchains are merged, the companies
will lose control over their individual programs. Moreover,
merging two different blockchain networks may suffer many
technical issues due to different policies, requirements, and
technologies used in the companies. Furthermore, when using
a shared blockchain network, it is very difficult if a company
wants to implement new policies for its services and customers
as these policies need to obtain the agreements from other
companies in the network. Consequently, these limitations may
prevent the companies from joining single-blockchain coalition
programs. Recently, the sidechain technology [6] has been
developed to enable the transfers of network tokens (e.g., loyalty
points) between different blockchain networks. This enables
multi-blockchains coalition program, which is a promising
solution to the aforementioned problems because the companies
are no longer required to merge their blockchains. They then
can also retain their controls over their own loyalty programs.
To further attract customer engagement to the loyalty pro-
grams, the customers can be incentivized to participate in the
consensus mechanisms in the individual blockchains to earn
additional loyalty points. Among the blockchain consensus
mechanisms, the Proof-of-Work (PoW) [7] has several limita-
tions including huge energy consumption and significant delay,
e.g., one hour on average [9], which makes it unsuitable for
loyalty programs. To overcome these problems, a new consensus
mechanism has been developed recently, namely Proof-of-Stake
(PoS) [8], [9], [12], which has many advantages, including neg-
ligible energy consumption and especially very low consensus
delay [9]. Furthermore, users who participate in the PoS have
a chance to obtain rewards in the forms of tokens. However,
this might have an effect on the system as a whole, since
the users may be attracted to the blockchain with the highest
reward. Such centralization to a single blockchain might have
negative impacts on the security and performance of the other
blockchains in the same coalition loyalty program. Therefore,
the impact of user consensus participation needs to be analyzed.
To address the abovementioned problems, we develop a novel
multi-blockchains platform for coalition loyalty program man-
�����������	
����������	���	������������
�	��������
�����������
978-1-7281-9505-6/21/$31.00 ©2021 IEEE
2
0
2
1
 I
E
E
E
 W
ir
el
es
s 
C
o
m
m
u
n
ic
at
io
n
s 
an
d
 N
et
w
o
rk
in
g
 C
o
n
fe
re
n
ce
 (
W
C
N
C
) 
| 9
7
8
-1
-7
2
8
1
-9
5
0
5
-6
/2
0
/$
3
1
.0
0
 ©
2
0
2
1
 I
E
E
E
 | 
D
O
I:
 1
0
.1
1
0
9
/W
C
N
C
4
9
0
5
3
.2
0
2
1
.9
4
1
7
5
0
1
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:59:25 UTC from IEEE Xplore.  Restrictions apply. 
agement. In particular, we first adopt the sidechain technology
which does not require complex and costly solutions for merg-
ing different blockchain networks and also allows the companies
to retain control over their individual loyalty programs. Among
the available blockchain consensus mechanisms, we adopt the
Ouroboros consensus mechanism [8] which has a low delay
(approximately 3 minutes on average1) and proven security
properties [8]. These characteristics are advantageous in gov-
erning the coalition loyalty program platform. We then conduct
security and performance analyses of the system, especially
in the cases of adversarial attacks, to show that the security
and performance of the system depend on the users’ consensus
participation. Thus, we model the rational user behavior using
the non-cooperative game theory to examine how the users will
act and to what extent such actions affect the system. Through
numerical experiments, we then show the impacts of the user
behavior and the rewards on the security and performance of
the proposed system.
II. SYSTEM MODEL AND ANALYSIS
A. Proposed System
1) System Overview: Fig. 1 illustrates our proposed coalition
loyalty management system which consists of the companies,
the customers, and the decentralized token exchange platform.
In the system, each company has its own loyalty program
managed on its individual blockchain network. Each company’s
blockchain contains a ledger that stores the customer accounts
and their loyalty points records. When a customer purchases
a product from a company, the corresponding loyalty points
are sent to the customer in forms of blockchain tokens (each
company may have a different type of tokens). Such transfer of
tokens is recorded on the blockchain as a transaction.
2) Token Exchange Platform: To form the coalition pro-
gram, the companies negotiate the loyalty points exchange
rates among them in advance. Then, each company creates
and stores a smart contract (i.e., a user-defined program which
is automatically enforced when the conditions stated in the
smart contract are met [13]) on the blockchain. This smart
contract specifies the exchange rate between the two tokens
and triggers the exchange of loyalty points between the two
companies. When a new company wants to join the coalition,
it just needs to negotiate the exchange rates with the coalition
and create corresponding smart contracts. This reduces the setup
times and implementation costs for new companies who want
to join the coalition, as well as let the companies maintain their
independent controls over their individual programs.
When the customers want to redeem their loyalty points from
one company at the vendors of another company, they can
freely exchange the tokens to that company’s tokens via the
proposed decentralized token exchange scheme. Sidechain is
the core technology of the proposed token exchange scheme.
This technology refers to the methods that enable the transfers
of assets (e.g., coins) between different blockchain networks
(i.e., sidechains). Depends on the level of centralization, these
1https://cardanodocs.com/cardano/proof-of-stake/
�������
��������	
���
�������������
������
	
��������	
��������
������
�
���
������
�
���
������
�
������
�
�
��
������
����
��������
��������
����
�
�	�����
��	�����
� �	�����
��	�����
�
�	�����
��	�����
�
�	�����
��	�����
� �	�����
��	�����
�
�	�����
��	�����
�
�������
�������
�������
�������
�������
������
�
�	�����
�
Fig. 1: An illustration of the proposed system.
methods can be further classified into centralized two-way pegs,
federated two-way pegs, and Simplified Payment Verification
(SPV). Although the first two schemes can achieve a high
processing speed, they both require trust in a single or a group
of entities, which is more vulnerable to corruption, single-
point-of-failure, and security threats [6]. In contrast, the SPV
scheme does not require a central authority to validate cross-
chain transactions. Thus, for validation, a user can submit an
SPV proof which shows that the transfer transaction belongs
to a valid block of the originating chain. Although this process
requires a longer time for confirmation, it eliminates the risk
of centralization and single-point-of-failure [6]. Therefore, we
propose to use the SPV scheme for our platform.
As illustrated in Fig. 2, the token exchange procedure consists
of several steps. At the beginning, two companies negotiate a
loyalty point-exchange agreement which specifies the exchange
rate between the two tokens. This agreement is then stored in
each chain as a smart contract. Then, when a customer wants to
exchange some T o
2 tokens into T o
1 tokens, the customer sends a
transaction Tx1, containing some T o
2 tokens, from its account
on sidechain 2 to the smart contract SC2. The customer then
sends a transaction Tx2 and an SPV proof from its account
on sidechain 1 to SC1. Tx2 triggers SC1 to validate the sent
SPV proof. During the confirmation period, SC1 checks (1)
the validation of the SPV proof and (2) any conflicts of the
submitted SPV proof. After the confirmation period, SC1 sends
a number of T o
1 tokens to the customer’s address on sidechain
1 in accordance with the exchange rate.
3) Blockchain Individual Consensus Mechanism: Due to the
advantages of low computational requirements, low delay, and
the ability to attract customers to participate in the blockchain
consensus, the PoS mechanism is chosen for our system. Among
several variants of the PoS mechanism, we choose to adopt the
Ouroboros consensus mechanism because of its proven security
properties [8]. In Ouroboros, time is divided into epochs, and
each epoch is divided into time slots. At the first time slot
of epoch ek, a committee of stakeholders executes an election
protocol to elect the leaders for the epoch ek, such that for
each time slot there is one designated leader who creates one
�����������	
����������	���	������������
�	��������
�����������
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:59:25 UTC from IEEE Xplore.  Restrictions apply. 
�
��������
�
�������������
�������������
��������
�
�����
���
��������
� �������
�
�����
���
� �������
�
�����
����
�����
���
��������������
�
�������������
��
 ����������!"�
��#������
�
�����
��������
�� ���
����
�
���
������ �������
$
�����
�������
#��
�����!"�
��#�
��
%�	
�
$
�����
�������
#��
�����!"�
��#�
��
%�	
�
&
'''
'''
��#
����
��
���
�
� �������
�
�����
���� �������
�
�����
���
�����������������
 ��������
�������(��
���������
�
�����
����
Fig. 2: An illustration of the token exchange procedure.
new block to add to the chain. The committee also elects the
committee members for the epoch ek+1.
To elect the leaders and committee, the current epoch’s
committee members create the seeds for the FTS algorithm
(which is a hash function that takes any string as input and
outputs a token index [9]). The current owner of the index is
chosen as a leader of this epoch or a committee member of
the next epoch. The selected leaders will be able to create new
blocks to add to the chain and obtain a block reward, e.g., a
number of tokens. The expected payoff Un of stakeholder n
who has sn stakes (tokens) in a network of N users is:
Un =
sn∑N
n=1 sn
R, (1)
where R is the block reward (tokens per block). This creates
an opportunity for the company to further increase customer
engagement by incentivizing the customers to participate in the
company blockchain via the block rewards. On the other hand,
this poses a threat to the multi-chains system’s security. As can
be seen from (1), a stakeholder’s reward is directly proportional
to the chain’s block reward. Consequently, a chain with a high
block reward may attract more stakes from stakeholders, causing
the centralization of stakes and leaving the other chains more
vulnerable to attacks. In the following, we will analyze how the
stakes level affects a blockchain’s security and performance.
B. Security and Performance Analysis
1) Adversary Model: To analyze the security and perfor-
mance of the considered system, we first define the adversary
model. The adversary with a stake budget BA attempts to attack
the consensus process of the blockchain networks, aiming to
revert a transaction by creating conflicting blocks. Let Bn and
γ denote the stake budget of stakeholder n and the honest
stake ratio, respectively. Then, the ratio of adversarial stakes
is 1−γ =
BA∑N
n=1 Bn +BA
. We assume that the adversary can
move its stakes to any chain to perform attacks such as double-
spending, grinding, nothing-at-stakes, and 51% attacks [9]. In a
double-spending attack, the adversary firstly sends a transaction
to spend some tokens, e.g., to redeem some loyalty points.
After that transaction is confirmed, i.e., the loyalty points are
redeemed, the adversary can create a fork (a different version
of the blockchain) to erase the transaction from the blockchain.
If that fork is accepted by the honest users, the adversary can
gain back the tokens it already spent. For grinding and nothing-
at-stakes attacks, when the adversary is elected to be the leader,
it can create multiple blocks to influence the leader election
process or create forks for a double-spending attack. In the
51% attack, the adversary who controls more than 50% of the
blockchain’s stakes will try to revert transactions or attack the
leader election process.
2) Security Analysis: To maintain the blockchain’s opera-
tions and security, a consensus mechanism must satisfy the
common prefix property (CP) with parameter κ ∈ N [11].
The property is satisfied if for any pair of honest users, their
versions of the chain C1, C2 must share a common prefix.
Specifically, assuming that C2 is longer than C1, removing κ
last blocks of C1 results in the prefix of C2. We will prove that
the adopted consensus mechanism can satisfy the CP property
with overwhelming probability in the following Theorem.
THEOREM 1. The common prefix violation probability is less
than or equal to (1− γ)κ.
Proof: Any fork created by the adversary must include all
the blocks created by the honest leaders. This is because if an
honest leader does not change its block, then the adversary can
either adopt the block in the fork or replace it with another
block. However, as the list of leaders is known, the adversary
must include the honest block in the fork. Otherwise, it will
create an invalid fork that will be rejected. Moreover, any
change in a block’s content results in a different block’s hash,
and the block’s hash is linked to its previous block. Thus, the
chain from the first block to the latest honest block is confirmed
by every honest user. As a result, the adversary can only create
forks with κ last blocks different from the honest fork if it is
elected to be the leader for κ consecutive blocks. Since (1−γ) is
the ratio of adversarial stakes, the probability that the adversary
is elected to be the leader for κ consecutive blocks is
Pr
CP = (1− γ)κ, (2)
which is the probability that the CP property is violated.
In our system, the adversary can create multiple blocks for
grinding and nothing-at-stakes attack. However, grinding attacks
are mitigated because the leader election process cannot be
affected by creating multiple blocks. Moreover, transactions
cannot be reverted without violating the CP probability [8].
Therefore, nothing-at-stakes and double-spending attacks are
mitigated if the CP property holds. As can be seen from (2), the
CP violation probability is proportional to the adversarial stakes
ratio. Moreover, the adversary who controls more than 51% of
the network’s stakes (51% attack) can successfully influence
the leader election process [8]. Thus, the centralization of stakes
into one chain poses a serious threat to the other chains’ security.
3) Performance Analysis: Besides security, the adversarial
ratio also negatively impacts the performance of a blockchain.
As can be seen from (2), the CP violation probability decreases
as κ increases. This means that to confirm a transaction, the
stakeholders have to wait until κc more blocks are added to
the chain, such that (1 − γ)κc is extremely small (e.g., 0.1%).
Formally, the transaction confirmation time tc is tc = κcTb,
�����������	
����������	���	������������
�	��������
�����������
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:59:25 UTC from IEEE Xplore.  Restrictions apply. 
where Tb is the time it takes to add one block to the chain
(e.g., Tb = 20s in Ouroboros [8]), and κc is defined by
κc = min{κ|(1− γ)κ < 0.1%} (3)
As observed from (2) and (3), the more stakes the adversary
can control in a blockchain network, the more impacts it can
have on the network’s security and performance. Therefore,
the stake distribution, i.e., how the total stakes of the system
distribute to each chain, has a significant impact on the system’s
security and performance. Since the stakeholders are rational
(i.e., they aim to maximize their profits), the major factor that
decides the final stake distribution is the investment strategy of
each stakeholder, i.e., the number of stakes a stakeholder invests
in each chain. Therefore, we will examine the stakeholder
strategy using game theory in the next Section to see how such
rational behaviors affect the proposed system.
III. PROBLEM FORMULATION
A. Stakeholders and Sidechains
The proposed system consists of a set M of M inter-
connected blockchain networks (chains) and a set N of N
players (stakeholders). The chains have block rewards R =
(R1, . . . , RM ). Each stakeholder has a budget of stakes B =
(B1, . . . , BN ). In the proposed system, the stakeholders can
use their stakes to take part in the consensus process of every
chain to earn additional profits. Particularly, when stakeholder
n invests smn to chain m, its expected payoff Um
n is:
Um
n =
smn
smn +
∑
i∈N−n
smi
Rm, (4)
where N−n is the set of all stakeholders except stakeholder n.
Since the stakeholders can exchange their tokens, they can freely
invest stakes within their budgets to any chain, i.e.,
∑M
m=1 s
m
n ≤
Bn. Thus, the total payoff of stakeholder n is
Un =
M∑
m=1
Um
n =
M∑
m=1
(
smn
smn + Tm
Rm
)
, (5)
where Tm =
∑
i∈N−n
smi expresses the total stakes invested in
chain m by all the other stakeholders.
B. Game Theoretical Analysis
Non-cooperative game theory [14] models the situations of
conflicting interests among the players. As shown in (4), the
payoff of stakeholder n on chain m is proportional to its strategy
(smn ) and inversely proportional to other stakeholders’ strategies
(Tm), which implies the conflict of interests among the stake-
holders. Therefore, this competition among the stakeholders
can be analyzed by applying the non-cooperative game theory.
Formally, the game is denoted by G(N , (Sn)n∈N , (Un)n∈N ),
which consists of three components: the set of players N =
(1, . . . , N), the strategy set Sn consists of all possible strategies
for each player n, and the payoff function of each player Un.
Specifically, N is the set of stakeholders, Un is given by (4),
and Sn is defined as
Sn = {sn = [s1n, . . . , s
M
n ]|
M∑
m=1
smn ≤ Bn}. (6)
A desirable outcome of a non-cooperative game is the pure-
strategy Nash equilibrium [14]. At the Nash equilibrium, every
player cannot get a better payoff by unilaterally changing to
any other strategies. As a result, if the system reaches the
Nash equilibrium, it becomes stable because no player has the
incentive to deviate from the equilibrium. We first prove the
existence of the Nash equilibrium in the following Theorem.
THEOREM 2. There exists at least one Nash equilibrium in G.
Proof: If Sn is compact and convex and Un is quasi-
concave ∀n ∈ N , there exists at least one Nash equilib-
rium [14]. The second-order partial derivative of Un is:
∂2Um
n
∂(smn )2
=
−2RmTm
(smn + Tm)3
≤ 0. (7)
Thus, Um
n is concave over Sn. Then, Un =
∑M
m=1 U
m
n is also
concave over Sn. Moreover, from (6), it is straightforward to
derive that Sn is compact and convex ∀n ∈ N .
Then, we prove in the following Theorem that a rational
player will always invest all its budget.
THEOREM 3. Every player n will invest all its budget, i.e.,∑M
m=1 s
m
n = Bn, regardless of other players’ strategies.
Proof: Assume that player n is employing strategy sn
which invests less than its budget, i.e.,
∑M
m=1 smn < Bn.
The utility function in this case is given in (5). If the player
chooses a strategy s′n which invests the remaining budget Δsjn
into a chain j, its utility function becomes:
U ′
n =
∑
m∈M−j
(
smn
smn + Tm
Rm
)
+
sjn +Δsjn
sjn +Δsjn + Tj
Rj , (8)
where M−j is the set of all chains except chain j. Then, the
difference in the utilities between the two strategies is:
U ′
n − Un =
Δsjn
∑
k∈N−n
sjk
(sjn +Δsjn + Tj)(s
j
n + Tj)
, (9)
which is always positive. Therefore, sn always gives a lower
payoff than s′n regardless of the other players’ strategies.
An important result from Theorem 3 is that the strategies
which invest less than the total budget can be removed from
Sn, ∀n ∈ N . Thus, we can reformulate the utility function to
reflect the budget constraint as follow:
Un =
M−1∑
m=1
(
smn
smn + Tm
Rm
)
+
Bn −∑M−1
m=1 smn
Bn −∑M−1
m=1 smn + TM
RM .
(10)
As a result, we can prove the uniqueness of the Nash
equilibrium in the following Theorem.
THEOREM 4. There exists a unique Nash equilibrium in G.
Proof: According to Rosen’s theorem [15], a sufficient
condition to guarantee the uniqueness of the Nash equilibrium
�����������	
����������	���	������������
�	��������
�����������
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:59:25 UTC from IEEE Xplore.  Restrictions apply. 
is that the matrix [G(s, ω) + GT (s, ω)] is negative definite for
a fixed ω > 0. G(s, ω) can be calculated by:⎡
⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
ω1
∂2U1
∂s11∂s
1
1
ω1
∂2U1
∂s21∂s
1
1
· · · ω1
∂2U1
∂sM1 ∂s1N
ω1
∂2U1
∂s11∂s
2
1
ω1
∂2U1
∂s21∂s
2
1
· · · ω1
∂2U1
∂sM1 ∂s2N
...
...
. . .
...
ωN
∂2UN
∂s1N∂sM1
ωN
∂2UN
∂s2N∂sM1
· · · ωN
∂2UN
∂sMN ∂sMN
⎤
⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
(11)
Let ωn = 1, ∀n ∈ N , the entries of G(s, ω) can be calculated
as follows:
• Gi,i =
2Ris
i
i
(
∑N
n=1 s
i
n)
3
− 2Ri
(
∑N
n=1 s
i
n)
2
.
• Gi,j = Gj,i =
2Ris
i
i
(
∑N
n=1 s
i
n)
3
− Ri
(
∑N
n=1 s
i
n)
2
, where j �= i
and j − 1 is divisible by M .
• All the other entries equal zero.
As a result, G(s, ω) can be expressed as a sum of 2 matrices
G = D+E, where D is a matrix with entries Di,j = Di,i = Gi,i,
and E is a diagonal matrix with entries Ei,i = − Ri
(
∑N
n=1 s
i
n)
2
.
Since D has identical columns (columns i and M + i are
identical), it is negative semi-definite. As a result, G(s, ω) is
the sum of a negative semi-definite matrix and a negative def-
inite matrix (E). Thus, G(s, ω) is negative definite. Therefore,
[G(s, ω) + GT (s, ω)] is negative definite.
With the existence and uniqueness guaranteed, the only ques-
tion remained is how to find the equilibrium point. Interestingly,
for the considered game model, we can prove the exact formula
of the Nash equilibrium in Theorem 5.
THEOREM 5. The point where every player’s strategy satisfies
smn = Bn
Rm∑M
i=1 Ri
, ∀m ∈ M, ∀n ∈ N is the unique Nash
equilibrium of G.
Proof: We prove that at the point where every player’s
strategy satisfies smn = Bn
Rm∑M
i=1 Ri
, ∀m ∈ M, ∀n ∈ N , every
player’s strategy maximizes its utility (i.e.,
∂Un
∂smn
= 0). Thus,
this is the Nash equilibrium of this game. Substitute smn =
Bn
Rm∑M
i=1 Ri
into
∂Un
∂smn
, we have
∂Un
∂smn
=
∑
j∈N−n
Bj
R2
m∑M
i=1 Ri∑N
n=1(Bn
Rm∑M
i=1 Ri
)2
−
∑
j∈N−n
Bj
R2
M∑M
i=1 Ri∑N
n=1(Bn
RM∑M
i=1 Ri
)2
,
=
∑
j∈N−n
Bj
( ∑M
i=1 Ri∑N
n=1(Bn)2
−
∑M
i=1 Ri∑N
n=1(Bn)2
)
,
=0, ∀m ∈ Mand ∀n ∈ N .
(12)
The proof is now completed.
An important result from Theorem 5 is that the number of
stakes a player invests in a chain only depends on its total
budget and the ratios of block rewards between the chains. This
result can help the blockchain operators to determine the stake
distribution by setting their block rewards accordingly, which is
vital to the system’s security and performance.
IV. NUMERICAL RESULTS
In this Section, we simulate a system with 100 stakeholders
(players) and 3 chains to evaluate stakeholder behaviors and
their impacts on the system. The block rewards R = [10, 30, 40]
are adapted from several real-world PoS blockchain networks
(Cardano, Algorand, and Tezos), whereas B are generated
randomly with normal distribution in the ranges of [10, 50].
In particular, the simulation is divided into iterations. At each
iteration, the strategy that maximizes player n’s profit (while
the strategies of all the other players are fixed) is computed.
The obtained result is then fixed as the new strategy of player
n, and the simulation continues to find the best strategy for
player n + 1 in the next iteration. The simulation is stopped
when every player’s strategy remains the same. During the
simulation, we record the convergence of the player strategies
to the Nash equilibrium and the final stake distribution. Then,
based on the final stake distribution, we show the CP violation
probability of each chain under different adversarial ratio.
From the performance perspective, we measure tc, which is
determined by κc.
Fig. 3(a) illustrates the player strategies in this game. As
observed from the figure, the player strategies converge and
become stable after 100 iterations. At the stable state, the stake
distribution is proportional to the block rewards ratio, i.e., the
chain with a higher block reward has more stakes. Moreover,
this shows that the simulation results match the analytical results
we proved in Theorem 5.
Fig. 3(b) shows the CP violation probabilities with parameter
κ = 6 when the adversary attacks with BA = [1, 500]. At
approximately BA = 320 and BA = 470, chain 3 and chain
2 can no longer satisfy the CP property with overwhelming
probability (i.e., PrCP > 0.1%), respectively. This is because
these two chains have fewer stakes than chain 1, and thus the
adversarial ratios (1− γ) ratio are higher in these chains.
Fig. 3(c) illustrates tc of 3 chains in case of adversarial
attacks. To determine tc, we calculate κc, and then we multiply
κc with Tb to determine how long the stakeholders have to
wait before a transaction is confirmed. The figure shows that tc
increases as the adversarial stake increases, and the chain with
the highest number of stakes (chain 1) has the lowest tc.
As observed from Fig. 3, the higher the block reward is, the
more stakes a chain has, and the better the chain’s security and
performance can be. Thus, the block rewards have a significant
impact on the system’s operation and security. However, deter-
mining the block reward is not a simple task. On the one hand,
the companies want to increase the block rewards to improve
their chains’ security and performance. On the other hand, the
block reward is the cost that the companies have to pay, and
�����������	
����������	���	������������
�	��������
�����������
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:59:25 UTC from IEEE Xplore.  Restrictions apply. 
�� ��� ��� ��� ��� ��� ��� ��� ��� ���
�	
��	���
�
���
���
���
���
����
����
�	
��
�
��
�
�	
�
��
��
��
�
�
������
������
������
������������	�����
���	
������������	�����
���	
������������	�����
���	
(a) Strategies convergence to the equilibrium.
�� ��� ��� ��� ��� ��� ��� ��� ��� ���
���
��������	��
�
�
���
���
���
���
���
���
�
� 
 
��
�!
�
"#
��
�
��
	�
��
$�
�%
�%
�	
��
&'
(
������
������
������
(b) Common prefix violation probability.
�� ��� ��� ��� ��� ��� ��� ��� ��� ���
���
��������	��
�
�
��
���
���
���
)�
��
��
�	
�
��
��
�"
� 
�	
�
��
	 
�
&�
(
������
������
������
(c) Transaction confirmation time.
Fig. 3: Simulation results.
thus it cannot be too high. Thus, the optimal setting of the block
reward remains an open issue for future work.
V. CONCLUSION
In this paper, we have proposed a novel blockchain-based
system to effectively manage the coalition loyalty program. The
proposed blockchain system utilizes the advantages of Proof-
of-Stake and sidechain technologies to allow the customers to
freely exchange loyalty points from different existing loyalty
programs. Moreover, new companies can join the coalition
without the need for the complex and costly merging processes
of different blockchain networks. We have also conducted
security and performance analyses of the proposed system and
showed that the user behaviors have a significant impact on the
system security and performance. Through a non-cooperative
game theory analysis, we have concluded that the user behaviors
depend greatly on the block rewards. Finally, we have conducted
numerical experiments to demonstrate that the block rewards
dictate how the users behave and have a significant impact on
system performance and security.
ACKNOWLEDGEMENT
This work was supported in part by the Joint Technology
and Innovation Research Centre—a partnership between the
University of Technology Sydney and the VNU Ho Chi Minh
City University of Technology (VNU HCMUT).
This work was funded in part by Vingroup Joint Stock
Company and supported by the Domestic Master/ PhD Scholar-
ship Programme of Vingroup Innovation Foundation (VINIF),
Vingroup Big Data Institute (VINBIGDATA).
This work is the output of the ASEAN IVO (http://www.nict.
go.jp/en/asean ivo/index.html) project on Cyber-Attack Detec-
tion and Information Security for Industry 4.0 and financially
supported by NICT (http://www.nict.go.jp/en/index.html).
REFERENCES
[1] L. Steinhoff and R. W. Palmatier, “Understanding loyalty program effec-
tiveness: managing target and bystander effects,” Journal of the Academy
of Marketing Science, vol. 44, no. 1, pp. 88–107, Aug. 2014.
[2] D. Kowalewski, J. McLaughlin, and A. J. Hill, “Blockchain Will
Transform Customer Loyalty Programs,” Harvard Business Review, Jul
27, 2017. [Online]. Available: https://hbr.org/2017/03/blockchain-will-
transform-customer-loyalty-programs. [Accessed: 29-Mar-2020].
[3] E. Breugelmans et al., “Advancing research on loyalty programs: a future
research agenda,” Marketing Letters, vol. 26, no. 2, pp. 127-139, June 2015.
[4] Kayden, “Introducing Krispay: Mobile miles for every-
day spend,” Got the Xtra Miles. [Online]. Available:
https://gothextramiles.com/2019/03/22/krispay-introducing-a-new-way-
to-earn-miles/. [Accessed: 15-Apr-2020].
[5] N. Morris, “Amex is reinventing rewards using blockchain,” Ledger
Insight, 2019. [Online]. Available: https://www.ledgerinsights.com/amex-
blockchain-rewards-american-express/. [Accessed: 15-Apr-2020].
[6] A. Back, (Oct. 2014). “Enabling blockchain innovations with pegged
sidechains”. [Online]. Available: http://kevinriggen.com/files/sidechains.pdf
[7] S. Nakamoto, (May 2008). “Bitcoin: A peer-to-peer electronic cash sys-
tem”. [Online]. Available: https://bitcoin.org/bitcoin.pdf
[8] A. Kiayias, A. Russell, B. David, and R. Oliynykov, “Ouroboros: A
Provably Secure Proof-of-Stake Blockchain Protocol,” in CRYPTO 2017,
Santa Barbara, USA, Aug. 20-24, 2017, pp. 357-388.
[9] C. T. Nguyen, D. T. Hoang, D. N. Nguyen, D. Niyato, H. T. Nguyen, and E.
Dutkiewicz, “Proof-of-Stake Consensus Mechanisms for Future Blockchain
Networks: Fundamentals, Applications and Opportunities,” in IEEE Access,
vol. 7, pp. 85727-85745, June 2019.
[10] M. Mitzenmacher and E. Upfal, Probability and computing: Random-
ization and probabilistic techniques in algorithms and data analysis.
Cambridge: Cambridge university press, 2017.
[11] J. Garay, A. Kiayias and N. Leonardos “The bitcoin backbone protocol:
Analysis and applications,” in Annual International Conference on the
Theory and Applications of Cryptographic Techniques, Sofia, Bulgaria,
April 26-30, 2015, pp. 281-310.
[12] Y. Gilad, R. Hemo, S. Micali, G. Vlachos, and N. Zeldovich, “Algorand:
Scaling byzantine agreements for cryptocurrencies,” in Proc. of the 26th
Symposium on Operating Systems Principles, Oct. 2017, pp. 51-68.
[13] L. Luu, D. Chu, H. Olickel, P. Saxena, and A. Hobor, “Making smart
contracts smarter,” in Proc. of the ACM SIGSAC Conference on Computer
and Communications Security, Vienna, Austria, Oct. 2016, pp. 254-269.
[14] Z. Han, D. Niyato, W. Saad, T. Başar, and A. Hjørungnes, Game Theory in
Wireless and Communication Networks: Theory, Models, and Applications.
Cambridge, UK: Cambridge University Press, 2012.
[15] J. B. Rosen, “Existence and Uniqueness of Equilibrium Points for Concave
N-Person Games,” Econometrica, vol. 33, no. 3, pp. 520-534, July 1965.
�����������	
����������	���	������������
�	��������
�����������
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:59:25 UTC from IEEE Xplore.  Restrictions apply.