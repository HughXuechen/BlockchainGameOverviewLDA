IoT Systems Internal Mapping using RTT with the integration of Blockchain technology
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Abstract— The degree to which innovators adopt Blockchain as 
a tool to create relevant and useful business solutions will 
determine how fast and far the platform moves into our daily 
lives. There are limitless opportunities for technology to define 
and shape future innovation. In a world dominated by digital 
technology, IoT plays a prominent role in our lives. It has created 
an ecosystem that links many systems to give smart performances 
in every task. The proliferation of the IoT has created a new 
evolution of cell phones, home and other embedded applications 
that are all connected to the internet. They have impeccably 
integrated human communication in ways we never expected 
before. Integrating blockchain and IOT will provide innovative 
technology. This integration will provide trustless, more secure, 
and more reliable IoT systems. The applications of this 
integration will be limitless. In this research, we will apply this 
concept in a simple game application. Bluetooth technology will 
be used to calculate the object’s positions by using RTT and other 
data from mobile sensors and apply them in kinematics equations. 
This application allows building a map of objects positions 
relative to each other. Blockchain will be used to save this data 
and assure its accuracy and correctness. The Game application 
will be a simple proof of the concept, but its future application 
will be limitless. 
 
Keywords—Blockchain, RTT, Bluetooth, Ethereum, Android 
studio. 
I. INTRODUCTION 
 
Blockchain definition  
 
The blockchain is a distributed database of records of all 
transactions or digital event that have been executed and 
shared among participating parties [1]. Each transaction 
verified by the majority of participants of the system. It 
contains every single record of each transaction. Blockchain 
Technology first became known when a person or group of 
individuals name ‘Satoshi Nakamoto’ published a white paper 
on “Bitcoin: A peer to peer electronic cash system” in 2008. 
Blockchain Technology Records Transaction in Digital 
Ledger, which is distributed over the network thus making it 
incorruptible [2].   
 
Importance of Blockchain  
 
� Immutability 
The immutable factor in blockchain ensures that the data is not  
 
manipulated, replaced or falsified in any way, shape. Any 
agreed and shared transaction across the network is also nearly 
impossible to undo. This helps in situations where certain data 
needs to be tracked accurately and efficiently [2]. 
 
� Decentralization 
The need for intermediaries and third parties is reduced with 
blockchain. This also helps to reduce costs by eliminating 
these middlemen. Efficiency is also increased as transactions 
are conducted between peers [3]. 
 
� Transparency 
It is one of the positive attributes of why people prefer using 
Blockchain technology. The full transparencies in the network 
make it one of the most likeable technologies out of different 
technologies available in the market. The data is being shared 
among all the participants [2][3].  
 
� Security 
The need of security has risen but Blockchain has promised its 
users to provide robust security. Information is stored in 
blocks. Each block stash the information of the last block in it 
and making it fully interconnected with each other [4]. 
 
 
 
 
 
 
Figure 1.  Blockchain architecture   
Source: Adapted from [5] 
IoT Systems Internal Mapping using RTT with 
the integration of Blockchain technology 
Noha Magdy*, Mohannad Barakat*, Bassem Mokhtar*§ 
*School of Engineering and Applied Sciences,Nile University,Egypt 
§College of Information Technology, University of Fujairah, Fujairah, UAE 
N.Magdy@nu.edu.eg, M.Barakat@nu.edu.eg, bassem@uof.ac.ae  
Proceedings of NILES 2019:
Novel Intelligent and Leading Emerging Sciences Conference
154
978-1-7281-3173-3/19/$31.00 ©2019 IEEE
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:23:21 UTC from IEEE Xplore.  Restrictions apply. 
 
IOT definition  
 
IOT is the extension of Internet connectivity into physical 
devices and everyday objects. Embedded with electronics, 
Internet connectivity, and other forms of hardware (such as 
sensors), these devices can communicate and interact with 
others over the Internet, and they can be remotely monitored 
and controlled [6] [7]. 
 
Literature review  
 
With the rise of IoT lately, the need for automatic device for 
mapping raised. Thus, in the past few years a lot of research 
has been done on using Bluetooth for distance estimation. 
Distance estimation identifies the distance between two 
machines in wireless network. Researchers have been focusing 
on signal strength and Signal Strength Indication (RSSI) to 
calculate the distance. The characteristic of Bluetooth RSSI 
value is different as environments. A research done on 2016 
has proved that RSSI is a poor distance estimator when using 
wireless sensor networks in buildings. Reflection, scattering 
and other physical properties have an extreme impact on RSSI 
measurement, which conclude that RSSI is a bad distance 
estimator [8] [9]. Another research stated that Some efforts 
have been made with purely signal strength based positioning, 
but indoor environments have shown to work unfavorably for 
these kinds of methods [10].  
 
Blockchain technology has many advantages and is constantly 
being explored for further applications. Since 2008, 
blockchain had different applications in different fields [11]. 
Despite the importance of IoT applications, Integrating IoT 
system with blockchain is still a not solved problem.  
 
This paper will present a real life application of integrating 
blockchain technology with IoT systems, and shows how this 
integration will add a valuable impact on IoT technology. 
Throughout the methodology, we will introduce more efficient 
way for indoor mapping using RTT.  
 
This paper will discuss the steps of integrating IoT with 
blockchain technology in a simple game application in section 
II, then section III will show the application testing results, 
section IV will discuss the results, section V will show some 
limitation and recommendation for future research, and finally 
section VI will conclude the work done and explained in this 
paper. 
II. METHODOLOGY  
Android studio was used to create the application for reading 
sensors’ data, and calculate the relative positions for different 
devices, as well as, sharing the data in the blockchain. Each 
device will represent a player in the game, and if the player 
knows the positions for other players, he will be able to shoot 
them as targets to win points. The scoring record will be 
evaluated by a smart contract on Ethereum to check its 
reliability. The steps for application creation is as follows: 
 
A. Connecting devices using Bluetooth  
A connection socket is opened for Bluetooth connection 
allowing sharing data between the devices. Once the devices 
are paired, they will be able to send and receive packets.  
 
B. Calculating RTT 
RTT calculation will be the starting point to calculate the 
distance between two devices. Packets will be sent cautiously 
to update the distance. This distance will be used later to 
evaluate positions using kinematics equations.  
 
RTT will be calculated with two scenarios to compare the 
results between both of them. The first scenario shown in 
figure 1 shows that there will be a processing delay for 
including t1 and t2 in the packet. This delay will affect time 
accuracy, which will affect the distance accuracy.  
 
 
 
 
 
 
Figure 2:  Scenario 1 for RTT 
 
The second scenario will surpass the processing delay that 
affects the values for t1 and t2 but will delay the calculation 
with one cycle. We expect that this delay will not affect the 
accuracy significantly, as the human rate in changing their 
speed will be bigger than the timing of the cycle.  
 
Proceedings of NILES 2019:
Novel Intelligent and Leading Emerging Sciences Conference
155
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:23:21 UTC from IEEE Xplore.  Restrictions apply. 
 
 
 
 
Figure. 3  Senario 2 for RTT 
  
C. Calculating velocities  
Using the accelerometer sensor, the device will get the values 
for its acceleration. Using the kinematic equation: 
 
                                                             (1) 
Knowing the calculated time, we will be able to calculate the 
velocity from equation 1 supposing that the initial velocity is 
zero.  
The devices will share their velocities with other devices along 
with their direction calculated using the device’s compass. 
This shared data will allow each device to locate the other 
devices. 
 
D. Scoring  
Knowing the positions for other devices, any player will direct 
his device to the right position and shoot on target to win 
points. He will share his score among all the players. Each 
player will have a record for all the scores.  
 
E. Sharing data on Blockchain  
At the end of the game, each player will share the scoring 
record on the blockchain. An Ethereum smart contract was 
implemented to compare the data of each player. If the 
players’ scores are similar among more than 51% of the 
players then the scores will be considered true and will be 
verified on the blockchain. This will prevent any player from 
manipulating the data, or it will be excluded. Besides, 
blockchain will save the data securely without any future 
manipulation. 
III. RESULTS  
Applying scenario 1 on calculating the RTT, there was a time 
delay, as expected, varying approximately between 1 to 3 
seconds. This time delay resulted in not accurate relative 
positions with a maximum error of 7 meters. Testing the 
methodology 60 times shows the following results in table (1). 
 
TABLE I.    PROBABILITIES OF DIFFERENT ERROR RANGES  
 
Error  Probability  
Less than 3 meters  0.4 
3 to 5 meters  0.5 
6 or more meters  0.1 
 
 The probability of getting less than 3 meters error range of the 
relative position was 0.4, the probability of getting the error in 
the range of 3 to 5 meters was 0.5, and the probability of 
getting the error of 6 meters or higher was 0.1. Due to these 
errors of distance, unexpected errors found in calculating 
relative velocity. As stated above relative velocity is calculated 
as the change of distance over time. With this big deviation in 
error, velocity rarely is calculated correctly. As relative 
velocity values are strongly damaged, it was hard to calculate 
the angle from it. Because of these errors, this algorithm is not 
efficient in building internal maps over low powered Bluetooth 
(Bluetooth 4.2 was used only) in regular cell phones. 
Calculating self-velocity and analyzing it on the compass 
directions by a background daemon seems to have an 
acceptable error range. Accurate error calculations will be 
easier when the relative velocity and angle are will be 
calculated. 
IV. DISCUSSION  
This research was built on the hypothesis that internal mapping 
for objects communicating through an IoT system could be 
implemented using RTT calculation, which with simple 
kinematics could give relative positions of the objects.  The 
data of the mapped IoT system will then be verified and saved 
on blockchain to guarantee high reliability and security. To 
test the hypothesis, the two scenarios explained should be done 
and test the accuracy of each. Scenario 1 was expected to give 
a time delay, which will result in an error range on relative 
positions on the objects. As expected the results showed a 
maximum error of 7 meters. Scenario 2 results are not included 
in this paper, but the results are expected to give high 
accuracy, as the time delay of scenario 1 will be surpassed. 
Although we applied the test on a game application, this 
research could be applied on different applications such as 
warehouses, self-driving cars or any other applications that 
have objects needs to communicate with each other knowing 
the relative positions of each other. 
V. LIMITATIONS &RECOMMENDATIONS  
Due to time constraints, the results of testing scenario 2 
(shown in figure 2) have been not conclusive yet. These results 
could do a major change in proving the concept of using RTT 
for calculating relative positions to create an internal map of 
objects. Besides, the lack of resources limited the testing to be 
Proceedings of NILES 2019:
Novel Intelligent and Leading Emerging Sciences Conference
156
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:23:21 UTC from IEEE Xplore.  Restrictions apply. 
 
done on only four different mobile devices with the same 
version of Bluetooth but different processing speeds, although, 
trying different versions of Bluetooth with different processing 
speeds could drive conclusion on how changing the devices 
could affect the accuracy. To overcome those constraints, we 
recommend those who are attentive to continue working on 
this topic to firstly, conclude the results of scenario 2 and 
compare the results of the two scenarios. Secondly, to 
calculate RTT using multithreaded application and take the 
average of the calculated time on each thread to increase the 
accuracy. We also recommend creating private blockchain 
developed to save and process the data of this application with 
high transaction speeds and zero cost. Using Ethereum was to 
test the concept, but its relatively low speed and high cost may 
cause problems in real-life applications. 
VI. CONCLUSION 
Internet of Things (IoT) is paving the way for a world, where 
many of our daily objects will be interconnected and will 
interact with their environment to collect information and 
automate certain tasks. Sharing IOT data requires a secure, 
fast, and reliable network and this is what blockchain 
technology could offer. Blockchain in 2010 was a peer-to-peer 
network for sharing ledger, but now the blockchain technology 
expanded to share data for different applications. We 
expanded the use of blockchain for sharing IoT data. To 
conclude, a shooting game was developed to present the 
concept of using blockchain technology for the internet of 
things. The devices were able to connect through the Bluetooth 
connection and join the game session. The live data of the 
game, which determines the winner, was captured using device 
sensors then moved to the smart contract to be processed using 
a secure blockchain network to be accessed easily with the 
right people through an inner-product proxy re-encryption 
scheme that ensures an efficient and secured data access to IoT 
data is presented. 
REFERENCES 
[1] M. V. Rijmenam, “What is the Blockchain?,” Blockchain, pp. 12–39. 
[2] S. H. Ammous, “Blockchain Technology: What is it Good for?,” SSRN 
Electronic Journal, 2016. 
[3] R. Beck, “Beyond Bitcoin: The Rise of Blockchain World,” Computer, 
vol. 51, no. 2, pp. 54–58, 2018. 
[4] V. L. Lemieux, “Trusting records: is Blockchain technology the answer?,” 
Records Management Journal, vol. 26, no. 2, pp. 110–139, 2016. 
[5] “Defining Blockchain Technology: Use Cases of Blockchain,” Edureka, 
22-May-2019. [Online]. Available: https://www.edureka.co/blog/blockchain-
technology/. [Accessed: 28-Jul-2019]. 
[6] I. Lee and K. Lee, “The Internet of Things (IoT): Applications, 
investments, and challenges for enterprises,” Business Horizons, vol. 58, no. 
4, pp. 431–440, 2015. 
[7] R. Casadei, G. Fortino, D. Pianini, W. Russo, C. Savaglio, and M. Viroli, 
“Modelling and simulation of Opportunistic IoT Services with Aggregate 
Computing,” Future Generation Computer Systems, vol. 91, pp. 252–262, 
2019. 
[8] S. Bertuletti, A. Cereatti, U. Della, M. Caldara, and M. Galizzi, “Indoor 
distance estimated from Bluetooth Low Energy signal strength: Comparison 
of regression models,” 2016 IEEE Sensors Applications Symposium (SAS), 
2016. 
[9] S. Rajkiran and C. Balakrishnan, “RSSI estimation using Bluetooth in 
smart phones,” 2015 2nd International Conference on Electronics and 
Communication Systems (ICECS), 2015. 
[10] Z. Jianyong, L. Haiyong, C. Zili, and L. Zhaohui, “RSSI based Bluetooth 
low energy indoor positioning,” 2014 International Conference on Indoor 
Positioning and Indoor Navigation (IPIN), 2014. 
[11] S. Huh, S. Cho, and S. Kim, “Managing IoT devices using blockchain 
platform,” 2017 19th International Conference on Advanced Communication 
Technology (ICACT), 2017. 
 
Proceedings of NILES 2019:
Novel Intelligent and Leading Emerging Sciences Conference
157
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 07:23:21 UTC from IEEE Xplore.  Restrictions apply.