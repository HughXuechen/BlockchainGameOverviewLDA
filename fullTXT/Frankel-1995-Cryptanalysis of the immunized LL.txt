Cryptanalysis of the Immunized LL Public Key 
Systems 
Yair F'rankel' * and Moti Yung2 
Sandia National Laboratories, Albuquerque, NM 
IBM T. J. Watson Research Center, Yorktown Heights, NY 
Abstract. In CRYPTO '93 Lim and Lee provided a valuable investi- 
gation of public key encryption systems secure against adaptive chosen 
ciphertest attach. In this paper we identify several insecurities of both 
their RSA and El Gamal based schemes. We first demonstrate that the 
RSA based scheme is insecure under an adaptive chosen ciphertext at- 
tack. We also point weaknesses in the design of both their RSA and 
El Gamal based schemes regarding the use of pseudorandom-generators, 
and in particular show that their choice of pseudorandom-generators for 
the RSA based scheme may be insecure even with respect to a known 
ciphertest only attack. 
They further claim that their schemes are particularly useful in the 
context of grouporiented cryptosystems due to the unique verification 
method used. (In fact their scheme is the only grouporiented practi- 
cal encryption claimed to be secure against chosen ciphertext attacks). 
Group oriented cryptosystems distribute the decryption process amongst 
a multiple of individuals in order to provide a mechanism in which no 
single person is trusted. We further demonstrate that both their schemes 
are completely insecure in this setting. 
* Research waa performed while the author was at GTE Laboratories Incorporated. 
D. Coppersmith (Ed.): Advances in Cryptology - CRYPTO '95, LNCS 963, pp. 287-296, 1995. 
0 Springer-Verlag Berlin Heidelberg 1995 
288 
1 Introduction 
We analyze the Lim and Lee public key cryptosystems (which are built upon the 
RSA [RSA78] and El-Gamal [ElGama185] cryptosystems) presented at CRYPT0 
‘93 [LimLee93]. Their systems introduced new insights and were designed (1) 
to strengthen the basic public-key systems against adaptive chosen ciphertext 
attacks, (2) to improve problems with previous such schemes, and (3) to be 
adaptable for group-oriented systems. In this paper we: 
- demonstrate that the Lim-Lee RSA based encryption scheme is insecure 
against an adaptive chosen ciphertext attack; 
- show that the Lim-Lee El Gamal based encryption scheme is insecure against 
an adaptive chosen ciphertext attack when used in a group oriented setting; 
- find weaknesses with regards to the usage of pseudorandom generators in 
the Lim-Lee schemes (in the RSA based scheme, one implementation is even 
insecure w.r.t. known ciphertext only attack); and 
- make heuristic recommendations on potential improvements of the Lim-Lee 
El Gamal based encryption scheme, strengthening the bindings between ci- 
phertext portions of the scheme. 
1.1 Chosen ciphertext security 
For many years, no public key system [DiffieHellman76] was shown to be secure 
under a chosen ciphertext attack. Indeed, Rabin’s scheme [Rabin79] which wm 
proven to be secure under chosen message attack and a dense message space 
shown, in fact, to be strongly insecure with respect to chosen ciphertext attacks. 
Thus, the question of how to design or prove security against such attacks wm 
open for a while. 
Provably secure chosen-ciphertext secure systems : 
The first solution for such systems was given in [NaorYungSO] which presented a 
public key cryptosystem secure against chosen ciphertext attack based on zero- 
knowledge non-interactive proof systems and probabilistic encryption. Chosen 
ciphertext attack formalizes the situation where the adversary (say, an operator 
of the decryption equipment in a company) as part of the attack obtains the 
decryption equipment and is allowed to sequentially query it as a black box (an 
input-output oracle). The system is said to be secure under a chosen ciphertext 
attack if the attacker cannot decrypt a new message. This is also known as the 
“lunch break attack”, “midnight-attack” or “querying-only attack” . The names 
visualize the situation where the supervisor is out of the office (for lunch) and 
the attacker is using the opportunity to play with the equipment over the break 
but it has no meaningful ciphertext in its possession (as the supervisor has put 
relevant documents in a safe and suspended communication). 
Strengthening this attack is possible: an “adaptive attack” is one where the 
attacker gets to query the decryption equipment also after receiving the mean- 
ingful ciphertext that the attacker wishes to open. However, the attacker is not 
289 
allowed to query the machine with the target ciphertext. This can be visualized 
as an “equipment testing available-ciphertext attack in which the attacker (a 
technician) who now can have access to a meaningful ciphertext it tries to 
understand. The technician is allowed to test the equipment in front of the su- 
pervisor, yet the attacker should query the machine with other messages (which 
look seemingly harmless to the supervisor overlooking the testing). That is, in 
this attack the adversary may ask queries based on the ciphertext it wants to 
decrypt but not the ciphertext itself. In [DoDwNaSl] a system secure against 
adaptive chosen ciphertext attack was given as part of “non-malleable cryptog- 
raphy”. Also [RackoffSimonQ1] gave a solution to such an attack assuming a 
stronger setting where the sender (the technician) who queries the machine also 
has a personal public key known to the decryption machine. 
Practical chosen-ciphertext secure sgsterns : 
The above theoretical methods employed the impractical non-interactive zero- 
knowledge proof systems. This motivated the study of practical immunization 
methods by somewhat simulating what is achieved by the theoretical methods. 
First [DamgardQl] suggested a practical approach (against the operator adver- 
sary), then [ZhengSeberry92] claimed a system that is secure even against adap- 
tive chosen ciphertext attacks (the technician adversary). They also showed that 
the scheme of [Damgardgl] does not withstand such attacks. Under a very strong 
assumption about a cryptographic hash function being as good as a random or- 
acle a method like theirs has been validated to be secure [BellareRogaway93]. 
Finally, [LimLee93] suggested public key schemes which they claimed to be se- 
cure against the (technician) adaptive attack as well. They also demonstrated 
some problems with the methods of [ZhengSeberrySP]. Then they further Bug- 
gested that their immunization technique works in the context of group-oriented 
cryptography [DesmedtFrankelSS] where the cryptographic power to decrypt is 
shared amongst a multiple of agents. 
Immunization methods against chosen ciphertext attacks attempt to entangle 
cryptographic operations and introduce dependencies among them so that it may 
be easy to be convinced that the party which has generated the ciphertext, indeed 
must have known the cleartext and thus could not have abused the system as it 
must have known the result of its query to begin with. This is the spirit of the 
theoretical work. 
We would like to remark that the work by [LimLee93] certainly teaches us 
desirable properties of a practical chosen ciphertext public key. They do point 
out certain problems with previous schemes and describe how a scheme for the 
group-oriented case should work. In fact for this purpose they advocate a valid- 
ity check which is based on the ciphertext and not on the recovered plaintext; 
which is a true statement. In short, we feel that their analysis is valuable. In their 
arguments they follow the above direction of thinking by simulating the theoret- 
ical approach. It would have seemed that it is plausible to argue that due to the 
computational relationships within the ciphertext gram, the attacker cannot gen- 
erate something new based on the available information without actually starting 
from a known cleartext message. Its information being past answers to queries 
290 
and, in the adaptive attack - the available ciphertext challenge. In fact this is 
what [LimLee93) argue, and they further give additional claims about “semantic 
security” (i.e., all bits are secure based on a hard problem [Gold.wMicali84]) and 
that certain approaches to breaking the method do not work. Nevertheless, we 
show that such general arguments should be taken with a grain of salt, and there 
are ways to abuse the system even when the queries must have portions which 
look quite dependent on each other and the plaintext message, and even if in 
addition weaker attacks seem not to be successful. 
1.2 Organization of paper 
In Section 2 we discuss the necessary background for the paper. The Lim-Lee 
RSA based scheme is cryptanalyzed in Section 3, and the El Gamal based scheme 
is broken in Section 4 under the group-oriented cryptography setting. In Sec- 
tion 5 we discuss inherent weaknesses in their use of pseudo-random generators. 
Potential improvements and conclusion are given in Section 6. 
2 Background 
Not at ion: 
Throughout this paper we denote 1x1 as the length of the string x and ~111x2 ae 
the concatenation of the string XI with string x2. 
Let G(x1, xa) denotes an X I  bit output sequence produced by cryptographi- 
cally strong pseudorandom generator on a seed 2 2  and let h(x) denote the output 
of a cryptographically secure hash function on a string z. 
Attacks: 
We consider “adaptive chosen ciphertext attacks” when the adversary is able 
to make queriea to a decryption oracle based on but different from a target 
ciphertext. We say that an attack is successful if, for a large enough fraction of 
the cases, the attacker is able to recover the ciphertext after the attack. Namely, 
for a large portion and appropriate choice of system’s parameters (as specified 
by the designer), the attacker can be successful. A strong attack, is one that 
every ciphertext (not only a fraction of them) can be recovered. 
Group- Oriented Cryptography: 
Let us give a brief description of group-oriented cryptosystems in our public key 
decryption setting. Group oriented cryptosystems, also called threshold cryp- 
tosystems, were developed a8 a method to distribute the decryption process 
amongst a multiple of individuals in order to provide a decryption mechanism 
in which no single person is trusted [Desmedt87, DesmedtFrankel89]. In such a 
scheme, the decryption key is initially distributed to a number of agents and 
each agent is given a partial key. When an encryption is received by the group, a 
quorum of agents is available to apply its partial keys. The results of the partial 
keys applied to the ciphertext are called partial results. These partial results are 
then combined by a polynomial time algorithm into the final decryption result. 
291 
No security is placed in the combining function (it can be a public server or 
available agent). 
As long as a less than a threshold of agents is attacked by an intruder that 
reads their memory the system remains secure (the intruder does not have a c c ~ 8  
to a threshold of the partial keys). A successful chosen ciphertext attack on 
a group oriented cryptmystem allows the adversary access to the combining 
function (as it is a public function with no security requirements put on it) and 
access to leas than a threshold of the partial keys. Then, the attacker is given the 
allowed information, he is allowed queries, and it attempts to break the system. 
Lim and Lee provide important insight on why group oriented cryptosystems 
axe particularly prone to chosen ciphertext attacks [LimLee93]. 
3 Breaking the Lim-Lee RSA based scheme 
First let US review the details of their RSA based scheme. 
be the private exponent of the RSA encryption scheme [RSA78]. 
For user A let eA be the public exponent, NA be the public modulus and d~ 
Encrypt ion: 
The ciphertext for a message rn is C = (co, ci, cz) where: 
- c1 = s3"* mod NA where 8 ER (1,. . .NA - 1) 
- cz = z @ rn where z = G(lrn1, s) 
- co = s3.H mod NA where H = h( ci I Icz) 
Decrypt ion: 
To decrypt C = (co ,  cl, c2) .  
- Verify that c:'"" = cr' where H' = h(clllcz); return NULL if false 
- Compute z = G(l.21, s) where s 
- Return r @ c p  
~ ( 1 1 ' ~ ) ' ~ ~  mod NA 
Note that the ciphertext was generated by encrypting the seed s, employing 
the seed for encryption (stream cipher) and encrypting a one-way integrity cer- 
tificate of the two fields. This seems to be a strong binding of the seed and the 
clear tex t . 
We now break the Lim-Lee RSA based encryption scheme. 
Theoreml. The Lim-Lee RSA based encryption scheme can be broken using 
an adaptive chosen ciphertezt attack. 
Proof. We first describe the attack and then show that the adversary is successful 
with sufficient probability. 
Observe using the Extended Euclidean Algorithm that there exist integers 
u, u such that eA u + H . u = gCd(eA, H). Since e A  is public and H can be 
292 
computed from publicly known values c1 and c2, the values of u and v can be 
generated in polynomial time. Then if gcd(eA, H )  = 1, the attacker is successful 
and it can compute s3 cr . cz mod NA. The attacker, when successful, can 
simply send the oracle the ciphertext C' = ( s " ~ " ,  c1,O ) where H" = h(clll0 ) 
and 0 is a string of all zero bits of length 1 ~ 2 1 .  To complete the attack notice 
that the oracle will pass the verification step and return z = G(lc21,~). 
It is now shown that the adversary succeeds with a large enough fraction 
of the ciphertexts. Using [Apostol76, Thm 3.91 with probability about 5 the 
gcd(eA, H) = 1 1 mod $(NA). In this estimate we assumed that the public 
exponent has been chosen at random and that H is almost random, since h as a 
strong cryptographic hash function - has an almost-random output distribution. 
In case when eA is chosen BS a constant (e.g., 3 is a popular choice for a globally 
chosen exponent) then the probability of a random number in the range being 
relatively prime can be estimated as the constant (e.g., for exponent 3) 
as the range of the function h is quite large. 0 
4 Attacks on the El Gamal based scheme 
First let us review the details of the Lim-Lee El Gamal based scheme. 
Let Q be a generator for GF@) where p is a large prime. For user A let 
YA G aXA be the public exponent, and ZA be the private key of the El Gamal 
encryption scheme [ElGama185]. 
Encryption: 
The ciphertext for a message rn is C = (c1, c2, c3, c4) where: 
- cg G a'o where ro E R  (1,. . . , p -  1)  
- c1 =arl where r1 E R  {1, . . . , p -  1) 
- cz = t CB m where z = G( Iml, 92 CO) 
- c4 
- c3 = ~(collc2) 
rg + ~ 3 ~ 1  mod p - 1. 
Decryption: 
To decrypt C = (c1, c2, c3, cq). 
- Verify that c3 = h(ckIIcz) where ck 
- Compute z = G ( l c ~ l , s )  where s = c~"d'modp 
- Return z $c2 
a c 4 ~ ; c s ;  return NULL if false 
4.1 Cryptanalyzing the group-oriented setting 
Lim and Lee discuss the case of using this scheme for group-oriented cryptogra- 
phy. In this case, we secretly share the private exponent and we need a secret 
sharing scheme to do it. Thus, what is generally needed is to make sure that 
the generator works in a field (or module), so assume p - 1 = wq where w is 
293 
small and q is a prime and choose the generator a above to be in GF(q), simi- 
larly the choice of exponents rg and r1 (see [DesmedtFrankel89]). Otherwise, the 
description stays the same as above. 
With the group-oriented setting the decryption agents verify the hash value 
(the first step in the decryption process) individually, before they jointly compute 
s. This is an important property for group-oriented decryption as [LimLee93] 
suggest. To compute s, an agent uses its share of the private key ZA and ci to 
get its partial result. A threshold of partial results can be interpolated to get 
the result c:”. Now s can be computed given 4. If the verification process is 
successful with a different ciphertext, then a random seed unrelated to s should 
be generated. We demonstrate that this is not the case and in fact one can attack 
the system. 
Theorem2. The Lim-Lee El Gamal based encryption scheme an the group- 
oriented setting can be strongly broken using an adaptive chosen ciphertext at- 
tack. 
Proof We only need to prove that an attacker can generate an s’ related to the 
s of a given ciphertext and recover s itself. 
The attacker can generate a ciphertext C’ = (c; f c1 . a mod p, c2, c3, C: 
TO + CgTl + c3 mod q )  and provide it to the oracle. Observe that the verify step 
will be accepted since cg remains the same and cb cg modp. The seed gen- 
erated in the decryption step will be s’ = (arl+l)cAcb f (arl+l)dAco. Thus 
s s ’ (aZA) - ’  mod p. 
To finish the proof we note that one agent (or combiner server) will receive the 
information needed in order to calculate s’ and therefore can generate s. That 
person (server) can generate C’ and be successful in performing the adaptive 
chosen ciphertext attack. 0 
5 Cautions on the use of pseudorandom generators 
Pseudorandom number generators do not necessarily exhibit the strength to 
withstand attacks, when correlated seeds can be generated or when the seed is 
poorly encrypted. Lim and Lee suggest to use generators like [AleChGoSch88] 
as possible pseudorandom generators. They specifically say that this is a good 
choice since these generators rely on the same (RSA) assumption as the cryp- 
tosystems and there is no need for further tools. They claim their system is 
semantically secure (that is, all encrypted bits are secure). However we show 
that the opposite is true and, in fact, this choice may be quite bad due to an 
algebraic interplay between the generator and the insecurity of the seed encryp- 
tion. 
Claim 1 The Lim-Lee RSA based scheme when used with the RSA based pseu- 
dorandom generator of [AleChGoSch88] with exponent being 9, is  insecure with 
respect t o  a 4 n o w n  ciphertext” only attack. 
294 
Proof. From Theorem 1 an attacker can determine s3g where g = gcd(eA,H). 
Therefore, as argued, the attacker is able to determine, s3 with good probability. 
Now using [AleChGoSch88] with the RSA function with exponent 3, the pad used 
in the encryption comprised of the concatenation of least significant bits of s, 
ss modn, (6")" = s9 modn , (ag)" = sZ7 modn , and so on. Knowing ssl in 
0 
Note again that the attack above did not employ any access to the device 84 
an oracle, it waa a pure known ciphertext attack. Encryption exponent being 3 
(as in the generator) is a popular choice, since it provides the fastest modular 
exponentiation for RSA. 
In addition we can also point out that Theorem 2 tells us that an attacker 
can generate outputs from the decryption functions baaed on seeds related to 
the original seed used to encrypt the meaningful ciphertext (i.e., the original C 
being attacked). Therefore we deduce that: 
Corollary3. The Lim-Lee El Gamal based encryption scheme has a weakness 
when attacked by an adaptive chosen ciphertext attack - the attacker can correlate 
the seeds of the various ctphertexts. 
turn, gives all the bits but the first one, since exponentiation is easy! 
6 Conclusion and Discussion 
The work of [LimLee93] discusses immunized public key encryption systems. 
It shows problems with previous such systems, and carefully discusses original 
requirements and designs of the first group-oriented such systems. We found 
their design goals, criticism of previous systems, discussions, methodologies, and 
some of their efficient techniques highly valuable. 
On the other hand, we presented cryptanalysis of and security problems with 
the actual schemes of [LimLee93]. We showed that one can generate relations in 
a meaningful way even if it does not seem 80 or even if the ciphertext gram 
is partially authenticated by a hash function. We showed that in the case of 
group-oriented cryptography, the availability of partial results in the combiner 
may enable strong attacks (in the original schemes no trust waa put in any single 
point and surely not in the combining stage), We also showed potential problems 
with the usage of a single key and the same algebraic problem for more than one 
task in a cryptosystem. 
6.1 
It seems difficult to modify the Lim-Lee El Gamal based scheme so that it is 
strong as the Diffie-Hellman problem due to the value c4 in the ciphertext. That 
is, due to the way c4 is generated, we do not see how opening up ciphertext c 
reduces to breaking the Diffie-Hellman problem. 
Potential improvements to the scheme 
We make the following preliminary suggestions to improve their El Gamal 
scheme. 
295 
(1) The function G should be a pseudorandom function rather than a pseudo- 
random number generator where s comprises of two values: a function index 
and an input value for that function. (In practice it is a block cipher opera- 
tion). This, heuristically, will reduce the relation between ciphertext grams, but 
it may make the computations less efficient, though. In fact a random function 
based on generators built on a totally different algebraic problem than the seed 
encryption is preferable (e.g., one based on DES or triple-DES) to disentangle 
potential algebraic dependencies that may ease cryptanalysis. 
( 2 )  The value cg should be h(coIIclllca) instead of h(co1lcz); it is preferable that 
again this hash function should not be baaed on the same algebraic problem aa 
the other encryption mechanisms. The type of bindings in the resulting “cipher- 
text gram” above has been recently formalized and a suggestion for immunized 
RSA based system has been shown as well in [F’ranklinReiter95]. 
(3) At some point in their work, Lim and Lee suggest to also include in the 
preimage of h in cg information like date and other related information under the 
hash function. We remark that, in doing so, one has to be careful not to introduce 
unstructured redundancy which may enable potential “birthday” attack on this 
ciphertext validation component by playing with the additional information. 
(4) Finally, when claiming security against chosen ciphertext attacks, the claims 
that the system is semantically secure and that it seems that the sender knows 
the cleartext from the ciphertext structure are not enough. Also, having a key 
perform different functions may be dangerous. We feel that the following two 
things better be done carefully when designing a chosen-ciphertext system based 
on heuristics. First, it may be a good idea to attempt to prove chosen ciphertext 
security under certain (strong, if not necessary known or widely assumed) prop- 
erties of the tools used. Second, it is also useful to extensively characterize how 
the attacker may have produced the ciphertext or what may be easily computed 
from it, and given a ciphertext what ciphertexts can be computed adaptively 
from it (as the quality of the system against adaptive chosen ciphertext attacks 
relates directly to how the designers capture this fact in their arguments). 
A natural open problem is designing a chosen ciphertext system which is 
practical and proven secure (e.g., as secure a8 El Gamal or RSA). 
References 
[AleChGoSch88] W. Alexi, B. Chor, 0. Goldreich and C. P. Schnorr, RSA and 
Rabtn functions: certain parts are as secure as the whole, SIAM 
J. Computing vol. 17 (2). 1988. 
T. M. Apostol Introduction to analytic number theory, Springer- 
Verlag, New York, 1976. 
M. Bellare and P. Rogaway, Random Omcles are Pmctical: a 
pomdigm for designing eficientprotocols, ACM, l-st Comp. and 
Corn. Sec. 1993. 
[Apostol76] 
[BellareRogaway93] 
296 
[DamgardSl] 
[Desmedt87] 
[DesmedtFrankel89] 
[DiffieHellman76] 
[ DoDw Nag11 
[ElGamal85] 
[FranklinReiter95] 
[GoGoMi86] 
[Gold w Micalit341 
[ LimLeeg31 
[NaorYungSO] 
[Rabin79] 
[RackoffSimon9 11 
[RSA78] 
[ ZhengSeberry921 
I. DamgBrd, Towards practical public key cryptosysterns se- 
cure against chosen ciphertext attacks, Advances in Cryptology- 
Proc. of Crypto '91. 
Y. Desmedt, Society and group oriented cryptogmphy: a new 
concept, Advances in Cryptology, Proc. of Crypto '87, Springer- 
Verlag, 1988. 
Y. Desmedt and Y. Frankel, Threshold cryptosystems, Advances 
in Cryptology, Proc. of Crypto '89 Springer-Verlag, 1990. 
W. Diffie and M. Hellman, New Directions in Cryptogmphy , 
IEEE Trans. on Information Theory 22 (6), 1976, pp. 644-654. 
D. Dolev, C .  Dwork and M. Nmr, Non-Malleable Cryptography, 
Proc. of the 23rd Annual ACM Symposium on the Theory of 
Computing, 1991, pp. 542-560. 
T. El Gamal, A Public key cryptosystem and a signature scheme 
based on discrete logarithm, IEEE Trans. on Information Theory 
M.K. Franklin and M.K. Reiter, Adaptive Chosen Ciphertest Se- 
curity for RSA from G-Q Signatures, Preliminary manuscript. 
0. Goldreich S. Goldwasser and S. Micali, How to Construct 
Random Functions, J. of the ACM 33 (1986), pp. 792-807. 
S. Goldwasser and S. Micali, Probabilistic Encryption, J. Com. 
Sys. Sci. 28 (1984), pp 270-299. 
C. H. Lim and P. J. Lee, Another method for attaining secu- 
rity against adaptive chosen ciphertext attacks, Advances in 
Cryptology-Proc. of Crypto '93. 
M. Naor and M. Yung, Public-key cryptosystem provably secure 
against chosen ciphertezt attack, Proc. of the 22nd Annual Sym- 
posium on the Theory of Computing, 1990, pp. 427-437. 
M. 0. Rabin, Digital Signatures and Public Key Functions as In- 
tractable as Factoring, Technical Memo TM-212, Lab. for Com- 
puter Science, MIT, 1979. 
C. Rackoff, and D. Simon, Non-Intemctiwe Zero-Knowledge 
Proof of Knowledge and Chosen Ciphertest Attacks, Advances 
in Cryptology- Proc. of Crypto '91. 
R. Rivest, A. Shamir and L. Adleman, A Method for Obtain- 
ing Digital Signature and Public Key Cryptosystems, Comm. of 
Y. Zheng and J. Seberry, Immunizing public key cryptosystems 
against chosen ciphertezt attacks, IEEE Jour. on Selected Areas 
in Communications, 11(5), 1993, pp. 715-724. (Also in: Advances 
in Cryptology-Proc. of Crypto '92). 
31, 465-472, 1985. 
ACM, 21 (1978), pp 120-126. 
	Cryptanalysis of the Immunized LL Public KeySystems
	Introduction
	Chosen ciphertext security
	Organization of paper
	Background
	Breaking the Lim-Lee RSA based scheme
	Attacks on the El Gamal based scheme
	Cryptanalyzing the group-oriented setting
	Cautions on the use of pseudorandom generators
	Conclusion and Discussion
	Potential improvements to the scheme
	References