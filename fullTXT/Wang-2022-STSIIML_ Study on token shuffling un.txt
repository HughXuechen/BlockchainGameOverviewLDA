STSIIML: Study on token shuffling under incomplete information based on machine learning
Received: 7 July 2022 | Accepted: 10 August 2022
DOI: 10.1002/int.23033
RE S EARCH ART I C L E
STSIIML: Study on token shuffling under
incomplete information based onmachine
learning
Yilei Wang1 | Tao Li1,2 | Ming Liu2 | Chunmei Li2 |
Hui Wang3
1State Key Laboratory of Public Big Data,
College of Computer Science and
Technology, Guizhou University,
Guiyang, China
2School of Computer Science, Qufu
Normal University, Rizhao, China
3School of Social Sciences, University of
Ulsan, Ulsan, Korea
Correspondence
Tao Li, State Key Laboratory of Public
Big Data, College of Computer Science
and Technology, Guizhou University,
Guiyang, China.
Email: litao_2019@qfnu.edu.cn
Funding information
National Natural Science Foundation of
China, Grant/Award Number: 62072273;
National Natural Science Foundation of
China, Grant/Award Number:
72111530206; National Natural Science
Foundation of China,
Grant/Award Number: 61962009;
National Natural Science Foundation of
China, Grant/Award Number: 62162008;
Foundation of State Key Laboratory of
Public Big Data, Grant/Award Number:
PBD2021‐04; Foundation of Guizhou
Provincial Key Laboratory of Public Big
Data, Grant/Award Number:
2019BDKFJJ009
Abstract
Transaction data on the public chain is open and
transparent to all participants, which poses a poten-
tial threat to the privacy of participants. Some
privacy‐conscious token holders want to employ
obfuscation methods to protect the origin and
destination of their tokens, and the need for token
shuffling services (TSS) arose at a historical moment.
The prevailing token shuffling policies rely too
heavily on blacklists in the token shuffling process,
which is contrary to the idea of decentralization.
Therefore, weakening or even eliminating the usage
of blacklisting mechanisms in TSSs, which is an
urgent issue to be addressed. In this paper, we adopt
the idea of machine learning and propose a general
framework for TSSs, which replaces the natural role
under incomplete information with machine learn-
ing, so as to achieve the goal of eliminating the
blacklist mechanism in TSSs. Then, the token
shuffling process is constructed as an extended game
under incomplete information on the basis of differ-
ent token shuffling policies, and this incomplete
information game is analyzed on the basis of poison
policy, haircut policy, and suicide policy respectively.
Finally, the sequential equilibrium under different
games is investigated through simulations. The
Int J Intell Syst. 2022;37:11078–11100.wileyonlinelibrary.com/journal/int11078 | © 2022 Wiley Periodicals LLC.
http://orcid.org/0000-0002-1602-3720
http://orcid.org/0000-0002-1448-3619
http://orcid.org/0000-0002-4655-782X
http://orcid.org/0000-0002-1397-1215
mailto:litao_2019@qfnu.edu.cn
https://wileyonlinelibrary.com/journal/int
http://crossmark.crossref.org/dialog/?doi=10.1002%2Fint.23033&domain=pdf&date_stamp=2022-08-26
simulation results show that in the incomplete
information game based on the poison policy, the
participation of two players in the TSS is a sequential
equilibrium, while in the incomplete information
game based on the haircut policy, the players do not
participate in the TSS is an sequential equilibrium.
KEYWORD S
blockchain, incomplete information game, machine learning,
token shuffling service
1 | INTRODUCTION
Transaction records of blockchain systems are open and transparent to all participants, which
facilitates the verification of transaction data, but also poses challenges to the anonymity of the
system.1 In the case of the bitcoin system, sending bitcoin is one of the core elements of the
transaction, which is reflected in the fact that bitcoins are sent from one or several addresses to
another or several addresses. To maintain the anonymity of the bitcoin system, the addresses in
it do not correspond to the users one by one. However, researchers have found that publicly
available transaction records are susceptible to social engineering analysis and the launching of
specific types of attacks2,3 by participants with ulterior motives to gain access to certain
information. The association between addresses and users makes the bitcoin system no longer
completely anonymous.4,5
This pseudo‐anonymity exists in many blockchain systems represented by the bitcoin
system. To help some participants with a high demand for anonymity to avoid having their
addresses and identities associated with malicious participants and thus better hide their
identities, token shuffling services (TSSs) have been created.6 This emerging service maintains
the decentralization characteristics of the blockchain system, whose original intention is to
improve the privacy and anonymity of participants and increase the difficulty of tracing their
flow of funds. However, such service inadvertently provides a paradise for illegal activities
represented by money laundering,7–9 and criminals are quick to capture the advantages offered
by TSSs and often leverage them to launch attacks against digital cryptocurrencies for their own
illegal purposes.
It is precise because the existing TSSs have varying degrees of defects, which pose a
threat to the security of the TSSs. In recent years, researchers have proposed various
cryptographic solutions10,11 in different dimensions to address the security threats of such
services and to improve the quality of service and participant experience. Introducing the
supervisor and updating the blacklist maintained by it,12 to a certain extent, curbs the
malicious behavior of the participants. This measure provides an effective deterrent method
for participants to maintain restraint during the transaction process to ensure that the
legitimate rights and interests of legitimate participants are not compromised by criminals.
Blacklisting can also ensure that legitimate participants' token quality will not be
significantly reduced in the TSS, that is, the number of bad tokens in their hands will
not be significantly increased.13
WANG ET AL. | 11079
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
1.1 | Related works
1.1.1 | Token shuffling service
In 2013, Maxwell proposes the famous CoinSwap14 scheme, which introduces a trusted third‐
party to ensure both parties to a transaction obfuscate their bitcoin in an anonymous manner.
This method of obfuscation is so similar to the shuffling process of playing cards that this paper
refers to it as a TSS. The introduction of trusted third‐party seriously weakens the
decentralization characteristics, which also brings many obvious drawbacks, such as collusion
between a third‐party and counter party, single point of failure, and distributed denial of service
(DDoS) attacks, and so on. To maintain the characteristics of decentralization, CoinShuffle,15 a
completely decentralized token shuffling service solution is proposed, whose design is inspired
by the accountable anonymous group communication protocol CoinJoin.16 In this scheme,
participants check whether a token shuffle transaction is in their interest before signing it. If
someone refuses to sign the transaction, this may cause problems such as denial of service
(DoS) attacks. One of the advances of the TSS in 2015 is reflected in the improvement of the
CoinShuffle scheme. Selij17 studies the anonymity effectiveness of CoinShuffle transactions in
the blockchain system, and improves them to make CoinShuffle transactions more difficult to
detect. In the same year, Ziegeldorf et al.6 propose the CoinParty scheme, a more novel and
efficient TSS. Although it cleverly introduces decrypted hybrid network and threshold
signatures, the CoinParty solution does not solve the problem of refunding funds when the
shuffling party gose offline. Since 2018, the token shuffling scheme for the Ethereum ecosystem
has become one of the hot research topics. The Möbius scheme18 can be seen as the first
trustless token shuffler for Ethereum. In the same year, Liu et al.19 propose an unlinkable token
shuffling scheme based on ring signature and elliptic curve digital signature algorithms to
better hide token transfer between different addresses. In 2019, MixEth, a scheme based on the
Ethereum system, is proposed by Seres et al.20 This solution provides a trustless TSS for a
Turing‐complete blockchain system. Not only is it highly anonymous, but it is also effective
against DoS attacks. Almost all of the above‐related work has studied the shuffling mechanism
from the perspective of defending against attackers and enhancing privacy. However, there may
also be some variation in the quality of the tokens held by the participants of the shuffling
transaction.
1.1.2 | Blacklist
The blacklist mechanism was first introduced into the research of TSS by Abramova et al.21
They utilize game theory22 to investigate how the anonymity of participants can be further
enhanced by the qualitative differentiation of tokens in the token shuffling process. In their
proposed scheme, they discuss both complete and incomplete information and further analyse
three different quantity propagation policies such as Poison, Haircut, and Seniority. However,
as their scheme does not update the blacklist in a timely manner, some participants could inject
bad tokens that have not been marked on blacklist, which poses a challenge to the fairness and
security of transactions. In fact, in most scenarios, TSS should be reduced to the gaming
behavior under incomplete information. Liu et al.23 study the impact of token quality on illegal
behaviors such as money laundering under incomplete information and discuss how to
effectively model illegal behaviors. Wang et al. propose a new quality propagation policy called
11080 | WANG ET AL.
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
Suicide on the basis of Seniority,24 and introduce a deposit mechanism in the quality
propagation policy to regulate the behaviors of participants in TSSs. Selij17 extends the poison
and haircut strategies to games with incomplete information and updates the blacklist in time
after shuffling to improve the reliability of the blacklist. Yu et al.25 introduce linear
programming to improve the suicide strategy and propose a new strategy called ImpSuic which
utilizes linear programming to help participants predict the maximum utility of shuffled tokens
and improve their ability to shuffle tokens before making a decision, which are more beneficial
for them to enhance their experience of participating in the service.
1.2 | Motivations and contributions
In this paper, we take the example of a central node‐based token shuffling process in which
participants send their tokens in turn to a third‐party who scrambles the received tokens and
forwards them. Eventually, the third‐party node sends the amount specified by the sender to the
corresponding destination address in turn.26 As transactions recorded on the blockchain are
traceable,27 the TSS somewhat blocks the association between the input and output addresses
corresponding to the transactions, which makes the connection between the two addresses
separated and thus untraceable. Nevertheless, there are attacks in the blockchain system,28 and
although researchers have tried to circumvent the attacks using some cryptographic means to clean
up the token shuffling environment, especially in the big data environment,29 malicious users30,31
may use the functionality of TSSs to engage in some illegal activities, which leads to a high risk of
some users (especially honest ones) obtaining illegal tokens after token shuffling process.
Nowadays, most token shuffling policies are based on blacklists given by authoritative
organizations to prevent money laundering.32 Unfortunately, there is a time lag between the
moment an illegal act occurs and the moment when an illegal transaction is added to the blacklist.
Accordingly, although we use a blacklist to prevent illegal behavior during the shuffling process, we
will still inadvertently accept bad tokens during the above time interval mentioned above. That is,
blacklisting is not a substitute for existing antimoney laundering measures. In general, it is
beneficial to the users of the TSS to estimate the quality of the tokens.
Although the credibility of preventing bitcoin money laundering through blacklisting is
extremely high, the timeliness is very low. Therefore, this paper will bypass the blacklist and
implement token shuffling policies, but this inevitably involves the quality of token injected
into the TSS. To this end, we leverage the ideas of machine learning to evaluate and classify
the quality of shuffled tokens, performing a function similar to a blacklist. While solving the
problem of untimely updating of the blacklist, the results have a high degree of confidence.
The main contributions of this paper are as follows:
1. We propose a generic framework for TSS in which a machine learning model is used to
replace the role of a blacklist. In this paper, we construct the token shuffling process as an
extended game under incomplete information and then find sequential equilibrium of three
token shuffling propagation strategies.
2. In the token shuffling process, we use the idea of Naive Bayes and publicly available money
laundering data set for training and learning to obtain a machine learning classifier, which
participants in the TSS use to predict the quality of other participants' tokens before deciding
whether to trade with them in the TSS. This will also go some way to discouraging illegal
practices such as "money laundering.”
WANG ET AL. | 11081
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
3. This paper also simulates and analyses sequential equilibrium under different games. The
simulation results show that in the incomplete information game based on the poison policy,
the shuffling of the two partners is a sequential equilibrium, while in the incomplete
information game based on the haircut policy, the players do not shuffle their tokens is a
sequential equilibrium.
1.3 | Road map
The rest of this paper is organized as follows. Section 2 introduces some basics such as token
quality and token propagation policies, machine learning, and incomplete information game
and signaling game. Section 3 briefly introduces the general framework of TSS and the
construction of machine learning models. Section 4 is the detailed analysis and demonstration
of the incomplete information game scheme. Section 5 is the simulation experiment. Section 6
is a conclusion and the future work.
2 | PRELIMINARIES
This section briefly introduces the basic content of token quality and token propagation
policies, machine learning, and the incomplete information game and signaling game.
2.1 | Token quality and token propagation policies
Since TSS allows multiple participants to join together, there is no way to distinguish precisely
whether the tokens sent to a third party by a participant in a TSS are legitimate tokens, that is,
there is no way to guarantee the quality of the tokens after the TSS. If participants inject good
tokens into the service, then the quality of the tokens will be good after the TSS. However, if a
malicious user takes advantage of the TSS and injects illegal tokens along with other
participants' legitimate tokens into the TSS, this will result in a decrease in the quality of the
tokens after the TSS for honest participants.
The token shuffling process can be performed through a trusted third‐party, or a protocol,
such as the CoinJoin protocol, can be used instead of a trusted third‐party. That is, there are
central token shuffling policies and decentralized token shuffling policies.33 There are currently
three popular shuffling policies shown as follows:
1. Poison policy. Suppose initiator A, whose tokens are of good or bad quality, and responder
B, whose tokens are all of good quality. When B agrees to participate in the transaction request
sponsored by A, at this point, A will put a deposit da in the smart contract. When B predicts the
quality of A's tokens, if at least one of those tokens is found to be bad, this TSS will cause all
tokens involved in the obfuscation to become blacklisted bad tokens and B will receive the
deposit da in the smart contract.34
2. Haircut policy. The haircut policy requires the output of each transaction
to be devalued in proportion to the blacklisted tokens in the total number of tokens
invested in that transaction.24 Under the poison strategy, where B blindly participates in
the TSS sponsored by A without assessing the quality of A's tokens, B is bound to have
a loss.
11082 | WANG ET AL.
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
3. Suicide policy. The suicide policy is aimed at malicious users utilizing TSS for illegal
activities such as money laundering. The aim is to prevent illegal activities from occurring
during the legitimate token shuffling process. When the tokens held by each of participants A
and B contain a certain percentage of bad tokens, the suicide strategy will mark all the tokens
held by the participant with a high percentage of bad tokens as “bad tokens” and add them to
the blacklist. In the meantime, the deposit in the smart contract cannot be refunded. For the
party with a small percentage of bad tokens, all his tokens will be recorded as “good tokens.”24
The suicide strategy provides that the rules for updating the quality of tokens on both sides after
the shuffle token transaction is completed are described in Section 4.
2.2 | Machine learning
Machine learning includes supervised learning with labels, unsupervised learning without
labels, and semisupervised learning. Each machine learning algorithm uses a different metric
to measure the eventual likelihood. But the essence of these indicators is a kind of “probability‐
like” representation. We can compress these metrics to between 0 and 1 through normalization
or sigmoid function, so that they indicate how certain our model is of the predicted outcome
(i.e., the confidence level). In any case, there is a desire for an algorithm that can measure
likelihood in terms of true probability, hence the probabilistic algorithm called Naive Bayes,
which belongs to the category of supervised learning with labels, and which can be used to
measure the probabilistic relationship between features and labels in a very straightforward
way.
The principle of the Naive Bayesian model (NBM) is to employ Bayesian formulas to
reasonably calculate the posterior probability based on knowing the prior probability of the
predicted object. That is, what is the probability value of the predicted object belonging to each
category. Then, the category with the maximum posterior probability is chosen as the category
to which the predictor belongs. Note that the Naive Bayesian formula has two default
preconditions. The first is that each feature is independent of each others, and its simplicity
implies independence of conditional probabilities. This assumption often does not hold in
practical applications, which has an impact on the correct classification of NBM. However, in
theory, the NBM has the lowest error rate compared to other classification methods. Second,
each feature is equally important. That is, the model considers that there is no dependency
between each feature. Naive Bayesian formula is as follows:
 
P A B
P A P B A
P B
( ) =
( ) ( )
( )
. (1)
The machine learning model in this paper also utilizes the Laplace correction method. First
of all, let us introduce why Laplace correction is needed. Because our sample data set is limited,
some values may not appear, which will result in a product probability of zero, which will
seriously affect our final classification results. The essence of the Laplace correction in the
model constructed in this paper is that instead of outputting the discrete probability values of
the sample classification results directly, the probability values are first smoothed, that is, all
features occur once by default.
Therefore, instead of a blacklist, we employ a machine learning algorithm to construct a
machine learning model that uses the probability that a sample may belong to a certain class as
WANG ET AL. | 11083
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
a basis for determining whether a token is a good or bad token. This enables respondent B of
the TSS to utilize this classification algorithm to analyze initiator A's token quality for the
probability of the presence of black money. For a detailed description, refer to Section 3.
2.3 | Complete and incomplete information game and
signaling game
1. Complete and incomplete information game. A complete information game is a game in which each
player knows the exact relevant information. But in reality, most of the problems we encounter are
incomplete information games. For example, when a company is exploring the beauty market for the
first time or when dealing with a stranger. Therefore, a game is said to be an incomplete information
game if the participants do not have all the relevant information about the game.
2. Signaling game. Signaling games are easy to understand and widely used as a type of
dynamic game with incomplete information, whose feature is that the players in the game are
divided into two types players which are signal sender and signal receiver, respectively. The
sender acts first by sending a type of information that is relevant to him, and the receiver then
chooses his own behavior in accordance with the information he receives.
3. Information set and sequential equilibrium. Intuitively, the elements of an information set are
one or more histories, which describe the complete path of a game tree from the head to some node.
The information set needs to satisfy the property that all histories in the same information set belong
to the same player, and that the actions that can be performed on these histories are the same.
Sequential equilibrium is an equilibrium concept for incomplete information dynamic games, which
requires that the combination of strategies of the players satisfies the laws of sequential rationality35
and weak consistency.36 Please refer to Section 4 for specific procedures.
3 | GENERAL FRAMEWORK OF TSS
The general framework of TSS consists of three parts, namely the machine learning
classification model part, the analysis part of incomplete information game on the shuffling
token propagation policy, and the sequential equilibrium part.
The basic flowchart of the generic framework for token shuffling is shown in Figure 1.
Before the TSS takes place, the responder can discern a probabilistic information value about
bad tokens based on previous transaction information through a machine learning model in the
first part, which in turn provides a prediction about the quality of the initiator's tokens. The
responder then further analyzes the probabilistic through the second and third parts and finally
decides whether to agree to participate in the TSS. The model employs a machine learning
model to weaken the role of blacklists and also solve the problem of untimely blacklist updates
while preventing illegal acts such as money laundering.
We have described the token shuffling propagation policies in Section 2.1, and will also
conduct experimental analysis of sequential equilibrium under different strategies in Section 5.
Therefore, our work in this section will focus on the construction of machine learning models
whose specific construction process is as follows.
The model proposed by this paper focuses on analyzing whether participants hold bad
tokens, employing a machine learning prediction approach, rather than the previous
blacklisting scheme. Since the blacklist is fixed and centralized, it is given by an institution,
11084 | WANG ET AL.
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
so there are two possible problems. First, the blacklist itself has been maliciously tampered
with. For example, staff in the institution, especially those with high‐level access, are involved
in money laundering or intentionally harming particular groups of people, which would reduce
the credibility of the blacklist. Second, blacklists are not updated in a timely manner due to the
time lag between the occurrence of an illegal act and the addition of an illegal transaction to the
FIGURE 1 Flow chart of the general framework of token shuffling [Color figure can be viewed at
wileyonlinelibrary.com]
WANG ET AL. | 11085
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
http://wileyonlinelibrary.com
blacklist, which can easily allow unscrupulous individuals to take advantage of it. Therefore,
replacing blacklists with machine learning models can fundamentally tackle the problem of
untimely blacklist updates.
We primarily use the idea of NBM and an existing money laundering data set for
classification training, resulting in a machine learning classifier model which is used to predict
whether the quality of the tokens is good or bad. The above classification process is divided into
three stages, and the specific process is as follows:
1. Data processing. We utilize a money laundering data set that is publicly available on the
Internet.32 There are five features in the data set, which are the transfer method (cash‐in
corresponds to 2 and transfer corresponds to 3), the source account number of the token, the
target account number of the token, the transaction amount, and the operation type, that is, 1 is
the presence of money laundering, while 0 is the absence of it. As shown in Table 1, 0–4
represent the above features respectively, and the last column is the predicted operation type.
We set up two steps in the machine learning model to process the data set. The first step is to
randomly shuffle the order of the data set and reorder it to get a brand new data set so that even
though we input the data set in the same order twice, the model will deal with a data set in a
different order twice. The second step is that we can adjust the parameter factors in the model
and randomly divide the data set into two parts, which are the training set and the test set,
respectively. If the parameter factor is 0.7, 70% of the data set is used for model learning, and
30% of the data set is used to test the accuracy of the model's prediction results.
2. Model prediction process. Participant B takes information about participant A's previous
transactions and feeds it into a trained model and outputs a prediction. This is the probability
that participant A is involved in illegal activities such as money laundering. Then, using the
discriminator in Figure 1, the probability that the user contains black money is determined.
Finally, based on the probabilistic information given by the model, participant B further
considers whether to engage in a transaction with A for TSS.
3. Model accuracy. Table 1 shows some of the predictions from our model. There are nine
rows of trading forecasts in the table, with five features and one forecast value per row. The
accuracy of the model after multiple runs is shown in Figure 2. It can be seen that the trained
model performs multiple runs with a prediction accuracy between 0.67 and 0.70. When the
TABLE 1 Partial prediction results
Num 0 1 2 3 4 Predict
0 3 45,645 35,270 335,249 1 0
1 3 414 84,965 5,983,503 1 1
2 3 6847 28,046 328,814 1 1
3 2 95,615 70,742 708,895 1 0
4 2 4161 76,270 249,082 1 0
5 3 13,541 86,616 7,259,213 1 1
6 2 83,352 25,201 1,111,902 0 0
7 3 80,621 35,270 335,249 1 1
8 3 40,037 73,055 361,845 1 1
11086 | WANG ET AL.
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
training and test data sets are different, the difference in accuracy is small, indicating that the
model is stable.
4 | SCALABLE GAMES
In this scheme, the private type of the participant is not determined by nature but is determined
based on the past transaction records of the participant by using the idea of machine learning.
In this way, it is more in line with the actual situation and avoids a series of problems caused by
unreasonable nature setting.
Furthermore, in comparison with our previous work,24 this paper does not employ
blacklists and we take into account the effect of beliefs on equilibrium. In comparison with
another our work,25 we take a game‐theoretic perspective, while the literature by Yu et al.25
takes a linear programming perspective.
Before describing the game, we give some general assumptions.
1. The game process in this paper contains two players, namely TSS initiator A (referred to as
participant A) and TSS responder B (referred to as participant B). Their token quality is qa
and qb, respectively, where token quality represents the proportion of good tokens held by A
or B. Once both parties reach the intention of TSS, both of them need to submit a certain
amount of deposits da and db. The deposit return rules vary according to different token
shuffling policies, and we will give them in the subsequent process.
2. Participants in the TSS can invest any amount of tokens, but for the sake of convenience,
this paper follows the approach of the literature by Wang et al.24 and Yu et al.25 and
assumes that both A and B inject one token into the TSS. If the TSS is successfully
completed, both parties still receive one token, but this one token may not be their
original token.
FIGURE 2 Model accuracy for multiple predictions [Color figure can be viewed at wileyonlinelibrary.com]
WANG ET AL. | 11087
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
http://wileyonlinelibrary.com
3. According to the literature Wang et al.24 and Yu et al.25 to encourage B to accept the TSS
request sponsored by A, A will give B a certain token reward c once B accepts the request,
which will result in a total amount of (1+c) for A's participation in the TSS.
4. For the anonymity requirement of TSS, this paper still uses the assumptions given in the
literature by Wang et al.24 and Yu et al.25 Because A is a token shuffling initiator, his
demand for anonymity is relatively high, which is assumed to be 1, while B is a token
shuffling receiver, and his demand for anonymity can be assumed to be τ < 1b . In other
words, once the TSS is successful, A's gain in anonymity is 1, while B's gain in anonymity
is τb.
5. TSS initiator A has two behaviors: Sponsor shuffling (SS) and not sponsor shuffling (NSS).
Once A sponsors a TSS, B has two options, which are accepting shuffling (AS) and not
accepting shuffling (NAS), respectively.
6. In incomplete information games, we usually call it the private type of a player, and nature
assigns the probability of which private type it belongs to. For brevity, this article assumes
that A has two private types. However, in this paper, we allow the recipient B to have an
initial assessment of the token quality of participant A through the machine learning
algorithm and use the algorithm instead of nature to assign the probability of a private type
to A. It should be noted that different policies have different private types of A. We describe
the private types of A in detail in a subsequent section according to different policies
respectively.
4.1 | Incomplete information game based on poison policy
Before describing the incomplete information game in detail, this paper first introduces some of
the token quality update rules and profit calculation rules involved in the game.
4.1.1 | The token quality update rules of the poison policy
The token quality update rules of poison policy are shown in Table 2.
4.1.2 | Participant private type
An update rule for the token quality of the poison policy is related to whether bad tokens are
included or not, and we do not care about the number of bad tokens included. Therefore, the
private type of B to A is defined as two types, which are denoted as including bad tokens (IB)
and not including bad tokens (NIB). With machine learning algorithms, it is possible to assess
whether participant A includes bad tokens in this shuffle, based on his previous transaction
TABLE 2 Quality update rules of poison policy tokens
q = 1b q = 0b
q = 1a
q q′ = 1, ′ = 1a b q q′ = 0, ′ = 0a b
q = 0a
q q′ = 0, ′ = 0a b q q′ = 0, ′ = 0a b
11088 | WANG ET AL.
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
records. We assume that the probabilities of IB and NIB predicted by utilizing a machine
learning algorithm are is β and β1 − , respectively.
4.1.3 | B's token quality distribution
Similar to A's token quality, B's token quality is also divided into two cases, which are IB and
NIB, respectively. Because A is the first mover in the incomplete information game, after he
chooses the behavior of S, he can no longer make a decision. Therefore, A's assessment of the
token quality of B does not work. We assume that the probabilities of B's private type of IB and
NIB are γ and γ1 − , respectively.
4.1.4 | Deposit return policy
According to the private types of A and B, there are four combinations (NIB, NIB), (NIB, IB),
(IB, NIB), and (IB, IB), where the former element of each combination represents the private
type of A, and the latter represents a private type of B. For the poison policy, we stipulate that if
the participant has no bad tokens in his TSS, his deposit will be returned, otherwise, his deposit
will be confiscated. The return and confiscation of the deposit are completed using smart
contracts. The specific rules are as follows:
* (NIB, NIB): Both A and B have no bad token, so both parties' deposits are returned.
* (NIB, IB): A has no bad token, B has a certain amount of bad tokens, returns A's deposit da,
confiscates B's deposit db, and gives db to A.
* (IB, NIB): A has a certain amount of bad tokens, B has no bad token, returns B's deposit db,
confiscates A's deposit da, and gives da to B.
* (IB, IB): Both A and B have bad tokens. According to the principle of literature,24,25 the
deposits of A and B are confiscated and returned to the other party, which is equivalent to
the exchange of deposits between both parties. The disadvantage of this method is that if
d d=a b, then it is equivalent to swapping deposits between A and B. For them, even if there
are bad tokens, the deposit will not be lost. Therefore, we stipulate that if both parties have
bad tokens, then the deposits of both parties will be confiscated, which can be realized by the
self‐destruct() function37 in the smart contract.
However, there are still some problems with the return policy of the deposit policy. For
example, if one party uses bad tokens as a deposit, even if the deposit will be given to the other
party, the other party will get those bad tokens. To tackle this problem, the solution in this paper is
to employ a machine learning algorithm to evaluate the token quality of deposit, and fully consider
the impact of the deposit's token quality when a party decides to initiate or accept a TSS.
4.1.5 | Income
The income of participants A and B consists of the following parts:
(1) The income of anonymity. (2) The fee c will be generated after B accepts A to initiate a
TSS, otherwise, no fee will be incurred. (3) The number of tokens after shuffling is calculated
WANG ET AL. | 11089
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
according to the token quality update rules. If the TSS does not occur, the token quality will
remain the level before the TSS. (4) The calculation of the deposit is based on the deposit return
policy. It should be noted that once the TSS is successful, the income brought by anonymity,
handling fee c, and the deposit need to be multiplied by the updated token quality.
Explanation: (1) Since c, da, and db are all paid before the TSS, they are not involved in the
TSS, and the token quality values they multiply are all the corresponding token qualities of the
participants before the token shuffling service. (2) The demands for anonymity of A and B are
related to whether the token shuffling is completed. In other words, if the token is successfully
shuffled, then A and B will have corresponding benefits in terms of anonymity, and this benefit
has nothing to do with the quality of their tokens. The above two points are different from the
assumptions in the literature Wang et al.24 and Yu et al.,25 because we fully consider the actual
situation of the token shuffling process.
The extended game of the incomplete information game based on poison policy is shown in
Figure 3. The specific process of the game is as follows.
1. First, predict the probability of whether A has bad tokens according to the machine learning
algorithm (similar to nature in the signaling game), assuming that the probability of no bad
tokens is β, and the probability of having bad tokens is β1 − .
2. If A chooses NSS, B has no chance to take the next action. The two parties can not
successfully shuffle tokens. Therefore, c will not be rewarded to B and both parties will not
be pledged their deposits, and their token qualities are still the initial token qualities before
TSS. The returns of A and B at terminal nodes ① and ② are q c(1 + )a and qb, respectively.
3. If A chooses SS, then information set I will be reached. We assume that the probability of
reaching nodes ③ and ④ is α and α1 − , respectively. No matter which node of ③ and ④ is
reached, B has two actions to choose, which are NAS and AS, respectively.
4. If B chooses NAS, which means that B does not accept the TSS request sponsored by A.
Therefore, A's deposit will be returned to A, and c will not be given to B. At this time, the
benefits of the participants in terminal nodes ⑤ and⑥ are the same. That is, the payoff of A
is q c(1 + )a , and the payoff of B is qb.
FIGURE 3 Extended game of incomplete information game based on poison policy
11090 | WANG ET AL.
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
5. If B chooses AS, it means that B accepts the TSS request sponsored by A, and the TSS is successful,
and A needs to pay B the fee c. A and B still have 1 token each after TSS. Both A and B have the
corresponding demand for anonymity, that is, A's gain in anonymity is 1, and B's is τb. Therefore,
for A, his total gain in terms of payment fees, amount of token injected into TSS and anonymity is
q c q1 + 1* ′ − *a a, and B's corresponding income is τ q c q+ 1* ′ + *b b a. However, A and B's returns
in terms of token quality and deposits after the TSS will vary depending on their private type. We
assume that the probability of B having bad tokens is γ , and the probability of not having bad
tokens is γ1 − . The following is an analysis of the benefits of Terminal node ⑦, ⑧, ⑨, and ⑩.
(1) Terminal node ⑦: In this case, neither A nor B has any bad tokens q q( = = 1)a b , and
the deposits of A and B will be returned to their account, respectively. According to
Table 2, the updated token quality of A and B is q q′ = ′ = 1a b . According to the
calculation formula of income, the income of A is q c q c1 + 1* ′ − * = 2 −a a . The income
of B is τ q c q τ c+ 1* ′ + * = + 1 +b b a b .
(2) Terminal node ⑧: In this case, A has no bad token q( = 1)a , but B has bad tokens
q( = 0)b , A's deposit is returned to A, and B's deposit will be confiscated and
compensated to A. According to Table 2, the updated token quality of A and B is
q q′ = ′ = 0a b . According to the calculation formula of income, the income of A is
q c q d q c1 + 1* ′ − * + * = 1 −a a b b . The return of B is τ q c q d q τ c+ 1* ′ + * − * = +b b a b b b .
(3) Terminal node ⑨: In this case, A has bad tokens q( = 0)a , but B has no bad token
q( = 1)b , A's deposit will be confiscated and compensated to B, and B's deposit will be
returned to B. According to Table 2, the updated token quality of A and B is q q′ = ′ = 0a b .
According to the calculation formula of income, the income of A is
q c q d q1 + 1* ′ − * − * = 1a a a a . The return of B is τ q c q d q τ+ 1* ′ + * + * =b b a a a b.
(4) Terminal node ⑩: In this case, both A and B have bad tokens q q( = = 0)a a , and both A
and B's deposits will be confiscated and compensated to each other. According to
Table 2, the updated token quality of A and B is q q′ = ′ = 0a b . According to the
calculation formula of income, the income of A is q c q d q1 + 1* ′ − * − * = 1a a a a . The
payoff of B is τ q c q d q τ+ 1* ′ + * − * =b b a b b b.
4.2 | Incomplete information game based on haircut policy
The incomplete information game based on the haircut policy is similar to the incomplete
information game based on the poison policy, the difference lies in the token quality update
rules, the type of participants, and the deposit return policy, which directly lead to the
difference in the income of the participants.
4.2.1 | The token quality update rules of the haircut policy
The token quality update rules of haircut policy are shown in Table 3.
TABLE 3 Haircut policy token quality update rules
value range of qa and qb value of q ′a value of q ′b
∈q q, [0, 1]a b q q c′ = *(1 + ) +a a
q
c(2 + )
b q q c′ = *(1 + ) +b a
q
c(2 + )
b
WANG ET AL. | 11091
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
4.2.2 | Participant private type
Under the haircut policy, the token quality of A and B are not simply divided into whether
there are bad tokens, but the proportion of bad tokens, so the value range of qa and qb is
between 0 and 1, not simply 0 or 1. This leads to the fact that the type of the participant is not
simply whether it contains bad tokens. On the other hand, the type of participant will also
directly affect the deposit return policy. For example, when both parties have bad tokens, the
party with a higher proportion of bad tokens will be deducted the deposit, and the deducted
deposit will be given to the party with a low proportion of bad tokens. Therefore, we stipulate
that the private type of participants are related to the ratio of the good tokens of A and B, and
the private types of participants are defined as two types: the quality of A is higher than B,
which is denoted as A  B, the token quality of B is higher than that of A, which is denoted as
A<B. Under this policy, the machine learning algorithm is used to evaluate the quality of
participants A and B based on their previous transaction records. We assume that B uses a
machine learning algorithm, and the probabilities of A B and A< B for the assessment of the
token quality between A and B are β and β1 − , respectively. Similarly, A uses a machine
learning algorithm, and the probabilities of A  B and A<B for the assessment of the token
quality between them are γ and γ1 − , respectively.
4.2.3 | Deposit return policy
According to the private types of A and B, there are four combinations which are (A  B, A  B),
(A  B, A<B), (A<B, A  B), and (A<B), A<B). The former of the tuple corresponding to
each combination represents the private type of A and the latter represents the private type of
B. For the haircut policy, we stipulate that whichever party has high‐quality tokens will be
returned the deposit, otherwise, his deposit will be confiscated. The return and confiscation of
the deposit are completed using smart contracts. The specific rules are as follows.
* (A  B, A B): Both A and B believe that A's tokens are of high quality, therefore, A's deposit
will be returned, B's deposit will be confiscated and compensated to A.
* (A  B, A<B): A considers A's token to be of high quality, B thinks of B's token of high
quality, and the deposits of A and B will be returned to their own accounts, respectively.
* (A< B, A  B): A believes that B's tokens are of high quality, B believes that A's tokens are of
high quality, A and B will exchange deposits.
* (A< B, A<B): Both A and B think that B's tokens are of high quality, therefore, B's deposit
will be returned, A's deposit will be confiscated and compensated to B.
4.2.4 | Income
The extended game of the incomplete information game based on the haircut policy is shown in
Figure 4. The specific process of the game is as follows:
1. First, according to a machine learning algorithm (similar to nature in a signaling game), B
evaluates the quality of A's token, assuming that the probabilities of A B and A< B are β
and β1 − , respectively.
11092 | WANG ET AL.
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
2. If A chooses NSS, B has no opportunity to take the next action. Both parties cannot
successfully carry out the token shuffling operation. Therefore, c will not be rewarded to B,
and both parties will not be pledged their deposits, and the token quality remains the initial
token quality before TSS. The returns of A and B at terminal nodes ① and ② are q c(1 + )a
and qb, respectively.
3. If A chooses SS, then information set I will be reached. We assume that the probability of
reaching nodes ③ and ④ are α and α1 − , respectively. No matter which node of ③ and ④
is reached, B has two actions to choose, which are NAS and AS, respectively.
4. If B chooses NAS, it means that B does not accept the TSS request sponsored by A.
Therefore, A's deposit will be returned to A, and there is no access to give c to B. In this case,
the benefits of the participants in terminal nodes ⑤ and ⑥ are the same. That is, the payoff
of A is q c(1 + )a , and the payoff of B is qb.
5. If B chooses AS, which means that B accepts the TSS request sponsored by A, and the TSS is
successful, and A needs to pay B the fee c. A and B still have 1 token each after TSS. Both A
and B have the corresponding demand for anonymity, that is, A's gain in anonymity is 1, and
B's gain in anonymity is τb. Therefore, for A, his income in terms of payment fees,
postshuffling quantity, and anonymity is A q c qΔ = 1 + 1* ′ − *a a, and the corresponding
income of B is B τ q c qΔ = + 1* ′ + *b b a. However, the token quality and deposit gains after
shuffling for A and B vary according to their different types. We assume that the
probabilities that A thinks A B and A< B are γ and γ1 − , respectively. According to
Table 3, the updated token quality of A and B is q q q c′ = ′ = *(1 + ) +a b a
q
c(2 + )
b . The following
is an analysis of the benefits of Terminal node ⑦, ⑧, ⑨, and ⑩.
(1) Terminal node ⑦: In this case, both A and B believe that A's tokens are of high quality,
A's deposit is returned, and B's deposit is confiscated and compensated to A. The return
of A is A d qΔ + *b b. The payoff of B is B d qΔ − *b b.
(2) Terminal node ⑧: A believes that B's tokens are of high quality, B believes that A's
tokens are of high quality, and A and B exchange deposits. According to the calculation
formula of income, the income of A is A d q d qΔ + * − *b b a a. The payoff of B is
B d q d qΔ + * − *a a b b.
FIGURE 4 Extended game of incomplete information game based on haircut policy
WANG ET AL. | 11093
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
(3) Terminal node ⑨: A believes that A's token is of high quality, B believes that B's token
is of high quality, and the deposits of A and B are returned to their respective accounts.
According to the calculation formula of income, the income of A is AΔ . The payoff of B
is BΔ .
(4) Terminal node ⑩: Both A and B think that B's tokens are of high quality, therefore, B's
deposit is returned, A's deposit is confiscated and compensated to B. According to
Table 3, the updated token quality of A and B is q qb q c′ = ′ = *(1 + ) +a a
q
c(2 + )
b .
According to the calculation formula of income, the income of A is A d qΔ − *a a. The
payoff of B is B d qΔ + *a a.
4.3 | Incomplete information game based on suicide policy
The private type and deposit return strategy of the incomplete information game based on the
suicide policy are the same as those of the haircut policy, and the difference between the two
policies is the update rules of the token quality. The basic idea of the token quality update rules
of Suicide policy is, that whoever has more bad tokens, then all the bad tokens belong to this
party after shuffling. Table 4 gives the token quality update rules of the suicide policy.24,25 It is
worth noting that A and B, respectively take Table 4 to update their own token quality. The
expansion of the incomplete information game based on suicide policy is the same as that in
Figure 4, the difference is that the token quality update rules are different. That is to say, the
derivation process of its private type, deposit return policy, and income can be similarly derived
with reference to the previous two policies, and will not be repeated here.
5 | PERFORMANCE ANALYSIS
We simulate the token shuffling process in Python, a popular programming tool, by drawing on
ideas from the literature.37 To ensure the accuracy of the data, we run 2100 rounds for each
validation when calculating revenue and counts and then average the values mentioned above.
The simulation results show that when there are more estimated good tokens, both parties are
more inclined to participate in the TSS, otherwise they tend not to participate in the TSS.
5.1 | Simulation analysis of token shuffling based on poison policy
We first consider the payoff for participant A in the case of randomly arriving at nodes I and II
without using machine learning algorithm. At both nodes, Participant A has two choices, SS
TABLE 4 Suicide policy token quality update rules
q ′ = 1a q ′ = 1b
q qa b 1 qa qbMax{0, + − 1}
q q<a b
qa qbMax{0, + − 1} 1
11094 | WANG ET AL.
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
and NSS, which denote sponsoring token shuffling and not sponsoring token shuffling,
respectively. Figure 5A shows the effect of the quality of participant A's token on his payoff
when c = 0.3, τ = 0.3b , q = 0.3b . It is easy to observe from Figure 5A that when his token
quality is low (q < = 0.5a ), participant A has a higher return by taking NSS; otherwise, the
payoff of taking SS is higher. When the quality of tokens injected into TSS is high (q > 0.5a ), the
returns of taking SS (gray and orange lines in the figure) is always higher than those of taking
NSS (black and blue lines). Figure 5B shows the effect of on the payoff of participant A when
c τ q q= 0.3, = 0.3, = 0.2, = 0.3b a b . It is easy to observe from Figure 5B that when B estimates
the quality of A's token is high, that is, when B believes that A's token quality is higher than
that of B's, regardless of whether it reaches node I or node II, A will have a higher income for
sponsoring token shuffling. From Figure 5A,B, it can be concluded that if A's token quality is
higher than that of B's or B's assessment of A's token quality is higher, participant A will be
more willing to sponsor TSS.
If the effect of machine learning model is considered, that is, the probability of reaching
nodes I and II is not random, but rather B evaluates the quality of the tokens held by A
according to a machine learning algorithm, and the result of this evaluation determines the
probability of reaching I and II, respectively. At the same time, A will also use machine
learning algorithm to evaluate the quality of B's token injected into the token shuffling service.
According to the simulation results in Figure 2, the accuracy rate of participants' assessment of
the tokens quality is close to 70%. Therefore, Participant A can decide which path to take based
on the quality assessment of Participant B's token. According to Figure 5B, Whichever path he
is currently on, that is, whether A is on path I or path II, he will choose to sponsor the TSS.
Once participant A selects a strategy according to the path, it can be seen from Figure 5B
that, for the sake of increasing profits, regardless of which path he is currently on, participant A
will always choose SS, and for participant B, the result he observes is that A sponsors the token
shuffling service. Figure 6A shows, when c γ τ q= 0.3, = 0.5, = 0.3, = 0.2b a , for participant B,
the effect of different token qualities and different paths on B's returns. It is clear from the
simulation results when participant B observes that A's choice is SS, the payoff for B to choose
AS is greater than the payoff for choosing NAS. In other words, when participant A sponsors
the TSS, participant B will choose AS for the sake of maximizing its benefit. Figure 6B shows
FIGURE 5 The impact of token quality and γ on A's return. (A) The impact of A's token quality on its
revenue and (B) the effect of γ on A's return. [Color figure can be viewed at wileyonlinelibrary.com]
WANG ET AL. | 11095
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
http://wileyonlinelibrary.com
the effect of γ on the return of B when c τ q q= 0.3, = 0.3, = 0.2, = 0.3b a b . It can be seen that,
under normal circumstances, participant A sponsors the TSS, that is, A chooses SS, and participant
B accepts the service, that is, B chooses AS, which is a sequential equilibrium. It is worth noting
that the above sequential equilibrium will be easier to achieve with larger values of γ .
While Figures 5 and 6 show the corresponding returns for Participants A and B under
different paths, the simulation results show that both Participants A and B choose to participate
in the TSS, and their returns are higher than if they do not participate in the service. But the
seemingly high payoffs are meaningless to the participants if, in reality, these high payoff paths
occur very infrequently. Figure 7 shows the frequency of occurrence of different paths when
c γ τ q= 0.3, = 0.5, = 0.3, = 0.3b b . It can be seen that the frequency of choosing the path of SS
is higher for participant A compared to NSS, regardless of whether it is at node I or node II. At
the simultaneous, given participant A's choice of SS, the frequency of choosing path SS  AS
will also be higher for participant B. This is consistent with the corresponding simulation
results in Figures 5 and 6.
FIGURE 6 The impact of token quality and γ on B's return. (A) The impact of B's token quality on its
revenue and (B) the effect of γ on B's return. [Color figure can be viewed at wileyonlinelibrary.com]
FIGURE 7 Frequency of game paths. The frequency of (A) player A's game path and (B) player B's game
path. [Color figure can be viewed at wileyonlinelibrary.com]
11096 | WANG ET AL.
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
http://wileyonlinelibrary.com
http://wileyonlinelibrary.com
5.2 | Simulation analysis of token shuffling based on haircut policy
This section analyzes the effect of different parameters on the participants' earnings under the
haircut policy. Figure 8 shows the effects of qa and qb on player A's returns under different
paths when c γ= 0.3, = 0.5, and τ = 0.3b . In general, under paths I  NSS and II  NSS
(Figure 8B,D), participant A has higher returns. At this case, qa has little effect on the income of
participant A, and the income of participant A is mainly affected by qb. It can be seen from
Figure 8B,D that the larger qb, the higher the income of participant A. That is to say, the higher
the quality of participant B's token, the higher the income of participant A who chooses not to
shuffle the token. Contrary to the poison policy, player A does not tend to shuffle tokens under
haircut policy. Figure 8 shows the situation when reaching nodes I and II are random. If the
influence of machine learning model is considered, then participant A can decide his policy
according to qa, which is the quality of his tokens injected into TSS. For example, when B's
assessment of A's token quality is smaller than his own, participant A will choose not to initiate
TSS.
Figure 9 shows the effects of qa and qb on player B's returns under different paths when
c = 0.3, γ = 0.5, and τ = 0.3b . In general, under the path SS AS (Figure 9A), participant B
has higher returns. That is to say, under the haircut policy, if participant A initiates a TSS, then
participant B will have a higher payoff when choosing AS. According to the simulation results
FIGURE 8 The impact of the token quality of A and B on A's income under different paths. (A) Path
I⟶ SS, (B) path I⟶NSS, (C) path II⟶ SS, and (D) path II⟶NSS. [Color figure can be viewed at
wileyonlinelibrary.com]
WANG ET AL. | 11097
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
http://wileyonlinelibrary.com
of Figure 8, it can be concluded that participant A has no motivation to sponsor TSS. However, if
Participant A sponsors the service, then according to Figure 9A,B, Participant B has the motivation
to accept the service. Therefore, the conclusion is that under the haircut policy, participant A does
not sponsor TSS and participant B accepts TSS, which is a sequential equilibrium.
6 | CONCLUSIONS AND FUTURE WORK
The proposal of a TSS is instrumental in addressing the anonymity and privacy issues in bitcoin
transactions. To avoid malicious participants from using the TSS for acts such as “money
laundering,” this paper proposes a general token shuffling framework. The framework consists
of three parts, such as a machine learning classification model, an incomplete information
game analysis of the token shuffling propagation strategy, and a sequential equilibrium. It
focuses on trying to find the sequential equilibrium of the token shuffling propagation policy
using a machine learning model instead of a blacklist, together with the analysis of the
incomplete information game. Before conducting a token shuffling transaction, participants in
the TSS can refer to the probability given by the machine learning model that the other party
may have bad tokens and have some estimate of the quality of the other party's tokens. Finally,
participants decide whether to agree to shuffle token transactions through the general token
FIGURE 9 The impact of the token quality of A and B on B's income under different paths. (A) Path
SS⟶AS, (B) path SS⟶NAS, and (C) path NSS. [Color figure can be viewed at wileyonlinelibrary.com]
11098 | WANG ET AL.
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
http://wileyonlinelibrary.com
shuffling framework. The model not only solves the problem of untimely blacklist updates, but
also maintains the accuracy comparable to that of the blacklist, which in turn paves the way for
the next decision. According to our simulation experiments, the responder to a TSS can make a
decision in his favor based on our general token shuffling framework before the token shuffling
transaction.
ACKNOWLEDGMENTS
This study is supported by the Foundation of National Natural Science Foundation of China
(Grant No: 62072273, 72111530206, 61962009, and 62162008); Foundation of State Key
Laboratory of Public Big Data (No. PBD2021‐04); Foundation of Guizhou Provincial Key
Laboratory of Public Big Data (No. 2019BDKFJJ009).
DATA AVAILABILITY STATEMENT
Research data are not shared.
ORCID
Yilei Wang http://orcid.org/0000-0002-1602-3720
Tao Li http://orcid.org/0000-0002-1448-3619
Ming Liu http://orcid.org/0000-0002-4655-782X
Chunmei Li http://orcid.org/0000-0002-1397-1215
REFERENCES
1. Sompolinsky Y, Zohar A. Secure high‐rate transaction processing in bitcoin. In: Böhme R, Okamoto T, eds.
International conference on financial cryptography and data security. Springer; 2015:507‐527.
2. Li T, Wang Z, Yang G, Cui Y, Chen Y, Yu X. Semi‐selfish mining based on hidden Markov decision process.
Int J Intell Syst. 2021;36(7):3596‐3612.
3. Li T, Wang Z, Chen Y, Li C, Jia Y, Yang Y. Is semi‐selfish mining available without being detected? Int J
Intell Syst. 2021. doi:10.1002/int.22656
4. Miyamae T, Matsuura K. Privacy analysis and evaluation policy of blockchain‐based anonymous
cryptocurrencies. arXiv preprint arXiv:2012.10563; 2020.
5. Li J, Ye H, Li T, et al. Efficient and secure outsourcing of differentially private data publishing with
multiple evaluators. IEEE Transactions on Dependable and Secure Computing; 2020.
6. Ziegeldorf JH, Matzutt R, Henze M, Grossmann F, Wehrle K. Secure and anonymous decentralized bitcoin
mixing. Future Generation Comput Syst. 2018;80(1):448‐466.
7. Bryans D. Bitcoin and money laundering: mining for an effective solution. Ind Law J. 2014;89:441.
8. Möser M, Böhme R, Breuker D. An inquiry into money laundering tools in the Bitcoin ecosystem. In:
Aaron G, ed. 2013 APWG eCrime Researchers Summit. IEEE; 2013:1‐14.
9. Wang Z, Lv Q, Lu Z, Wang Y, Yue S. ForkDec: accurate detection for selfish mining attacks. Security
Commun Netwk. 2021;2021:5959698. doi:10.1155/2021/5959698
10. Chen Y, Dong S, Li T, Wang Y, Zhou H. Dynamic multi‐key FHE in asymmetric key setting from LWE.
IEEE Trans Inform Forensics Security. 2021;16:5239‐5249.
11. Liu Z, Li J, Lv S, et al. EncodeORE: reducing leakage and preserving practicality in order‐revealing
encryption. IEEE Transactions on Dependable and Secure Computing. 2020.
12. Böhme R, Christin N, Edelman B, Moore T. Bitcoin: economics, technology, and governance. J Econ
Perspect. 2015;29(2):213‐38.
13. Möser M, Narayanan A. Effective cryptocurrency regulation through blacklisting. Preprint; 2019.
14. Maxwll G. Coinswap. 2013. https://bitcointalk.org/index.php?topic=321228
15. Ruffing T, Moreno‐Sanchez P, Kate A. Coinshuffle: practical decentralized coin mixing for bitcoin. In:
Kutylowski M, Vaidya J, eds. European Symposium on Research in Computer Security. Springer; 2014:
345‐364.
WANG ET AL. | 11099
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
http://orcid.org/0000-0002-1602-3720
http://orcid.org/0000-0002-1448-3619
http://orcid.org/0000-0002-4655-782X
http://orcid.org/0000-0002-1397-1215
https://doi.org/10.1002/int.22656
https://doi.org/10.1155/2021/5959698
https://bitcointalk.org/index.php?topic=321228
16. Maxwell G. Coinjoin: Bitcoin privacy for the real world; 2013. https://bitcointalk.org/index.php
17. Selij JW. CoinShuffle anonymity in the Block chain; 2015. http://rp.delaat.net/2014-2015/p77/report.pdf
(20.8.2018.)
18. Meiklejohn S, Mercer R. Möbius: trustless tumbling for transaction privacy; 2018.
19. Liu Y, Liu X, Tang C, Wang J, Zhang L. Unlinkable coin mixing scheme for transaction privacy
enhancement of bitcoin. IEEE Access. 2018; 6: 23261‐23270.
20. Seres IA, Nagy DA, Buckland C, Burcsi P. Mixeth: efficient, trustless coin mixing service for ethereum.
Cryptology ePrint Archive; 2019.
21. Abramova S, Schöttle P, Böhme R. Mixing coins of different quality: a game‐theoretic approach. In:
Brenner M, Rohloff K, Bonneau J, et al., eds. International Conference on Financial Cryptography and Data
Security. Springer; 2017: 280‐297.
22. Rasmusen E. Games and Information. Vol 13. Basil Blackwell Oxford; 1989.
23. Liu X, Yu X, Zhu H, Yang G, Wang Y, Yu X. A game‐theoretic approach of mixing different qualities of
coins. Int J Intell Syst. 2020;35(12):1899‐1911.
24. Wang Y, Bracciali A, Yang G, Li T, Yu X. Adversarial behaviours in mixing coins under incomplete
information. Appl Soft Comput. 2020;96(5):106605.
25. Yu X, Wang Z, Wang Y, et al. Impsuic: a quality updating rule in mixing coins with maximum utilities. Int
J Intell Syst. 2021;36(3):1182‐1198.
26. Zhu L, Dong H, Shen M. Privacy protection mechanism for blockchain transaction data. Big Data Res.
2018;4(1):46‐56.
27. Wang Y, Wang Z, Yang G, et al. On‐chain is not enough: ensuring pre‐data on the chain credibility for
blockchain‐based source‐tracing systems. Digital Commun Netwk. 2021. doi:10.1016/j.dcan.2021.10.002
28. Li T, Chen Y, Wang Y, et al. Rational protocols and attacks in blockchain system. Security Commun Netwk.
2020;2020:8839047. doi:10.1155/2020/8839047
29. Yuan F, Chen S, Liang K, Xu L. Research on the Coordination Mechanism of Traditional Chinese Medicine
Medical Record Data Standardization and Characteristic Protection Under Big Data Environment.
Shandong: 2021.
30. Ren H, Huang T, Yan H. Adversarial examples: attacks and defenses in the physical world. Int J Mach
Learn Cybernet. 2021;12(11):3325‐3336.
31. Huang T, Chen Y, Yao B, Yang B, Wang X, Li Y. Adversarial attacks on deep‐learning‐based radar range
profile target recognition. Inform Sci. 2020;531:159‐176.
32. Mahootiha M, Golpayegani AH, Sadeghian B. Designing a new method for detecting money laundering
based on social network analysis. In: Ahmadi A, Teshnelab M, Dadkhah C, eds. 26th International
Computer Conference, Computer Society of Iran, CSICC 2021, Tehran, Iran, March 3–4, 2021. IEEE;2021:1‐7.
33. Khalilov MCK, Levi A. A survey on anonymity and privacy in bitcoin‐like digital cash systems. IEEE
Commun Survey Tutorials. 2018;20(3):2543‐2585.
34. Wang Y, Bracciali A, Li T, Li F, Cui X, Zhao M. Randomness invalidates criminal smart contracts. Inform
Sci. 2019;477(10):291‐301.
35. Geanakoplos J, Pearce D, Stacchetti E. Psychological games and sequential rationality. Games Econ Behav.
1989;1(1):60‐79.
36. Driessen TS. A survey of consistency properties in cooperative game theory. SIAM Review. 1991;33(1):43‐59.
37. Korbak T. Introduction to Lewis signaling games with Python; 2019. https://tomekkorbak.com/2019/10/
08/lewis-signaling-games/
How to cite this article: Wang Y, Li T, Liu M, Li C, Wang H. STSIIML: Study on token
shuffling under incomplete information based on machine learning. Int J Intell Syst.
2022;37:11078‐11100. doi:10.1002/int.23033
11100 | WANG ET AL.
 1098111x, 2022, 12, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.23033 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
https://bitcointalk.org/index.php
http://rp.delaat.net/2014-2015/p77/report.pdf(20.8.2018.)
http://rp.delaat.net/2014-2015/p77/report.pdf(20.8.2018.)
https://doi.org/10.1016/j.dcan.2021.10.002
https://doi.org/10.1155/2020/8839047
https://tomekkorbak.com/2019/10/08/lewis-signaling-games/
https://tomekkorbak.com/2019/10/08/lewis-signaling-games/
https://doi.org/10.1002/int.23033