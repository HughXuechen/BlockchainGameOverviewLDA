Blockchain Enabled Decentralized Local Electricity Markets With Flexibility From Heating Sources
IEEE TRANSACTIONS ON SMART GRID, VOL. 14, NO. 2, MARCH 2023 1607
Blockchain Enabled Decentralized Local Electricity
Markets With Flexibility From Heating Sources
Weiqi Hua , Student Member, IEEE, Yue Zhou , Member, IEEE, Meysam Qadrdan , Senior Member, IEEE,
Jianzhong Wu , Senior Member, IEEE, and Nick Jenkins , Fellow, IEEE
Abstract—Electric power systems are transitioning towards a
decentralized paradigm with the engagement of active prosumers
(both producers and consumers) through using distributed multi-
energy sources. This paper proposes a novel Blockchain based
peer-to-peer trading architecture which integrates negotiation-
based auction and pricing mechanisms in local electricity
markets, through automating, standardizing, and self-enforcing
trading procedures using smart contracts. The negotiation of the
volume and price of the peer-to-peer electricity trading among
prosumers is modeled as a cooperative game, and the interaction
between a retailer and its ensemble of prosumers is modeled
as a Stackelberg game. The flexibility provision from residential
heating systems is incorporated into the energy scheduling of pro-
sumers. Case studies demonstrate that the proposed architecture
in local electricity markets helps improve local energy balance.
Flexibility from the residential heating systems enables prosumers
to be more responsive to the variation of retail electricity prices.
The proposed model reduces 41.24% of average daily electricity
costs for individual prosumers or consumers compared to the
case without the peer-to-peer electricity trading.
Index Terms—Blockchain, electrification of heat, local electric-
ity market, prosumer, renewable energy, smart contract.
NOMENCLATURE
Functions
f tradeoff
n Function of the tradeoff of the prosumer n.
f profit Function of the profits of a retailer.
Parameters
�t Scheduling interval (0.5 h).
ε
hp
n Coefficient of performance of the air-source heat
pump of the prosumer n.
Manuscript received 15 September 2021; revised 3 February 2022; accepted
22 February 2022. Date of publication 11 March 2022; date of cur-
rent version 20 February 2023. This work was supported in part by the
EPSRC through the Project “Maximizing Flexibility Through Multi-Scale
Integration of Energy System (MISSION)” under Grant EP/S001492/1, and
in part by the Project “Integrated Heating and Cooling Networks With Heat-
Sharing-Enabled Smart Prosumers” under Grant EP/T022795/1. Paper no.
TSG-01499-2021. (Corresponding author: Meysam Qadrdan.)
Weiqi Hua was with the School of Engineering, Cardiff University,
Cardiff CF24 3AA, U.K. He is now with the Department of Engineering
Science, University of Oxford, Oxford OX1 3QG, U.K. (e-mail:
weiqi.hua@eng.ox.ac.uk).
Yue Zhou, Meysam Qadrdan, Jianzhong Wu, and Nick Jenkins are with the
School of Engineering, Cardiff University, Cardiff CF24 3AA, U.K. (e-mail:
zhouy68@cardiff.ac.uk; qadrdanm@cardiff.ac.uk; wuj5@cardiff.ac.uk;
jenkinsn6@cardiff.ac.uk).
Color versions of one or more figures in this article are available at
https://doi.org/10.1109/TSG.2022.3158732.
Digital Object Identifier 10.1109/TSG.2022.3158732
π
rt,max
t Maximum retail electricity price at the schedul-
ing time t (GBP/kWh).
π
rt,min
t Minimum retail electricity price at the schedul-
ing time t (GBP/kWh).
πwh
t Wholesale electricity price at the scheduling
time t (GBP/kWh).
τ a
t Temperature of the ambient air at the scheduling
time t (K).
τmax
n Maximum temperature boundary to maintain the
comfort of the prosumer n (K).
τmin
n Minimum temperature boundary to maintain the
comfort of the prosumer n (K).
ξb
n Price elasticity of the prosumer n as an electricity
buyer.
ξ s
n Price elasticity of the prosumer n as an electricity
seller.
cn Thermal capacitance of the prosumer n’s house-
hold (J/kgK).
de
n,t Electricity consumption of appliances of the
prosumer n at the scheduling time t (kW).
dts, max
n Maximum charging rate of the thermal energy
storage of the prosumer n (kW).
ppv
n,t Electricity produced by the roof-top solar panel
of the prosumer n at the scheduling time t (kW).
qhp,max
n Nominal maximum heating power of the air-
source heat pump of the prosumer n (kW).
qts, max
n Maximum discharging rate of the thermal energy
storage of the prosumer n (kW).
sts, max
n Thermal energy storage capacity of the pro-
sumer n (kWh).
un Thermal transmittance of the prosumer n’s
household (W/K).
Sets
Ci Set of the smart contracts deployed by the
seller i.
Cj Set of the smart contracts deployed by the
buyer j.
N Index set of prosumers.
SF,n Decision space of the follower n.
SL Decision space of the leader.
T Index set of the scheduling time.
Variables
φi Network serial number of the seller i.
1949-3053 c© 2022 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See https://www.ieee.org/publications/rights/index.html for more information.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:17:25 UTC from IEEE Xplore.  Restrictions apply. 
https://orcid.org/0000-0002-6616-6797
https://orcid.org/0000-0002-6698-4714
https://orcid.org/0000-0002-1688-0191
https://orcid.org/0000-0001-7928-3602
https://orcid.org/0000-0003-3082-6260
1608 IEEE TRANSACTIONS ON SMART GRID, VOL. 14, NO. 2, MARCH 2023
φj Network serial number of the buyer j.
πmin
i Minimum accepted buying price of the seller i
(GBP/kWh).
πmax
j Maximum accepted selling price of the buyer j
(GBP/kWh).
π
p2p
n,m,t Agreed selling/buying price between the pro-
sumer n and prosumer m at the scheduling time t
(GBP/kWh).
π rt
t Retail electricity price at the scheduling time t
(GBP/kWh).
τn,t Indoor temperature of the prosumer n’s house-
hold at the scheduling time t (K).
θi Auction end time of the seller i.
θj Auction end time of the buyer j.
ϑ Binary variable indicating the charging (if ϑ =
1) or discharging (if ϑ = 0) of the thermal
energy storage.
dhp
n,t Electricity used to run the air-source heat
pump of the prosumer n at the scheduling
time t (kW).
dh
n,t Heating power supplied to the household of the
prosumer n at the scheduling time t (kW).
dmatched
n,t Matched electricity demand of the prosumer n at
the scheduling time t (kW).
dts
n,t Heating power charged to the thermal energy
storage of the prosumer n at the scheduling time t
(kW).
dunmatched
n,t Unmatched electricity demand of the prosumer n
at the scheduling time t (kW).
idi Address of the account of the seller i.
idj Address of the account of the buyer j.
pi Amount of the supplied electricity of the seller i
(kW).
pj Amount of the electricity demand of the buyer j
(kW).
pp2p
n,m,t power exchange between the prosumer n and
prosumer m at the scheduling time t (kW).
pmatched
n,t Matched electricity supply of the prosumer n at
the scheduling time t (kW).
pp2r
n,t Power export from the prosumer n to a retailer
at the scheduling time t (kW).
pr2p
n,t Power import from a retailer to the prosumer n
at the scheduling time t (kW).
punmatched
n,t Unmatched electricity supply of the prosumer n
at the scheduling time t (kW).
qhp
n,t Heating power supplied by the heat pump of the
prosumer n at the scheduling time t (kW).
qts
n,t Heating power discharged from the thermal
energy storage of the prosumer n at the schedul-
ing time t (kW).
sts
n,t Stored thermal energy of the prosumer n at the
scheduling time t (kWh).
ti Start time of the supplied electricity of the
seller i.
tj Start time of the electricity demand of the
buyer j.
I. INTRODUCTION
IN efforts to achieve the goals of clean energy supply and
zero carbon emissions, electric power systems are transi-
tioning to a decentralized paradigm with the integration of
distributed energy sources (DERs), e.g., roof-top solar pan-
els [21]. Increasing numbers of consumers in distribution
networks are able to produce energy on-site and actively par-
ticipate in local electricity markets using DERs, which gives
them a new role of prosumers [22]. Decarbonization of heat
through electrification [23], e.g., using air-source heat pumps,
provides great flexibility for prosumers to strategically store
energy, shift or curtail demand, and exchange electricity with
retailers or neighboring prosumers in responding to dynamic
electricity pricing signals.
Accommodating the new role of prosumers requires a flex-
ible structure of local electricity markets. The innovation of
peer-to-peer electricity trading enables prosumers to directly
exchange electricity in local markets for regional energy
balance. The peer-to-peer electricity trading has been well doc-
umented in terms of the architecture design [1]–[3], pricing
design [4], [5], auction mechanisms [6], [7], and regula-
tions [24], for which the game-theoretic approaches have been
widely applied to analyze the decision making and interactions
among stakeholders. In [1], the key elements and technologies
of the peer-to-peer electricity trading were identified and cat-
egorized into a hierarchical system architecture, in which the
trading behaviors were modeled through using the game the-
ory. Reference [2] designed a peer-to-peer architecture based
on the coalition formation game, under which prosumers were
incentivized to form social coalition groups and benefited from
their groups. Yan et al. [3] studied an innovative architec-
ture of joint energy and carbon markets, through which the
impacts of network constraints on the carbon prices and car-
bon footprint among energy networks were investigated. In [4],
a pricing mechanism of the peer-to-peer energy trading was
designed based on the coalition game to construct a stable
grand coalition for prosumers and facilitate the local energy
balance. Tushar et al. [5] designed a pricing scheme to incen-
tivize prosumers to participate in the peer-to-peer electricity
trading during the peak demand period through forming coali-
tions based on the cooperative Stackelberg game. Haggi and
Sun [6] developed a multi-round double auction mechanism
with matching algorithm to facilitate the peer-to-peer energy
exchange in distribution networks. Reference [7] designed a
uniform-price auction mechanism for peer-to-peer energy trad-
ing in both sellers and buyers’ markets for an efficient energy
allocation. Schneiders et al. [24] investigated practical regu-
lations and regulatory trails for implementing the peer-to-peer
electricity trading, and identified the policy barriers for policy
makers in order to reap the social benefits while avoid risks
on power system infrastructures and prosumers.
Recent research has recognized the importance of the elec-
trification of heat in terms of the power system decarbonization
and energy market decentralization. Nematkhah et al. [8]
designed a peer-to-peer trading framework for residential pro-
sumers with heating, ventilation, and air conditioning systems,
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:17:25 UTC from IEEE Xplore.  Restrictions apply. 
HUA et al.: BLOCKCHAIN ENABLED DECENTRALIZED LOCAL ELECTRICITY MARKETS WITH FLEXIBILITY 1609
TABLE I
COMPARISON BETWEEN THE EXISTING STUDIES AND OUR PROPOSED RESEARCH
in which an online scheduling for individual prosumers was
developed along with the energy sharing among prosumers in
achieving the local energy balance. Analogously, Liu et al. [9]
incorporated the heat pump, refrigeration devices, and energy
storage units into a designed peer-to-peer energy trading
platform, and proposed a double-auction mechanism to pro-
mote the collaboration among prosumers. Researchers in [10]
developed a Nash-type non-cooperative game model to fea-
ture the peer-to-peer trading among multi-energy prosumers,
in which fair pricing strategies for the trading of both electric-
ity and heat were yielded through minimizing the energy costs
of prosumers. In [11], residential prosumers with heat pumps,
solar panels, and electrical and thermal storage systems were
modeled under various pricing regimes of the peer-to-peer
energy trading. Chen et al. [12] investigated the peer-to-peer
energy trading by considering the energy conversion of multi-
energy microgrids. Zhang et al. [13] analyzed the impacts of
multi-energy systems on the peer-to-peer energy trading, and
demonstrated that the multi-energy coupling could reduce the
electricity import from the utility grid.
Nonetheless, the large numbers of transactions and nego-
tiations in the peer-to-peer electricity trading amplify the
volumes of the information flows. The emergence of smart
contracts [25], based on Blockchain technologies, has the
potential to reduce the burdens of information flows through
supporting a secure, automatic, and trusted electricity trad-
ing platform. On this platform, standardized procedures of the
peer-to-peer electricity trading are set out by programmable
functions of smart contracts which are replicable for all pro-
sumers. The execution of smart contracts and settlement of
electricity trading are self-enforced and collectively verified
by every node in Blockchain networks. Implementing the
Blockchain smart contracts into the operation [14], [15], plan-
ning [16], [17], and trading [18]–[20] in power systems has
been focused in the literature. Danzi et al. [14] designed a
smart contact to enforce the control strategy for the operation
of DERs, so that the voltage of power systems was main-
tained below the recommended limits. Thomas et al. [15]
incorporated instructions for the shared control of separated
distribution networks into a general form of smart contracts,
and demonstrated the advantages of the reduced transaction
cost and computational requirements. In [16], a smart con-
tract was designed for power system operators to improve
the investment coordination in electricity networks. As an
industrial practice, the Sun Exchange [17] partnered with
local solar constructors to provide a crowdsale of solar pan-
els to customers through Blockchain smart contracts, so as to
encourage customers for investing in clean energy generation
and earning incomes from selling surplus electricity. To man-
age increasing volumes of charging or discharging requests
from electric vehicle owners, a peer-to-peer electricity trading
system was proposed by [18], in which the trading procedures
were standardized as smart contracts executed on the Ethereum
platform. Han et al. [19] designed a smart contract to enforce
the predefined rules of the trading and payment for enhancing
the security and fairness. Abdella et al. [20] designed multiple
smart contracts for the payment settlement and authentication
of balancing markets, pool markets, and bilateral markets, and
demonstrated the improvements on the throughput, scalability,
and success rate.
The differences between the existing studies and our
proposed research are presented in Table I. Compared to the
existing studies, the key research questions to be addressed by
this paper are:
• How to design the architecture of local electricity markets
to accommodate prosumers and support the peer-to-peer elec-
tricity trading? What energy scheduling and trading decisions
should prosumers make and what electricity pricing strat-
egy should retailers/aggregators formulate to maximize their
benefits?
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:17:25 UTC from IEEE Xplore.  Restrictions apply. 
1610 IEEE TRANSACTIONS ON SMART GRID, VOL. 14, NO. 2, MARCH 2023
• How to tailor smart contracts to the auction and pric-
ing mechanisms of the peer-to-peer electricity trading, in
order to enhance the automation, standardization, and self-
enforcement?
• How will heating sources affect the flexibility of electricity
consumption and exchange, and benefit for both prosumers and
retailers in local electricity markets?
Overall, by addressing the aforementioned research ques-
tions, this paper has made following key contributions:
• The flexibility and benefits of heating sources in decen-
tralized local electricity markets were investigated, along with
scheduling and trading decisions of multi-energy prosumers.
• A novel negotiation-based pricing and clearing mechanism
for peer-to-peer electricity trading was designed in the form of
standardized smart contracts, supported by a Blockchain based
platform to guarantee the verifiability, information efficiency,
and tamper-resistance.
• The interactions between retailers and prosumers were
modeled as a Stackelberg game, and iterative negotiations
among prosumers were modeled as a cooperative game to yield
optimal decisions which maximize the profits for retailers and
maximize the tradeoff for individual prosumers. The proposed
model can reduce 41.24% of average daily electricity costs
for individual prosumers or consumers compared to the case
without the peer-to-peer electricity trading.
The rest of this paper is organized as follows. Section II
introduces the framework and problem formulations of local
electricity markets to analyze the decision making and interac-
tions of retailers and prosumers through using the cooperative
Stackelberg game. Section III discusses the architecture of
Blockchain networks and two standardized forms of smart
contracts for the peer-to-peer electricity trading among pro-
sumers. Case studies are provided in Section IV. Section V
concludes this paper and identifies the future works.
II. FRAMEWORK OF PEER-TO-PEER TRADING
This research investigates the architecture of local elec-
tricity markets in supporting peer-to-peer electricity trading,
by analyzing the roles of prosumers and electricity retailers.
The objectives of this research include 1) helping individual
prosumers strategically schedule electrical and heating energy
sources and loads, and make trading decisions in the day-ahead
market, so as to save their electricity costs. 2) helping retailers
determine the day-ahead half-hourly electricity prices consid-
ering effects of peer-to-peer electricity trading and flexibility
provision from heating sources, so as to maximize their profits.
Considering the increasing deployment of roof-top solar pan-
els and electrified heating sources [7], the intended application
scale of the proposed research is on residential neighboring
prosumers with both the roof-top solar panel and air-source
heat pump.
A schematic illustration of the peer-to-peer electricity trad-
ing between multi-energy prosumers is presented in Fig. 1.
These prosumers are able to exchange electricity with retail-
ers or other neighboring prosumers. This research assumes
that a retailer provides the day-ahead half-hourly electricity
prices for its prosumers. Each household is equipped with an
Fig. 1. Schematic illustration of the peer-to-peer electricity trading between
multi-energy prosumers. Each prosumer is equipped with a roof-top solar
panel, air-source heat pump, and hot water cylinder, along with other electri-
cal and heating loads. Prosumers are able to exchange electricity with other
neighboring prosumers or the retailer.
air-source heat pump and a hot water cylinder to meet its
heating demand and provide flexibility for its electricity con-
sumption and exchange. The thermal inertia of a household
is modeled by a simple (1R1C [26]) thermal model and the
indoor temperature is controlled within the comfort range of
residents. A prosumer has three options to meet its electricity
demand: 1) buying electricity from its retailer at retail elec-
tricity prices, 2) generating electricity using its roof-top solar
panels, and 3) buying electricity from other neighboring pro-
sumers through the designed peer-to-peer trading platform at
agreed prices. Meanwhile, a prosumer has two options to sell
the extra electricity for earning revenues: 1) selling electricity
to its retailer at wholesale electricity prices, and 2) selling elec-
tricity to other neighboring prosumers through the designed
peer-to-peer trading platform at agreed prices.
A. The Role of Prosumers
Individual prosumers aim to maximize their own tradeoff by
strategically deciding the generation, consumption, and power
exchange with its retailer or other neighboring prosumers,
and selling/buying prices agreed with other neighboring pro-
sumers. The tradeoff of a prosumer can be described as the
revenues of selling electricity to retailers or neighboring pro-
sumers, subtracting the payments of buying electricity from
retailers or neighboring prosumers as
f tradeoff
n :=
∑
t∈T
⎛
⎝pp2r
n,t · πwh
t +
∑
m∈N ,m �=n
pp2p
n,m,t · π
p2p
n,m,t − pr2p
n,t · π rt
t
⎞
⎠
× �t, (1)
where f tradeoff
n is the function of the tradeoff of the prosumer
n, T is the index set of the scheduling time, pp2r
n,t is the power
export from the prosumer n to a retailer at the scheduling time
t, πwh
t is the wholesale electricity price at the scheduling time
t, N is the index set of prosumers, pp2p
n,m,t is the power exchange
between the prosumer n and prosumer m (m ∈ N , m �= n) at
the scheduling time t, π
p2p
n,m,t is the agreed selling/buying price
between the prosumer n and prosumer m at the scheduling time
t, pr2p
n,t is the power import from a retailer to the prosumer n at
the scheduling time t, π rt
t is the retail electricity price at the
scheduling time t, and �t is the scheduling interval. When the
prosumer n sells electricity to the prosumer m, pp2p
n,m,t becomes
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:17:25 UTC from IEEE Xplore.  Restrictions apply. 
HUA et al.: BLOCKCHAIN ENABLED DECENTRALIZED LOCAL ELECTRICITY MARKETS WITH FLEXIBILITY 1611
positive, π
p2p
n,m,t indicates the agreed selling price, and the term
(pp2p
n,m,t ·πp2p
n,m,t ·�t) indicates the revenues of the prosumer n at
the scheduling time t; When the prosumer n buys electricity
from the prosumer m, pp2p
n,m,t becomes negative, π
p2p
n,m,t indi-
cates the agreed buying price, and the term (pp2p
n,m,t ·πp2p
n,m,t ·�t)
indicates the costs of the prosumer n at the scheduling time t.
When a prosumer imports/exports electricity from/to a
retailer, this prosumer is a price taker which accepts the
retail prices (π rt
t )/wholesale prices (πwh
t ) determined by cen-
tralized energy markets, considering the small market share
of individual prosumers compared to retailers or generation
companies; When a prosumer trades electricity with neigh-
boring prosumers, this prosumer becomes a price maker which
determines its own buying/selling prices (pp2p
n,m,t) through the
negotiation. This decentralized pricing scheme incentivizes
prosumers to strategically schedule their multi-energy sources
and participate in the peer-to-peer electricity trading. In addi-
tion, since our research focuses on the operation of residential
prosumers, for which the operational costs of the roof-top solar
panel, air-source heat pump, and thermal energy storage is
extremely low, compared to the installation costs, it is assumed
that the operational costs of the roof-top solar panel, air-source
heat pump, and thermal energy storage of a prosumer are zero.
When a prosumer schedules its multi-energy generation and
consumption, the following operational constraints need to be
considered:
• Electricity balance constraint:
pr2p
n,t + ppv
n,t = pp2r
n,t +
∑
m∈N
pp2p
n,m,t + dhp
n,t + de
n,t,∀n ∈ N , t ∈ T ,
(2)
where ppv
n,t is the electricity produced by the roof-top solar
panel of the prosumer n at the scheduling time t, dhp
n,t is the
electricity used to run the air-source heat pump of the pro-
sumer n at the scheduling time t, and de
n,t is the electricity
consumption of appliances of the prosumer n at the scheduling
time t.
• Available heating power constraint:
qts
n,t + qhp
n,t ≥ dts
n,t + dh
n,t,∀n ∈ N , t ∈ T , (3)
where qts
n,t is the heating power discharged from the thermal
energy storage of the prosumer n at the scheduling time t,
qhp
n,t is the heating power supplied by the heat pump of the
prosumer n at the scheduling time t, dts
n,t is the heating power
charged to the thermal energy storage of the prosumer n at
the scheduling time t, and dh
n,t is the heating power supplied
to the household, e.g., for space heating, of the prosumer n at
the scheduling time t.
• Air-source heat pump constraints: Eq. (4) describes the
capacity constraint of the air-source heat pump, and Eq. (5)
describes the performance of the air-source heat pump for
using electricity to pump heat from a cold place to a warm
place.
0 ≤ qhp
n,t ≤ qhp,max
n ,∀n ∈ N , t ∈ T , (4)
qhp
n,t = ε
hp
n · dhp
n,t,∀n ∈ N , t ∈ T , (5)
where qhp,max
n is the nominal maximum heating power of the
air-source heat pump of the prosumer n, and ε
hp
n is the coef-
ficient of performance of the air-source heat pump of the
prosumer n.
• Thermal energy storage constraints: Eqs. (6) and (7)
describe the constraints of charging and discharging rates of
the thermal energy storage, respectively, Eq. (8) describes the
energy dynamics of the thermal energy storage, and Eq. (9)
describes the capacity constraint of the thermal energy storage.
0 ≤ dts
n,t ≤ dts, max
n ,∀n ∈ N , t ∈ T , (6)
0 ≤ qts
n,t ≤ qts, max
n ,∀n ∈ N , t ∈ T , (7)
sts
n,t = sts
n,t−1 + [
ϑ · dts
n,t − (1 − ϑ) · qts
n,t
] · �t,∀n ∈ N , t ∈ T ,
(8)
0 ≤ sts
n,t ≤ sts, max
n ,∀n ∈ N , t ∈ T , (9)
where dts, max
n and qts, max
n are the maximum charging and dis-
charging rates of the thermal energy storage of the prosumer n,
respectively, sts
n,t is the stored thermal energy of the prosumer
n at the scheduling time t, ϑ ∈ {0, 1} is a binary variable indi-
cating the charging (if ϑ = 1) or discharging (if ϑ = 0) of
the thermal energy storage, and sts, max
n is the thermal energy
storage capacity of the prosumer n.
• Buildings’ thermal inertia constraints: Eqs. (10) - (12)
describe the building thermal inertia by using the 1R1C
model [26], where Eq. (10) describes the dynamics of the
indoor temperature of a household, Eq. (11) describes the tem-
perature boundaries to maintain a prosumer’s comfort, and
Eq. (12) describes that the temperature at the end of the
scheduling horizon needs to be greater than or equal to the
temperature at the start of the scheduling horizon.
τn,t = exp
(−�t · un
cn
)
· τn,t−1 +
[
1 − exp
(−�t · un
cn
)]
· τ a
t
+ 1
un
·
[
1 − exp
(−�t · un
cn
)]
· dh
n,t, ∀n ∈ N , t ∈ T ,
(10)
τmin
n ≤ τn,t ≤ τmax
n , ∀n ∈ N , t ∈ T , (11)
τn,|T | ≥ τn,1, ∀n ∈ N , (12)
where τn,t is the indoor temperature of the prosumer n’s house-
hold at the scheduling time t with the unit of K, un is the
thermal transmittance of the prosumer n’s household with the
unit of W/K, cn is the thermal capacitance of the prosumer n’s
household with the unit of J/kgK, τ a
t is the temperature of the
ambient air at the scheduling time t, and τmin
n and τmax
n are the
minimum and maximum temperature boundaries to maintain
the comfort of the prosumer n.
Therefore, the tradeoff maximization problem of the pro-
sumer n can be described as
max
pp2r
n,t ,p
p2p
n,m,t,π
p2p
n,m,t,p
r2p
n,t ,d
hp
n,t,
qts
n,t,q
hp
n,t,d
ts
n,t,d
h
n,t,s
ts
n,t,τn,t
: f tradeoff
n ,∀n ∈ N , t ∈ T , (13)
s.t. Eqs. (2) − (12).
B. The Role of Retailers
Individual retailers aim to maximize their profits by strate-
gically determining the retail electricity prices. The profits of
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:17:25 UTC from IEEE Xplore.  Restrictions apply. 
1612 IEEE TRANSACTIONS ON SMART GRID, VOL. 14, NO. 2, MARCH 2023
a retailer can be described as the revenues of selling electricity
to its prosumers, subtracting the costs of buying the electric-
ity in wholesale markets (
∑
n∈N pr2p
n,t · πwh
t · �t) and buying
the electricity from its prosumers at the wholesale electric-
ity prices (
∑
n∈N pp2r
n,t · πwh
t · �t). Since the proposed model
focuses on the local electricity markets, the retailer is assumed
as a price taker in the wholesale markets, i.e., they must accept
the prevailing wholesale electricity prices. Hence, the function
of a retailer’s profits can be described as
f profit :=
∑
n∈N
pr2p
n,t · π rt
t · �t −
[
∑
n∈N
(
pr2p
n,t + pp2r
n,t
)
· πwh
t · �t
]
,
(14)
where f profit is the objective function of the profits of a retailer.
When a retailer decides the retail prices, the following
maximum/minimum price limits need to be considered as
π
rt,min
t ≤ π rt
t ≤ π
rt,max
t ,∀t ∈ T , (15)
where π
rt,min
t and π
rt,max
t are the minimum and maximum
limits of the retail electricity price at the scheduling time t.
The minimum and maximum limits are set by regulators
as the floor and cap of the retail electricity price, respec-
tively, to ensure a fair energy market. For instance, in
the GB energy market, the regulator, Office of Gas and
Electricity Markets (Ofgem) sets a price cap since 2017
to limit the rates at which a supplier can charge from
consumers [27].
Therefore, the profits maximization problem of a retailer
can be described as
max
π rt
t
: f profit,∀t ∈ T , (16)
s.t. Eq. (15).
C. Cooperative Stackelberg Game-Theoretic Problem
The interactions between a retailer and its |N | prosumers
were modeled as a Stackelberg game-theoretic problem,
through which the retailer acts as a leader to determine the
retail electricity pricing, and |N | prosumers act as the fol-
lowers to determine the volume of electricity exchange with
the retailer. The prosumers themselves play a cooperative
game to negotiate the volume and price of the peer-to-
peer electricity trading between themselves. Therefore, this
leads to a 1-leader and |N |-follower cooperative Stackelberg
game-theoretic problem. The procedure of this cooperative
Stackelberg game is as follows:
Step 1: The leader (retailer) determines the retail electric-
ity prices, by solving its optimization problem, i.e., objective
function Eq. (16) constrained by Eq. (15), based on the daily
prediction of power exchange with prosumers as
SL = {
π rt∗
t |t ∈ T
}
, (17)
where SL is the decision space of the leader.
Step 2: With the leader’s strategy, each individual pro-
sumer decides the responding strategies by solving its own
optimization problem, i.e., objective function Eq. (13) con-
strained by Eqs. (2) - (12), as
SF,n =
{
pp2r∗
n,t , pp2p∗
n,m,t, π
p2p∗
n,m,t, pr2p∗
n,t , dhp∗
n,t , qts∗
n,t ,
qhp∗
n,t , dts∗
n,t , dh∗
n,t, sts∗
n,t , τ
∗
n,t|t ∈ T
}
,∀n ∈ N , (18)
where SF,n is the decision space of the follower n.
Step 3: The followers cooperatively negotiate the vol-
ume and price of the electricity to be exchanged with each
other in an iterative manner. The iterative negotiation is
self-enforced by the standardized auction procedures on the
Blockchain based platform of peer-to-peer trading, which will
be detailed in Section III. In every iteration of negotiation, a
prosumer decreases/increases its selling/buying prices to clear
the unmatched supply/demand. The price decrement/increment
of different prosumers would be different depending on their
idiosyncratic responsiveness. To model these idiosyncratic
responsiveness, this research extends the concept of price
elasticities of a seller/buyer from microeconomics [28]. The
price elasticities of a seller/buyer describe the relative changes
in the electricity supply/demand resulting from a change in
selling/buying prices. Since the relative change in the electric-
ity supply/demand is unknown prior to the next iteration of
negotiation, our research uses the ratio of the unmatched sup-
ply/demand to matched supply/demand to replace it. The price
elasticities of a prosumer as an electricity seller and buyer are
defined as (19) and (20), respectively.
ξ s
n := punmatched
n,t (ι)/pmatched
n,t (ι)
�π
p2p
n,m,t/π
p2p
n,m,t(ι)
, (19)
ξb
n := dunmatched
n,t (ι)/dmatched
n,t (ι)
�π
p2p
n,m,t/π
p2p
n,m,t(ι)
, (20)
where ξ s
n and ξb
n are the price elasticities of the prosumer
n as an electricity seller and buyer, respectively, ι is the
iteration number of the negotiation, �π
p2p
n,m,t is the change of
the selling/buying price of the prosumer n negotiated with the
prosumer m at the scheduling time t from the iteration ι to
(ι+1), i.e., �π
p2p
n,m,t = π
p2p
n,m,t(ι+1)-πp2p
n,m,t(ι), punmatched
n,t (ι) is the
unmatched electricity supply of the prosumer n at the schedul-
ing time t which has not been accepted by any buyer until the
iteration ι, pmatched
n,t (ι) is the matched electricity supply of the
prosumer n at the scheduling time t which has already been
accepted by other buyers before the iteration ι, dunmatched
n,t (ι)
is the unmatched electricity demand of the prosumer n at the
scheduling time t which has not been satisfied by any seller
until the iteration ι, and dmatched
n,t (ι) is the matched electric-
ity demand of the prosumer n at the scheduling time t which
has already been satisfied by other sellers before the iteration
ι. Given that the total amount of the scheduled peer-to-peer
electricity trading of the prosumer n at the scheduling time t
equals to the sum of matched and unmatched amount at any
iteration, we have
∑
m∈N
pp2p∗
n,m,t =
{
punmatched
n,t (ι) + pmatched
n,t (ι), if
∑
m∈N pp2p
n,m,t > 0,
−[
dunmatched
n,t (ι) + dmatched
n,t (ι)
]
, if
∑
m∈N pp2p
n,m,t < 0.
(21)
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:17:25 UTC from IEEE Xplore.  Restrictions apply. 
HUA et al.: BLOCKCHAIN ENABLED DECENTRALIZED LOCAL ELECTRICITY MARKETS WITH FLEXIBILITY 1613
At the initial iteration, we have
π
p2p
n,m,t(ι = 1) = π
p2p∗
n,m,t, (22)
!
{
punmatched
n,t (ι = 1) = ∑
m∈N pp2p∗
n,m,t, if
∑
m∈N pp2p
n,m,t > 0,
dunmatched
n,t (ι = 1) = − ∑
m∈N pp2p∗
n,m,t, if
∑
m∈N pp2p
n,m,t < 0,
(23)
pmatched
n,t (ι = 1) = dmatched
n,t (ι = 1) = 0. (24)
Next, a prosumer adjusts its selling or buying price in every
iteration according to its price elasticity, until the unmatched
supply or demand is accepted. For an electricity seller, if there
still exists unmatched electricity supply at the iteration ι, i.e.,
punmatched
n,t (ι) > 0, this seller would decrease the selling price,
i.e., �π
p2p
n,m,t < 0. According to Eq. (19), we have
π
p2p
n,m,t(ι + 1) = π
p2p
n,m,t(ι) + π
p2p
n,m,t(ι) · punmatched
n,t (ι)
ξ s
n · pmatched
n,t (ι)
. (25)
For an electricity buyer, if there still exists unmatched electric-
ity demand at the iteration ι, i.e., dunmatched
n,t (ι)>0, this buyer
would increase the buying price, i.e., �π
p2p
n,m,t > 0. According
to Eq. (20), we have
π
p2p
n,m,t(ι + 1) = π
p2p
n,m,t(ι) + π
p2p
n,m,t(ι) · dunmatched
n,t (ι)
ξb
n · dmatched
n,t (ι)
. (26)
Step 4: This negotiation is iteratively proceeded until the
cooperative equilibrium [29] is reached. At the cooperative
equilibrium, not any prosumer wants to deviate its strategy. Let
ι� denote the iteration of reaching the cooperative equilibrium.
Theorem 1: The cooperative game converges to the coop-
erative equilibrium when the following three criteria hold
simultaneously:
• Prosumers exchange electricity with each other as much
as possible at their optimal price {πp2p∗
n,m,t|t ∈ T }.
• For the electricity sellers whose supply is not accepted
until the iteration ι�, their selling prices would decrease to the
wholesale electricity price. For the electricity buyers whose
demand is not satisfied until the iteration ι�, their buying prices
would increase to the retail electricity price as
π
p2p
n,m,t
(
ι�
) =
{
πwh
t , if punmatched
n,t (ι�) > 0,
π rt
t , if dunmatched
n,t (ι�) > 0.
(27)
• At the iteration ι�, there is no unmatched supply (if the
total demand is higher than the total supply of all prosumers)
or unmatched demand (if the total supply is higher than the
total demand of all prosumers) for any prosumer as
{
punmatched
n,t (ι�) = 0,∀n ∈ N , if
∑
n∈N pp2p
n,m,t < 0,
dunmatched
n,t (ι�) = 0,∀n ∈ N , if
∑
n∈N pp2p
n,m,t > 0.
(28)
Proof: For the criteria of Eqs. (27) and (28), 1) if
punmatched
n,t (ι) > 0, according to Eq. (25), the selling
price would decrease, i.e., π
p2p
n,m,t(ι + 1) < π
p2p
n,m,t(ι), and
if dunmatched
n,t (ι) > 0, according to Eq. (26), the buying
price would increase, i.e., π
p2p
n,m,t(ι + 1) > π
p2p
n,m,t(ι). The
iterative negotiation continues; 2) if punmatched
n,t (ι) = 0 or
dunmatched
n,t (ι) = 0, the selling or buying price would remain
Fig. 2. Flowchart of the cooperative Stackelberg game between the leader
and followers.
unchanged, i.e., π
p2p
n,m,t(ι + 1) = π
p2p
n,m,t(ι). The iterative negoti-
ation converges; 3) The iterative negotiation will diverge only
if π
p2p
n,m,t(ι) < πwh
t (when punmatched
n,t (ι) > 0), or π
p2p
n,m,t(ι) > π rt
t
(when dunmatched
n,t (ι) > 0), i.e., π
p2p
n,m,t exceeds the bound-
aries of [πwh
t , π rt
t ], which means that the seller/buyer would
export/import the electricity to/from the retailer at πwh
t /π rt
t to
minimize the electricity costs, rather than trading with other
prosumers.
Step 5: The remaining supply or demand of prosumers
which has not been matched during the peer-to-peer electricity
trading will be exchanged with the retailer at the whole-
sale or retail electricity price. The outputs of the cooperative
Stackelberg game are the optimal solutions for both the retailer
and its |N | prosumers, denoted as {S�
L,S�
F,n}, ∀n ∈ N .
The flowchart of the cooperative Stackelberg game between
the leader and followers is presented in Fig. 2.
III. BLOCKCHAIN BASED PLATFORM FOR PEER-TO-PEER
ELECTRICITY TRADING
This section introduces the architecture of Blockchain
networks, and two standardized forms of smart contracts for
negotiating the volume and price of peer-to-peer electricity
trading among prosumers.
A. Architecture of Blockchain Networks
A Blockchain based platform for the peer-to-peer electricity
trading was developed to integrate the negotiation information
and trading decisions of prosumers as shown in Fig. 3.
The states of smart contracts and accounts, transactions, and
receipts are structured into three modified Merkle Patricia
Tries [30] stored in the block body, in order to improve the ver-
ifiability and searching efficiency of trading information. The
root hashes of these three modified Merkle Patricia Tries are
stored in the block header to guarantee the tamper-resistance.
The blocks are chronologically chained through including the
hash of the previous block header into the current block, form-
ing a Blockchain [31]. Market operators operate full nodes
to manage the trading platform and validate all transactions.
Prosumers operate simplified payment verification (SPV) [32]
clients to access Blockchain networks for negotiation and trad-
ing. The SPV clients only store the block headers and verify
their related transactions with lower computational and storage
requirements compared to the full nodes.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:17:25 UTC from IEEE Xplore.  Restrictions apply. 
1614 IEEE TRANSACTIONS ON SMART GRID, VOL. 14, NO. 2, MARCH 2023
Fig. 3. Architecture of Blockchain based platform for the peer-to-peer
electricity trading. The states of smart contracts and accounts, transactions,
and receipts are structured into three modified Merkle Patricia Tries. The
Blockchain is formed through chronologically including the hash of the
previous block header into the current block. Market operators operate full
nodes and prosumers operate simplified payment verification.
B. Smart Contracts
Two standardized forms of smart contracts were designed
for electricity sellers and buyers, respectively, with the proce-
dures of the contract deployment, auction, winner selection,
and ownership exchange. In the smart contracts of sellers, a
number of buyers bid with a higher price in competition with
each other. Once the auction ends, the buyer with the highest
buying price wins. In the smart contracts of buyers, a num-
ber of sellers offer with a lower price in competition with
each other. Once the auction ends, the seller with the lowest
selling price wins. Both the seller’s contracts and the buyer’s
contracts are used in the day-ahead market, to negotiate the
price and volume of electricity for the following day. These
two standardized forms of smart contracts are replicable for all
prosumers, which prevents unforeseen trading behaviors and
reduces the costs for processing the information of negotia-
tion and trading. Each smart contract can be deployed by an
individual prosumer and multiple prosumers can deploy their
own smart contracts simultaneously by specifying their own
time of the auction end. Let i and j denote the indices of the
electricity seller and buyer, respectively. The detailed trading
procedures in the smart contracts of sellers and buyers are
described as follows.
1) Smart Contracts of Sellers:
Step 1 (Deployment of Seller): An electricity seller i deploys
the selling contracts by providing the information of the
seller’s address idi, network serial number φi, start time ti and
end time ti+�ti of the supplied electricity, supplied amount pi,
minimum accepted buying price πmin
i , and auction end time θi,
which can be described as Ci (idi, φi, ti, ti + �ti, pi, π
min
i , θi),
where Ci is the set of the smart contracts deployed by the seller
i. The network serial number is used to help prosumers find
their neighboring prosumers. The seller/buyer address is in
the payable property, which means it can receive the payment
from the smart contracts after the auction ends.
Step 2 (Auction of Buyers): For a seller’s contracts, a number
of buyers can enter the smart contracts to compete by biding
with a higher price. There are three conditions which allow a
buyer to enter the smart contracts:
• The auction is not ended, i.e., now ≤ θi;
• The network serial number of the buyer matches that of
the seller, i.e., φj = φi;
• The buyer’s buying price, denoted as πj, is higher than the
minimum accepted buying price of the seller, i.e., πj > πmin
i ;
• The buyer’s buying price is higher than the current highest
buying price, denoted as π�
i , i.e., πj > π�
i .
Once a buyer enters the seller’s smart contracts, the submit-
ted buying value (π�
i ·pi ·�ti) will be charged from the buyer’s
account and frozen by the smart contracts. Every time when
a buyer with a higher buying price π ′
j replaces the previous
highest buying price πj, the smart contracts will firstly trans-
fer the frozen buying value (πj · pi · �ti) back to the previous
highest buyer’s address, and then charge (π ′
j · pi · �ti) form
the current highest buyer’s address. The Blockchain networks
update the information of the current highest buyer’s address,
denoted as idj, i.e., j� = idj and its buying price, i.e., π�
i = π ′
j .
Step 3 (Pay to Seller): Once the auction ends, i.e., now > θi,
the highest buyer becomes the winner. After the delivery time
ti+�ti, the smart meter of the highest buyer sends the delivery
signal to the smart contracts. The smart contracts subsequently
transfer the frozen value to the seller’s account, after meeting
three conditions:
• The delivery is ended, i.e., now > ti + �ti;
• The paying value is non-zero, i.e., (π�
i · pi · �ti) > 0;
• The pay-to-seller function has not been called, i.e.,
paid = false.
Step 4 (Adjustment): For the case of the over-delivery due
to the uncertainty of solar generation, if a seller supplies more
energy than its promised volume in the day-ahead market, i.e.,
(p̂i ·�ti) > (pi ·�ti), where p̂ is the actual delivered power of
the seller i, the over-delivered energy, i.e., (p̂i·�ti−pi·�ti), will
be purchased by the retailer at the wholesale price πwh
t through
calling the transfer function by the retailer. For the case of the
under-delivery due to the uncertainty of solar generation, if
a seller supplies less energy than its promised volume in the
day-ahead market, i.e., (p̂i · �ti) < (pi · �ti), this seller needs
to purchase the under-delivered energy, i.e., (pi ·�ti − p̂i ·�ti)
from the retailer at the retail price π rt
t through calling the
transfer function, in order to meet the demand of its buyers.
Since the wholesale price is lower than the selling price and
retail price is higher than the buying price, the seller would
be incentivized to accurately predict its solar generation in the
day-ahead market to maximize its tradeoff.
2) Smart Contracts of Buyers:
Step 1 (Deployment of Buyer): An electricity buyer j
deploys the buying contracts by providing the information
of the buyer’s address idj, network serial number φj, start
time tj and end time tj + �tj of the electricity demand,
demand amount pj, maximum accepted selling price πmax
j ,
and the auction end time θj, which can be described as Cj
(idj, φj, tj, tj+�tj, pj, π
max
j , θj), where Cj is the set of the smart
contracts deployed by the buyer j.
Step 2 (Buyer Deposit): The electricity buyer j deposits the
value (πmax
j · pj · �tj) into the smart contracts. This deposit
is frozen by the smart contracts until a seller enters the smart
contracts.
Step 3 (Sellers Auction): For a buyer’s contracts, a number
of sellers can enter the smart contracts to compete by offering
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:17:25 UTC from IEEE Xplore.  Restrictions apply. 
HUA et al.: BLOCKCHAIN ENABLED DECENTRALIZED LOCAL ELECTRICITY MARKETS WITH FLEXIBILITY 1615
Algorithm 1 Selling Contracts
1: input: seller’s address (payable) idi, network serial num-
ber φi, supply start time ti, supply end time ti + �ti,
supplied amount pi, minimum accepted buying price πmin
i ,
auction end time θi
2: function: buyers auction (called by buyers)
3: input: network serial number φj, buying price πj
4: require: now ≤ θi
5: require: φj = φi
6: require: πj > πmin
i
7: require: πj > highest buying price π�
i
8: if π�
i �= 0
9: smart contracts transfer (π�
i ·pi ·�ti) back to previous
highest buyer’s address
10: end
11: output: update current highest buyer’s address j�=idj
and its buying price π�
i = π ′
j
12: function: pay-to-seller
13: input: paying value (π�
i · pi · �ti)
14: require: now > ti + �ti
15: require: (π�
i · pi · �ti) > 0
16: require: paid = false
17: smart contracts transfer (π�
i ·pi ·�ti) to seller’s address
18: output: paid = true
19: function: adjustment
20: input: actual delivery (p̂i · �ti), submitted volume
(pi · �ti), wholesale price πwh
t , retail price π rt
t
21: require: paid = true
22: if (p̂i · �ti) > (pi · �ti)
23: smart contracts transfer [(p̂i-pi)·�ti · πwh
t ] from the
retailer to the seller
24: else if (p̂i · �ti) < (pi · �ti)
25: smart contracts transfer [(pi-p̂i)·�ti · π rt
t ] from the
seller to the retailer
26: output: adjustment completed
with a lower price. There are three conditions which allow a
seller to enter the smart contracts:
• The auction is not ended, i.e., now ≤ θj;
• The network serial number of the seller matches that of
the buyer, i.e., φi = φj;
• The seller’s selling price, denoted as πi, is lower than the
maximum accepted selling price of the buyer, i.e., πi < πmax
j ;
• The seller’s selling price is lower than the current lowest
selling price, denoted as π�
j , i.e., πi < π�
j .
Once a seller with price π ′
i enters the buyer’s smart con-
tracts, the smart contracts would refund the difference between
the previous deposit (π�
j · pj · �tj) and current selling value
(π ′
i · pj · �tj) to the buyer’s address. The Blockchain networks
update the information of the current lowest seller’s address,
i.e., i� = idi and its selling price, i.e., π�
j = π ′
i .
Step 4 (Pay to Seller): Once the auction ends, i.e., now >
θi, the lowest seller becomes the winner. After the delivery
time tj + �tj, the smart meter of the buyer sends the delivery
signal to the smart contracts. The smart contracts subsequently
Algorithm 2 Buying Contracts
1: input: buyer’s address (payable) idj, network serial num-
ber φj, demand start time tj, demand end time tj + �tj,
demand amount pj, maximum accepted selling price πmax
j ,
auction end time θj
2: function: buyer deposit (called by the buyer)
3: input: deposit
4: require: deposit = (πmax
j · pj · �tj)
5: output: deposit transferred from idj to smart contracts
6: function: sellers auction (called by sellers)
7: input: network serial number φi, selling price πi
8: require: now ≤ θj
9: require: φi = φj
10: require: πi < πmax
j
11: require: πi < lowest selling price π�
j
12: if π�
j = 0
13: smart contracts transfer (πmax
j · pj · �tj-π ′
i · pj · �tj)
back to the buyer’s address
14: else
15: smart contracts transfer (π�
j · pj · �tj-π ′
i · pj · �tj)
back to the buyer’s address
16: end
17: output: update the current lowest seller’s address i�=idi
and its selling price π�
j = πi
18: function: pay-to-seller
19: input: paying value (π�
j · pj · �tj)
20: require: now > tj + �tj
21: require: (π�
j · pj · �tj) > 0
22: require: paid = false
23: smart contracts transfer (π�
j ·pj ·�tj) to seller’s address
24: output: paid = true
25: function: adjustment
26: input: actual delivery (p̂i · �tj), submitted volume
(pj · �tj), wholesale price πwh
t , retail price π rt
t
27: require: paid = true
28: if (p̂i · �tj) > (pj · �tj)
29: smart contracts transfer [(p̂i-pj)·�tj · πwh
t ] from the
retailer to the seller
30: else if (p̂i · �tj) < (pj · �tj)
31: smart contracts transfer [(pj-p̂i)·�tj · π rt
t ] from the
seller to the retailer
32: output: adjustment completed
transfer the frozen value to the lowest seller’s account, after
meeting three conditions:
• The delivery is ended, i.e., now > tj + �tj;
• The paying value is non-zero, i.e., (π�
j · pj · �tj) > 0;
• The pay-to-seller function has not been called, i.e.,
paid = false.
Step 5 (Adjustment): For the case of the over-delivery due
to the uncertainty of solar generation, if a seller supplies
more energy than the demanded volume in the day-ahead mar-
ket, i.e., (p̂i · �tj) > (pj · �tj), the over-delivered energy,
i.e., (p̂i · �tj − pj · �tj), will be purchased by the retailer
at the wholesale price πwh
t through calling the transfer func-
tion by the retailer. For the case of the under-delivery due
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:17:25 UTC from IEEE Xplore.  Restrictions apply. 
1616 IEEE TRANSACTIONS ON SMART GRID, VOL. 14, NO. 2, MARCH 2023
to the uncertainty of solar generation, if a seller supplies
less energy than the demanded volume in the day-ahead
market, i.e., (p̂i · �tj) < (pj · �tj), this seller needs to pur-
chase the under-delivered energy, i.e., (pj · �tj − p̂i · �tj)
from the retailer at the retail price π rt
t through calling
the transfer function, in order to meet the demand of its
buyers.
Remark 1: The minimum accepted buying price of the seller
and maximum accepted selling price of the buyer are the initial
prices yielded by solving their own optimization problems,
which corresponds to the Eq. (22). For the buyers’ auction,
how a buyer bids with a higher price is modeled by Eq. (26).
For the sellers’ auction, how a seller offers with a lower price
is modeled by Eq. (25).
Remark 2: There are two time domains defined in our
research: 1) the time for prosumers’ day-ahead energy schedul-
ing, in which the time interval (�t) corresponds to every
half-hour for the following day and time horizon (|T |) corre-
sponds to the total 48 half-hour intervals. We have (�t, |T |) =
(0.5, 48); 2) The time of the auction end (θi and θj), only
before which buyers or sellers can enter the smart contracts for
the real-time negotiation on the price and volume of electricity
for the following day.
C. Advantage Remark
The proposed Blockchain smart contracts have the
following advantages compared to the existing Blockchain-
based mechanisms on the peer-to-peer electricity
trading:
1) The optimal decisions on the price and volume of peer-
to-peer electricity trading are integrated into the Blockchain
platform as the inputs, without interventions from power
system operators or market operators.
2) The negotiation and price clearing mechanisms mod-
eled by the cooperative game are standardized by the
designed smart contracts, which could be automatically
executed in a self-enforcing manner. This reduces the
costs for processing the information from the trading and
negotiation.
3) The idiosyncratic smart contracts are designed specifi-
cally for the auctions of 1-buyer, multiple-seller or 1-seller,
multiple buyers to adapt dynamic supply-demand balance of
local energy markets.
4) The prosumers can operate the SPV clients, which
reduces the requirements on computation and storage, so that
they are able to participate in the peer-to-peer electricity
trading with smart meters or smart phones.
IV. CASE STUDIES
Case studies have been conducted on 7 households in
England, served by the same electricity retailer. The prosumers
1, 3, 4 and 7 are equipped with roof-top solar panels, whereas
the prosumers 2, 5, and 6 are without roof-top solar panels.
The generation profiles of the roof-top solar panels were col-
lected from Renewables.ninja [33] with the installed capacity
of 6 kW. The scheduling horizon is 24 h for the next day in
the 0.5 h interval. £0.065/kWh of the average wholesale price
TABLE II
PARAMETERS OF HEATING SYSTEMS USED IN THE CASE STUDIES
TABLE III
COMPARISON OF ASSUMPTIONS OF CASES
in 2020 from the GB energy market [34] was used. The min-
imum and maximum limits of the retail electricity price were
decided by choosing the minimum and maximum historical
retail electricity prices in the GB energy markets, in which
π
rt,min
t = £0/kWh and π
rt,max
t = £0.35/kWh. The input data
of the solar generation and ambient temperature in a typical
winter day was selected to investigate the impacts of heat-
ing systems. The parameters of heating systems used in the
case studies are listed in Table II. The specific value of price
elasticities for each prosumer is determined by the average
historical values of the changes of electricity consumption
resulting from the changes of retail electricity prices. The
smart contracts were written in the Solidity language [30] and
deployed on the Remix - Ethereum IDE [35]. The optimization
problems were programmed by the MATLAB and solved by
the artificial immune algorithm [36]. The simulations were
performed on a machine with the Intel Core i7-4470HQ CPU
at 2.20 GHz.
To evaluate the benefits of the designed architecture of local
electricity markets in terms of the peer-to-peer electricity trad-
ing and flexibility provision from heating sources, four cases
have been analyzed and compared:
• Case 1 (Proposed Model): All prosumers are equipped
with thermal energy storage and able to participate in
the peer-to-peer electricity trading. The indoor tempera-
ture can be flexibly controlled within the comfort range of
prosumers.
• Case 2 (Constant Indoor Temperature): The indoor
temperature of a household is assumed to be constant to
specifically investigate how to strategically run the air-source
heat pump and thermal energy storage in responding to retail
electricity prices.
• Case 3 (No Thermal Energy Storage): To investigate how
the thermal energy storage affects the flexibility of electricity
exchange, this case removes the thermal energy storage and
assumes the constant indoor temperature.
• Case 4 (No Peer-to-Peer Electricity Trading): To investi-
gate the impacts of the peer-to-peer electricity trading, this
case removes the option of exchanging electricity among
prosumers themselves.
The comparison of assumptions of these four cases is
summarized in Table III.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:17:25 UTC from IEEE Xplore.  Restrictions apply. 
HUA et al.: BLOCKCHAIN ENABLED DECENTRALIZED LOCAL ELECTRICITY MARKETS WITH FLEXIBILITY 1617
Prosumer 1 (With Solar Panel)
On-site Generation and Consumption
0
2
4
6
Prosumer 5 (Without Solar Panel)
Appliances Consumption
Heat Pump Consumption
Solar Generation
1 12 24 36 48
Time (0.5 h)
-4
-2
0
2
4
6
E
le
ct
ric
ity
 (
kW
)
Electricity Exchange
Sell
Buy
1 12 24 36 48
Retailer to Prosumer
Prosumer to Retailer
Peer-to-Peer
Fig. 4. Comparison of the electricity on-site generation, consumption, and
exchange between the prosumer 1 and prosumer 5. The x axes indicate the
scheduling time and the y axes indicate the electricity. The stacked areas in
the top two sub-figures indicate the total electricity consumption. The positive
value of the electricity exchange indicates a prosumer sells electricity to other
prosumers or the retailer, and the negative value of the electricity exchange
indicates a prosumer buys electricity from other prosumers or the retailer.
A. Impacts of On-Site Electricity Generation
To investigate the impacts of the on-site solar generation
on the electricity exchange, the prosumer 1 with the solar
panel installed and prosumer 5 without the solar panel installed
under the case 1 are sampled for comparison as presented in
Fig. 4. With the installation of the roof-top solar panel, the
prosumer 1 is able to generate electricity from 9:00 - 15:30.
As a result, the electricity import from the retailer to the pro-
sumer 1 during this period is close to zero. By contrast, without
the installation of the roof-top solar panel, the prosumer 5
has to rely on the electricity import from other prosumers or
the retailer during the entire scheduling horizon. This causes
higher daily electricity costs for the prosumer 5 (£ 5.72), com-
pared to the daily electricity costs for the prosumer 1 (£ 4.76),
under the same scale of the electricity demand.
During the periods when there is no solar radiation, both
prosumers and consumers have to rely on the electricity import
from the retailer. During the periods when there is solar radi-
ation, the total on-site generation is lower than total demand
of all prosumers. The electricity sellers therefore prefer to sell
their electricity to other prosumers at higher agreed prices,
rather than selling to the retailer at the wholesale price. For this
reason, the electricity exported from all electricity sellers (pro-
sumers 1, 3, 4, and 7) to the retailer over the entire scheduling
horizon is zero. In addition, the reason for a prosumer still buy-
ing electricity from the retailer instead of other prosumers, e.g.,
the prosumer 5 at 12:30, is that the total on-site generation is
lower than the total demand and this buyer cannot be satisfied
due to providing a lower buying price compared to the prices
provided by other buyers.
B. Performance of Heating Systems
The heating performances of the prosumer 1 in the Case 2
are presented in Fig. 5. To specifically investigate how to
strategically run the air-source heat pump and thermal energy
storage in responding to retail electricity prices, the indoor
temperature is assumed to be maintained at 291.15 K during
Fig. 5. Heating performances of the prosumer 1 in the Case 2. The x axes
indicate the scheduling time. The y axis in the first sub-figure indicates the
retail electricity price, the y axis in the second sub-figure indicates the outdoor
temperature, the y axes in the third, fifth, and sixth sub-figures indicate the
thermal power, and the y axis in the fourth sub-figure indicates the stored
thermal energy. The heat supplied to a household comes from the air-source
heat pump and thermal energy storage.
the entire scheduling horizon. During the period from 4:30
to 8:00, the highest thermal demand is supplied by ramping
up the air-source heat pump and discharging of the thermal
energy storage to the maximum levels. During the period from
11:30 to 13:30, the lowest thermal demand is primarily sup-
plied by the discharging of the thermal energy storage instead
of the air-source heat pump, since the electricity demand by
other electrical appliances increases. During the period from
16:00 to 21:00 when the retail electricity prices are relatively
high, the air-source heat pump reduces the heating supply
to avoid higher electricity costs. To complement this reduced
heating supply, the discharge from the thermal energy storage
increases.
To investigate how the thermal energy storage affects the
flexibility of using grid electricity, the Case 2 is compared with
Case 3 in which the only source for supplying heat demand
is the air-source heat pump. The comparison of the electricity
import from the retailer to prosumer 1 between the Case 2 and
Case 3 is presented in Fig. 6. It can be seen that during the
period when the retail electricity prices are relatively high as
indicated in the blue box, the electricity import in the Case 2 is
lower than that in the Case 3 due to the increase of discharge
from the thermal energy storage.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:17:25 UTC from IEEE Xplore.  Restrictions apply. 
1618 IEEE TRANSACTIONS ON SMART GRID, VOL. 14, NO. 2, MARCH 2023
Fig. 6. Comparison of the electricity import from the retailer to the pro-
sumer 1 between the Case 2 and Case 3. The x axis indicates the scheduling
time and the y axis indicates the electricity.
Fig. 7. Unmatched electricity supply/demand and selling/buying prices with
the proceeding of the negotiating iterations. The x axes indicate the iteration
number. The y axis in the top sub-figure indicates the unmatched electricity
supply/demand, and the y axis in the bottom sub-figure indicates the peer-
to-peer selling/buying price. The positive values of the unmatched electricity
indicate the prosumers sell electricity to other prosumers, and the negative
values of the unmatched electricity indicate the prosumers buy electricity
from other prosumers.
C. Demonstration of Cooperative Negotiation
To demonstrate the iterative negotiation among prosumers,
the peer-to-peer electricity trading for the twenty-eighth time
interval in the Case 1 is sampled. The changes of unmatched
electricity supply/demand and selling/buying prices with the
proceeding of the negotiating iterations are presented in Fig. 7.
The prosumers 1, 3, 4, and 7 are electricity sellers, and the pro-
sumers 2, 5, and 6 are electricity buyers. At the first iteration,
the initial selling/buying amounts and prices are obtained from
solving the optimization problem of each prosumer. At the sec-
ond iteration, 0.042 kWh of electricity supply from the seller 7
is accepted by the buyer 5 at £ 0.090/kWh of the agreed price.
The unmatched sellers and buyers keep adjusting their prices
until the fourth iteration, at which 0.044 kWh and 0.077 kWh
of electricity supply from the sellers 1 and 3, respectively, are
accepted by the buyer 5 at £ 0.100/kWh of the agreed price.
At the fifth iteration, 0.110 kWh and 0.016 kWh of electricity
demand from buyers 5 and 6, respectively, are accepted by
the seller 4 at £ 0.105/kWh of the agreed price. At the sixth
iteration, the rest 0.026 kWh of electricity supply from the
seller 4 is accepted by the buyer 2 at £ 0.100/kWh of the
Fig. 8. Comparison of the total electricity exchange between all prosumers
and the retailer with and without the peer-to-peer electricity trading. The x
axes indicate the scheduling time and the y axes indicate the electricity.
agreed price. Since the total supply of sellers is lower than
the total demand of buyers, there is 0.007 kWh of electricity
demand from the buyer 2 which needs to be imported from
the retailer.
D. Impacts of Peer-to-Peer Electricity Trading
To investigate the impacts of the peer-to-peer electricity
trading, our proposed model in Case 1 is compared to the case
without the peer-to-peer electricity trading in Case 4, under
which the prosumers who have extra electricity can only export
to the retailer. The comparison of these two cases in terms of
the total electricity exchange between all prosumers and the
retailer is presented in Fig. 8. With the peer-to-peer electric-
ity trading during the period from 9:00 to 15:30, instead of
selling/buying the electricity to/from the retailer at the whole-
sale/retail electricity prices, prosumers prefer to trade with
other prosumers at their agreed prices. For this reason, the
total export during this period is close to zero and the total
import during this period is reduced compared to the Case 4,
which indicates an improved local energy balance.
E. Scalability Evaluation
To evaluate the scalability in terms of the cost reduction
and computational efficiency, our proposed model is tested
under the cases of 1) 7-prosumer, 1-retailer, 4-solar panel,
2) 200-prosumer, 4-retailer, 100-solar panel, 3) 500-prosumer,
10-retailer, 250-solar panel, and 4) 1000-prosumer, 20-retailer,
500-solar panel. The comparison of the computational time
and total daily electricity costs with and without the peer-to-
peer electricity trading is presented in Fig. 9. With respect
to the computational efficiency, it can be seen from the figure
that the computational time linearly increases with the increase
of the system scale, and the proposed model spends more time
in every case due to the computational burden of the cooper-
ative game among prosumers. The computational time under
the scale of 1000-prosumer, 20-retailer, 500-solar panel is still
within an acceptable range. With respect to the total daily
costs, the average daily costs for each prosumer/consumer
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:17:25 UTC from IEEE Xplore.  Restrictions apply. 
HUA et al.: BLOCKCHAIN ENABLED DECENTRALIZED LOCAL ELECTRICITY MARKETS WITH FLEXIBILITY 1619
Fig. 9. Comparison of the computational time and total daily electricity
costs of all prosumers with and without the peer-to-peer electricity trading,
under the cases of 1) 7-prosumer, 1-retailer, 4-solar panel, 2) 200-prosumer,
4-retailer, 100-solar panel, 3) 500-prosumer, 10-retailer, 250-solar panel, and
4) 1000-prosumer, 20-retailer, 500-solar panel. The x axes indicate the system
scale. The y axis in the top sub-figure indicates the computational time, and
the y axis in the bottom sub-figure indicates the total daily electricity costs
of all prosumers.
with the peer-to-peer electricity trading over the four cases
are £ 5.40, whereas the average daily costs for each pro-
sumer/consumer without the peer-to-peer electricity trading
over the four cases are £ 9.19. The peer-to-peer electricity
trading reduces 41.24% of average daily electricity costs for
each prosumer/consumer. For prosumers with the installation
of solar panels, the cost reduction primarily comes from the
on-site generation. For consumers without the installation of
solar panels, they can also save their costs by buying electricity
from neighboring prosumers.
V. CONCLUSION
This paper proposed a Blockchain based local electricity
markets with the flexibility provision from heat sources. The
negotiation of the volume and price of the peer-to-peer elec-
tricity trading among prosumers was modeled by a cooperative
game, and automatically self-enforced by two standardized
forms of smart contracts. The interaction between a retailer
and its ensemble of prosumers was modeled as a Stackelberg
game, in order to find optimal decisions for maximizing prof-
its for retailers and minimizing electricity costs for prosumers.
Case studies show that the roof-top solar panels help pro-
sumers reduce their dependence on buying grid electricity
from the retailer. The thermal energy storage is able to com-
plement the heat supply from the air-source heat pump, in
responding to the variation of retail electricity prices. The peer-
to-peer trading in local electricity markets helps prosumers
save the electricity costs and improve the local energy balance.
As a future work, we will investigate the responsibilities
and assets accounting of prosumers in local electricity markets
from the regulatory perspective. For instance, how to charge
for the use of distribution networks and allocate carbon credits
when prosumers participate in the peer-to-peer electricity trad-
ing? How to audit for both physical assets, e.g., air-source heat
pump, and non-physical assets, e.g., transaction information,
for prosumers?
REFERENCES
[1] C. Zhang, J. Wu, Y. Zhou, M. Cheng, and C. Long, “Peer-to-peer energy
trading in a microgrid,” Appl. Energy, vol. 220, pp. 1–12, Jun. 2018.
[2] W. Tushar et al., “A coalition formation game framework for peer-to-peer
energy trading,” Appl. Energy, vol. 261, Mar. 2020, Art. no. 114436.
[3] M. Yan et al., “Blockchain for transacting energy and carbon allowance
in networked microgrids,” IEEE Trans. Smart Grid, vol. 12, no. 6,
pp. 4702–4714, Nov. 2021.
[4] J. Li, Y. Ye, and G. Strbac, “Stabilizing peer-to-peer energy trading
in prosumer coalition through computational efficient pricing,” Electr.
Power Syst., vol. 189, Dec. 2020, Art. no. 106764.
[5] W. Tushar et al., “Grid influenced peer-to-peer energy trading,” IEEE
Trans. Smart Grid, vol. 11, no. 2, pp. 1407–1418, Mar. 2020.
[6] H. Haggi and W. Sun, “Multi-round double auction-enabled peer-to-peer
energy exchange in active distribution networks,” IEEE Trans. Smart
Grid, vol. 12, no. 5, pp. 4403–4414, Sep. 2021.
[7] A. Grubler et al., “A low energy demand scenario for meeting the 1.5 ◦C
target and sustainable development goals without negative emission
technologies,” Nat. Energy, vol. 3, no. 6, pp. 515–527, 2018.
[8] F. Nematkhah, S. Bahrami, F. Aminifar, and J. P. S. Catalão, “Exploiting
the potentials of HVAC systems in transactive energy markets,” IEEE
Trans. Smart Grid, vol. 12, no. 5, pp. 4039–4048, Sep. 2021.
[9] W. Liu, D. Qi, and F. Wen, “Intraday residential demand response
scheme based on peer-to-peer energy trading,” IEEE Trans. Ind.
Informat., vol. 16, no. 3, pp. 1823–1835, Mar. 2020.
[10] R. Jing, M. N. Xie, F. X. Wang, and L. X. Chen, “Fair P2P energy trading
between residential and commercial multi-energy systems enabling inte-
grated demand-side management,” Appl. Energy, vol. 262, Mar. 2020,
Art. no. 114551.
[11] L. Langer, “An optimal peer-to-peer market considering modulating
heat pumps and photovoltaic systems under the German Levy regime,”
Energies, vol. 13, no. 20, p. 5348, 2020.
[12] T. Chen, S. Bu, X. Liu, J. Kang, F. R. Yu, and Z. Han, “Peer-to-peer
energy trading and energy conversion in interconnected multi-energy
microgrids using multi-agent deep reinforcement learning,” IEEE Trans.
Smart Grid, vol. 13, no. 1, pp. 715–727, Jan. 2022.
[13] H. Zhang, S. Zhang, X. Hu, H. Cheng, Q. Gu, and M. Du,
“Parametric optimization-based peer-to-peer energy trading among
commercial buildings considering multiple energy conversion,” Appl.
Energy, vol. 306, Jan. 2020, Art no. 118040.
[14] P. Danzi, M. Angjelichinoski, Č. Stefanović, and P. Popovski,
“Distributed proportional-fairness control in microgrids via blockchain
smart contracts,” in Proc. IEEE Int. Conf. Smart Grid Commun.
(SmartGridComm), Dresden, Germany, 2017, pp. 45–51.
[15] L. Thomas, Y. Zhou, C. Long, J. Wu, and N. Jenkins, “A general form
of smart contract for decentralized energy systems management,” Nat.
Energy, vol. 4, no. 2, pp. 140–149, 2019.
[16] C. Brandstätt, G. Brunekreeft, and N. Friedrichsen, “Improving invest-
ment coordination in electricity networks through smart contracts,”
Bremen Energy Working Papers, Bremen, Germany, Rep., 2011.
[Online]. Available: https://www.econstor.eu/handle/10419/103342
[17] “The Sun Exchange Inc.” Jan. 2022. [Online]. Available:
https://thesunexchange.com/
[18] C. Liu, K. K. Chai, X. Zhang, and Y. Chen, “Peer-to-peer electricity trad-
ing system: Smart contracts based proof-of-benefit consensus protocol,”
Wireless Netw., vol. 27, pp. 4217–4228, Feb. 2019.
[19] D. Han, C. Zhang, J. Ping, and Z. Yan, “Smart contract architecture for
decentralized energy trading and management based on blockchains,”
Energy, vol. 199, May 2020, Art. no. 117417.
[20] J. Abdella, Z. Tari, A. Anwar, A. Mahmood, and F. Han, “An archi-
tecture and performance evaluation of blockchain-based peer-to-peer
energy trading,” IEEE Trans. Smart Grid, vol. 12, no. 4, pp. 3364–3378,
Jul. 2021.
[21] P. Alstone, D. Gershenson, and D. M. Kammen, “Decentralized energy
systems for clean electricity access,” Nat. Clim. Change, vol. 5, no. 4,
pp. 305–314, 2015.
[22] Y. Parag and B. K. Sovacool, “Electricity market design for the prosumer
era,” Nat. Energy, vol. 1, no. 4, pp. 1–6, 2016.
[23] S. Pauliuk et al., “Global scenarios of resource and emission sav-
ings from material efficiency in residential buildings and cars,” Nat.
Commun., vol. 12, no. 1, pp. 1–10, 2021.
[24] A. Schneiders, M. Fell, and C. Nolden. “Peer-to-peer energy trading
and the sharing economy: Social, markets and regulatory perspectives,”
2020, doi: 10.20944/preprints202008.0266.v1.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:17:25 UTC from IEEE Xplore.  Restrictions apply. 
http://dx.doi.org/10.20944/preprints202008.0266.v1
1620 IEEE TRANSACTIONS ON SMART GRID, VOL. 14, NO. 2, MARCH 2023
[25] V. Buterin et al., “A next-generation smart contract and decentralized
application platform,” White Paper, vol. 3, no. 37, 2014. [Online].
Available: https://blockchainlab.com/pdf/Ethereum_white_paper-a
_next_generation_smart_contract_and_decentralized_application_
platform-vitalik-buterin.pdf
[26] A. Ashouri, S. S. Fux, M. J. Benz, and L. Guzzella, “Optimal design and
operation of building services using mixed-integer linear programming
techniques,” Energy, vol. 59, pp. 365–376, Sep. 2013.
[27] “Default Tariff Cap.” Dec. 2021. [Online]. Available: https://www.
ofgem.gov.uk/energy-policy-and-regulation/policy-and-regulatory-
programmes/default-tariff-cap
[28] R. M. Ayers and R. A. Collinge, Microeconomics: Explore and Apply
and Companion Website PLUS. Hoboken, NJ, USA: Prentice-Hall, 2003.
[29] B. Tołwiński, “A concept of cooperative equilibrium for dynamic
games,” Automatica, vol. 18, no. 4, pp. 431–441, 1982.
[30] C. Dannen, Introducing Ethereum and Solidity. Berkeley, CA, USA:
Springer, 2017, vol. 318.
[31] M. Swan, Blockchain: Blueprint for a New Economy. Sebastopol, CA,
USA: O’Reilly Media, Inc., 2015.
[32] I.-C. Lin and T.-C. Liao, “A survey of blockchain security issues and
challenges,” Int. J. Netw. Security, vol. 19, no. 5, pp. 653–659, 2017.
[33] “renewables.ninja.” Sep. 2021. [Online]. Available:
https://www.renewables.ninja/
[34] “Data Portal.” Sep. 2021. [Online]. Available: https://www.ofgem.gov.
uk/data-portal
[35] “Remix IDE.” Sep. 2021. [Online]. Available: https://remix.ethereum.
org/
[36] W.-Y. Chiu, H. Sun, and H. V. Poor, “A multiobjective approach to
multimicrogrid system design,” IEEE Trans. Smart Grid, vol. 6, no. 5,
pp. 2263–2272, Sep. 2015.
Weiqi Hua (Student Member, IEEE) received the
M.Sc. and Ph.D. degrees in engineering from the
University of Durham, U.K., in 2017 and 2020,
respectively, and then took the postdoctoral posi-
tion with Cardiff University in 2020. Since 2021,
he has been with the University of Oxford, U.K.,
as a Postdoctoral Researcher. His research interests
include the energy system modeling, energy system
digitalization, and peer-to-peer energy trading. He
served as a Guest Editor of IET Smart Grid on the
topic of peer-to-peer energy trading and Water on
the topic of energy-water nexus.
Yue Zhou (Member, IEEE) received the B.Sc.,
M.Sc., and Ph.D. degrees in electrical engineer-
ing from Tianjin University, China, in 2011,
2016 and 2016, respectively. He is a Lecturer
of Cyber–Physical Systems with the School of
Engineering, Cardiff University, Wales, U.K. His
research interests include demand response, peer-
to-peer energy trading, and cyber–physical systems.
He is a Managing Editor of Applied Energy and an
Associate Editor of IET Energy Systems Integration,
IET Renewable Power Generation, and Frontiers in
Energy Research. He is the Chair of CIGRE U.K. Next Generation Network
(NGN) Committee. He is also a Committee Member of IEEE PES U.K. and
Ireland Chapter.
Meysam Qadrdan (Senior Member, IEEE) is a
Reader of Cardiff University. His research focuses
on modeling and analysis of integrated energy
systems.
Jianzhong Wu (Senior Member, IEEE) received the
B.Sc., M.Sc., and Ph.D. degrees in electrical engi-
neering from Tianjin University, China, in 1999,
2002 and 2004, respectively. He is a Professor of
Multi-Vector Energy Systems and the Head of the
School of Engineering, Cardiff University, U.K. His
research interests include integrated multi-energy
infrastructure and smart grid. He is Co-Editor-in-
Chief of Applied Energy. He is the Co-Director of
U.K. Energy Research Centre and EPSRC Supergen
Energy Networks Hub.
Nick Jenkins (Fellow, IEEE) received the B.Sc.
degree from Southampton University, Southampton,
U.K., in 1974, the M.Sc. degree from Reading
University, Reading, U.K., in 1975, and the Ph.D.
degree from Imperial College London, London,
U.K., in 1986. He is currently a Professor with
Cardiff University, Cardiff, U.K. Before moving to
academia, his career included 14 years of indus-
trial experience of which 5 years were in developing
countries. While at university, he has developed
teaching and research activities in both electrical
power engineering and renewable energy.
Authorized licensed use limited to: CITY UNIV OF HONG KONG. Downloaded on April 15,2023 at 09:17:25 UTC from IEEE Xplore.  Restrictions apply. 
<<
  /ASCII85EncodePages false
  /AllowTransparency false
  /AutoPositionEPSFiles false
  /AutoRotatePages /None
  /Binding /Left
  /CalGrayProfile (Gray Gamma 2.2)
  /CalRGBProfile (sRGB IEC61966-2.1)
  /CalCMYKProfile (U.S. Web Coated \050SWOP\051 v2)
  /sRGBProfile (sRGB IEC61966-2.1)
  /CannotEmbedFontPolicy /Warning
  /CompatibilityLevel 1.4
  /CompressObjects /Off
  /CompressPages true
  /ConvertImagesToIndexed true
  /PassThroughJPEGImages true
  /CreateJobTicket false
  /DefaultRenderingIntent /Default
  /DetectBlends true
  /DetectCurves 0.0000
  /ColorConversionStrategy /LeaveColorUnchanged
  /DoThumbnails false
  /EmbedAllFonts true
  /EmbedOpenType false
  /ParseICCProfilesInComments true
  /EmbedJobOptions true
  /DSCReportingLevel 0
  /EmitDSCWarnings false
  /EndPage -1
  /ImageMemory 1048576
  /LockDistillerParams true
  /MaxSubsetPct 100
  /Optimize true
  /OPM 0
  /ParseDSCComments false
  /ParseDSCCommentsForDocInfo false
  /PreserveCopyPage true
  /PreserveDICMYKValues true
  /PreserveEPSInfo false
  /PreserveFlatness true
  /PreserveHalftoneInfo true
  /PreserveOPIComments false
  /PreserveOverprintSettings true
  /StartPage 1
  /SubsetFonts false
  /TransferFunctionInfo /Remove
  /UCRandBGInfo /Preserve
  /UsePrologue false
  /ColorSettingsFile ()
  /AlwaysEmbed [ true
    /Arial-Black
    /Arial-BoldItalicMT
    /Arial-BoldMT
    /Arial-ItalicMT
    /ArialMT
    /ArialNarrow
    /ArialNarrow-Bold
    /ArialNarrow-BoldItalic
    /ArialNarrow-Italic
    /ArialUnicodeMS
    /BookAntiqua
    /BookAntiqua-Bold
    /BookAntiqua-BoldItalic
    /BookAntiqua-Italic
    /BookmanOldStyle
    /BookmanOldStyle-Bold
    /BookmanOldStyle-BoldItalic
    /BookmanOldStyle-Italic
    /BookshelfSymbolSeven
    /Century
    /CenturyGothic
    /CenturyGothic-Bold
    /CenturyGothic-BoldItalic
    /CenturyGothic-Italic
    /CenturySchoolbook
    /CenturySchoolbook-Bold
    /CenturySchoolbook-BoldItalic
    /CenturySchoolbook-Italic
    /ComicSansMS
    /ComicSansMS-Bold
    /CourierNewPS-BoldItalicMT
    /CourierNewPS-BoldMT
    /CourierNewPS-ItalicMT
    /CourierNewPSMT
    /EstrangeloEdessa
    /FranklinGothic-Medium
    /FranklinGothic-MediumItalic
    /Garamond
    /Garamond-Bold
    /Garamond-Italic
    /Gautami
    /Georgia
    /Georgia-Bold
    /Georgia-BoldItalic
    /Georgia-Italic
    /Haettenschweiler
    /Helvetica
    /Helvetica-Bold
    /HelveticaBolditalic-BoldOblique
    /Helvetica-BoldOblique
    /Helvetica-Condensed-Bold
    /Helvetica-LightOblique
    /HelveticaNeue-Bold
    /HelveticaNeue-BoldItalic
    /HelveticaNeue-Condensed
    /HelveticaNeue-CondensedObl
    /HelveticaNeue-Italic
    /HelveticaNeueLightcon-LightCond
    /HelveticaNeue-MediumCond
    /HelveticaNeue-MediumCondObl
    /HelveticaNeue-Roman
    /HelveticaNeue-ThinCond
    /Helvetica-Oblique
    /HelvetisADF-Bold
    /HelvetisADF-BoldItalic
    /HelvetisADFCd-Bold
    /HelvetisADFCd-BoldItalic
    /HelvetisADFCd-Italic
    /HelvetisADFCd-Regular
    /HelvetisADFEx-Bold
    /HelvetisADFEx-BoldItalic
    /HelvetisADFEx-Italic
    /HelvetisADFEx-Regular
    /HelvetisADF-Italic
    /HelvetisADF-Regular
    /Impact
    /Kartika
    /Latha
    /LetterGothicMT
    /LetterGothicMT-Bold
    /LetterGothicMT-BoldOblique
    /LetterGothicMT-Oblique
    /LucidaConsole
    /LucidaSans
    /LucidaSans-Demi
    /LucidaSans-DemiItalic
    /LucidaSans-Italic
    /LucidaSansUnicode
    /Mangal-Regular
    /MicrosoftSansSerif
    /MonotypeCorsiva
    /MSReferenceSansSerif
    /MSReferenceSpecialty
    /MVBoli
    /PalatinoLinotype-Bold
    /PalatinoLinotype-BoldItalic
    /PalatinoLinotype-Italic
    /PalatinoLinotype-Roman
    /Raavi
    /Shruti
    /Sylfaen
    /SymbolMT
    /Tahoma
    /Tahoma-Bold
    /Times-Bold
    /Times-BoldItalic
    /Times-Italic
    /TimesNewRomanMT-ExtraBold
    /TimesNewRomanPS-BoldItalicMT
    /TimesNewRomanPS-BoldMT
    /TimesNewRomanPS-ItalicMT
    /TimesNewRomanPSMT
    /Times-Roman
    /Trebuchet-BoldItalic
    /TrebuchetMS
    /TrebuchetMS-Bold
    /TrebuchetMS-Italic
    /Tunga-Regular
    /Verdana
    /Verdana-Bold
    /Verdana-BoldItalic
    /Verdana-Italic
    /Vrinda
    /Webdings
    /Wingdings2
    /Wingdings3
    /Wingdings-Regular
    /ZapfChanceryITCbyBT-MediumItal
    /ZWAdobeF
  ]
  /NeverEmbed [ true
  ]
  /AntiAliasColorImages false
  /CropColorImages true
  /ColorImageMinResolution 200
  /ColorImageMinResolutionPolicy /OK
  /DownsampleColorImages false
  /ColorImageDownsampleType /Average
  /ColorImageResolution 300
  /ColorImageDepth -1
  /ColorImageMinDownsampleDepth 1
  /ColorImageDownsampleThreshold 1.50000
  /EncodeColorImages true
  /ColorImageFilter /DCTEncode
  /AutoFilterColorImages false
  /ColorImageAutoFilterStrategy /JPEG
  /ColorACSImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /ColorImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /JPEG2000ColorACSImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /JPEG2000ColorImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /AntiAliasGrayImages false
  /CropGrayImages true
  /GrayImageMinResolution 200
  /GrayImageMinResolutionPolicy /OK
  /DownsampleGrayImages false
  /GrayImageDownsampleType /Average
  /GrayImageResolution 300
  /GrayImageDepth -1
  /GrayImageMinDownsampleDepth 2
  /GrayImageDownsampleThreshold 1.50000
  /EncodeGrayImages true
  /GrayImageFilter /DCTEncode
  /AutoFilterGrayImages false
  /GrayImageAutoFilterStrategy /JPEG
  /GrayACSImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /GrayImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /JPEG2000GrayACSImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /JPEG2000GrayImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /AntiAliasMonoImages false
  /CropMonoImages true
  /MonoImageMinResolution 400
  /MonoImageMinResolutionPolicy /OK
  /DownsampleMonoImages false
  /MonoImageDownsampleType /Bicubic
  /MonoImageResolution 600
  /MonoImageDepth -1
  /MonoImageDownsampleThreshold 1.50000
  /EncodeMonoImages true
  /MonoImageFilter /CCITTFaxEncode
  /MonoImageDict <<
    /K -1
  >>
  /AllowPSXObjects false
  /CheckCompliance [
    /None
  ]
  /PDFX1aCheck false
  /PDFX3Check false
  /PDFXCompliantPDFOnly false
  /PDFXNoTrimBoxError true
  /PDFXTrimBoxToMediaBoxOffset [
    0.00000
    0.00000
    0.00000
    0.00000
  ]
  /PDFXSetBleedBoxToMediaBox true
  /PDFXBleedBoxToTrimBoxOffset [
    0.00000
    0.00000
    0.00000
    0.00000
  ]
  /PDFXOutputIntentProfile (None)
  /PDFXOutputConditionIdentifier ()
  /PDFXOutputCondition ()
  /PDFXRegistryName ()
  /PDFXTrapped /False
  /CreateJDFFile false
  /Description <<
    /CHS <FEFF4f7f75288fd94e9b8bbe5b9a521b5efa7684002000410064006f006200650020005000440046002065876863900275284e8e55464e1a65876863768467e5770b548c62535370300260a853ef4ee54f7f75280020004100630072006f0062006100740020548c002000410064006f00620065002000520065006100640065007200200035002e003000204ee553ca66f49ad87248672c676562535f00521b5efa768400200050004400460020658768633002>
    /CHT <FEFF4f7f752890194e9b8a2d7f6e5efa7acb7684002000410064006f006200650020005000440046002065874ef69069752865bc666e901a554652d965874ef6768467e5770b548c52175370300260a853ef4ee54f7f75280020004100630072006f0062006100740020548c002000410064006f00620065002000520065006100640065007200200035002e003000204ee553ca66f49ad87248672c4f86958b555f5df25efa7acb76840020005000440046002065874ef63002>
    /DAN <FEFF004200720075006700200069006e0064007300740069006c006c0069006e006700650072006e0065002000740069006c0020006100740020006f007000720065007400740065002000410064006f006200650020005000440046002d0064006f006b0075006d0065006e007400650072002c0020006400650072002000650067006e006500720020007300690067002000740069006c00200064006500740061006c006a006500720065007400200073006b00e60072006d007600690073006e0069006e00670020006f00670020007500640073006b007200690076006e0069006e006700200061006600200066006f0072007200650074006e0069006e006700730064006f006b0075006d0065006e007400650072002e0020004400650020006f007000720065007400740065006400650020005000440046002d0064006f006b0075006d0065006e0074006500720020006b0061006e002000e50062006e00650073002000690020004100630072006f00620061007400200065006c006c006500720020004100630072006f006200610074002000520065006100640065007200200035002e00300020006f00670020006e0079006500720065002e>
    /DEU <FEFF00560065007200770065006e00640065006e0020005300690065002000640069006500730065002000450069006e007300740065006c006c0075006e00670065006e0020007a0075006d002000450072007300740065006c006c0065006e00200076006f006e002000410064006f006200650020005000440046002d0044006f006b0075006d0065006e00740065006e002c00200075006d002000650069006e00650020007a0075007600650072006c00e40073007300690067006500200041006e007a006500690067006500200075006e00640020004100750073006700610062006500200076006f006e00200047006500730063006800e40066007400730064006f006b0075006d0065006e00740065006e0020007a0075002000650072007a00690065006c0065006e002e00200044006900650020005000440046002d0044006f006b0075006d0065006e007400650020006b00f6006e006e0065006e0020006d006900740020004100630072006f00620061007400200075006e0064002000520065006100640065007200200035002e003000200075006e00640020006800f600680065007200200067006500f600660066006e00650074002000770065007200640065006e002e>
    /ESP <FEFF005500740069006c0069006300650020006500730074006100200063006f006e0066006900670075007200610063006900f3006e0020007000610072006100200063007200650061007200200064006f00630075006d0065006e0074006f0073002000640065002000410064006f00620065002000500044004600200061006400650063007500610064006f007300200070006100720061002000760069007300750061006c0069007a00610063006900f3006e0020006500200069006d0070007200650073006900f3006e00200064006500200063006f006e006600690061006e007a006100200064006500200064006f00630075006d0065006e0074006f007300200063006f006d00650072006300690061006c00650073002e002000530065002000700075006500640065006e00200061006200720069007200200064006f00630075006d0065006e0074006f00730020005000440046002000630072006500610064006f007300200063006f006e0020004100630072006f006200610074002c002000410064006f00620065002000520065006100640065007200200035002e003000200079002000760065007200730069006f006e0065007300200070006f00730074006500720069006f007200650073002e>
    /FRA <FEFF005500740069006c006900730065007a00200063006500730020006f007000740069006f006e00730020006100660069006e00200064006500200063007200e900650072002000640065007300200064006f00630075006d0065006e00740073002000410064006f006200650020005000440046002000700072006f00660065007300730069006f006e006e0065006c007300200066006900610062006c0065007300200070006f007500720020006c0061002000760069007300750061006c00690073006100740069006f006e0020006500740020006c00270069006d007000720065007300730069006f006e002e0020004c0065007300200064006f00630075006d0065006e00740073002000500044004600200063007200e900e90073002000700065007500760065006e0074002000ea0074007200650020006f007500760065007200740073002000640061006e00730020004100630072006f006200610074002c002000610069006e00730069002000710075002700410064006f00620065002000520065006100640065007200200035002e0030002000650074002000760065007200730069006f006e007300200075006c007400e90072006900650075007200650073002e>
    /ITA (Utilizzare queste impostazioni per creare documenti Adobe PDF adatti per visualizzare e stampare documenti aziendali in modo affidabile. I documenti PDF creati possono essere aperti con Acrobat e Adobe Reader 5.0 e versioni successive.)
    /JPN <FEFF30d330b830cd30b9658766f8306e8868793a304a3088307353705237306b90693057305f002000410064006f0062006500200050004400460020658766f8306e4f5c6210306b4f7f75283057307e305930023053306e8a2d5b9a30674f5c62103055308c305f0020005000440046002030d530a130a430eb306f3001004100630072006f0062006100740020304a30883073002000410064006f00620065002000520065006100640065007200200035002e003000204ee5964d3067958b304f30533068304c3067304d307e305930023053306e8a2d5b9a3067306f30d530a930f330c8306e57cb30818fbc307f3092884c3044307e30593002>
    /KOR <FEFFc7740020c124c815c7440020c0acc6a9d558c5ec0020be44c988b2c8c2a40020bb38c11cb97c0020c548c815c801c73cb85c0020bcf4ace00020c778c1c4d558b2940020b3700020ac00c7a50020c801d569d55c002000410064006f0062006500200050004400460020bb38c11cb97c0020c791c131d569b2c8b2e4002e0020c774b807ac8c0020c791c131b41c00200050004400460020bb38c11cb2940020004100630072006f0062006100740020bc0f002000410064006f00620065002000520065006100640065007200200035002e00300020c774c0c1c5d0c11c0020c5f40020c2180020c788c2b5b2c8b2e4002e>
    /NLD (Gebruik deze instellingen om Adobe PDF-documenten te maken waarmee zakelijke documenten betrouwbaar kunnen worden weergegeven en afgedrukt. De gemaakte PDF-documenten kunnen worden geopend met Acrobat en Adobe Reader 5.0 en hoger.)
    /NOR <FEFF004200720075006b00200064006900730073006500200069006e006e007300740069006c006c0069006e00670065006e0065002000740069006c002000e50020006f0070007000720065007400740065002000410064006f006200650020005000440046002d0064006f006b0075006d0065006e00740065007200200073006f006d002000650072002000650067006e0065007400200066006f00720020007000e5006c006900740065006c006900670020007600690073006e0069006e00670020006f00670020007500740073006b007200690066007400200061007600200066006f0072007200650074006e0069006e006700730064006f006b0075006d0065006e007400650072002e0020005000440046002d0064006f006b0075006d0065006e00740065006e00650020006b0061006e002000e50070006e00650073002000690020004100630072006f00620061007400200065006c006c00650072002000410064006f00620065002000520065006100640065007200200035002e003000200065006c006c00650072002e>
    /PTB <FEFF005500740069006c0069007a006500200065007300730061007300200063006f006e00660069006700750072006100e700f50065007300200064006500200066006f0072006d00610020006100200063007200690061007200200064006f00630075006d0065006e0074006f0073002000410064006f00620065002000500044004600200061006400650071007500610064006f00730020007000610072006100200061002000760069007300750061006c0069007a006100e700e3006f002000650020006100200069006d0070007200650073007300e3006f00200063006f006e0066006900e1007600650069007300200064006500200064006f00630075006d0065006e0074006f007300200063006f006d0065007200630069006100690073002e0020004f007300200064006f00630075006d0065006e0074006f00730020005000440046002000630072006900610064006f007300200070006f00640065006d0020007300650072002000610062006500720074006f007300200063006f006d0020006f0020004100630072006f006200610074002000650020006f002000410064006f00620065002000520065006100640065007200200035002e0030002000650020007600650072007300f50065007300200070006f00730074006500720069006f007200650073002e>
    /SUO <FEFF004b00e40079007400e40020006e00e40069007400e4002000610073006500740075006b007300690061002c0020006b0075006e0020006c0075006f0074002000410064006f0062006500200050004400460020002d0064006f006b0075006d0065006e007400740065006a0061002c0020006a006f0074006b006100200073006f0070006900760061007400200079007200690074007900730061007300690061006b00690072006a006f006a0065006e0020006c0075006f00740065007400740061007600610061006e0020006e00e400790074007400e4006d0069007300650065006e0020006a0061002000740075006c006f007300740061006d0069007300650065006e002e0020004c0075006f0064007500740020005000440046002d0064006f006b0075006d0065006e00740069007400200076006f0069006400610061006e0020006100760061007400610020004100630072006f0062006100740069006c006c00610020006a0061002000410064006f00620065002000520065006100640065007200200035002e0030003a006c006c00610020006a006100200075007500640065006d006d0069006c006c0061002e>
    /SVE <FEFF0041006e007600e4006e00640020006400650020006800e4007200200069006e0073007400e4006c006c006e0069006e006700610072006e00610020006f006d002000640075002000760069006c006c00200073006b006100700061002000410064006f006200650020005000440046002d0064006f006b0075006d0065006e007400200073006f006d00200070006100730073006100720020006600f60072002000740069006c006c006600f60072006c00690074006c006900670020007600690073006e0069006e00670020006f006300680020007500740073006b007200690066007400650072002000610076002000610066006600e4007200730064006f006b0075006d0065006e0074002e002000200053006b006100700061006400650020005000440046002d0064006f006b0075006d0065006e00740020006b0061006e002000f600700070006e00610073002000690020004100630072006f0062006100740020006f00630068002000410064006f00620065002000520065006100640065007200200035002e00300020006f00630068002000730065006e006100720065002e>
    /ENU (Use these settings to create PDFs that match the "Recommended"  settings for PDF Specification 4.01)
  >>
>> setdistillerparams
<<
  /HWResolution [600 600]
  /PageSize [612.000 792.000]
>> setpagedevice