IPBSM: An optimal bribery selfish mining in the presence of intelligent and pure attackers
Int J Intell Syst. 2020;35:1735–1748. wileyonlinelibrary.com/journal/int © 2020 Wiley Periodicals LLC | 1735
Received: 12 June 2020 | Revised: 2 July 2020 | Accepted: 23 July 2020
DOI: 10.1002/int.22270
RE S EARCH ART I C L E
IPBSM: An optimal bribery selfishmining in
the presence of intelligent and pure attackers
Guoyu Yang1,2 | Yilei Wang1 | Zhaojie Wang1 |
Youliang Tian3 | Xiaomei Yu4 | Shouzhe Li5
1School of Information Science and
Engineering, Qufu Normal University,
Rizhao, China
2Institute of Artificial Intelligence and
Blockchain, Guangzhou University,
Guangzhou, China
3State Key Laboratory of Public Big Data,
College of Computer Science and
Technology, Guizhou University,
Guizhou, China
4School of Information Science and
Engineering, Shandong Normal University,
Jinan, China
5Department of Computer Science,
University of Wisconsin‐Madison,
Wisconsin, Madison, USA
Correspondence
Yilei Wang, School of Information Science
and Engineering, Qufu Normal University,
Rizhao 276826, China.
Email: ylwangqfnu@163.com
Abstract
Blockchain is a “decentralized” system, where the
security heavily depends on that of the consensus
protocols. For instance, attackers gain illegal reven-
ues by leveraging the vulnerabilities of the consensus
protocols. Such attacks consist of selfish mining
(SM1), optimal selfish mining (ϵ‐optimal), bribery
selfish mining (BSM), and so forth. In existing works,
the attacks only consider the circumstances, where
part of miners are rational. However, miners are
hardly nonrational in the blockchain system since
they hope to maximize their revenues. Furthermore,
attackers prefer intelligent tools to increase their
power for more additional revenues. Therefore, new
models are urgently needed to formulate the scenar-
ios, where attackers are purely rational and in-
telligent. In this paper, we propose a new BSMmodel,
where all miners are rational. Moreover, rational at-
tackers are intelligent such that they optimize their
strategies by utilizing reinforcement learning to boost
their revenues. More specifically, we propose a new
selfish mining algorithm: intelligent bribery selfish
mining (IPBSM), where attackers choose optimal
strategies resorting to reinforcement learning when
they interact with the external environment. The
external environment can be further modeled as a
Markov decision process to facilitate the construction
mailto:ylwangqfnu@163.com
http://crossmark.crossref.org/dialog/?doi=10.1002%2Fint.22270&domain=pdf&date_stamp=2020-08-06
of reinforcement learning. The simulation results
manifest that IPBSM, compared with SM1 and
ϵ‐optimal, has lower power thresholds and higher
revenues. Therefore, IPBSM is a threat no to be ne-
glected to the blockchain system.
KEYWORDS
blockchain, game theory, reinforcement learning, selfish mining
1 | INTRODUCTION
Crypto currency is a centralized system, where the central authority is in charge of formulating
policies. In such a centralized system, data is stored in the central node.1 However, the system
will be crashed once the central authority or node is a breakdown, which causes huge economic
losses to the society.2‐4 It is vital to design a decentralized crypto currency to circumvent such
problems. In 2008, Satoshi Nakamoto proposes bitcoin, a new distributed crypto currency,
where each node plays an equal role in a peer to peer network.5 The most distinction is the
“decentralization,” which independents on the central node.6 Therefore, the whole system runs
well even if one node is a breakdown.
In the bitcoin system, miners include several transactions into one block and append it to
the public ledger (aka. blockchain) through a consensus mechanism.7 More specifically, one
miner is selected to append his block to the blockchain and receive revenues, which consist of
the transaction fees and a constant reward. Bitcoins have become a hotspot due to the high
economic value. Miners, especially attackers, managed to gain additional revenues by deviating
from the consensus mechanism. Normally, the revenues of miners are proportionate to their
powers. That is, according to the consensus mechanism, the more power the miner has, the
higher probability he is selected to append his block to the blockchain. However, miners can
double spend their coins by forking the blockchain when the power is larger than 51% of the
whole system. Forking is possible while with a small probability. Unfortunately, malicious
miners can generate factitious forks by strategically behaving in the system.8‐10 For example,
miners with small proportion powers may form a mining pool and mine blocks with their
whole power. The mining pool is prone to converge 51% power if they chose proper strate-
gies.11,12 Therefore, miners with small proportion powers still gain additional revenues.13,14
Furthermore, mining pools breed other attackers such as selfish mining attacks and stubborn
attacks. These strategic attacks ruin the economic environment with respect to the crypto
currency system. Therefore, these attacks turn into serious problems in the blockchain system.
One solution, in our opinion, is to promote the proportion of the honest miners and construct a
consensus mechanism with incentive compatibility.15
1.1 | Related works
Traditionally, bitcoin protocols are incentive compatible. That is, miners with less power
cannot gain additional revenue by deviating from the bitcoin protocols.16 However, in 2013,
1736 | YANG ET AL.
 1098111x, 2020, 11, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.22270 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
Eyal and Sirer17 propose a seminal attack: selfish mining (SM1), where malicious miners in one
pool build a private chain when they find new blocks instead of broadcasting in the public
chain. The simulation results indicate that miners with only 25% gain additional revenue. While
25% is a rather high requirement for miners. Then Nayak et al. propose stubborn mining attacks
on the basis of SM1,18 where selfish miners are stubborn. Put differently, they do not abandon
the private chain even if the public chain is longer than that. Recall that in SM1, miners merge
to the public chain when it is longer than their private chain. Sapirshtein et al., combining
Markov Decision Process (MDP) with SM1, proposes ϵ‐optimal attacks.19 The experiments
illustrate that miners who conduct ϵ‐optimal attacks can achieve more revenue than those with
SM1. Meanwhile, the power threshold is no significant reduction. Bonneau et al.20 allow miners
to bribe others such that they may roll back the transactions by tentatively control more power.
Gao et al. further propose the notion of bribery selfish mining attacks (BSM),21 where attackers
bribe others whenever there is a fork, so that others mine on the private chain other than the
public chain. However, they do not implement BSM attacks.
1.2 | Motivations and contributions
Attackers, as mentioned above, manage to achieve illegal revenue through selfish mining.
While selfish mining attacks lead to relative higher revenue unless the attackers have relative
higher power. Furthermore, the cost cannot be neglected when the attackers briber others.22
Although BSM is proposed in Reference [21], it falls short of concrete implementation. On the
other hand, we should model BSM within a pure rational scenario since most miners in
the blockchain system are rational. Furthermore, attackers are more intelligent than before, so
the new BSM model should also consider intelligent miners.
In this paper, we construct a novel model, where all miners are rational. More specifically,
rational miners try to maximize their revenues and rational attackers optimize their strategies
by utilizing reinforcement learning. Therefore, similar to SM1 and ϵ ‐optimal, the new BSM can
be modeled as a MDP since the current state only depends on previous state and action. The
main contributions of this paper are as follows.
• We construct a new BSM model: pure‐BSM. Different from the BSM model, all miners in
pure‐BSM are rational including the attackers. Rational miners mine on the chain, where
they gain maximum revenues. The attackers may sponsor bribery attacks on the private chain
whenever there is a fork of the same length. In such a circumstance, rational miners fall into
the “venal miner's dilemma.” Similar to the prisoner's dilemma, rational miners choose to
accept bribes to obtain higher rewards. Finally, the private chain will become the legal
longest chain since all rational miners will choose it.
• We propose an intelligent bribery selfish mining (IPBSM) based on pure‐BSM. Similar to SM1
and ϵ‐optimal, The attackers interact with the external environment during the selfish mining
process, which can be modeled as MDP. The difference is that IPBSM is based on the new
pure‐BSM model. Moreover, according to changes in the external environment, the attackers
choose their optimal attacking strategies by reinforcement learning.
• We present the algorithm of IPBSM in details. In Section 3.2, the steps of the IPBSM algo-
rithm are described. Furthermore, we do a simulation of IPBSM in Section 5. The simulation
results illustrate that, compared with SM1 and ϵ‐optimal, attackers resorting to IPBSM
achieve higher revenues with lower thresholds.
YANG ET AL. | 1737
 1098111x, 2020, 11, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.22270 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
1.3 | Roadmap of this paper
The roadmap of this paper is as follows. Section 2 presents the preliminaries such as re-
inforcement learning, selfish mining, bribery attack, and BSM. Section 3 outlines the algorithm
and the pseudocodes of IPBSM in detail. In Section 4, we analyze our algorithm in theory.
Section 5, simulations of IPBSM are presented to verify the theoretical analysis in Section 4.
Section 6 concludes this paper and prospects of the future works.
2 | PRELIMINARIES
2.1 | Reinforcement learning and MDP
Reinforcement learning (RL) is an area of machine learning, which selects actions according to
the specific environment to maximize the expected rewards.23,24 The environment is regulated
as the MDP. Generally, MDP provides a mathematical framework for modeling decision
making, where the outcomes are partly random and partly under the control of a decision‐
maker.25
The formal definition of MDP is as follows: M=<S, A, P, R, where S represents state space
and ∈s St is the state at time t. A is the set of actions, ∈a At is the action selected at time t.
P represents a stochastic transition matrix, where ∣p s s a( , )t t t+1 describes the probability of
transition from st and at to st+1. R is the reward matrix, ∣r s s a( , )t t t+1 represents the direct
reward obtained from st to st+1 by taking action at . In the MDP model, state st only depends on
st−1 and at−1, regardless of other states or actions. Analogously, we can get all the states
s s s( , , …, )T0 1 and actions a a a( , , …, )T0 1 according to that selected strategies. To describe the
MDP model, we define the state value function as follows:
∑V s E γ r( ) = ,π p
π
t
T
t
t
=0
−1⎛
⎝
⎜⎜
⎞
⎠
⎟⎟ (1)
In Equation (1), ∈γ [0, 1] is discount factor and rt represents the direct reward obtained from
state st to st+1. Here, V s( )π can be regarded as an expected reward function related to strategies
π . Based on Equation (1), the extension state value function V s( )π 0 can be expressed as follows:
∑ ∑∣ ∣V s p a s p s s a r γv s( ) = ( ) ( , )( + ( )).π π0 0 0 1 0 0 0 1
(2)
As described above, we can find the corresponding value function V (s)π for any strategies π .
Consequently, an optimal strategy of MDP can be presented as folows:
π argmax V s= ( ( )).* π π
(3)
2.2 | Selfish mining
In 2013, Eyal and Sirer17 propose the SM1 algorithm. Attackers can earn more relative revenue
by deviating from the obtain bitcoin protocol. In SM1, honest miners discover a new block, then
they will immediately broadcast the new block to obtain rewards. However, the behavior of
selfish miners is contrary to honest miners.26 That is, they keep the discovered blocks private,
1738 | YANG ET AL.
 1098111x, 2020, 11, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.22270 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
thereby intentionally forking the blockchain. The honest miners continue to mine on the public
chain, while the selfish miners mine on its own private branch. More specifically, we consider
the following four scenarios. (1) when the public chain is longer than the private chain: the
possibility that the private branch overtakes the public chain is small due to the mining power
of selfish miners a minority. Consequently, the selfish miners adopt the public chain whenever
their private chain falls behind. (2) when the private chain is one block ahead of the public
chain: selfish miners reveal all blocks of the private branch when the honest miners discover a
new block. In this scenario, the selfish miners unanimously adopt the previous private chain,
while honest miners will choose either chain depending on the propagation of the notifications.
Instead, the selfish miners keep new block private. (3) when the private chain is two blocks
ahead of the public chain: the selfish miners immediately publish their private branch. (4) we
consider the remaining circumstance: the selfish miners reveal the first unpublished block in
the private branch when the honest miners discover a new block. Otherwise, the selfish miners
keep block private.
2.3 | Bribery attack
Bonneau et al.20 propose a consensus protocol attack algorithm: bribery attack. In bribery
attack, the attackers can bribe others to achieve additional profits by double‐spending.27
Specifically, the attackers are able to rent arbitrary amounts of power at a cost of ⋅δ B per block,
where B is the mining reward for one block and δ is the additional fees. We consider the
following scenario: the attackers want to reverse the specific transaction when they have
minority mining power.28 In this scenario, the attackers bribe other miners for renting their
power to temporally enhance their mining power. Consequently, the attacker, despite tem-
porarily, can accumulate more than 51% mining power and easily reverse transactions by 51%
attack. As described above, the purpose of bribery attacks is similar to 51% attack. The distinct
for the former is the attackers temporarily have majority mining power. Further, bribery attacks
consist of the following renting methods:
• Out‐of‐Band Payment: the attackers entice other miners through offline payments. It is the
simplest mechanism that attackers pay the owners of mining capacity directly. However, this
renting method requires credibility between the attacker and the bribed miners.
• Negative‐Fee Mining Pool: the attackers distribute pool profits and bribe other miners that
the rational miners off the public chain.
• In‐Band Payment via Forking: an online payment via blockchain that allows miners to bribe
only when the private chain becomes the new longest legal chain. In this circumstance, there
is no need to be credible between the attacker and the bribed miners.
In Sections 2.4 and 3, we will describe what the attacker can utilize the above three renting
methods to obtain more relative revenues under certain circumstances.
2.4 | Bribery selfish mining
In 2019, Shang Gao et al.21 proposed the concept of BSM: it can improve the attacker's relative
revenues by combining bribery attack with selfish mining. In most cases of Section 2.3, the attacker
YANG ET AL. | 1739
 1098111x, 2020, 11, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.22270 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
wants to achieve double spending through bribery attack, which requires a large cost. However, it
can sponsor the bribery attack at a lower cost after executing a Match for selfish miners. Specifically,
the length of the public and private chains is equal after an honest miner discovered a new block. In
this circumstance, the attacker publishes all blocks of private chain to produce a fork of the same
length, namely “0‐lead racing.” To increase the probability that the private branch becomes the
longest legal chain, the attacker will sponsor bribery attack on it. The attacker can rent the power of
other miners via the method of renting in Section 2.3, then they temporarily gain greater computing
power. Now, the attacker needs to consider the advantages and disadvantages of the three renting
methods to select the optimal strategy. In the BSM model, the attacker will induce other miners to
work on the private branch by renting their computing power using the In‐Band Payment. In
addition, attackers can utilize smart contracts to ensure that only miners who successfully discover
new blocks are rewarded with bribe money.
The BSM model includes attackers, venal miners, and other miners. Specifically, attackers
who sponsor the BSM attack, venal miners who accepted bribes and mine on the attacker's
private branch, and other Miners continued to mine in the public chain. As mentioned above,
when bribery racing occurs, venal miners will encounter “venal miner's dilemma,” which all
venal miners choose to accept the attacker's branch for a higher reward, but still suffer from
some losses. Different from miner's dilemma, venal miner's dilemma involves one attacker and
multiple venal miners. Venal miners will choose to accept the attacker's branch and fall into the
dilemma to lose their rewards.
3 | INTELLIGENT BRIBERY SELFISH MINING
In this paper, we first construct a pure‐BSM model, where all miners are pure rational. Then we
propose, based on pure‐BSM model, a novel selfish mining algorithm: IPBSM, which maximizes
the relative profits of mining by reinforcement learning and bribery attack. Moreover, IPBSM
greatly reduces the threshold of mining power through selfish mining. In the next part, we will
introduce the model and algorithm of IPBSM in detail.
3.1 | The construction of pure‐BSM model
As described, we assume that miners in the blockchain are rational miners. Compared with
honest miners, rational miners follow the Bitcoin protocol most of the time, but they prefer to
choose the most profitable strategy, which may deviate from the protocol. To describe pure‐
BSM in a concise way. Without loss of generalization, we suppose there are two groups of
parties: one is a malicious pool with a minority of mining power and the other is a group of
rational miners with the majority of power. However, the malicious pool of minority power can
obtain more relative revenue through IPBSM.
In IPBSM, the intelligent attacker finds an optimal strategy by reinforcement learning and
bribery attack. Let's consider the following scenario: at first, the length of the private chain and
public chain is the same. We suppose the rational miners find a new block. Then the attacker
publishes all blocks on the private chain, which produces a fork with the same length, called
“0‐lead racing.”21 In SM1, the selfish miners unanimously adopt the previous private chain,
while honest miners will choose either chain depending on the propagation of the notifications.
While in IPBSM, the selfish miners will increase the additional revenue on the private chain.
1740 | YANG ET AL.
 1098111x, 2020, 11, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.22270 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
Thus, more rational miners prefer to mine on the private branch. Consequently, the probability
is improved, where the private branch becomes the longest public chain. Specifically, we as-
sume that the rewards of mining on the private chain and public chain are Rper. The bribery
benefits are negl(n) on the private chain, where negl(n) is the negligible function. The rational
miner's revenue of mining on any branch is Rper when the attackers to attack blockchain
through SM1 or ϵ‐optimal. However, rational miners can obtain more revenue when they
discover a new block on the bribery private branch. The inequality of revenue is as follows:
R negl n R+ ( ) > .per per (4)
Therefore, rational miners will choose bribery private branch with greater revenue. That makes
the blocks of public branch invalid and increases the relative revenue of attackers.
Further, to maximize revenue, intelligent attackers will find an optimal mining policy
through reinforcement learning. As described, we formalize the external environment into the
MDP model M= (S, A, P, R), where S is the state space, A the action space, P a stochastic
transition matrix, and R the reward matrix. Let's assume that and la represent the lengths of the
public and private chains respectively. Now, we will describe M in more detail.
Action space A: it represents the set of policies that an attacker can choose at all‐state.
• Adopt: the attackers discard la blocks of private chain and select public chain.
• Override: the attackers select override When l l>a h . Thus, this invalidates the blocks in the
public branch.
• Match: rational miners find the next new block, which makes the length of public and private
chains are the same. That is, l l=a h . In this circumstance, the attacker publishes all blocks of
private chain to produce a fork and sponsors bribery attack by choosing renting methods in
Section 2.3.
• Wait: the attacker does not publish new blocks, but keeps mining on its private chain.
State space S: here the triple l l< , , optional>a h represents a state in the set, where la is length
of private chain, lh the length of public chain. The value of optional can be chosen from
relevant, irrelevant, and active. Further, we consider the following scenario: if the current state
is l l< , , relevant>a h , then the previous state was l l< , − 1, optional>a h . The state
l l< , , irrelevant>a h means that the previous state is l l< − 1, , optional>a h . If optional is active, it
means that there is a fork in public chain due to previous match action.
Stochastic transition matrix P: in the MDP model, each state is represented as a triple
l<l , , optional>a h . We assume the attacker's power is α, and that of rational miners is α1 − .
Therefore, the probability with initial state <1, 0, irrelevant> and <0, 1, relevant> can re-
present as α and α1 − , respectively. The attackers transfer to the next state by selecting the
optimal action correspond to the current state.
Reward matrix R: As mentioned, the attackers transfer to the next state by selecting action of
the current state. The attackers will obtain rewards by transferring to the next state. We assume
the direct reward is R R< , >la lh , where Rla is the reward for the attacker to obtain la blocks, and
Rlh means that rational miners get blocks of lh . Thus, the reward table is shown in Tabel 1. The
left‐most column is the specific state and action. The middle column represents state and
probability based on the first column. The corresponding two‐dimensional reward is specified
on the right‐most column, describing the reward of the attacker and the rational miners re-
spectively. In addition, the notation * represents l l>a h .
YANG ET AL. | 1741
 1098111x, 2020, 11, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.22270 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
3.2 | The IPBSM algorithm in details
Algorithm 1 Intelligent Bribery Selfish Mining (IPBSM)
Input: low ← 0, high ← 1
Output: rho
1: functionOPTIMALSTRATEGY (α γ, , maxlen, eps, low, high)
2: rho = (low + high)/2
3: mdp = OptimalStrategyMdp (α γ, , maxlen, rho)
4: if mdp. V[0] > 0
5: low = rho
6: else
7: high = rho
8: end if
9: if high ‐ low ≤ eps then
10: return rho
11: end if
12: OptimalStrategy (α γ, , maxlen, eps, low, high)
13: end function
14:
15: functionOPTIMALSTRATEGYMDP (α γ, , maxlen, rho)
16: states ←{}
17: Init (states)
18: for indx, state ← states. items() do
19: if Action == Adopt then
20 p_adopt, r_adopt ← ComputationAdopt (state)
21: end if
22: if Action == Override then
23: p_override, r_override ← ComputationOverride (state)
24: end if
25: if Action == Match then
26: p_match, r_match ← BriberyComputationMatch (state)
27: end if
28: if Action == Wait then
29: p_wait, r_wait ← ComputationWait (state)
30: end if
31: end for
32: P ← [p_adopt, p_override, p_match, p_wait]
33: R ← [r_adopt, r_override, r_match, r_wait]
34: mdp ← mdptoolbox. mdp. PolicyIteration (P, R, Discount)
35: return mdp
36: end function
In Algorithm 1, we first initial search segment as [0,1], which 0 represents the left boundary of
the segment, 1 is the right boundary. ρ is assigned the middle point of the search segment. When
the segment difference is less than or equal to eps, it means that the current maximum expected
revenue has been found. In the OptimalStrategyMdp function, we first initialize all states in the
blockchain network. For each state, we calculate the revenue for the attackers by taking different
1742 | YANG ET AL.
 1098111x, 2020, 11, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.22270 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
actions. Further, if the selected action is Match, the attacker will take bribery attacks on the current
network so that he can induce rational miners to choose private branch whenever there is a fork.
Finally, we implement the Markov model problem with MDPToolbox.25
4 | ANALYSIS IPBSM
In this section, the IPBSM algorithm is presented in more detail. We assume the current state is
l l< , , relevant>a h , where l l=a h . Thus, the attacker will select Match to maximize their related
revenue. Consequently, there is a fork with the same length (aka. 0‐lead racing). Now, let's consider
SM1 and IPBSM under such a scenario respectively. In SM1, the attacker always mines on the
private chain, while rational miners choose to mine on the fork according to the first received block.
However, In IPBSM, the attacker also takes bribery attack on the private chain. After sponsor the
bribery attack, the revenue on private chain change to R + negl(n)per . Therefore, to maximize
related revenue, rational miners deviated from bitcoin and choose to mine in the private chain. In
this scenario, We use “bribery 0‐lead racing” to express the above scenario (refer Figure 1).
Further, we use the state machine to analyze the IPBSM algorithm. A state machine is usually
used to describe the dependent state behavior of an object, modeling the behavior of a single object.
It represents the order in which an object executes related events and correspond to different events
throughout its life cycle. The state machine of IPBSM as described in Figure 2.
In Figure 2, α denotes the mining power of attacker and α1 − denotes the rational miner's
power. State 0 describes that the current blockchain has no fork, while State 0' denotes a fork
FIGURE 1 The states transition of the
Markov model [Color figure can be viewed at
wileyonlinelibrary.com]
TABLE 1 The transition and reward matrices P and R in the decision model M
State× Action State Probability Reward
l l( , , optional), adopta h (1, 0, irrelevant) α R(0, )lh
(0, 1,relevant) α1 −
l l( , , optional), override*a h l l( − , 0, irrelevant)a h α R( , 0)lh+1
l l( − − 1, 1, relevant)a h α1 −
l l( , , irrelevant),waita h l h( , , irrelevant)a+1 α (0, 0)
l l( , , relevant),activea h l l( , , relevant)a h+1 α1 − (0, 0)
l , l( , active),waita h l l( , , active)a h+1 α (0, 0)
l l( , , relevant), match*a h l l( − , 1, relevant)a h ⋅γ α(1 − ) R( , 0)lh
l l( , , relevant)a h+1 γ α(1 − )(1 − ) (0, 0)
l l( , , relevant),matcha h ∕(1, 0, relevant irrelevant) 1 R( , 0)la
YANG ET AL. | 1743
 1098111x, 2020, 11, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.22270 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
http://wileyonlinelibrary.com
with equal length, namely “bribery 0‐lead racing.” Different from SM1 and ϵ‐optimal, the
attacker will sponsor a bribery attack when the state is 0'. In this circumstance, attackers and
rational miners choose private fork to mine. Specifically, when the current state is 0, if attackers
find a new block first, then they keep the block as private chain and reach state 1. If rational
miners discover a new block, they immediately publish it to obtain the reward. Thus, this moves
from the current state to state 0. The state transfer from state 2 to state 3 when attackers find the
next new block. However, if rational miners discover new block first, attackers publish all
blocks of private chain and transfer to state 0.
5 | SIMULATIONS
In this section, we simulated the IPBSM algorithm to verify the above theoretical analysis.
During a simulation, the attacker takes strategy generally by the algorithm to attack the bitcoin
network. To illustrate, we will describe the simulation result in detail.
FIGURE 2 The state machine of intelligent bribery selfish mining [Color figure can be viewed at
wileyonlinelibrary.com]
FIGURE 3 The influence of the maximum length of private chain and public chain on the related
revenue of the attackers in intelligent bribery selfish mining [Color figure can be viewed at
wileyonlinelibrary.com]
1744 | YANG ET AL.
 1098111x, 2020, 11, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.22270 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
http://wileyonlinelibrary.com
http://wileyonlinelibrary.com
Figure 3 shows the influence of the maximum length of private chain and public chain on
the related revenue of the attackers in the IPBSM. Specifically, we assume that the attacker's
mining power ∕ ∕ ∕ ∕α = [1 4, 1 3, 2 5, 1 2]. Therefore, the mining power of rational miners is
α1 − . In Figure 4, we consider the following scenario. First, when the attacker has 1/4 of
mining power, the related revenue does not increase significantly with the maximum length of
the private and public chain. Second, if the longest chain is less than 10 when the attacker has
1/3 power, the related revenue will increase gradually with the maximum length. But for the
case where the longest length is more than 10, the related revenue does not increase sig-
nificantly. Thirdly, this considers the attacker has 2/5 of mining power, when the longest chain
less than 13, the attacker's related revenue is increase with a maximum length of chain.
However, it does not increase when the longest chain is great than 13. Finally, if the attacker
has 1/2 power, the attacker always can obtain greater related revenue. Thus, the related revenue
has an upper bound when the attacker does not have majority mining power. On the contrary,
the attacker can always increase the relative return with 51% attack.
To further verify the influence of the longest chain on the relative revenue of the attacker,
ϵ‐optimal algorithm is simulated with the same hypothesis. In Figure 4, we find that there is an
upper bound for the attacker's related revenue when the attacker has minority power. But if the
attacker has majority mining power, the relative revenue increases with the length of the chain
until it is 1.
As described above, the IPBSM algorithm solves the problems of high mining power
threshold and low related revenue. To illustrate, we compare the IPBSM in this paper with SM1,
ϵ‐optimal and honest mining. As shown in Figure 5, it can be seen that the relative revenue of
IPBSM, ϵ‐optimal, and SM1 increases with the gradual increase of mining power. When the
attacker has less than 25% of mining power, we find that the related revenue of honest mining is
not only more than SM1 but also approximately equals to ϵ‐optimal. In this scenario, neither
FIGURE 4 The influence of the maximum length of private chain and public chain on the related
revenue of the attackers in ϵ‐optimal algorithm [Color figure can be viewed at wileyonlinelibrary.com]
YANG ET AL. | 1745
 1098111x, 2020, 11, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.22270 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
http://wileyonlinelibrary.com
ϵ‐optimal nor SM1 obtain higher related revenue compare with honest mining. Therefore,
ϵ‐optimal and SM1 have a mining power threshold of above 25%. Observed IPBSM, the attacker
can obtain greater related revenue than others when threshold is less than 25%.
More importantly, the attacker only needs to have more than 0.75% of mining power, they
can obtain higher related revenue compared to honest mining. Thus, the IPBSM algorithm
significantly reduces the threshold of selfish mining. On the other hand, when the attacker has
more than 25% of mining power, SM1 or ϵ‐optimal can be deployed to obtain higher related
revenue than honest mining. Moreover, ϵ‐optimal can get higher related revenue than SM1
when the mining power is greater than 32.5%. In fact, most attackers don't have the majority of
mining power. As Figure 5, when the attacker has minority mining power, we find that the
IPBSM always obtains higher relative revenue than other selfish mining algorithms. Therefore,
IPBSM improves the relative revenue of the attacker, who adopts selfish mining attacks.
6 | CONCLUSION AND FUTURE WORK
Attackers will leverage the vulnerability of consensus protocol to launch a series of attacks on
cryptocurrency systems for illicit gains. In this paper, we propose a novel selfish mining al-
gorithm: IPBSM. The IPBSM deploys reinforcement learning to find the optimal strategy to
maximize its relative revenue. Further, the proposed algorithm can effectively help crypto-
currency systems to develop effective defense schemes. The experimental results illustrate that
IPBSM has lower threshold and higher relative revenue than SM1 and ϵ‐optimal. However, we
find that IPBSM could not resist miner's dilemma. It means that IPBSM cannot reach the Nash
equilibrium when there have multiple attackers. Therefore, the malicious pool does not actively
apply IPBSM to attack the bitcoin network. Future work should solve the problem of venal
miner's dilemma and further optimize the IPBSM model. In addition, we should try to modify
or propose a novel consensus protocol to resist the selfish mining attack.
FIGURE 5 The revenue of SM1, ϵ‐optimal and honest mining [Color figure can be viewed at
wileyonlinelibrary.com]
1746 | YANG ET AL.
 1098111x, 2020, 11, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.22270 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
http://wileyonlinelibrary.com
REFERENCES
1. Tschorsch F, Scheuermann B. Bitcoin and beyond: a technical survey on decentralized digital currencies.
IEEE Commun Surveys Tutorials. 2016;18(3):2084‐2123.
2. Yang HY, Yang Y, Han F, Zhao M, Guo L. Containment control of heterogeneous fractional‐order multi‐
agent systems. J Franklin Inst. 2019;356(2):752‐765.
3. Zheng X, Liu H. A scalable coevolutionary multi‐objective particle swarm optimizer. Int J Comput Intell.
2010;3(5):590‐600.
4. Yu X, Wang H, Zheng, Zheng X, Wang Y. Effective algorithms for vertical mining probabilistic frequent
patterns in uncertain mobile environments. Int J Ad‐Hoc Ubiquitious Comput. 2016;23(3‐4):14437‐14151.
5. Nakamoto S. Bitcoin: a peer‐to‐peer electronic cash system. Tech. rep., Manubot; 2019.
6. Puthal D, Malik N, Mohanty SP, Kougianos E, Das G. Everything you wanted to know about the blockchain:
its promise, components, processes, and problems. IEEE Consumer Electr Magazine. 2018;7(4):6‐14.
7. Gervais, A, Karame, GO, Wüst, K, Glykantzis, V, Ritzdorf, H, Capkun, S. On the security and performance of
proof of work blockchains; 2016:3‐16.
8. Wang, T, Liew, SC, Zhang, S. When blockchain meets aI: optimal mining strategy achieved by machine
learning. arXiv preprint arXiv:1911.12942. 2019. http://arXiv.org/abs/arXiv:1911.12942
9. Wang Y, Bracciali A, Li T, Li F, Cui X, Zhao M. Randomness invalidates criminal smart contracts. Inform
Sci. 2019;447:291‐301.
10. Zhang L, Wang Y, Li F, Hu Y, Au MH. A game‐theoretic method based on Q‐learning to invalidate criminal
smart contracts. Inform Sci. 2019;498:144‐153.
11. Lewenberg Y, Bachrach Y, Sompolinsky Y, Zohar A, Rosenschein JS. Bitcoin mining pools: a cooperative
game theoretic analysis. Citeseer. 2015:919‐927.
12. Rosenfeld, M. Analysis of bitcoin pooled mining reward systems. arXiv preprint arXiv:1112.4980. 2011.
http://arXiv.org/abs/arXiv:1112.4980
13. Jiang N, Xu JaH, Wan J. Toward optimal participant decisions with voting‐based incentive model for crowd
sensing. Inform Sci. 2020;512:1‐17.
14. Jiang JZR, Wu C, Chen JaT. PAN: pipeline assisted neural networks model for data‐to‐text generation in
social internet of things. Inform Sci. 2020;530:168‐179.
15. Wang Y, Yang G, Bracciali A, et al. Incentive compatible and anti‐compounding of wealth in proof‐of‐stake.
Inform Sci. 2020;530:85‐94.
16. Barber S, Boyen X, Shi E, Uzun E. Bitter to betterałhow to make bitcoin a better currency. Berlin, Heidelberg:
Springer; 2012:399‐414.
17. Eyal I, Sirer EG. Majority is not enough: bitcoin mining is vulnerable. Berlin, Heidelberg: Springer; 2014:
436‐454.
18. Nayak K, Kumar S, Miller A, Shi E. Stubborn mining: generalizing selfish mining and combining with an
eclipse attack. Saarbruecken: IEEE; 2016:305‐320.
19. Sapirshtein A, Sompolinsky Y, Zohar A. Optimal selfish mining strategies in bitcoin. Berlin, Heidelberg:
Springer; 2016:515‐532.
20. Bonneau J, Felten EW, Goldfeder S, Kroll JA, Narayanan A. Why buy when you can rent? bribery attacks on
bitcoin consensus; 2016.
21. Gao, S, Li, Z, Peng, Z, Xiao, B. Power adjusting and bribery racing: novel mining attacks in the bitcoin
system. In Proceedings of the 2019 ACM SIGSAC Conference on Computer and Communications; 2019:
833‐850.
22. McCorry P, Hicks A, Meiklejohn S. Smart contracts for bribing miners. Berlin: Springer; 2018:3‐18.
23. Hou, C, Zhou, M, Ji, Y, et al., SquirRL: automating attack discovery on blockchain incentive mechanisms
with deep reinforcement learning. arXiv preprint arXiv:1912.01798. 2019. http://arXiv.org/abs/arXiv:1912.
01798
24. Sutton RS, Barto AG. Reinforcement learning: an introduction. Cambridge, MA: MIT Press; 2018.
25. Chadès I, Chapron G, Cros MJ, Garcia F, Sabbadin R. MDPtoolbox: a multi‐platform toolbox to solve
stochastic dynamic programming problems. Ecography. 2014;37(9):916‐920.
26. Göbel J, Keeler HP, Krzesinski AE, Taylor PG. Bitcoin blockchain dynamics: the selfish‐mine strategy in the
presence of propagation delay. Performance evaluation. 2016;104:23‐41.
YANG ET AL. | 1747
 1098111x, 2020, 11, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.22270 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
http://arXiv.org/abs/arXiv:1911.12942
http://arXiv.org/abs/arXiv:1112.4980
http://arXiv.org/abs/arXiv:1912.01798
http://arXiv.org/abs/arXiv:1912.01798
27. Rosenfeld M. Analysis of hashrate‐based double spending. arXiv preprint arXiv:1402.2009. 2014. http://
arXiv.org/abs/arXiv:1402.2009
28. Sompolinsky Y, Zohar A. Secure high‐rate transaction processing in bitcoin. Berlin: Springer; 2015:507‐527.
How to cite this article: Yang G, Wang Y, Wang Z, Tian Y, Yu X, Li S. IPBSM: An
optimal bribery selfish mining in the presence of intelligent and pure attackers. Int J Intell
Syst. 2020;35:1735‐1748. https://doi.org/10.1002/int.22270
1748 | YANG ET AL.
 1098111x, 2020, 11, D
ow
nloaded from
 https://onlinelibrary.w
iley.com
/doi/10.1002/int.22270 by C
ity U
niversity O
f H
ong K
ong, W
iley O
nline L
ibrary on [15/04/2023]. See the T
erm
s and C
onditions (https://onlinelibrary.w
iley.com
/term
s-and-conditions) on W
iley O
nline L
ibrary for rules of use; O
A
 articles are governed by the applicable C
reative C
om
m
ons L
icense
http://arXiv.org/abs/arXiv:1402.2009
http://arXiv.org/abs/arXiv:1402.2009
https://doi.org/10.1002/int.22270