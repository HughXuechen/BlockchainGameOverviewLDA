Microgrid Trading Game Model Based on Blockchain Technology and Optimized Particle Swarm Algorithm
Received November 22, 2020, accepted December 10, 2020, date of publication December 15, 2020,
date of current version December 30, 2020.
Digital Object Identifier 10.1109/ACCESS.2020.3044980
Microgrid Trading Game Model Based on
Blockchain Technology and Optimized
Particle Swarm Algorithm
BINYAO LIU1, MING WANG1, JIAKAI MEN2, AND DECHANG YANG 1, (Member, IEEE)
1College of Information and Electrical Engineering, China Agricultural University, Beijing 100083, China
2College of Automation and Electrical Engineering, Linyi University, Linyi 276005, China
Corresponding author: Dechang Yang (yangdechang@cau.edu.cn)
This work was supported by the National Natural Science Foundation of China under Grant 51977212.
ABSTRACT With the increase in the number of microgrids and the maturity of technology, microgrids
will also participate in power market bidding while ensuring their own consumption. This paper establishes
a microgrid transaction model based on the blockchain platform and uses the Optimized Particle Swarm
Algorithm (OPSO) to solve the optimal bidding strategy in the transaction, which achieves the respective
profit optimization of each subject. The model proposed in this paper realizes the organic integration
of blockchain and microgrid to solve the problem of underutilization of energy in a microgrid gaming
competition. The proposed optimized particle swarm algorithm has high convergence accuracy and strong
search capability. Also, the two major market players are used as research objects to establish an actual
‘‘Wind Turbine - Energy Storage System - Electric Vehicle’’ mini-microgrid system to solve the real-time
electricity price problem. A comparative analysis of themodel is carried out utilizing an example verification.
INDEX TERMS Blockchain, microgrid, optimized particle swarm algorithm (OPSO), game competition,
energy storage system (ESS).
I. INTRODUCTION
As the economy and society continue to develop, distributed
power producers and sellers are gradually participating in
electricity market transactions [1]. It is hoped that distributed
renewable energy (such as wind power, photovoltaic power
generation, etc.) can be fully utilized to address the shortage
of energy demand.
As an important part of the smart grid, the microgrid can
efficiently integrate various distributed energy sources and
increase the penetration rate of renewable energy. After the
collapse of the large power grid, the supply of power can
be quickly restored to ensure uninterrupted power supply for
important users and make up for the shortcomings of the
centralized power supply of the large power grid [2], [3].
In the electricity market, microgrids form multiple sub-
jects involved in the competition playing bidding against
each other. In blockchain microgrid transactions, each sub-
ject is pro-consumer. The purpose of studying real-time
microgrid trading is to complement microgrids with different
The associate editor coordinating the review of this manuscript and
approving it for publication was Fabio Massaro .
characteristics, to fully utilize the surplus power of micro-
grids, and make efficient use of energy. How to fully guaran-
tee the balance of interests of the various market entities and
increase the utilization ratio of renewable energy is a problem
that needs to be solved [4]. Therefore, the construction of
the microgrid power trading model is of great significance
to energy consumption.
However, the research on the electric energy trading of
microgrid still faces many obstacles. There are still multi-
ple obstacles to the study of electricity trading in micro-
grids. For example, the lack of clarity of the trading entity,
the opacity of the price, and the complexity of the algorithm.
As a distributed database and decentralized P2P network,
the blockchain has the characteristics of smart contracts,
distributed decision-making, collaborative autonomy, high
security and openness, and transparency that are tamper-
proof. The blockchain network can support the construction
and protection of the power spot trading market.
In recent years, the trading model has been studied in
microgrid market trading supported by blockchain tech-
nology. Most of the current adoption is using blockchain
technology for platform building and data recording.
225602 This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ VOLUME 8, 2020
https://orcid.org/0000-0002-0971-6705
https://orcid.org/0000-0002-7044-0349
B. Liu et al.: Microgrid Trading Game Model Based on Blockchain Technology and OPSO
Reference [5] proposes an energy framework for P2P
multi-settlement transactions. A multi-settlement market is
implemented using blockchain technology to make optimal
decisions in selling/buying energy. There is a lack of more
specific elaboration on practical application. Reference [6]
develops a V2G secure energy trading mechanism based on
the alliance blockchain. And the optimal pricing strategy is
obtained using the game knowledge. However, it is not suf-
ficiently connected to the internal microgrid. Reference [7]
discusses the application of smart grid and blockchain tech-
nologies to smart cars, which is valuable to learn from.
Reference [8] proposes a decentralized distributed energy
trading mechanism based on blockchain smart contract tech-
nology as a way to enable P2P energy trading between pro-
ducers. The question of how to further facilitate and motivate
transactions between energy sources is one that requires
further study. Reference [9] investigates scheduling schemes
between microgrids using the PSO algorithm to minimize
carbon emissions and cost per microgrid based on traditional
scheduling. But improvements can be made to the algorithms
for decentralized trading. Reference [10] presents a decentral-
ized energy management system for electric microgrids that
allows microgrid participants to trade with the distribution
network and between participants. It enables users to get
better profits directly. But it is further possible to construct
a game model of multiparty competition.
The above research has studied the scheduling between
microgrids and explored the application of various
blockchain technologies to power sales, based on the develop-
ment needs of the existing power system. However, the com-
petitive relationship between the internal entities has not
yet been clearly explained, and the practical application of
blockchain technology in microgrids has not been explicitly
analyzed in a case study. How to maximize the profit of the
respective entities between microgrids under a decentralized
trading mechanism is a problem to be solved.
The main contributions of this paper are as follows:
1) Microgrid transaction design: analyze the coupling
between blockchain technology and microgrid trans-
actions, and provide decentralized transaction support
using blockchain and smart contract technology.
2) Trading platform model construction: The trading rela-
tionship between microgrids is investigated, and the
subjects are divided into operators, storage providers,
and large users, and the demands of each subject
are identified and mathematical function models are
established.
3) Solving the model: The optimal particle swarm algo-
rithm is used to realize the demand for electricity and
tariff from operators, storage providers, and large users
at various times of the day. The feasibility and validity
of the constructed model and the solution algorithm are
verified by applying them to the actual model.
The rest of the paper is organized as follows: in Sec. II,
a brief introduction to the concepts related to blockchain
technology and a coupled analysis of microgrid group
transactions and blockchain technology are presented; in
Sec. III, a multi-party game model based on microgrid
operators, large users, and distributed storage providers is
developed; in Sec. IV, the OPSO is used to solve the above
multi-body game model; in Sec. V, using the wind turbine,
energy storage device, and electric vehicle combination
model as a practical example of a small-scale microgrid
for verification of the algorithm; in Sec.VI, conclusion, and
summary.
II. THEORETICAL ANALYSIS
A. BLOCKCHAIN TECHNICAL
Blockchain technology is also known as distributed ledger
technology. As the underlying technology and infrastructure
of Bitcoin, blockchain has the characteristics of decentraliza-
tion, information security and transparency, smart contracts,
and verifiability. When the blockchain is used on different
occasions, the hierarchical structure of the blockchain will be
fine-tuned according to the specific application occasions, but
the application structure of the blockchain basically consists
of six levels [11], [12].
The bottom layer is the data layer, which uses a chain
structure to store the underlying data blocks; the second
layer is the network layer, including network transmission
mechanisms and verification mechanisms; the third layer is
the consensus layer, which encapsulates algorithms to allow
distributed blocks to reach consensus; the fourth layer is the
incentive layer, which mainly includes the issuance mecha-
nism and distribution mechanism; the fifth layer is the con-
tract layer, which generates smart contracts; the top layer is
the application layer, which is the actual case of blockchain
application in power transactions.
B. COUPLING ANALYSIS BETWEEN BLOCKCHAIN AND
MICROGRID TRANSACTION
In addition to its application in the financial field such as dig-
ital currency, blockchain is also developing rapidly in energy
transactions in the power sector. Its decentralized nature
naturally corresponds to the distributed nature of the main
body of power purchase and sale in the power grid. And the
features of data transparency, traceability, and anti-tampering
can improve the security and reliability of transactions [13].
For the characteristics of the blockchain, the corresponding
section in the microgrid is shown in table 1:
Due to a large number of microgrid participants, with the
blockchain technology, contracts are signed directly between
consumers and producers, which also helps to enhance the
status of consumers and market influence. In microgrid trad-
ing, operators and users publish contracts with bidding infor-
mation into the trading area, and the system generates smart
contracts based on the information from both parties and
feeds back to them.
In this paper, the microgrid market players include
Microgrid operators (MOs), Distributed storage providers
(DPs), and Large users (LUs). To maximize their interests,
VOLUME 8, 2020 225603
B. Liu et al.: Microgrid Trading Game Model Based on Blockchain Technology and OPSO
TABLE 1. Analysis of the fit between blockchain technology and
microgrid Transactions.
the three players will influence the market changes by formu-
lating different strategies to buy and sell electricity at different
stages of the game.
1) MICROGRID OPERATORS
Mainly responsible for generating and buying and selling
electricity.
2) DISTRIBUTED STORAGE PROVIDERS
Mainly collects and stores the distributed electric energy of
all distributed users.
3) LARGE USERS
Only consider obtaining the required power at a lower cost.
Acting as a consumer, buying electricity but not selling
electricity.
Fig.1 shows the game structure of the three-party market
players. Each market subject is equipped with a correspond-
ing block, and each subject block will be connected at the
same time to form an energy block network. Each block
FIGURE 1. Microgrid group trading market structure.
conducts transactions, blockchain searches, and links work
in different periods to form a blockchain.
In a large energy block network, each main module will
actively submit its identity authentication or logo, such as
identity ID, account, energy form, geographic location, and
other basic information as the core basis of power transmis-
sion data and market transaction data [14].
And through the analysis and mining of the energy block
network, the market game equilibrium can be realized. In the
case of multiple parties participating in the competition at
the same time, each subject can choose a plan that is more
in line with its interests based on the quotation. All block
information is transparent and open, and each entity judges
the transaction based on its needs and benefits. If both parties
meet the transaction conditions, a consensus between the two
nodes can be generated and the transaction can be completed.
III. MATHEMATICAL MODEL
In the microgrid system, to maximize their own interests,
the microgrid operators, distributed storage providers, and
large users participating in the market game will influence
market changes by formulating different strategies for pur-
chasing and selling electricity at different stages. All three
have different objectives and needs, and therefore a functional
relationship needs to be established separately.
A. LUS DEMAND MODEL
The goal of Large users is to obtain the target power at the
lowest cost and put it into production. In order to simplify
the model, this article assumes that the main users of the
multi-microgrid system do not have the conditions to produce
electricity. The goals of Large users to purchase electricity
mainly include the cost of electricity purchase from MOs
CMtoU
buy (t) and the cost of electricity purchase from DPs
CDtoU
buy (t). The specific form of electricity purchase depends
on the electricity sales strategy of each entity, and the mathe-
matical expression is as follows:
1) PURCHASE ELECTRICITY FROM MOS
CMtoU
buy (t) =
n∑
i=1
cMitoU
buy (t) · qMitoU
buy (t) (1)
Among them, cMitoU
buy (t) and qMitoU
buy (t) respectively repre-
sent the unit cost of electricity purchased from the i-th MO at
time t and the amount of electricity purchased.
2) PURCHASE ELECTRICITY FROM DPS
CDtoU
buy (t) =
n∑
i=1
cDitoUbuy (t) · qDitoUbuy (t) (2)
Among them, c
DjtoU
buy (t) and q
DjtoU
buy (t) respectively repre-
sent the unit cost of electricity purchased from the j-th DP
at time t and the amount of electricity purchased.
225604 VOLUME 8, 2020
B. Liu et al.: Microgrid Trading Game Model Based on Blockchain Technology and OPSO
B. MOS MATHEMATICAL MODEL
Since the microgrid contains intermittent energy sources
(wind power, solar energy, etc.), within a unit time period,
its content processes are not necessarily balanced with its
own load, and external power is usually surplus or lack of
power. When the system has surplus electricity, the microgrid
operator will sell electricity to other users to obtain revenue
PMOsell (t). When the operator lacks electricity, it will purchase
electricity externally at a cost of CMO
buy (t). It is described in
mathematical form as follows:
1) ELECTRICITY SALES PROFIT
The MO’s profit on electricity sales is the sum of the electric-
ity sold by each MO to DP, LU and other MOs multiplied by
the real-time electricity price.
PMOsell (t) =
n1∑
i=1
pMtoMi
sell (t) · qMtoMi
sell (t)
+
n2∑
j=1
p
MtoDj
sell (t) · q
MtoDj
sell (t)
+
n3∑
m=1
pMtoLmsell (t) · qMtoLmsell (t) (3)
Among them, pMtoMi
sell (t), p
MtoDj
sell (t) and pMtoLmsell (t) respec-
tively represent the price of electricity sold to the i-th MO,
the j-th DS, and the m-th LU at time t; qMtoMi
sell (t), q
MtoDj
sell (t)
and qMtoLmsell (t) respectively represent the amount of electricity
sold to the i-th MO, the j-th DS, and the m-th LU at time t.
2) ELECTRICITY PURCHASES COST
The MO’s cost on power purchases is the sum of the power
purchased by each MO from DP, and other MOs multiplied
by the real-time electricity price.
CMO
buy (t) =
n1∑
i=1
cMitoM
buy (t) · qMitoM
buy (t)
+
n2∑
j=1
c
DjtoM
buy (t) · q
DjtoM
buy (t) (4)
Among them, cMitoM
buy (t) and c
DjtoM
buy (t) respectively repre-
sent the unit cost of electricity purchased from the i-th MO
and the j-th DS at time t, qMitoM
buy (t) and q
DjtoM
buy (t) respec-
tively represent the amount of electricity purchased from the
i-th MO and the j-th DS at time t.
C. DPS MATHEMATICAL MODEL
Distributed storage providers can not only inspire ordinary
users to actively participate in the electricity market, but also
increase the utilization rate of renewable energy and provide
the market with more energy sources and purchase channels.
Distributed storage providers mainly use the bid-ask price
difference to maximize their profits. On the one hand, when
the market lacks electricity, they sell electricity to obtain
incomePDPsell(t). On the other hand, they purchase electricity at
the lowest costCDP
buy(t). The specific mathematical description
is as follows:
1) ELECTRICITY PURCHASES COST
a: PURCHASE ELECTRICITY FROM MOs
CMtoD
buy (t) =
n∑
i=1
cMitoD
buy (t) · qMitoD
buy (t) (5)
Among them, cMitoD
buy (t) and qMitoD
buy (t) respectively repre-
sent the unit cost of electricity purchased from the i-th MO
and the amount of electricity at time t.
b: PURCHASE ELECTRICITY FROM OTHER DPs
CDtoD
buy (t) =
n∑
i=1
cDitoDbuy (t) · qDitoDbuy (t) (6)
Among them, cDitoDbuy (t) and qDitoDbuy (t) respectively represent
the unit cost of electricity purchased from the j-th DP and the
amount of electricity at time t.
2) ELECTRICITY SALES PROFIT
a: SALE ELECTRICITY TO MOs
PDtoMsell (t) =
n∑
i=1
cDtoMi
sell (t) · qDtoMi
sell (t) (7)
Among them, cDtoMi
sell (t) and qDtoMi
sell (t) respectively repre-
sent the unit cost of electricity sold to the i-th MO and the
amount of electricity sold at time t.
b: SALE ELECTRICITY TO OTHER DPs
PDtoDsell (t) =
n∑
j=1
cDtoDisell (t) · qDtoDisell (t) (8)
Among them, cDtoDisell (t) and qDtoDisell (t) respectively represent
the unit cost of electricity sold to the j-th DP and the amount
of electricity sold at time t.
c: SALE ELECTRICITY TO LUs
PDtoLsell (t) =
n∑
m=1
cDtoLisell (t) · qDtoLisell (t) (9)
Among them, cDtoLisell (t) and qDtoLisell (t) respectively represent
the unit cost of electricity sold to the m-th LU and the amount
of electricity sold at time t.
D. ACTUAL MATHEMATICAL MODEL
On the premise of ensuring the balance of power and the
continuous and stable operation of the power system, the new
round of power reform will open up some power generation
and power consumption plans, and establish a peer-to-peer
power trading market model. Qualified power generation
companies, power sales companies, or large customers can
VOLUME 8, 2020 225605
B. Liu et al.: Microgrid Trading Game Model Based on Blockchain Technology and OPSO
determine transaction capabilities and transaction prices
through bilateral or multilateral transactions, thereby realiz-
ing the organic connection between dispatching business and
market transactions.
The virtual power plant in the microgrid can integrate
different resources in the distributed power generation system
to form an overall participating power market. At present, due
to the intermittent and volatility of renewable energy, when it
is directly connected to the grid, it will cause operation dis-
order and quality degradation [15]. The microgrid can organ-
ically combine distributed power generation systems based
on renewable energy, user loads, energy storage systems,
and control systems [16]. Therefore, an actual transaction
model of the microgrid can be constructed to validate the
effectiveness of our scheme.
In order to verify the actual market conditions of the three
major players of microgrid market transactions. Considering
the application of new environmental protection technologies
represented by fast-charging energy storage and electric vehi-
cles in the microgrid, wind turbines are added as the operators
in this model, and electric vehicles are only used as large
users, and electricity is not sold.
Because the charging load of electric vehicles is very
random, in order to meet its charging needs, reduce the
adverse impact of electric vehicle charging on the distri-
bution network. Access to energy storage systems (ESS)
in fast-charging stations can alleviate the adverse effects
of uncertain charging loads. At the same time, the use of
low-cost electricity during valleys instead of high-priced elec-
tricity during peaks is used to cut peaks and fill valleys. ESS
acts as the depositor of this model.
The microgrid is composed of 6 wind turbines, 1 electric
energy storage system ESS, and 3 electric vehicles [17]. The
parameter settings are shown in table 2 to table 4.
TABLE 2. Wind turbine parameters.
TABLE 3. ESS parameters.
TABLE 4. Electric vehicles parameters.
In the power market environment, the output of each dis-
tributed power supply of the virtual power plant is reasonably
adjusted, and the optimization decision-making goal of the
three major players is to maximize the total profit of the
consortium. The objective function is:
max
∑
i
∑
t
λi(t)qi(t) (10)
Among them: λi(t) is the respective electricity quotation,
qi(t) is the respective electricity generation.
Establish constraints for different subjects:
1) WIND POWER SYSTEM
PMimin(t) ≤ PMi(t) ≤ PMimax(t) (11)
Among them, PMimin(t) and PMimax(t) are the minimum
and maximum power limits used by wind turbine i at time t,
which are determined by the wind speed, and the specific
values depend on time changes.
2) ESS
Qmin(t) ≤ Q(t) ≤ Qmax(t) (12)
Among them, Qmin(t) and Qmax(t) represent the upper and
lower limits of the energy storage motor.
3) ELECTRIC VEHICLES Soc(t) = Soc(t − 1)−
t
Er
η
Socmin(t) ≤ Soc(t) ≤ Socmax(t)
(13)
Among them, Soc(t) is the state of charge of the electric
vehicle battery at the end of the t-th period [18], η is the charge
and discharge efficiency of the battery,Er is the rated capacity
of the battery, Socmin(t) and Socmax(t) are the upper and lower
limits of the amount of charge.
IV. OPTIMIZE PARTICLE SWARM ALGORITHM
A. BASIC PSO
The research focus of this paper is to solve the optimal
bidding strategy of each market entity in the microgrid.
In microgrid transactions, the game competition among the
three major players can be regarded as a multi-objective
optimization model. Among them, the constraint condition is
to meet the electricity demand of each subject. The objective
function is mainly as follows: all major entities obtain the
maximum profit; ensure that there is no abandonment of
electricity when conducting mutual transactions.
When solving multi-objective optimization problems,
basic PSO has the advantages of fast convergence, high
accuracy, strong stability, simplicity and generality, and easy
implementation. It is highly capable of optimizing complex
nonlinear problems and is better suited for solving complex
multi-dimensional optimization problems. There is a certain
degree of fit with this model, as shown in Fig.2.
225606 VOLUME 8, 2020
B. Liu et al.: Microgrid Trading Game Model Based on Blockchain Technology and OPSO
FIGURE 2. PSO and microgrid group transaction model analogy.
But the global searchability of the PSO is strong at the
beginning, but the local searchability is relatively weak. With
iteration, its global search capability is relatively weakened,
while its local search capability is relatively enhanced. This
leads to uncertain solutions when solving microgrid transac-
tions, and power abandonment may occur. In order to obtain
more accurate and efficient results and make transaction data
universal, after improving the PSO algorithm, an optimized
particle swarm algorithm (OPSO) can be obtained to solve
the microgrid transaction problem under the blockchain.
B. OPTIMIZED PSO
Particle Swarm Optimization (PSO) is a swarm-based opti-
mization tool. The system is initialized as a set of random
solutions, and the optimal solution is searched through iter-
ation [19]. The particle swarm optimization algorithm is an
optimization algorithm based on the theory of swarm intel-
ligence, which guides the optimization search through the
swarm intelligence generated by the whole work and compe-
tition among particles in the swarm [20]. Compared with evo-
lutionary algorithms, PSO retains the global search strategy
based on population, but its speed-displacementmodel is sim-
ple to operate and avoids complicated genetic operations [21].
Although when solving multi-objective competition prob-
lems, particle swarm optimization is a good method.
However, the traditional particle swarm algorithm is easy to
fall into a local optimal solution, which leads to multiple
parties in the game not getting the best profit point. The core
of optimizing the particle swarm algorithm is to enhance the
searchability and reduce the number of iterations. Therefore,
the OPSO can obtain the best results more efficiently and
accurately in microgrid transactions.
The specific optimization process is as follows:
In a D-dimensional search space, suppose there are U par-
ticles in the group, where the position xj of the j-th particle is
[xj1, xj2, · · · , xjD], The position of each particle corresponds
to a potential solution. The D-dimensional velocity vj of the
j-th particle is [vj1, vj2, · · · , vjD], and the current optimal
position sbj of the j-th particle is [sj1, sj2, · · · , sjD], the cur-
rent optimal of the entire particle swarm The position sbg is
[sg1, sg2, · · · , sgD]. After the k-th flight, the update speed of
the j-th particle is:
vk+1j = ωvkj + c1r1
(
sbj − x
k
j
)
+ c2r2
(
sbg − x
k
j
)
(14)
Updated location:
xk+1j = xkj + v
k+1
j (15)
Among them: vkj is the speed of the j-th particle after the
k-th flight; vk+1j is the speed of the j-th particle after the k+1
flight; xkj is the position of the j-th particle after the k-th flight;
xk+1j is the position of the j-th particle after the k + 1 flight;
c1c2 is the learning factor; ω is the inertia weight; r1r2 is a
random number between 0 and 1. To optimized the particle
swarm algorithm is to improve the learning factor.
The linear dynamic adjustment method is used to calculate
the learning factor c1c2. Compared with the fixed value,
the learning speed is accelerated c1c2 are:
c1 = cmax
1 −
(
cmax
1 − cmin
1
)
k/kmax
c2 = cmax
2 −
(
cmax
2 − cmin
2
)
k/kmax (16)
Among them: cmax
1 and cmin
1 are the upper and lower limits
of c1, respectively; cmax
2 and cmin
2 are the upper and lower
limits of c2, respectively; kmax is the maximum number of
flights.
The specific implementation steps of the improved
algorithm are shown in Fig.3.
C. TRADING PROCESS
The OPSO is used to solve the competitive game process
in the microgrid market under blockchain technology as
follows:
(1) Set the initial set of strategies for each game subject
to participate in the competitive game. Each subject
publishes information in the blockchain network dur-
ing the time period t, and each subject can use the
private key to view other information. For market sub-
ject k, n sub-particle swarm individuals are randomly
generated within its quotation range. Each particle
swarm individual represents a quotation strategy. The
price strategy set of subject k in time period t can be
expressed as:
ηn(t) = {p1(t), p2(t), · · · , pn(t)}
(2) Each market entity releases purchase and sales infor-
mation to the blockchain network according to its own
needs. The market entity k1 selects another market
entity k2 as the transaction object by predicting its own
controllable resource adjustment ability within the time
VOLUME 8, 2020 225607
B. Liu et al.: Microgrid Trading Game Model Based on Blockchain Technology and OPSO
FIGURE 3. OPSO flow chart. k is the preset maximum number of
iterations.
period t and then uses the secret key to decrypt all
the information of k2. After verifying its authenticity,
determine whether the objective function value meets
the conditions, if not, the subject k1 converts the trans-
action object or k2 provides a second offer and enters
the loop.
(3) Update the objective function value according to the
game strategy. If the subject kl accepts the purchase/
sale strategy of the subject k2, the two parties reach an
agreement to generate a smart contract:
Ctr .ik−l = [signk
∣∣∣signl ∥∥∥Qi |[t, t +1t] ∣∣∣Pi ]
(4) If the subject k2 meets its own needs, the position
of the particles in each subgroup is updated. Calculate
the local optimal pbest1, pbest2 of the particle, and
the global optimal gbest1, gbest2 of each subgroup
according to the method of a single objective function.
Recombine the new particle swarm to get themaximum
profit of this entity and the best quotation between the
entities.
(5) Until the maximum number of iterations is met,
the number of iterations is N = N + 1; if N ≤ Nmax ,
go to step 2; otherwise, output the optimal result.
V. CASE ANALYSIS
A. TRADING MODEL ANALYSIS
In order to verify the feasibility of the constructed game
model, the microgrid market competition game simulation
system is constructed in Python. The system selects 3 groups
of MOs, 2 groups of DPs, and 3 groups of LUs as the main
players in the market game. The subjects compete with each
other according to their own goals and stipulate that the
electricity purchase price of each game subject is replaced by
the corresponding electricity sale price [22]. If the bidding
strategy space of each type of market entity is set to be
consistent, the bidding strategy range of each type of entity is
described as:
MOs: 0.5 ∼ 1.1 yuan/(kWh);
DPs: are 0.5 ∼ 0.95 yuan/(kWh);
LUs: are 0.5 ∼ 1.05 yuan/(kWh).
The 24-hour electricity demand of each entity and the
electricity sold byMOs andDPs can be obtained by reviewing
the data [23]. The 24-hour electricity demand and supply of
each market entity are shown in Fig.4 and Fig.5:
FIGURE 4. The electricity demand of each market entity.
FIGURE 5. 24-hour power supply of MOs and DPs.
In this model, set the maximum number of iterations
Nmax = 100, the total number of market entities n = 8, and
each entity randomly generates m = 10 quotation strategies
within the scope of the bidding strategy; set the optimal factor
ρ = 0.02 and the constantQ = 1. Since this model belongs to
a multi-objective and multi-stage optimization problem, this
paper takesMOs and DPs as examples to verify the feasibility
of the model.
1) MOS ARE THE MOST PROFITABLE
From Fig.6, it can be seen that during the daytime
(08:00-23:00) there is a large demand for electricity, and
all market entities sell electricity at higher prices. Affected
by competition from DPs, there is only a slight difference
between the quotations of MOs to LUs and DPs. However,
during the period from 00:00 to 07:00, MOs have become
225608 VOLUME 8, 2020
B. Liu et al.: Microgrid Trading Game Model Based on Blockchain Technology and OPSO
FIGURE 6. Quotation of maximum profit of MOs.
the main suppliers of electricity for LUs, and their quotations
have been increased accordingly and better benefits have
been obtained.
Selecting the quotation at 12 noon for analysis, from
table 5, it can be seen that the system demand reaches the
maximum at this time, and some MOs that lack power will
also purchase electricity from other entities. The purchase
price from multi-power MOs is 1.05 yuan/(kWh), due to the
limited supply capacity of the store, the store’s quotation is
0.92 yuan/(kWh). On the premise of maximizing the profit
of the operator, the quoted price of the MOs will always be
slightly higher than that of the depository in order to obtain
high profits.
TABLE 5. 12: 00-noon transaction quotation Situation.
From Fig.7, the period between 0:00-09:00 for eachmarket
entity is the low electricity consumption stage. The major
entities have low demand, and each electricity seller will not
sell electricity to MOs. DPs need to store power for sale at
this time, soMOs can obtain certain benefits by selling power
to DPs at this time. There is electricity demand between
11:00-23:00, and it peaks at 12:00 noon. At this time, theMOs
is also the main power supplier for LUs.
2) DPS ARE THE MOST PROFITABLE
The game data at 12:00 noon is still selected for analysis,
as Fig.8 and table 6. When customizing the bidding
strategy for LUs, the electricity price of MOs is set at
1.04 yuan/(kWh), and the price of DPs should not be higher
than 1.04 yuan/(kWh). In order to maximize the profits
of DPs, the pricing strategy of DPs at this time is also
1.04 yuan/(kWh), and they compete with MOs at the same
FIGURE 7. Electricity trading under the best quotation.
FIGURE 8. Quotation of the maximum profit of DPs.
TABLE 6. 12: 00-noon transaction quotation Situation.
time. During the period from 0:00-07:00, DPs belong to the
charging period of energy storage batteries and purchase elec-
tricity from MOs at a lower price to sell during the daytime
peak power consumption.
DPs are in a charged state during the time period of
0:00-07:00, and only purchase electricity from MOs at low
prices without selling electricity. From Fig.9, in the period
from 08:00 to 24:00, it will competewith othermarket players
and formulate the optimal bidding strategy. Among them,
electricity is mainly sold to LUs to obtain benefits. DPs will
sell electricity to each other according to the situation, and
they will also sell electricity to MOs who lack electricity
during the noon peak period.
B. SOURCE-STORAGE-LOAD COMPETITION MODEL
The status of each node in the blockchain is equal, and normal
operation is jointly maintained through a consensus mech-
anism. Therefore, under blockchain architecture, the three
real-time scheduling transaction models are shown in Fig.10.
VOLUME 8, 2020 225609
B. Liu et al.: Microgrid Trading Game Model Based on Blockchain Technology and OPSO
FIGURE 9. Electricity trading under the best quotation.
FIGURE 10. Scheduling transaction model.
Through experimental simulation, input the parameters of
wind turbines, energy storage systems, and electric vehicles,
using an optimized particle swarm algorithm, in the game of
small microgrids, output the output power of each subject,
and the results are shown in Fig.11 to Fig.13.
FIGURE 11. Wind turbine output decision.
In general, wind turbine power generation can be fully
utilized, and the energy storage system and electric vehicles
coordinate to ensure the stable operation of the microgrid and
reduce operating costs. The interaction between source stor-
age and load is in line with following the output of renewable
FIGURE 12. ESS output decision.
FIGURE 13. Electric vehicles output decision.
energy, maximizing the use of renewable energy, and enhanc-
ing the load experience. The feasibility and effectiveness of
the algorithm are verified.
For wind turbines: As the marginal cost of new wind
energy is negligible, wind farms, as operators, usually guaran-
tee that all electricity is sold at a low price. However, with the
addition of energy storage systems, wind farms will partici-
pate more actively in competition. During the low electricity
consumption period (0:00-08:00), generate less electricity,
and generate more electricity during the peak electricity con-
sumption period (09:00-24:00) to obtain more profits.
For ESS: wind power needs to be stored when power is
low and sold during the day to complete. In the case of only
considering peak shaving and valley filling, the energy stor-
age system strategically selects storage during the double low
period of night load and price. And strategically discharge
during the double peak period of load and price to earn the
profit difference between the peak and trough of price.
For electric vehicle users: mainly rely on the battery
to participate in charging and discharging, mainly charging
directly at night. Due to the limited capacity of the battery,
it is also necessary to connect to the energy storage system to
obtain sufficient power during the day.
C. ALGORITHM VERIFICATION
In order to verify the performance of the (OPSO) in themicro-
grid game model transaction, this paper uses the ant colony
algorithm, genetic algorithm, and traditional particle swarm
algorithm to optimize the objective function. Among them,
225610 VOLUME 8, 2020
B. Liu et al.: Microgrid Trading Game Model Based on Blockchain Technology and OPSO
the number of iterations is set to 200. Then take the maximum
value of Microgrid operators profit (MOMAX), the maxi-
mum value of Distributed storage providers profit (DPMAX),
and the minimum value of Large users cost (LUMIN) as the
objective function [24]. The results are compared in table 7
below:
TABLE 7. Algorithm comparison.
The average number of convergence times of the OPSO
is the smallest, indicating that its global convergence ability
is strong. In addition, the optimal solution OPSO of the
objective function also shows its searchability and efficiency,
indicating that improved learning factors are reasonable.
VI. CONCLUSION
This paper studied the problem of market competition and
game in the microgrid system. By analyzing the demands
of multiple market players such as microgrid operators,
large users, and distributed storage providers, a local multi-
microgrid market competition game model was developed
based on blockchain technology. Taking into account the
competitive relationship between the multiple parties and
their respective goals, the OPSO was used to perform the fit
analysis of the blockchain transactions. The optimized algo-
rithm has better global search and convergence capabilities,
which improves the solution efficiency. After the arithmetic
analysis of the market competition game model, the micro-
grid operator and the storage provider were solved and ana-
lyzed as the profit maximum, respectively. Finally, the actual
microgrid system simulation was established, and the mech-
anism formed by the broadcast negotiation from the dispatch
chain to the transaction chain was designed, and the trust
mechanism and smart contract between the ‘‘source-storage-
load’’ nodes were formed. The analysis results showed that:
(1) The blockchain-supported transaction model proposed
in this paper can be used for internal power transactions
in the microgrid. Both parties to the transaction can
dynamically adjust the quotation according to market
transaction information, and have good adaptability
and efficiency;
(2) Particle swarm algorithm can be better used for
multi-objective solution model by improving learning
factor, and it has superiority in iterative ability and
searchability;
(3) With the significant increase in the proportion of flex-
ible loads and the improvement of demand response
technology, the dispatchable resources, and clean
energy in the microgrid will become more abundant.
Considering the actual model to select electric vehicles
and wind power generation has certain reference value.
REFERENCES
[1] R. Alvaro-Hermana, J. Fraile-Ardanuy, P. J. Zufiria, L. Knapen, and
D. Janssens, ‘‘Peer to peer energy trading with electric vehicles,’’
IEEE Intell. Transp. Syst. Mag., vol. 8, no. 3, pp. 33–44, Fall 2016,
doi: 10.1109/MITS.2016.2573178.
[2] M. Daneshvar, B. Mohammadi-ivatloo, S. Asadi, M. Abapour, and
A. Anvari-Moghaddam, ‘‘A transactive energy management frame-
work for regional network of microgrids,’’ in Proc. Int. Conf. Smart
Energy Syst. Technol. (SEST), Porto, Portugal, Sep. 2019, pp. 1–6,
doi: 10.1109/SEST.2019.8849075.
[3] S. Thakur, B. P. Hayes, and J. G. Breslin, ‘‘Distributed double auction
for peer to peer energy trade using blockchains,’’ in Proc. 5th Int. Symp.
Environ.-Friendly Energies Appl. (EFEA), Rome, Italy, Sep. 2018, pp. 1–8,
doi: 10.1109/EFEA.2018.8617061.
[4] D. J. Hammerstrom, S. E. Widergren, and C. Irwin, ‘‘Evaluating transac-
tive systems: Historical and current U.S. DOE research and development
activities,’’ IEEE Electrific. Mag., vol. 4, no. 4, pp. 30–36, Dec. 2016,
doi: 10.1109/MELE.2016.2614182.
[5] K. Nakayama, R. Moslemi, and R. Sharma, ‘‘Transactive energy man-
agement with blockchain smart contracts for P2P multi-settlement
markets,’’ in Proc. IEEE Power Energy Soc. Innov. Smart Grid
Technol. Conf. (ISGT), Washington, DC, USA, Feb. 2019, pp. 1–5,
doi: 10.1109/ISGT.2019.8791652.
[6] Z. Zhou, B. Wang, M. Dong, and K. Ota, ‘‘Secure and efficient Vehicle-to-
Grid energy trading in cyber physical systems: Integration of blockchain
and edge computing,’’ IEEE Trans. Syst., Man, Cybern. Syst., vol. 50, no. 1,
pp. 43–57, Jan. 2020, doi: 10.1109/TSMC.2019.2896323.
[7] H. Liao, Y. Mu, Z. Zhou, M. Sun, Z. Wang, and C. Pan, ‘‘Blockchain
and learning-based secure and intelligent task offloading for vehicular fog
computing,’’ IEEE Trans. Intell. Transp. Syst., early access, Jul. 21, 2020,
doi: 10.1109/TITS.2020.3007770.
[8] S. Yu, S. Yang, Y. Li, and J. Geng, ‘‘Distributed energy transaction mech-
anism design based on smart contract,’’ in Proc. China Int. Conf. Electr.
Distrib. (CICED), Washington, DC, USA, Sep. 2018, pp. 2790–2793,
doi: 10.1109/CICED.2018.8592130.
[9] M. Yousif, Q. Ai, Y. Gao, W. A. Wattoo, Z. Jiang, R. Hao, ‘‘An optimal
dispatch strategy for distributed microgrids using PSO,’’ CSEE J. Power
Energy Syst., vol. 6, no. 3, pp. 724–734, Jun. 2019, doi: 10.17775/CSEE-
JPES.2018.01070.
[10] A. Wlodarczyk, A. Kowalczyk, and J. Tarnawski, ‘‘Decentralized micro-
grid energy management system with market-based energy trade sys-
tem,’’ in Proc. 23rd Int. Conf. Methods Models Autom. Robot. (MMAR),
Aug. 2018, pp. 205–210, doi: 10.1109/MMAR.2018.8486048.
[11] L. W. Chew, ‘‘Power distribution network modeling using block-based
approach,’’ in Proc. IEEE 15th Electron. Packag. Technol. Conf. (EPTC
), Dec. 2013, pp. 230–234, doi: 10.1109/EPTC.2013.6745718.
[12] X. Kong, J. Zhang, H. Wang, and J. Shu, ‘‘Framework of decentralized
multi-chain data management for power systems,’’ in CSEE J. Power
Energy Syst., vol. 6, no. 2, pp. 458–468, Jun. 2020, doi: 10.17775/CSEE-
JPES.2018.00820.
[13] Z. Zhao, J. Guo, X. Luo, J. Xue, C. S. Lai, Z. Xu, and
L. L. Lai, ‘‘Energy transaction for multi-microgrids and internal microgrid
based on blockchain,’’ IEEE Access, vol. 8, pp. 144362–144372, 2020,
doi: 10.1109/ACCESS.2020.3014520.
[14] H. Jun, D. Changhong, and H.Wentao, ‘‘Optimal sizing of distributed gen-
eration in micro-grid considering energy price equilibrium point analysis
model,’’ in Proc. IEEE 8th Conf. Ind. Electron. Appl. (ICIEA), Melbourne,
VIC, Australia, Jun. 2013, pp. 79–84, doi: 10.1109/ICIEA.2013.6566344.
[15] M. T. Turan, Y. Ates, O. Erdinc, and E. Gokalp, ‘‘Effect of dis-
tributed generation based campus model combined with electric vehi-
cle charging stations on the distribution network,’’ in Proc. Int. Conf.
Smart Energy Syst. Technol. (SEST), Porto, Portugal, Sep. 2019, pp. 1–5,
doi: 10.1109/SEST.2019.8849132.
[16] X.-J. Wei and Q. Lu, ‘‘Study on the economic evaluation model of wind,
solar and energy storage combined power generation unit,’’ in Proc. Int.
Conf. Netw. Inf. Syst. Comput. (ICNISC), Shanghai, China, Apr. 2017,
pp. 199–204, doi: 10.1109/ICNISC.2017.00050.
VOLUME 8, 2020 225611
http://dx.doi.org/10.1109/MITS.2016.2573178
http://dx.doi.org/10.1109/SEST.2019.8849075
http://dx.doi.org/10.1109/EFEA.2018.8617061
http://dx.doi.org/10.1109/MELE.2016.2614182
http://dx.doi.org/10.1109/ISGT.2019.8791652
http://dx.doi.org/10.1109/TSMC.2019.2896323
http://dx.doi.org/10.1109/TITS.2020.3007770
http://dx.doi.org/10.1109/CICED.2018.8592130
http://dx.doi.org/10.17775/CSEEJPES.2018.01070
http://dx.doi.org/10.17775/CSEEJPES.2018.01070
http://dx.doi.org/10.1109/MMAR.2018.8486048
http://dx.doi.org/10.1109/EPTC.2013.6745718
http://dx.doi.org/10.17775/CSEEJPES.2018.00820
http://dx.doi.org/10.17775/CSEEJPES.2018.00820
http://dx.doi.org/10.1109/ACCESS.2020.3014520
http://dx.doi.org/10.1109/ICIEA.2013.6566344
http://dx.doi.org/10.1109/SEST.2019.8849132
http://dx.doi.org/10.1109/ICNISC.2017.00050
B. Liu et al.: Microgrid Trading Game Model Based on Blockchain Technology and OPSO
[17] S. Paul and N. P. Padhy, ‘‘A multi-objective genetic algorithm approach
for synergetic Source-Storage-Load dispatch in a residential microgrid,’’
in Proc. 20th Int. Conf. Intell. Syst. Appl. Power Syst. (ISAP), New Delhi,
India, Dec. 2019, pp. 1–7, doi: 10.1109/ISAP48318.2019.9065963.
[18] D. Xu, P. Li, and B. Zhao, ‘‘Optimal scheduling of microgrid
with consideration of demand response in smart grid,’’ in Proc.
IEEE 12th Int. Conf. Netw., Sens. Control, Apr. 2015, pp. 426–431,
doi: 10.1109/ICNSC.2015.7116075.
[19] C.-R. Wang and Y.-E. Zhang, ‘‘Distribution network reconfiguration
basedl on modified particle swarm optimization algorithm,’’ in Proc.
Int. Conf. Mach. Learn. Cybern., Dalian, China, 2006, pp. 2076–2080,
doi: 10.1109/ICMLC.2006.258346.
[20] Y. Xiaojing, J. Qingju, and L. Xinke, ‘‘Center particle swarm optimiza-
tion algorithm,’’ in Proc. IEEE 3rd Inf. Technol., Netw., Electron. Autom.
Control Conf. (ITNEC), Chengdu, China, Mar. 2019, pp. 2084–2087,
doi: 10.1109/ITNEC.2019.8729510.
[21] X. Sun, P. Hu, Y. Li, H. Kang, Q. Chen, and Y. Shen, ‘‘An improved
algorithm for multi-swarm particle swarm optimization based on clus-
tering algorithm,’’ in Proc. IEEE 4th Int. Conf. Comput. Commun.
(ICCC), Chengdu, China, Dec. 2018, pp. 2017–2021, doi: 10.1109/Com-
pComm.2018.8780708.
[22] Z. Liu, J. Gao, H. Yu, and X. Wang, ‘‘Operation mechanism and
strategies for transactive electricity market with multi-microgrid in
grid-connected mode,’’ IEEE Access, vol. 8, pp. 79594–79603, 2020,
doi: 10.1109/ACCESS.2020.2990297.
[23] P. Chen, C. Zhao, J. Li, and Z. Liu, ‘‘Solving the economic dispatch
in power system via a modified genetic particle swarm optimization,’’
in Proc. Int. Joint Conf. Comput. Sci. Optim., Apr. 2009, pp. 201–204,
doi: 10.1109/CSO.2009.475.
[24] W. Al-Saedi, S. W. Lachowicz, D. Habibi, and O. Bass, ‘‘Power quality
improvement in autonomous microgrid operation using particle swarm
optimization,’’ in Proc. IEEE PES Innov. Smart Grid Technol., Perth, WA,
USA, Nov. 2011, pp. 1–6, doi: 10.1109/ISGT-Asia.2011.6257101.
BINYAO LIU is currently pursuing the B.S. degree
with China Agriculture University, Beijing, China.
Her main research interest includes microgrid
trading.
MING WANG received the B.S. degree in elec-
trical engineering and automation from Shenyang
Agricultural University, Liaoning, China. She is
currently pursuing the M.S. degree with the
China Agricultural University, Beijing, China. Her
research interest includes optimal operation of
integrated energy systems.
JIAKAI MEN received the B.S. degree in elec-
trical engineering from Linyi University, Linyi,
China, in 2019, where he is currently pursuing the
M.Sc. degree. His main research interests include
new energy grid connection and integrated energy
system planning.
DECHANG YANG (Member, IEEE) received the
M.S. degree in electrical engineering from China
Agricultural University, Beijing, China, in 2008,
and the Ph.D. degree in power system from TU
Dortmund, in 2012. He is currently an Associate
Professor with China Agricultural University.
His research interests include active distribu-
tion network operation and control, integrated
multi-energy system planning, economic dispatch-
ing, and optimal management energy systems.
225612 VOLUME 8, 2020
http://dx.doi.org/10.1109/ISAP48318.2019.9065963
http://dx.doi.org/10.1109/ICNSC.2015.7116075
http://dx.doi.org/10.1109/ICMLC.2006.258346
http://dx.doi.org/10.1109/ITNEC.2019.8729510
http://dx.doi.org/10.1109/CompComm.2018.8780708
http://dx.doi.org/10.1109/CompComm.2018.8780708
http://dx.doi.org/10.1109/ACCESS.2020.2990297
http://dx.doi.org/10.1109/CSO.2009.475
http://dx.doi.org/10.1109/ISGT-Asia.2011.6257101